(self.webpackChunkui=self.webpackChunkui||[]).push([[179],{867:(xp,vc,bc)=>{"use strict";function Jt(e){return"function"==typeof e}function Iu(e){const t=e(i=>{Error.call(i),i.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}const wp=Iu(e=>function(t){e(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((i,r)=>`${r+1}) ${i.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t});function g(e,n){if(e){const t=e.indexOf(n);0<=t&&e.splice(t,1)}}class mn{constructor(n){this.initialTeardown=n,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let n;if(!this.closed){this.closed=!0;const{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(const c of t)c.remove(this);else t.remove(this);const{initialTeardown:i}=this;if(Jt(i))try{i()}catch(c){n=c instanceof wp?c.errors:[c]}const{_finalizers:r}=this;if(r){this._finalizers=null;for(const c of r)try{yt(c)}catch(h){n=n??[],h instanceof wp?n=[...n,...h.errors]:n.push(h)}}if(n)throw new wp(n)}}add(n){var t;if(n&&n!==this)if(this.closed)yt(n);else{if(n instanceof mn){if(n.closed||n._hasParent(this))return;n._addParent(this)}(this._finalizers=null!==(t=this._finalizers)&&void 0!==t?t:[]).push(n)}}_hasParent(n){const{_parentage:t}=this;return t===n||Array.isArray(t)&&t.includes(n)}_addParent(n){const{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(n),t):t?[t,n]:n}_removeParent(n){const{_parentage:t}=this;t===n?this._parentage=null:Array.isArray(t)&&g(t,n)}remove(n){const{_finalizers:t}=this;t&&g(t,n),n instanceof mn&&n._removeParent(this)}}mn.EMPTY=(()=>{const e=new mn;return e.closed=!0,e})();const be=mn.EMPTY;function Ar(e){return e instanceof mn||e&&"closed"in e&&Jt(e.remove)&&Jt(e.add)&&Jt(e.unsubscribe)}function yt(e){Jt(e)?e():e.unsubscribe()}const kr={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},Os={setTimeout(e,n,...t){const{delegate:i}=Os;return i?.setTimeout?i.setTimeout(e,n,...t):setTimeout(e,n,...t)},clearTimeout(e){const{delegate:n}=Os;return(n?.clearTimeout||clearTimeout)(e)},delegate:void 0};function Xa(e){Os.setTimeout(()=>{const{onUnhandledError:n}=kr;if(!n)throw e;n(e)})}function Ao(){}const Ur=qi("C",void 0,void 0);function qi(e,n,t){return{kind:e,value:n,error:t}}let Fs=null;function gs(e){if(kr.useDeprecatedSynchronousErrorHandling){const n=!Fs;if(n&&(Fs={errorThrown:!1,error:null}),e(),n){const{errorThrown:t,error:i}=Fs;if(Fs=null,t)throw i}}else e()}class Pr extends mn{constructor(n){super(),this.isStopped=!1,n?(this.destination=n,Ar(n)&&n.add(this)):this.destination=Po}static create(n,t,i){return new oo(n,t,i)}next(n){this.isStopped?ko(function xc(e){return qi("N",e,void 0)}(n),this):this._next(n)}error(n){this.isStopped?ko(function Kn(e){return qi("E",void 0,e)}(n),this):(this.isStopped=!0,this._error(n))}complete(){this.isStopped?ko(Ur,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(n){this.destination.next(n)}_error(n){try{this.destination.error(n)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const Ls=Function.prototype.bind;function Zi(e,n){return Ls.call(e,n)}class gn{constructor(n){this.partialObserver=n}next(n){const{partialObserver:t}=this;if(t.next)try{t.next(n)}catch(i){mr(i)}}error(n){const{partialObserver:t}=this;if(t.error)try{t.error(n)}catch(i){mr(i)}else mr(n)}complete(){const{partialObserver:n}=this;if(n.complete)try{n.complete()}catch(t){mr(t)}}}class oo extends Pr{constructor(n,t,i){let r;if(super(),Jt(n)||!n)r={next:n??void 0,error:t??void 0,complete:i??void 0};else{let c;this&&kr.useDeprecatedNextContext?(c=Object.create(n),c.unsubscribe=()=>this.unsubscribe(),r={next:n.next&&Zi(n.next,c),error:n.error&&Zi(n.error,c),complete:n.complete&&Zi(n.complete,c)}):r=n}this.destination=new gn(r)}}function mr(e){kr.useDeprecatedSynchronousErrorHandling?function Rl(e){kr.useDeprecatedSynchronousErrorHandling&&Fs&&(Fs.errorThrown=!0,Fs.error=e)}(e):Xa(e)}function ko(e,n){const{onStoppedNotification:t}=kr;t&&Os.setTimeout(()=>t(e,n))}const Po={closed:!0,next:Ao,error:function ao(e){throw e},complete:Ao},ts="function"==typeof Symbol&&Symbol.observable||"@@observable";function jr(e){return e}function ca(e){return 0===e.length?jr:1===e.length?e[0]:function(t){return e.reduce((i,r)=>r(i),t)}}let Ln=(()=>{class e{constructor(t){t&&(this._subscribe=t)}lift(t){const i=new e;return i.source=this,i.operator=t,i}subscribe(t,i,r){const c=function ns(e){return e&&e instanceof Pr||function Ns(e){return e&&Jt(e.next)&&Jt(e.error)&&Jt(e.complete)}(e)&&Ar(e)}(t)?t:new oo(t,i,r);return gs(()=>{const{operator:h,source:y}=this;c.add(h?h.call(c,y):y?this._subscribe(c):this._trySubscribe(c))}),c}_trySubscribe(t){try{return this._subscribe(t)}catch(i){t.error(i)}}forEach(t,i){return new(i=Ro(i))((r,c)=>{const h=new oo({next:y=>{try{t(y)}catch(w){c(w),h.unsubscribe()}},error:c,complete:r});this.subscribe(h)})}_subscribe(t){var i;return null===(i=this.source)||void 0===i?void 0:i.subscribe(t)}[ts](){return this}pipe(...t){return ca(t)(this)}toPromise(t){return new(t=Ro(t))((i,r)=>{let c;this.subscribe(h=>c=h,h=>r(h),()=>i(c))})}}return e.create=n=>new e(n),e})();function Ro(e){var n;return null!==(n=e??kr.Promise)&&void 0!==n?n:Promise}const Yn=Iu(e=>function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let ci=(()=>{class e extends Ln{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){const i=new Ka(this,this);return i.operator=t,i}_throwIfClosed(){if(this.closed)throw new Yn}next(t){gs(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const i of this.currentObservers)i.next(t)}})}error(t){gs(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;const{observers:i}=this;for(;i.length;)i.shift().error(t)}})}complete(){gs(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return(null===(t=this.observers)||void 0===t?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){const{hasError:i,isStopped:r,observers:c}=this;return i||r?be:(this.currentObservers=null,c.push(t),new mn(()=>{this.currentObservers=null,g(c,t)}))}_checkFinalizedStatuses(t){const{hasError:i,thrownError:r,isStopped:c}=this;i?t.error(r):c&&t.complete()}asObservable(){const t=new Ln;return t.source=this,t}}return e.create=(n,t)=>new Ka(n,t),e})();class Ka extends ci{constructor(n,t){super(),this.destination=n,this.source=t}next(n){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===i||i.call(t,n)}error(n){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===i||i.call(t,n)}complete(){var n,t;null===(t=null===(n=this.destination)||void 0===n?void 0:n.complete)||void 0===t||t.call(n)}_subscribe(n){var t,i;return null!==(i=null===(t=this.source)||void 0===t?void 0:t.subscribe(n))&&void 0!==i?i:be}}function Oo(e){return Jt(e?.lift)}function Vn(e){return n=>{if(Oo(n))return n.lift(function(t){try{return e(t,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function _n(e,n,t,i,r){return new is(e,n,t,i,r)}class is extends Pr{constructor(n,t,i,r,c,h){super(n),this.onFinalize=c,this.shouldUnsubscribe=h,this._next=t?function(y){try{t(y)}catch(w){n.error(w)}}:super._next,this._error=r?function(y){try{r(y)}catch(w){n.error(w)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(y){n.error(y)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:t}=this;super.unsubscribe(),!t&&(null===(n=this.onFinalize)||void 0===n||n.call(this))}}}function Ft(e,n){return Vn((t,i)=>{let r=0;t.subscribe(_n(i,c=>{i.next(e.call(n,c,r++))}))})}function Ct(e){return this instanceof Ct?(this.v=e,this):new Ct(e)}function bt(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=function sr(e){var n="function"==typeof Symbol&&Symbol.iterator,t=n&&e[n],i=0;if(t)return t.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}(e),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(c){t[c]=e[c]&&function(h){return new Promise(function(y,w){!function r(c,h,y,w){Promise.resolve(w).then(function(I){c({value:I,done:y})},h)}(y,w,(h=e[c](h)).done,h.value)})}}}"function"==typeof SuppressedError&&SuppressedError;const V=e=>e&&"number"==typeof e.length&&"function"!=typeof e;function H(e){return Jt(e?.then)}function ee(e){return Jt(e[ts])}function ie(e){return Symbol.asyncIterator&&Jt(e?.[Symbol.asyncIterator])}function ue(e){return new TypeError(`You provided ${null!==e&&"object"==typeof e?"an invalid object":`'${e}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const se=function ae(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function he(e){return Jt(e?.[se])}function Te(e){return function Wi(e,n,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=t.apply(e,n||[]),c=[];return r={},h("next"),h("throw"),h("return"),r[Symbol.asyncIterator]=function(){return this},r;function h(G){i[G]&&(r[G]=function(re){return new Promise(function(fe,ge){c.push([G,re,fe,ge])>1||y(G,re)})})}function y(G,re){try{!function w(G){G.value instanceof Ct?Promise.resolve(G.value.v).then(I,P):z(c[0][2],G)}(i[G](re))}catch(fe){z(c[0][3],fe)}}function I(G){y("next",G)}function P(G){y("throw",G)}function z(G,re){G(re),c.shift(),c.length&&y(c[0][0],c[0][1])}}(this,arguments,function*(){const t=e.getReader();try{for(;;){const{value:i,done:r}=yield Ct(t.read());if(r)return yield Ct(void 0);yield yield Ct(i)}}finally{t.releaseLock()}})}function Ae(e){return Jt(e?.getReader)}function Ee(e){if(e instanceof Ln)return e;if(null!=e){if(ee(e))return function _t(e){return new Ln(n=>{const t=e[ts]();if(Jt(t.subscribe))return t.subscribe(n);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(e);if(V(e))return function St(e){return new Ln(n=>{for(let t=0;t<e.length&&!n.closed;t++)n.next(e[t]);n.complete()})}(e);if(H(e))return function ot(e){return new Ln(n=>{e.then(t=>{n.closed||(n.next(t),n.complete())},t=>n.error(t)).then(null,Xa)})}(e);if(ie(e))return Dt(e);if(he(e))return function pt(e){return new Ln(n=>{for(const t of e)if(n.next(t),n.closed)return;n.complete()})}(e);if(Ae(e))return function Wt(e){return Dt(Te(e))}(e)}throw ue(e)}function Dt(e){return new Ln(n=>{(function vn(e,n){var t,i,r,c;return function el(e,n,t,i){return new(t||(t=Promise))(function(c,h){function y(P){try{I(i.next(P))}catch(z){h(z)}}function w(P){try{I(i.throw(P))}catch(z){h(z)}}function I(P){P.done?c(P.value):function r(c){return c instanceof t?c:new t(function(h){h(c)})}(P.value).then(y,w)}I((i=i.apply(e,n||[])).next())})}(this,void 0,void 0,function*(){try{for(t=bt(e);!(i=yield t.next()).done;)if(n.next(i.value),n.closed)return}catch(h){r={error:h}}finally{try{i&&!i.done&&(c=t.return)&&(yield c.call(t))}finally{if(r)throw r.error}}n.complete()})})(e,n).catch(t=>n.error(t))})}function At(e,n,t,i=0,r=!1){const c=n.schedule(function(){t(),r?e.add(this.schedule(null,i)):this.unsubscribe()},i);if(e.add(c),!r)return c}function ln(e,n,t=1/0){return Jt(n)?ln((i,r)=>Ft((c,h)=>n(i,c,r,h))(Ee(e(i,r))),t):("number"==typeof n&&(t=n),Vn((i,r)=>function qt(e,n,t,i,r,c,h,y){const w=[];let I=0,P=0,z=!1;const G=()=>{z&&!w.length&&!I&&n.complete()},re=ge=>I<i?fe(ge):w.push(ge),fe=ge=>{c&&n.next(ge),I++;let Ie=!1;Ee(t(ge,P++)).subscribe(_n(n,Fe=>{r?.(Fe),c?re(Fe):n.next(Fe)},()=>{Ie=!0},void 0,()=>{if(Ie)try{for(I--;w.length&&I<i;){const Fe=w.shift();h?At(n,h,()=>fe(Fe)):fe(Fe)}G()}catch(Fe){n.error(Fe)}}))};return e.subscribe(_n(n,re,()=>{z=!0,G()})),()=>{y?.()}}(i,r,e,t)))}function gt(e=1/0){return ln(jr,e)}const bn=new Ln(e=>e.complete());function Tu(e){return e[e.length-1]}function Ki(e){return Jt(Tu(e))?e.pop():void 0}function ar(e){return function $r(e){return e&&Jt(e.schedule)}(Tu(e))?e.pop():void 0}function Fl(e,n=0){return Vn((t,i)=>{t.subscribe(_n(i,r=>At(i,e,()=>i.next(r),n),()=>At(i,e,()=>i.complete(),n),r=>At(i,e,()=>i.error(r),n)))})}function ii(e,n=0){return Vn((t,i)=>{i.add(e.schedule(()=>t.subscribe(i),n))})}function Yi(e,n){if(!e)throw new Error("Iterable cannot be null");return new Ln(t=>{At(t,n,()=>{const i=e[Symbol.asyncIterator]();At(t,n,()=>{i.next().then(r=>{r.done?t.complete():t.next(r.value)})},0,!0)})})}function Qn(e,n){return n?function $s(e,n){if(null!=e){if(ee(e))return function zo(e,n){return Ee(e).pipe(ii(n),Fl(n))}(e,n);if(V(e))return function di(e,n){return new Ln(t=>{let i=0;return n.schedule(function(){i===e.length?t.complete():(t.next(e[i++]),t.closed||this.schedule())})})}(e,n);if(H(e))return function ua(e,n){return Ee(e).pipe(ii(n),Fl(n))}(e,n);if(ie(e))return Yi(e,n);if(he(e))return function wc(e,n){return new Ln(t=>{let i;return At(t,n,()=>{i=e[se](),At(t,n,()=>{let r,c;try{({value:r,done:c}=i.next())}catch(h){return void t.error(h)}c?t.complete():t.next(r)},0,!0)}),()=>Jt(i?.return)&&i.return()})}(e,n);if(Ae(e))return function Cc(e,n){return Yi(Te(e),n)}(e,n)}throw ue(e)}(e,n):Ee(e)}class _r extends ci{constructor(n){super(),this._value=n}get value(){return this.getValue()}_subscribe(n){const t=super._subscribe(n);return!t.closed&&n.next(this._value),t}getValue(){const{hasError:n,thrownError:t,_value:i}=this;if(n)throw t;return this._throwIfClosed(),i}next(n){super.next(this._value=n)}}function Et(...e){return Qn(e,ar(e))}function co(e={}){const{connector:n=(()=>new ci),resetOnError:t=!0,resetOnComplete:i=!0,resetOnRefCountZero:r=!0}=e;return c=>{let h,y,w,I=0,P=!1,z=!1;const G=()=>{y?.unsubscribe(),y=void 0},re=()=>{G(),h=w=void 0,P=z=!1},fe=()=>{const ge=h;re(),ge?.unsubscribe()};return Vn((ge,Ie)=>{I++,!z&&!P&&G();const Fe=w=w??n();Ie.add(()=>{I--,0===I&&!z&&!P&&(y=nl(fe,r))}),Fe.subscribe(Ie),!h&&I>0&&(h=new oo({next:Ce=>Fe.next(Ce),error:Ce=>{z=!0,G(),y=nl(re,t,Ce),Fe.error(Ce)},complete:()=>{P=!0,G(),y=nl(re,i),Fe.complete()}}),Ee(ge).subscribe(h))})(c)}}function nl(e,n,...t){if(!0===n)return void e();if(!1===n)return;const i=new oo({next:()=>{i.unsubscribe(),e()}});return Ee(n(...t)).subscribe(i)}function lr(e,n){return Vn((t,i)=>{let r=null,c=0,h=!1;const y=()=>h&&!r&&i.complete();t.subscribe(_n(i,w=>{r?.unsubscribe();let I=0;const P=c++;Ee(e(w,P)).subscribe(r=_n(i,z=>i.next(n?n(w,z,P,I++):z),()=>{r=null,y()}))},()=>{h=!0,y()}))})}function Vd(e,n){return e===n}function an(e){for(let n in e)if(e[n]===an)return n;throw Error("Could not find renamed property on target object.")}function Ec(e,n){for(const t in n)n.hasOwnProperty(t)&&!e.hasOwnProperty(t)&&(e[t]=n[t])}function vi(e){if("string"==typeof e)return e;if(Array.isArray(e))return"["+e.map(vi).join(", ")+"]";if(null==e)return""+e;if(e.overriddenName)return`${e.overriddenName}`;if(e.name)return`${e.name}`;const n=e.toString();if(null==n)return""+n;const t=n.indexOf("\n");return-1===t?n:n.substring(0,t)}function Au(e,n){return null==e||""===e?null===n?"":n:null==n||""===n?e:e+" "+n}const Ud=an({__forward_ref__:an});function pn(e){return e.__forward_ref__=pn,e.toString=function(){return vi(this())},e}function It(e){return Dc(e)?e():e}function Dc(e){return"function"==typeof e&&e.hasOwnProperty(Ud)&&e.__forward_ref__===pn}function Ic(e){return e&&!!e.\u0275providers}const Pu="https://g.co/ng/security#xss";class Pe extends Error{constructor(n,t){super(function da(e,n){return`NG0${Math.abs(e)}${n?": "+n:""}`}(n,t)),this.code=n}}function vt(e){return"string"==typeof e?e:null==e?"":String(e)}function ha(e,n){throw new Pe(-201,!1)}function yr(e,n){null==e&&function Mt(e,n,t,i){throw new Error(`ASSERTION ERROR: ${e}`+(null==i?"":` [Expected=> ${t} ${i} ${n} <=Actual]`))}(n,e,null,"!=")}function ct(e){return{token:e.token,providedIn:e.providedIn||null,factory:e.factory,value:void 0}}function Fi(e){return{providers:e.providers||[],imports:e.imports||[]}}function Ac(e){return kc(e,sl)||kc(e,Lu)}function kc(e,n){return e.hasOwnProperty(n)?e[n]:null}function rl(e){return e&&(e.hasOwnProperty(Bo)||e.hasOwnProperty(Hd))?e[Bo]:null}const sl=an({\u0275prov:an}),Bo=an({\u0275inj:an}),Lu=an({ngInjectableDef:an}),Hd=an({ngInjectorDef:an});var Ut=function(e){return e[e.Default=0]="Default",e[e.Host=1]="Host",e[e.Self=2]="Self",e[e.SkipSelf=4]="SkipSelf",e[e.Optional=8]="Optional",e}(Ut||{});let uo;function Mi(e){const n=uo;return uo=e,n}function pa(e,n,t){const i=Ac(e);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:t&Ut.Optional?null:void 0!==n?n:void ha(vi(e))}const Dn=globalThis,fn={},In="__NG_DI_FLAG__",Hs="ngTempTokenPath",ju=/\n/gm,Lc="__source";let ol;function os(e){const n=ol;return ol=e,n}function Nc(e,n=Ut.Default){if(void 0===ol)throw new Pe(-203,!1);return null===ol?pa(e,void 0,n):ol.get(e,n&Ut.Optional?null:void 0,n)}function nt(e,n=Ut.Default){return(function Nu(){return uo}()||Nc)(It(e),n)}function Ke(e,n=Ut.Default){return nt(e,al(n))}function al(e){return typeof e>"u"||"number"==typeof e?e:0|(e.optional&&8)|(e.host&&1)|(e.self&&2)|(e.skipSelf&&4)}function Hu(e){const n=[];for(let t=0;t<e.length;t++){const i=It(e[t]);if(Array.isArray(i)){if(0===i.length)throw new Pe(900,!1);let r,c=Ut.Default;for(let h=0;h<i.length;h++){const y=i[h],w=hi(y);"number"==typeof w?-1===w?r=y.token:c|=w:r=y}n.push(nt(r,c))}else n.push(nt(i))}return n}function ll(e,n){return e[In]=n,e.prototype[In]=n,e}function hi(e){return e[In]}function ys(e){return{toString:e}.toString()}var ma=function(e){return e[e.OnPush=0]="OnPush",e[e.Default=1]="Default",e}(ma||{}),Hr=function(e){return e[e.Emulated=0]="Emulated",e[e.None=2]="None",e[e.ShadowDom=3]="ShadowDom",e}(Hr||{});const Li={},Zt=[],ga=an({\u0275cmp:an}),zc=an({\u0275dir:an}),cl=an({\u0275pipe:an}),ul=an({\u0275mod:an}),ls=an({\u0275fac:an}),Uo=an({__NG_ELEMENT_ID__:an}),ho=an({__NG_ENV_ID__:an});function Gu(e,n,t){let i=e.length;for(;;){const r=e.indexOf(n,t);if(-1===r)return r;if(0===r||e.charCodeAt(r-1)<=32){const c=n.length;if(r+c===i||e.charCodeAt(r+c)<=32)return r}t=r+1}}function _a(e,n,t){let i=0;for(;i<t.length;){const r=t[i];if("number"==typeof r){if(0!==r)break;i++;const c=t[i++],h=t[i++],y=t[i++];e.setAttribute(n,h,y,c)}else{const c=r,h=t[++i];Zu(c)?e.setProperty(n,c,h):e.setAttribute(n,c,h),i++}}return i}function qu(e){return 3===e||4===e||6===e}function Zu(e){return 64===e.charCodeAt(0)}function dl(e,n){if(null!==n&&0!==n.length)if(null===e||0===e.length)e=n.slice();else{let t=-1;for(let i=0;i<n.length;i++){const r=n[i];"number"==typeof r?t=r:0===t||Wu(e,t,r,null,-1===t||2===t?n[++i]:null)}}return e}function Wu(e,n,t,i,r){let c=0,h=e.length;if(-1===n)h=-1;else for(;c<e.length;){const y=e[c++];if("number"==typeof y){if(y===n){h=-1;break}if(y>n){h=c-1;break}}}for(;c<e.length;){const y=e[c];if("number"==typeof y)break;if(y===t){if(null===i)return void(null!==r&&(e[c+1]=r));if(i===e[c+1])return void(e[c+2]=r)}c++,null!==i&&c++,null!==r&&c++}-1!==h&&(e.splice(h,0,n),c=h+1),e.splice(c++,0,t),null!==i&&e.splice(c++,0,i),null!==r&&e.splice(c++,0,r)}const hl="ng-template";function jl(e,n,t){let i=0,r=!0;for(;i<e.length;){let c=e[i++];if("string"==typeof c&&r){const h=e[i++];if(t&&"class"===c&&-1!==Gu(h.toLowerCase(),n,0))return!0}else{if(1===c){for(;i<e.length&&"string"==typeof(c=e[i++]);)if(c.toLowerCase()===n)return!0;return!1}"number"==typeof c&&(r=!1)}}return!1}function Rr(e){return 4===e.type&&e.value!==hl}function bi(e,n,t){return n===(4!==e.type||t?e.value:hl)}function $l(e,n,t){let i=4;const r=e.attrs||[],c=function Tp(e){for(let n=0;n<e.length;n++)if(qu(e[n]))return n;return e.length}(r);let h=!1;for(let y=0;y<n.length;y++){const w=n[y];if("number"!=typeof w){if(!h)if(4&i){if(i=2|1&i,""!==w&&!bi(e,w,t)||""===w&&1===n.length){if(Ti(i))return!1;h=!0}}else{const I=8&i?w:n[++y];if(8&i&&null!==e.attrs){if(!jl(e.attrs,I,t)){if(Ti(i))return!1;h=!0}continue}const z=Hl(8&i?"class":w,r,Rr(e),t);if(-1===z){if(Ti(i))return!1;h=!0;continue}if(""!==I){let G;G=z>c?"":r[z+1].toLowerCase();const re=8&i?G:null;if(re&&-1!==Gu(re,I,0)||2&i&&I!==G){if(Ti(i))return!1;h=!0}}}}else{if(!h&&!Ti(i)&&!Ti(w))return!1;if(h&&Ti(w))continue;h=!1,i=w|1&i}}return Ti(i)||h}function Ti(e){return 0==(1&e)}function Hl(e,n,t,i){if(null===n)return-1;let r=0;if(i||!t){let c=!1;for(;r<n.length;){const h=n[r];if(h===e)return r;if(3===h||6===h)c=!0;else{if(1===h||2===h){let y=n[++r];for(;"string"==typeof y;)y=n[++r];continue}if(4===h)break;if(0===h){r+=4;continue}}r+=c?1:2}return-1}return function Bc(e,n){let t=e.indexOf(4);if(t>-1)for(t++;t<e.length;){const i=e[t];if("number"==typeof i)return-1;if(i===n)return t;t++}return-1}(n,e)}function Gd(e,n,t=!1){for(let i=0;i<n.length;i++)if($l(e,n[i],t))return!0;return!1}function ql(e,n){e:for(let t=0;t<n.length;t++){const i=n[t];if(e.length===i.length){for(let r=0;r<e.length;r++)if(e[r]!==i[r])continue e;return!0}}return!1}function vs(e,n){return e?":not("+n.trim()+")":n}function Je(e){let n=e[0],t=1,i=2,r="",c=!1;for(;t<e.length;){let h=e[t];if("string"==typeof h)if(2&i){const y=e[++t];r+="["+h+(y.length>0?'="'+y+'"':"")+"]"}else 8&i?r+="."+h:4&i&&(r+=" "+h);else""!==r&&!Ti(h)&&(n+=vs(c,r),r=""),i=h,c=c||!Ti(i);t++}return""!==r&&(n+=vs(c,r)),n}function Nn(e){return ys(()=>{const n=Uc(e),t={...n,decls:e.decls,vars:e.vars,template:e.template,consts:e.consts||null,ngContentSelectors:e.ngContentSelectors,onPush:e.changeDetection===ma.OnPush,directiveDefs:null,pipeDefs:null,dependencies:n.standalone&&e.dependencies||null,getStandaloneInjector:null,signals:e.signals??!1,data:e.data||{},encapsulation:e.encapsulation||Hr.Emulated,styles:e.styles||Zt,_:null,schemas:e.schemas||null,tView:null,id:""};br(t);const i=e.dependencies;return t.directiveDefs=bs(i,!1),t.pipeDefs=bs(i,!0),t.id=function Yu(e){let n=0;const t=[e.selectors,e.ngContentSelectors,e.hostVars,e.hostAttrs,e.consts,e.vars,e.decls,e.encapsulation,e.standalone,e.signals,e.exportAs,JSON.stringify(e.inputs),JSON.stringify(e.outputs),Object.getOwnPropertyNames(e.type.prototype),!!e.contentQueries,!!e.viewQuery].join("|");for(const r of t)n=Math.imul(31,n)+r.charCodeAt(0)<<0;return n+=2147483648,"c"+n}(t),t})}function Ge(e){return tn(e)||zi(e)}function Vc(e){return null!==e}function Ni(e){return ys(()=>({type:e.type,bootstrap:e.bootstrap||Zt,declarations:e.declarations||Zt,imports:e.imports||Zt,exports:e.exports||Zt,transitiveCompileScopes:null,schemas:e.schemas||null,id:e.id||null}))}function fl(e,n){if(null==e)return Li;const t={};for(const i in e)if(e.hasOwnProperty(i)){let r=e[i],c=r;Array.isArray(r)&&(c=r[1],r=r[0]),t[r]=i,n&&(n[r]=c)}return t}function xt(e){return ys(()=>{const n=Uc(e);return br(n),n})}function Qi(e){return{type:e.type,name:e.name,factory:null,pure:!1!==e.pure,standalone:!0===e.standalone,onDestroy:e.type.prototype.ngOnDestroy||null}}function tn(e){return e[ga]||null}function zi(e){return e[zc]||null}function er(e){return e[cl]||null}function vr(e,n){const t=e[ul]||null;if(!t&&!0===n)throw new Error(`Type ${vi(e)} does not have '\u0275mod' property.`);return t}function Uc(e){const n={};return{type:e.type,providersResolver:null,factory:null,hostBindings:e.hostBindings||null,hostVars:e.hostVars||0,hostAttrs:e.hostAttrs||null,contentQueries:e.contentQueries||null,declaredInputs:n,inputTransforms:null,inputConfig:e.inputs||Li,exportAs:e.exportAs||null,standalone:!0===e.standalone,signals:!0===e.signals,selectors:e.selectors||Zt,viewQuery:e.viewQuery||null,features:e.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:fl(e.inputs,n),outputs:fl(e.outputs)}}function br(e){e.features?.forEach(n=>n(e))}function bs(e,n){if(!e)return null;const t=n?er:Ge;return()=>("function"==typeof e?e():e).map(i=>t(i)).filter(Vc)}const Gn=0,Qe=1,Ot=2,Xt=3,Kt=4,jo=5,pi=6,ya=7,qn=8,po=9,ml=10,wt=11,fo=12,lt=13,ft=14,Zn=15,va=16,$o=17,ei=18,xs=19,ws=20,Ho=21,Gr=22,Sn=23,Un=24,Ht=25,ba=1,gl=2,qr=7,qs=9,ti=11;function tr(e){return Array.isArray(e)&&"object"==typeof e[ba]}function fi(e){return Array.isArray(e)&&!0===e[ba]}function Wl(e){return 0!=(4&e.flags)}function mo(e){return e.componentOffset>-1}function xa(e){return 1==(1&e.flags)}function Or(e){return!!e.template}function Xl(e){return 0!=(512&e[Ot])}function ye(e,n){return e.hasOwnProperty(ls)?e[ls]:null}let De=null,Le=!1;function We(e){const n=De;return De=e,n}const zt={version:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{}};function dt(e){if(!zn(e)||e.dirty){if(!e.producerMustRecompute(e)&&!jn(e))return void(e.dirty=!1);e.producerRecomputeValue(e),e.dirty=!1}}function Bt(e){e.dirty=!0,function rt(e){if(void 0===e.liveConsumerNode)return;const n=Le;Le=!0;try{for(const t of e.liveConsumerNode)t.dirty||Bt(t)}finally{Le=n}}(e),e.consumerMarkedDirty?.(e)}function ht(e){return e&&(e.nextProducerIndex=0),We(e)}function Lt(e,n){if(We(n),e&&void 0!==e.producerNode&&void 0!==e.producerIndexOfThis&&void 0!==e.producerLastReadVersion){if(zn(e))for(let t=e.nextProducerIndex;t<e.producerNode.length;t++)xi(e.producerNode[t],e.producerIndexOfThis[t]);for(;e.producerNode.length>e.nextProducerIndex;)e.producerNode.pop(),e.producerLastReadVersion.pop(),e.producerIndexOfThis.pop()}}function jn(e){Ai(e);for(let n=0;n<e.producerNode.length;n++){const t=e.producerNode[n],i=e.producerLastReadVersion[n];if(i!==t.version||(dt(t),i!==t.version))return!0}return!1}function un(e){if(Ai(e),zn(e))for(let n=0;n<e.producerNode.length;n++)xi(e.producerNode[n],e.producerIndexOfThis[n]);e.producerNode.length=e.producerLastReadVersion.length=e.producerIndexOfThis.length=0,e.liveConsumerNode&&(e.liveConsumerNode.length=e.liveConsumerIndexOfThis.length=0)}function xi(e,n){if(function Es(e){e.liveConsumerNode??=[],e.liveConsumerIndexOfThis??=[]}(e),Ai(e),1===e.liveConsumerNode.length)for(let i=0;i<e.producerNode.length;i++)xi(e.producerNode[i],e.producerIndexOfThis[i]);const t=e.liveConsumerNode.length-1;if(e.liveConsumerNode[n]=e.liveConsumerNode[t],e.liveConsumerIndexOfThis[n]=e.liveConsumerIndexOfThis[t],e.liveConsumerNode.length--,e.liveConsumerIndexOfThis.length--,n<e.liveConsumerNode.length){const i=e.liveConsumerIndexOfThis[n],r=e.liveConsumerNode[n];Ai(r),r.producerIndexOfThis[i]=n}}function zn(e){return e.consumerIsAlwaysLive||(e?.liveConsumerNode?.length??0)>0}function Ai(e){e.producerNode??=[],e.producerIndexOfThis??=[],e.producerLastReadVersion??=[]}let Ci=null;const Xn=()=>{},jc=(()=>({...zt,consumerIsAlwaysLive:!0,consumerAllowSignalWrites:!1,consumerMarkedDirty:e=>{e.schedule(e.ref)},hasRun:!1,cleanupFn:Xn}))();class yo{constructor(n,t,i){this.previousValue=n,this.currentValue=t,this.firstChange=i}isFirstChange(){return this.firstChange}}function Bn(){return Ea}function Ea(e){return e.type.prototype.ngOnChanges&&(e.setInput=Lm),kp}function kp(){const e=Pp(this),n=e?.current;if(n){const t=e.previous;if(t===Li)e.previous=n;else for(let i in n)t[i]=n[i];e.current=null,this.ngOnChanges(n)}}function Lm(e,n,t,i){const r=this.declaredInputs[t],c=Pp(e)||function Dy(e,n){return e[Nm]=n}(e,{previous:Li,current:null}),h=c.current||(c.current={}),y=c.previous,w=y[r];h[r]=new yo(w&&w.currentValue,n,y===Li),e[i]=n}Bn.ngInherit=!0;const Nm="__ngSimpleChanges__";function Pp(e){return e[Nm]||null}const Ks=function(e,n,t){};function xn(e){for(;Array.isArray(e);)e=e[Gn];return e}function yl(e,n){return xn(n[e])}function wr(e,n){return xn(n[e.index])}function Lp(e,n){return e.data[n]}function Yl(e,n){return e[n]}function Ds(e,n){const t=n[e];return tr(t)?t:t[Gn]}function Da(e,n){return null==n?null:e[n]}function Hc(e){e[$o]=0}function Sy(e){1024&e[Ot]||(e[Ot]|=1024,zm(e,1))}function Qu(e){1024&e[Ot]&&(e[Ot]&=-1025,zm(e,-1))}function zm(e,n){let t=e[Xt];if(null===t)return;t[jo]+=n;let i=t;for(t=t[Xt];null!==t&&(1===n&&1===i[jo]||-1===n&&0===i[jo]);)t[jo]+=n,i=t,t=t[Xt]}const kt={lFrame:Gp(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function us(){return kt.bindingsEnabled}function Jl(){return null!==kt.skipHydrationRootTNode}function Re(){return kt.lFrame.lView}function nn(){return kt.lFrame.tView}function Wo(e){return kt.lFrame.contextLView=e,e[qn]}function vl(e){return kt.lFrame.contextLView=null,e}function gi(){let e=Gc();for(;null!==e&&64===e.type;)e=e.parent;return e}function Gc(){return kt.lFrame.currentTNode}function Xo(e,n){const t=kt.lFrame;t.currentTNode=e,t.isParent=n}function Vp(){return kt.lFrame.isParent}function Up(){kt.lFrame.isParent=!1}function Cr(){const e=kt.lFrame;let n=e.bindingRootIndex;return-1===n&&(n=e.bindingRootIndex=e.tView.bindingStartIndex),n}function qc(){return kt.lFrame.bindingIndex++}function wn(e){const n=kt.lFrame,t=n.bindingIndex;return n.bindingIndex=n.bindingIndex+e,t}function Jd(e,n){const t=kt.lFrame;t.bindingIndex=t.bindingRootIndex=e,ec(n)}function ec(e){kt.lFrame.currentDirectiveIndex=e}function $p(){return kt.lFrame.currentQueryIndex}function tc(e){kt.lFrame.currentQueryIndex=e}function Hp(e){const n=e[Qe];return 2===n.type?n.declTNode:1===n.type?e[pi]:null}function th(e,n,t){if(t&Ut.SkipSelf){let r=n,c=e;for(;!(r=r.parent,null!==r||t&Ut.Host||(r=Hp(c),null===r||(c=c[ft],10&r.type))););if(null===r)return!1;n=r,e=c}const i=kt.lFrame=Gm();return i.currentTNode=n,i.lView=e,!0}function nh(e){const n=Gm(),t=e[Qe];kt.lFrame=n,n.currentTNode=t.firstChild,n.lView=e,n.tView=t,n.contextLView=e,n.bindingIndex=t.bindingStartIndex,n.inI18n=!1}function Gm(){const e=kt.lFrame,n=null===e?null:e.child;return null===n?Gp(e):n}function Gp(e){const n={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:e,child:null,inI18n:!1};return null!==e&&(e.child=n),n}function Zc(){const e=kt.lFrame;return kt.lFrame=e.parent,e.currentTNode=null,e.lView=null,e}const qm=Zc;function nd(){const e=Zc();e.isParent=!0,e.tView=null,e.selectedIndex=-1,e.contextLView=null,e.elementDepthCount=0,e.currentDirectiveIndex=-1,e.currentNamespace=null,e.bindingRootIndex=-1,e.bindingIndex=-1,e.currentQueryIndex=0}function Er(){return kt.lFrame.selectedIndex}function Sa(e){kt.lFrame.selectedIndex=e}function si(){const e=kt.lFrame;return Lp(e.tView,e.selectedIndex)}let Xm=!0;function vo(){return Xm}function bl(e){Xm=e}function Ma(e,n){for(let t=n.directiveStart,i=n.directiveEnd;t<i;t++){const c=e.data[t].type.prototype,{ngAfterContentInit:h,ngAfterContentChecked:y,ngAfterViewInit:w,ngAfterViewChecked:I,ngOnDestroy:P}=c;h&&(e.contentHooks??=[]).push(-t,h),y&&((e.contentHooks??=[]).push(t,y),(e.contentCheckHooks??=[]).push(t,y)),w&&(e.viewHooks??=[]).push(-t,w),I&&((e.viewHooks??=[]).push(t,I),(e.viewCheckHooks??=[]).push(t,I)),null!=P&&(e.destroyHooks??=[]).push(t,P)}}function ih(e,n,t){Wp(e,n,3,t)}function rh(e,n,t,i){(3&e[Ot])===t&&Wp(e,n,t,i)}function Zp(e,n){let t=e[Ot];(3&t)===n&&(t&=8191,t+=1,e[Ot]=t)}function Wp(e,n,t,i){const c=i??-1,h=n.length-1;let y=0;for(let w=void 0!==i?65535&e[$o]:0;w<h;w++)if("number"==typeof n[w+1]){if(y=n[w],null!=i&&y>=i)break}else n[w]<0&&(e[$o]+=65536),(y<c||-1==c)&&(Ny(e,t,n,w),e[$o]=(4294901760&e[$o])+w+2),w++}function Xp(e,n){Ks(4,e,n);const t=We(null);try{n.call(e)}finally{We(t),Ks(5,e,n)}}function Ny(e,n,t,i){const r=t[i]<0,c=t[i+1],y=e[r?-t[i]:t[i]];r?e[Ot]>>13<e[$o]>>16&&(3&e[Ot])===n&&(e[Ot]+=8192,Xp(y,c)):Xp(y,c)}const Wc=-1;class id{constructor(n,t,i){this.factory=n,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=i}}function Kp(e){return e!==Wc}function Ta(e){return 32767&e}function rd(e,n){let t=function Qm(e){return e>>16}(e),i=n;for(;t>0;)i=i[ft],t--;return i}let Yp=!0;function sh(e){const n=Yp;return Yp=e,n}const eg=255,tg=5;let ng=0;const Ys={};function sd(e,n){const t=rg(e,n);if(-1!==t)return t;const i=n[Qe];i.firstCreatePass&&(e.injectorIndex=n.length,oh(i.data,e),oh(n,null),oh(i.blueprint,null));const r=ic(e,n),c=e.injectorIndex;if(Kp(r)){const h=Ta(r),y=rd(r,n),w=y[Qe].data;for(let I=0;I<8;I++)n[c+I]=y[h+I]|w[h+I]}return n[c+8]=r,c}function oh(e,n){e.push(0,0,0,0,0,0,0,0,n)}function rg(e,n){return-1===e.injectorIndex||e.parent&&e.parent.injectorIndex===e.injectorIndex||null===n[e.injectorIndex+8]?-1:e.injectorIndex}function ic(e,n){if(e.parent&&-1!==e.parent.injectorIndex)return e.parent.injectorIndex;let t=0,i=null,r=n;for(;null!==r;){if(i=nf(r),null===i)return Wc;if(t++,r=r[ft],-1!==i.injectorIndex)return i.injectorIndex|t<<16}return Wc}function Jp(e,n,t){!function ig(e,n,t){let i;"string"==typeof t?i=t.charCodeAt(0)||0:t.hasOwnProperty(Uo)&&(i=t[Uo]),null==i&&(i=t[Uo]=ng++);const r=i&eg;n.data[e+(r>>tg)]|=1<<r}(e,n,t)}function og(e,n,t){if(t&Ut.Optional||void 0!==e)return e;ha()}function ag(e,n,t,i){if(t&Ut.Optional&&void 0===i&&(i=null),!(t&(Ut.Self|Ut.Host))){const r=e[po],c=Mi(void 0);try{return r?r.get(n,i,t&Ut.Optional):pa(n,i,t&Ut.Optional)}finally{Mi(c)}}return og(i,0,t)}function lg(e,n,t,i=Ut.Default,r){if(null!==e){if(2048&n[Ot]&&!(i&Ut.Self)){const h=function Kc(e,n,t,i,r){let c=e,h=n;for(;null!==c&&null!==h&&2048&h[Ot]&&!(512&h[Ot]);){const y=Qp(c,h,t,i|Ut.Self,Ys);if(y!==Ys)return y;let w=c.parent;if(!w){const I=h[ws];if(I){const P=I.get(t,Ys,i);if(P!==Ys)return P}w=nf(h),h=h[ft]}c=w}return r}(e,n,t,i,Ys);if(h!==Ys)return h}const c=Qp(e,n,t,i,Ys);if(c!==Ys)return c}return ag(n,t,i,r)}function Qp(e,n,t,i,r){const c=function Pi(e){if("string"==typeof e)return e.charCodeAt(0)||0;const n=e.hasOwnProperty(Uo)?e[Uo]:void 0;return"number"==typeof n?n>=0?n&eg:cg:n}(t);if("function"==typeof c){if(!th(n,e,i))return i&Ut.Host?og(r,0,i):ag(n,t,i,r);try{let h;if(h=c(i),null!=h||i&Ut.Optional)return h;ha()}finally{qm()}}else if("number"==typeof c){let h=null,y=rg(e,n),w=Wc,I=i&Ut.Host?n[Zn][pi]:null;for((-1===y||i&Ut.SkipSelf)&&(w=-1===y?ic(e,n):n[y+8],w!==Wc&&tf(i,!1)?(h=n[Qe],y=Ta(w),n=rd(w,n)):y=-1);-1!==y;){const P=n[Qe];if(ef(c,y,P.data)){const z=jy(y,n,t,h,i,I);if(z!==Ys)return z}w=n[y+8],w!==Wc&&tf(i,n[Qe].data[y+8]===I)&&ef(c,y,n)?(h=P,y=Ta(w),n=rd(w,n)):y=-1}}return r}function jy(e,n,t,i,r,c){const h=n[Qe],y=h.data[e+8],P=ah(y,h,t,null==i?mo(y)&&Yp:i!=h&&0!=(3&y.type),r&Ut.Host&&c===y);return null!==P?bo(n,h,P,y):Ys}function ah(e,n,t,i,r){const c=e.providerIndexes,h=n.data,y=1048575&c,w=e.directiveStart,P=c>>20,G=r?y+P:e.directiveEnd;for(let re=i?y:y+P;re<G;re++){const fe=h[re];if(re<w&&t===fe||re>=w&&fe.type===t)return re}if(r){const re=h[w];if(re&&Or(re)&&re.type===t)return w}return null}function bo(e,n,t,i){let r=e[t];const c=n.data;if(function zy(e){return e instanceof id}(r)){const h=r;h.resolving&&function Sc(e,n){const t=n?`. Dependency path: ${n.join(" > ")} > ${e}`:"";throw new Pe(-200,`Circular dependency in DI detected for ${e}${t}`)}(function Qt(e){return"function"==typeof e?e.name||e.toString():"object"==typeof e&&null!=e&&"function"==typeof e.type?e.type.name||e.type.toString():vt(e)}(c[t]));const y=sh(h.canSeeViewProviders);h.resolving=!0;const I=h.injectImpl?Mi(h.injectImpl):null;th(e,i,Ut.Default);try{r=e[t]=h.factory(void 0,c,e,i),n.firstCreatePass&&t>=i.directiveStart&&function Km(e,n,t){const{ngOnChanges:i,ngOnInit:r,ngDoCheck:c}=n.type.prototype;if(i){const h=Ea(n);(t.preOrderHooks??=[]).push(e,h),(t.preOrderCheckHooks??=[]).push(e,h)}r&&(t.preOrderHooks??=[]).push(0-e,r),c&&((t.preOrderHooks??=[]).push(e,c),(t.preOrderCheckHooks??=[]).push(e,c))}(t,c[t],n)}finally{null!==I&&Mi(I),sh(y),h.resolving=!1,qm()}}return r}function ef(e,n,t){return!!(t[n+(e>>tg)]&1<<e)}function tf(e,n){return!(e&Ut.Self||e&Ut.Host&&n)}class Dr{constructor(n,t){this._tNode=n,this._lView=t}get(n,t,i){return lg(this._tNode,this._lView,n,al(i),t)}}function cg(){return new Dr(gi(),Re())}function cr(e){return ys(()=>{const n=e.prototype.constructor,t=n[ls]||xo(n),i=Object.prototype;let r=Object.getPrototypeOf(e.prototype).constructor;for(;r&&r!==i;){const c=r[ls]||xo(r);if(c&&c!==t)return c;r=Object.getPrototypeOf(r)}return c=>new c})}function xo(e){return Dc(e)?()=>{const n=xo(It(e));return n&&n()}:ye(e)}function nf(e){const n=e[Qe],t=n.type;return 2===t?n.declTNode:1===t?e[pi]:null}const Jc="__parameters__";function eu(e,n,t){return ys(()=>{const i=function rf(e){return function(...t){if(e){const i=e(...t);for(const r in i)this[r]=i[r]}}}(n);function r(...c){if(this instanceof r)return i.apply(this,c),this;const h=new r(...c);return y.annotation=h,y;function y(w,I,P){const z=w.hasOwnProperty(Jc)?w[Jc]:Object.defineProperty(w,Jc,{value:[]})[Jc];for(;z.length<=P;)z.push(null);return(z[P]=z[P]||[]).push(h),w}}return t&&(r.prototype=Object.create(t.prototype)),r.prototype.ngMetadataName=e,r.annotationCls=r,r})}function Ko(e,n){e.forEach(t=>Array.isArray(t)?Ko(t,n):n(t))}function nu(e,n,t){n>=e.length?e.push(t):e.splice(n,0,t)}function Aa(e,n){return n>=e.length-1?e.pop():e.splice(n,1)[0]}function xl(e,n){const t=[];for(let i=0;i<e;i++)t.push(n);return t}function Is(e,n,t){let i=sc(e,n);return i>=0?e[1|i]=t:(i=~i,function mg(e,n,t,i){let r=e.length;if(r==n)e.push(t,i);else if(1===r)e.push(i,e[0]),e[0]=t;else{for(r--,e.push(e[r-1],e[r]);r>n;)e[r]=e[r-2],r--;e[n]=t,e[n+1]=i}}(e,i,n,t)),i}function uh(e,n){const t=sc(e,n);if(t>=0)return e[1|t]}function sc(e,n){return function dh(e,n,t){let i=0,r=e.length>>t;for(;r!==i;){const c=i+(r-i>>1),h=e[c<<t];if(n===h)return c<<t;h>n?r=c:i=c+1}return~(r<<t)}(e,n,1)}const ph=ll(eu("Optional"),8),ru=ll(eu("SkipSelf"),4);function bh(e){return 128==(128&e.flags)}var Oa=function(e){return e[e.Important=1]="Important",e[e.DashCase=2]="DashCase",e}(Oa||{});const ou=/^>|^->|<!--|-->|--!>|<!-$/g,Dg=/(<|>)/g,wh="\u200b$1\u200b";const au=new Map;let Ch=0;const ud="__ngContext__";function Ir(e,n){tr(n)?(e[ud]=n[xs],function av(e){au.set(e[xs],e)}(n)):e[ud]=n}let hd;function Sh(e,n){return hd(e,n)}function El(e){const n=e[Xt];return fi(n)?n[Xt]:n}function Mh(e){return Ag(e[fo])}function Th(e){return Ag(e[Kt])}function Ag(e){for(;null!==e&&!fi(e);)e=e[Kt];return e}function a(e,n,t,i,r){if(null!=i){let c,h=!1;fi(i)?c=i:tr(i)&&(h=!0,i=i[Gn]);const y=xn(i);0===e&&null!==t?null==r?pe(n,t,y):oe(n,t,y,r||null,!0):1===e&&null!==t?oe(n,t,y,r||null,!0):2===e?function Tn(e,n,t){const i=it(e,n);i&&function Me(e,n,t,i){e.removeChild(n,t,i)}(e,i,n,t)}(n,y,h):3===e&&n.destroyNode(y),null!=c&&function ur(e,n,t,i,r){const c=t[qr];c!==xn(t)&&a(n,e,i,c,r);for(let y=ti;y<t.length;y++){const w=t[y];ji(w[Qe],w,e,n,i,c)}}(n,e,c,t,r)}}function d(e,n){return e.createComment(function gf(e){return e.replace(ou,n=>n.replace(Dg,wh))}(n))}function f(e,n,t){return e.createElement(n,t)}function L(e,n){const t=e[qs],i=t.indexOf(n);Qu(n),t.splice(i,1)}function B(e,n){if(e.length<=ti)return;const t=ti+n,i=e[t];if(i){const r=i[va];null!==r&&r!==e&&L(r,i),n>0&&(e[t-1][Kt]=i[Kt]);const c=Aa(e,ti+n);!function v(e,n){ji(e,n,n[wt],2,null,null),n[Gn]=null,n[pi]=null}(i[Qe],i);const h=c[ei];null!==h&&h.detachView(c[Qe]),i[Xt]=null,i[Kt]=null,i[Ot]&=-129}return i}function j(e,n){if(!(256&n[Ot])){const t=n[wt];n[Sn]&&un(n[Sn]),n[Un]&&un(n[Un]),t.destroyNode&&ji(e,n,t,3,null,null),function S(e){let n=e[fo];if(!n)return $(e[Qe],e);for(;n;){let t=null;if(tr(n))t=n[fo];else{const i=n[ti];i&&(t=i)}if(!t){for(;n&&!n[Kt]&&n!==e;)tr(n)&&$(n[Qe],n),n=n[Xt];null===n&&(n=e),tr(n)&&$(n[Qe],n),t=n&&n[Kt]}n=t}}(n)}}function $(e,n){if(!(256&n[Ot])){n[Ot]&=-129,n[Ot]|=256,function Q(e,n){let t;if(null!=e&&null!=(t=e.destroyHooks))for(let i=0;i<t.length;i+=2){const r=n[t[i]];if(!(r instanceof id)){const c=t[i+1];if(Array.isArray(c))for(let h=0;h<c.length;h+=2){const y=r[c[h]],w=c[h+1];Ks(4,y,w);try{w.call(y)}finally{Ks(5,y,w)}}else{Ks(4,r,c);try{c.call(r)}finally{Ks(5,r,c)}}}}}(e,n),function K(e,n){const t=e.cleanup,i=n[ya];if(null!==t)for(let c=0;c<t.length-1;c+=2)if("string"==typeof t[c]){const h=t[c+3];h>=0?i[h]():i[-h].unsubscribe(),c+=2}else t[c].call(i[t[c+1]]);null!==i&&(n[ya]=null);const r=n[Ho];if(null!==r){n[Ho]=null;for(let c=0;c<r.length;c++)(0,r[c])()}}(e,n),1===n[Qe].type&&n[wt].destroy();const t=n[va];if(null!==t&&fi(n[Xt])){t!==n[Xt]&&L(t,n);const i=n[ei];null!==i&&i.detachView(e)}!function lv(e){au.delete(e[xs])}(n)}}function ne(e,n,t){return function de(e,n,t){let i=n;for(;null!==i&&40&i.type;)i=(n=i).parent;if(null===i)return t[Gn];{const{componentOffset:r}=i;if(r>-1){const{encapsulation:c}=e.data[i.directiveStart+r];if(c===Hr.None||c===Hr.Emulated)return null}return wr(i,t)}}(e,n.parent,t)}function oe(e,n,t,i,r){e.insertBefore(n,t,i,r)}function pe(e,n,t){e.appendChild(n,t)}function _e(e,n,t,i,r){null!==i?oe(e,n,t,i,r):pe(e,n,t)}function it(e,n){return e.parentNode(n)}function je(e,n,t){return et(e,n,t)}let ze,$i,Br,Yr,et=function Ne(e,n,t){return 40&e.type?wr(e,t):null};function ut(e,n,t,i){const r=ne(e,i,n),c=n[wt],y=je(i.parent||n[pi],i,n);if(null!=r)if(Array.isArray(t))for(let w=0;w<t.length;w++)_e(c,r,t[w],y,!1);else _e(c,r,t,y,!1);void 0!==ze&&ze(c,i,n,t,r)}function st(e,n){if(null!==n){const t=n.type;if(3&t)return wr(n,e);if(4&t)return Mn(-1,e[n.index]);if(8&t){const i=n.child;if(null!==i)return st(e,i);{const r=e[n.index];return fi(r)?Mn(-1,r):xn(r)}}if(32&t)return Sh(n,e)()||xn(e[n.index]);{const i=Nt(e,n);return null!==i?Array.isArray(i)?i[0]:st(El(e[Zn]),i):st(e,n.next)}}return null}function Nt(e,n){return null!==n?e[Zn][pi].projection[n.projection]:null}function Mn(e,n){const t=ti+e+1;if(t<n.length){const i=n[t],r=i[Qe].firstChild;if(null!==r)return st(i,r)}return n[qr]}function Nr(e,n,t,i,r,c,h){for(;null!=t;){const y=i[t.index],w=t.type;if(h&&0===n&&(y&&Ir(xn(y),i),t.flags|=2),32!=(32&t.flags))if(8&w)Nr(e,n,t.child,i,r,c,!1),a(n,e,r,y,c);else if(32&w){const I=Sh(t,i);let P;for(;P=I();)a(n,e,r,P,c);a(n,e,r,y,c)}else 16&w?Ri(e,n,i,t,r,c):a(n,e,r,y,c);t=h?t.projectionNext:t.next}}function ji(e,n,t,i,r,c){Nr(t,i,e.firstChild,n,r,c,!1)}function Ri(e,n,t,i,r,c){const h=t[Zn],w=h[pi].projection[i.projection];if(Array.isArray(w))for(let I=0;I<w.length;I++)a(n,e,r,w[I],c);else{let I=w;const P=h[Xt];bh(i)&&(I.flags|=128),Nr(e,n,I,P,r,c,!0)}}function _i(e,n,t){""===t?e.removeAttribute(n,"class"):e.setAttribute(n,"class",t)}function Ii(e,n,t){const{mergedAttrs:i,classes:r,styles:c}=t;null!==i&&_a(e,n,i),null!==r&&_i(e,n,r),null!==c&&function zr(e,n,t){e.setAttribute(n,"style",t)}(e,n,c)}function Hi(e){return function dr(){if(void 0===$i&&($i=null,Dn.trustedTypes))try{$i=Dn.trustedTypes.createPolicy("angular",{createHTML:e=>e,createScript:e=>e,createScriptURL:e=>e})}catch{}return $i}()?.createHTML(e)||e}function Oi(){if(void 0!==Br)return Br;if(typeof document<"u")return document;throw new Pe(210,!1)}function Ss(){if(void 0===Yr&&(Yr=null,Dn.trustedTypes))try{Yr=Dn.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:e=>e,createScript:e=>e,createScriptURL:e=>e})}catch{}return Yr}function Js(e){return Ss()?.createHTML(e)||e}function Ms(e){return Ss()?.createScriptURL(e)||e}class ds{constructor(n){this.changingThisBreaksApplicationSecurity=n}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${Pu})`}}function Qo(e){return e instanceof ds?e.changingThisBreaksApplicationSecurity:e}function Ts(e,n){const t=function Pg(e){return e instanceof ds&&e.getTypeName()||null}(e);if(null!=t&&t!==n){if("ResourceURL"===t&&"URL"===n)return!0;throw new Error(`Required a safe ${n}, got a ${t} (see ${Pu})`)}return t===n}class hv{constructor(n){this.inertDocumentHelper=n}getInertBodyElement(n){n="<body><remove></remove>"+n;try{const t=(new window.DOMParser).parseFromString(Hi(n),"text/html").body;return null===t?this.inertDocumentHelper.getInertBodyElement(n):(t.removeChild(t.firstChild),t)}catch{return null}}}class pv{constructor(n){this.defaultDoc=n,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert")}getInertBodyElement(n){const t=this.inertDocument.createElement("template");return t.innerHTML=Hi(n),t}}const wo=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function cu(e){return(e=String(e)).match(wo)?e:"unsafe:"+e}function ea(e){const n={};for(const t of e.split(","))n[t]=!0;return n}function md(...e){const n={};for(const t of e)for(const i in t)t.hasOwnProperty(i)&&(n[i]=!0);return n}const Og=ea("area,br,col,hr,img,wbr"),Fg=ea("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),pr=ea("rp,rt"),Na=md(Og,md(Fg,ea("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),md(pr,ea("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),md(pr,Fg)),eo=ea("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),Xx=md(eo,ea("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),ea("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),PT=ea("script,style,template");class RT{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(n){let t=n.firstChild,i=!0;for(;t;)if(t.nodeType===Node.ELEMENT_NODE?i=this.startElement(t):t.nodeType===Node.TEXT_NODE?this.chars(t.nodeValue):this.sanitizedSomething=!0,i&&t.firstChild)t=t.firstChild;else for(;t;){t.nodeType===Node.ELEMENT_NODE&&this.endElement(t);let r=this.checkClobberedElement(t,t.nextSibling);if(r){t=r;break}t=this.checkClobberedElement(t,t.parentNode)}return this.buf.join("")}startElement(n){const t=n.nodeName.toLowerCase();if(!Na.hasOwnProperty(t))return this.sanitizedSomething=!0,!PT.hasOwnProperty(t);this.buf.push("<"),this.buf.push(t);const i=n.attributes;for(let r=0;r<i.length;r++){const c=i.item(r),h=c.name,y=h.toLowerCase();if(!Xx.hasOwnProperty(y)){this.sanitizedSomething=!0;continue}let w=c.value;eo[y]&&(w=cu(w)),this.buf.push(" ",h,'="',Kx(w),'"')}return this.buf.push(">"),!0}endElement(n){const t=n.nodeName.toLowerCase();Na.hasOwnProperty(t)&&!Og.hasOwnProperty(t)&&(this.buf.push("</"),this.buf.push(t),this.buf.push(">"))}chars(n){this.buf.push(Kx(n))}checkClobberedElement(n,t){if(t&&(n.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${n.outerHTML}`);return t}}const OT=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,FT=/([^\#-~ |!])/g;function Kx(e){return e.replace(/&/g,"&amp;").replace(OT,function(n){return"&#"+(1024*(n.charCodeAt(0)-55296)+(n.charCodeAt(1)-56320)+65536)+";"}).replace(FT,function(n){return"&#"+n.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let Lg;function mv(e){return"content"in e&&function NT(e){return e.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===e.nodeName}(e)?e.content:null}var Ah=function(e){return e[e.NONE=0]="NONE",e[e.HTML=1]="HTML",e[e.STYLE=2]="STYLE",e[e.SCRIPT=3]="SCRIPT",e[e.URL=4]="URL",e[e.RESOURCE_URL=5]="RESOURCE_URL",e}(Ah||{});function Yx(e){const n=Cf();return n?Js(n.sanitize(Ah.HTML,e)||""):Ts(e,"HTML")?Js(Qo(e)):function LT(e,n){let t=null;try{Lg=Lg||function Rg(e){const n=new pv(e);return function fv(){try{return!!(new window.DOMParser).parseFromString(Hi(""),"text/html")}catch{return!1}}()?new hv(n):n}(e);let i=n?String(n):"";t=Lg.getInertBodyElement(i);let r=5,c=i;do{if(0===r)throw new Error("Failed to sanitize html because the input is unstable");r--,i=c,c=t.innerHTML,t=Lg.getInertBodyElement(i)}while(i!==c);return Hi((new RT).sanitizeChildren(mv(t)||t))}finally{if(t){const i=mv(t)||t;for(;i.firstChild;)i.removeChild(i.firstChild)}}}(Oi(),vt(e))}function za(e){const n=Cf();return n?n.sanitize(Ah.URL,e)||"":Ts(e,"URL")?Qo(e):cu(vt(e))}function Jx(e){const n=Cf();if(n)return Ms(n.sanitize(Ah.RESOURCE_URL,e)||"");if(Ts(e,"ResourceURL"))return Ms(Qo(e));throw new Pe(904,!1)}function Cf(){const e=Re();return e&&e[ml].sanitizer}class Xe{constructor(n,t){this._desc=n,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=ct({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}const Ef=new Xe("ENVIRONMENT_INITIALIZER"),ew=new Xe("INJECTOR",-1),tw=new Xe("INJECTOR_DEF_TYPES");class gv{get(n,t=fn){if(t===fn){const i=new Error(`NullInjectorError: No provider for ${vi(n)}!`);throw i.name="NullInjectorError",i}return t}}function $T(...e){return{\u0275providers:nw(0,e),\u0275fromNgModule:!0}}function nw(e,...n){const t=[],i=new Set;let r;const c=h=>{t.push(h)};return Ko(n,h=>{const y=h;Ng(y,c,[],i)&&(r||=[],r.push(y))}),void 0!==r&&iw(r,c),t}function iw(e,n){for(let t=0;t<e.length;t++){const{ngModule:i,providers:r}=e[t];yv(r,c=>{n(c,i)})}}function Ng(e,n,t,i){if(!(e=It(e)))return!1;let r=null,c=rl(e);const h=!c&&tn(e);if(c||h){if(h&&!h.standalone)return!1;r=e}else{const w=e.ngModule;if(c=rl(w),!c)return!1;r=w}const y=i.has(r);if(h){if(y)return!1;if(i.add(r),h.dependencies){const w="function"==typeof h.dependencies?h.dependencies():h.dependencies;for(const I of w)Ng(I,n,t,i)}}else{if(!c)return!1;{if(null!=c.imports&&!y){let I;i.add(r);try{Ko(c.imports,P=>{Ng(P,n,t,i)&&(I||=[],I.push(P))})}finally{}void 0!==I&&iw(I,n)}if(!y){const I=ye(r)||(()=>new r);n({provide:r,useFactory:I,deps:Zt},r),n({provide:tw,useValue:r,multi:!0},r),n({provide:Ef,useValue:()=>nt(r),multi:!0},r)}const w=c.providers;if(null!=w&&!y){const I=e;yv(w,P=>{n(P,I)})}}}return r!==e&&void 0!==e.providers}function yv(e,n){for(let t of e)Ic(t)&&(t=t.\u0275providers),Array.isArray(t)?yv(t,n):n(t)}const HT=an({provide:String,useValue:an});function vv(e){return null!==e&&"object"==typeof e&&HT in e}function gd(e){return"function"==typeof e}const bv=new Xe("Set Injector scope."),zg={},qT={};let xv;function Bg(){return void 0===xv&&(xv=new gv),xv}class Co{}class Vg extends Co{get destroyed(){return this._destroyed}constructor(n,t,i,r){super(),this.parent=t,this.source=i,this.scopes=r,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Cv(n,h=>this.processProvider(h)),this.records.set(ew,kh(void 0,this)),r.has("environment")&&this.records.set(Co,kh(void 0,this));const c=this.records.get(bv);null!=c&&"string"==typeof c.value&&this.scopes.add(c.value),this.injectorDefTypes=new Set(this.get(tw.multi,Zt,Ut.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const t of this._ngOnDestroyHooks)t.ngOnDestroy();const n=this._onDestroyHooks;this._onDestroyHooks=[];for(const t of n)t()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear()}}onDestroy(n){return this.assertNotDestroyed(),this._onDestroyHooks.push(n),()=>this.removeOnDestroy(n)}runInContext(n){this.assertNotDestroyed();const t=os(this),i=Mi(void 0);try{return n()}finally{os(t),Mi(i)}}get(n,t=fn,i=Ut.Default){if(this.assertNotDestroyed(),n.hasOwnProperty(ho))return n[ho](this);i=al(i);const c=os(this),h=Mi(void 0);try{if(!(i&Ut.SkipSelf)){let w=this.records.get(n);if(void 0===w){const I=function YT(e){return"function"==typeof e||"object"==typeof e&&e instanceof Xe}(n)&&Ac(n);w=I&&this.injectableDefInScope(I)?kh(wv(n),zg):null,this.records.set(n,w)}if(null!=w)return this.hydrate(n,w)}return(i&Ut.Self?Bg():this.parent).get(n,t=i&Ut.Optional&&t===fn?null:t)}catch(y){if("NullInjectorError"===y.name){if((y[Hs]=y[Hs]||[]).unshift(vi(n)),c)throw y;return function fa(e,n,t,i){const r=e[Hs];throw n[Lc]&&r.unshift(n[Lc]),e.message=function as(e,n,t,i=null){e=e&&"\n"===e.charAt(0)&&"\u0275"==e.charAt(1)?e.slice(2):e;let r=vi(n);if(Array.isArray(n))r=n.map(vi).join(" -> ");else if("object"==typeof n){let c=[];for(let h in n)if(n.hasOwnProperty(h)){let y=n[h];c.push(h+":"+("string"==typeof y?JSON.stringify(y):vi(y)))}r=`{${c.join(", ")}}`}return`${t}${i?"("+i+")":""}[${r}]: ${e.replace(ju,"\n  ")}`}("\n"+e.message,r,t,i),e.ngTokenPath=r,e[Hs]=null,e}(y,n,"R3InjectorError",this.source)}throw y}finally{Mi(h),os(c)}}resolveInjectorInitializers(){const n=os(this),t=Mi(void 0);try{const r=this.get(Ef.multi,Zt,Ut.Self);for(const c of r)c()}finally{os(n),Mi(t)}}toString(){const n=[],t=this.records;for(const i of t.keys())n.push(vi(i));return`R3Injector[${n.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Pe(205,!1)}processProvider(n){let t=gd(n=It(n))?n:It(n&&n.provide);const i=function WT(e){return vv(e)?kh(void 0,e.useValue):kh(ow(e),zg)}(n);if(gd(n)||!0!==n.multi)this.records.get(t);else{let r=this.records.get(t);r||(r=kh(void 0,zg,!0),r.factory=()=>Hu(r.multi),this.records.set(t,r)),t=n,r.multi.push(n)}this.records.set(t,i)}hydrate(n,t){return t.value===zg&&(t.value=qT,t.value=t.factory()),"object"==typeof t.value&&t.value&&function KT(e){return null!==e&&"object"==typeof e&&"function"==typeof e.ngOnDestroy}(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}injectableDefInScope(n){if(!n.providedIn)return!1;const t=It(n.providedIn);return"string"==typeof t?"any"===t||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(n){const t=this._onDestroyHooks.indexOf(n);-1!==t&&this._onDestroyHooks.splice(t,1)}}function wv(e){const n=Ac(e),t=null!==n?n.factory:ye(e);if(null!==t)return t;if(e instanceof Xe)throw new Pe(204,!1);if(e instanceof Function)return function ZT(e){const n=e.length;if(n>0)throw xl(n,"?"),new Pe(204,!1);const t=function Pc(e){return e&&(e[sl]||e[Lu])||null}(e);return null!==t?()=>t.factory(e):()=>new e}(e);throw new Pe(204,!1)}function ow(e,n,t){let i;if(gd(e)){const r=It(e);return ye(r)||wv(r)}if(vv(e))i=()=>It(e.useValue);else if(function sw(e){return!(!e||!e.useFactory)}(e))i=()=>e.useFactory(...Hu(e.deps||[]));else if(function rw(e){return!(!e||!e.useExisting)}(e))i=()=>nt(It(e.useExisting));else{const r=It(e&&(e.useClass||e.provide));if(!function XT(e){return!!e.deps}(e))return ye(r)||wv(r);i=()=>new r(...Hu(e.deps))}return i}function kh(e,n,t=!1){return{factory:e,value:n,multi:t?[]:void 0}}function Cv(e,n){for(const t of e)Array.isArray(t)?Cv(t,n):t&&Ic(t)?Cv(t.\u0275providers,n):n(t)}const Ug=new Xe("AppId",{providedIn:"root",factory:()=>JT}),JT="ng",aw=new Xe("Platform Initializer"),du=new Xe("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),lw=new Xe("AnimationModuleType"),Ev=new Xe("CSP nonce",{providedIn:"root",factory:()=>Oi().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});let cw=(e,n,t)=>null;function Pv(e,n,t=!1){return cw(e,n,t)}class lA{}class hw{}class uA{resolveComponentFactory(n){throw function cA(e){const n=Error(`No component factory found for ${vi(e)}.`);return n.ngComponent=e,n}(n)}}let Zg=(()=>{class e{static#e=this.NULL=new uA}return e})();function dA(){return Oh(gi(),Re())}function Oh(e,n){return new Mr(wr(e,n))}let Mr=(()=>{class e{constructor(t){this.nativeElement=t}static#e=this.__NG_ELEMENT_ID__=dA}return e})();function hA(e){return e instanceof Mr?e.nativeElement:e}class fw{}let lc=(()=>{class e{constructor(){this.destroyNode=null}static#e=this.__NG_ELEMENT_ID__=()=>function pA(){const e=Re(),t=Ds(gi().index,e);return(tr(t)?t:e)[wt]}()}return e})(),fA=(()=>{class e{static#e=this.\u0275prov=ct({token:e,providedIn:"root",factory:()=>null})}return e})();class _d{constructor(n){this.full=n,this.major=n.split(".")[0],this.minor=n.split(".")[1],this.patch=n.split(".").slice(2).join(".")}}const mA=new _d("16.2.7"),Fv={};function yw(e,n=null,t=null,i){const r=vw(e,n,t,i);return r.resolveInjectorInitializers(),r}function vw(e,n=null,t=null,i,r=new Set){const c=[t||Zt,$T(e)];return i=i||("object"==typeof e?void 0:vi(e)),new Vg(c,n||Bg(),i||null,r)}let Eo=(()=>{class e{static#e=this.THROW_IF_NOT_FOUND=fn;static#t=this.NULL=new gv;static create(t,i){if(Array.isArray(t))return yw({name:""},i,t,"");{const r=t.name??"";return yw({name:r},t.parent,t.providers,r)}}static#n=this.\u0275prov=ct({token:e,providedIn:"any",factory:()=>nt(ew)});static#i=this.__NG_ELEMENT_ID__=-1}return e})();function Nv(e){return e.ngOriginalError}class cc{constructor(){this._console=console}handleError(n){const t=this._findOriginalError(n);this._console.error("ERROR",n),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(n){let t=n&&Nv(n);for(;t&&Nv(t);)t=Nv(t);return t||null}}function Bv(e){return n=>{setTimeout(e,void 0,n)}}const Ve=class wA extends ci{constructor(n=!1){super(),this.__isAsync=n}emit(n){super.next(n)}subscribe(n,t,i){let r=n,c=t||(()=>null),h=i;if(n&&"object"==typeof n){const w=n;r=w.next?.bind(w),c=w.error?.bind(w),h=w.complete?.bind(w)}this.__isAsync&&(c=Bv(c),r&&(r=Bv(r)),h&&(h=Bv(h)));const y=super.subscribe({next:r,error:c,complete:h});return n instanceof mn&&n.add(y),y}};function xw(...e){}class dn{constructor({enableLongStackTrace:n=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Ve(!1),this.onMicrotaskEmpty=new Ve(!1),this.onStable=new Ve(!1),this.onError=new Ve(!1),typeof Zone>"u")throw new Pe(908,!1);Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),n&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!i&&t,r.shouldCoalesceRunChangeDetection=i,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function CA(){const e="function"==typeof Dn.requestAnimationFrame;let n=Dn[e?"requestAnimationFrame":"setTimeout"],t=Dn[e?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&n&&t){const i=n[Zone.__symbol__("OriginalDelegate")];i&&(n=i);const r=t[Zone.__symbol__("OriginalDelegate")];r&&(t=r)}return{nativeRequestAnimationFrame:n,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function IA(e){const n=()=>{!function DA(e){e.isCheckStableRunning||-1!==e.lastRequestAnimationFrameId||(e.lastRequestAnimationFrameId=e.nativeRequestAnimationFrame.call(Dn,()=>{e.fakeTopEventTask||(e.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{e.lastRequestAnimationFrameId=-1,Uv(e),e.isCheckStableRunning=!0,Vv(e),e.isCheckStableRunning=!1},void 0,()=>{},()=>{})),e.fakeTopEventTask.invoke()}),Uv(e))}(e)};e._inner=e._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,i,r,c,h,y)=>{if(function MA(e){return!(!Array.isArray(e)||1!==e.length)&&!0===e[0].data?.__ignore_ng_zone__}(y))return t.invokeTask(r,c,h,y);try{return ww(e),t.invokeTask(r,c,h,y)}finally{(e.shouldCoalesceEventChangeDetection&&"eventTask"===c.type||e.shouldCoalesceRunChangeDetection)&&n(),Cw(e)}},onInvoke:(t,i,r,c,h,y,w)=>{try{return ww(e),t.invoke(r,c,h,y,w)}finally{e.shouldCoalesceRunChangeDetection&&n(),Cw(e)}},onHasTask:(t,i,r,c)=>{t.hasTask(r,c),i===r&&("microTask"==c.change?(e._hasPendingMicrotasks=c.microTask,Uv(e),Vv(e)):"macroTask"==c.change&&(e.hasPendingMacrotasks=c.macroTask))},onHandleError:(t,i,r,c)=>(t.handleError(r,c),e.runOutsideAngular(()=>e.onError.emit(c)),!1)})}(r)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!dn.isInAngularZone())throw new Pe(909,!1)}static assertNotInAngularZone(){if(dn.isInAngularZone())throw new Pe(909,!1)}run(n,t,i){return this._inner.run(n,t,i)}runTask(n,t,i,r){const c=this._inner,h=c.scheduleEventTask("NgZoneEvent: "+r,n,EA,xw,xw);try{return c.runTask(h,t,i)}finally{c.cancelTask(h)}}runGuarded(n,t,i){return this._inner.runGuarded(n,t,i)}runOutsideAngular(n){return this._outer.run(n)}}const EA={};function Vv(e){if(0==e._nesting&&!e.hasPendingMicrotasks&&!e.isStable)try{e._nesting++,e.onMicrotaskEmpty.emit(null)}finally{if(e._nesting--,!e.hasPendingMicrotasks)try{e.runOutsideAngular(()=>e.onStable.emit(null))}finally{e.isStable=!0}}}function Uv(e){e.hasPendingMicrotasks=!!(e._hasPendingMicrotasks||(e.shouldCoalesceEventChangeDetection||e.shouldCoalesceRunChangeDetection)&&-1!==e.lastRequestAnimationFrameId)}function ww(e){e._nesting++,e.isStable&&(e.isStable=!1,e.onUnstable.emit(null))}function Cw(e){e._nesting--,Vv(e)}class SA{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Ve,this.onMicrotaskEmpty=new Ve,this.onStable=new Ve,this.onError=new Ve}run(n,t,i){return n.apply(t,i)}runGuarded(n,t,i){return n.apply(t,i)}runOutsideAngular(n){return n()}runTask(n,t,i,r){return n.apply(t,i)}}const Ew=new Xe("",{providedIn:"root",factory:Dw});function Dw(){const e=Ke(dn);let n=!0;return function hn(...e){const n=ar(e),t=function Bd(e,n){return"number"==typeof Tu(e)?e.pop():n}(e,1/0),i=e;return i.length?1===i.length?Ee(i[0]):gt(t)(Qn(i,n)):bn}(new Ln(r=>{n=e.isStable&&!e.hasPendingMacrotasks&&!e.hasPendingMicrotasks,e.runOutsideAngular(()=>{r.next(n),r.complete()})}),new Ln(r=>{let c;e.runOutsideAngular(()=>{c=e.onStable.subscribe(()=>{dn.assertNotInAngularZone(),queueMicrotask(()=>{!n&&!e.hasPendingMacrotasks&&!e.hasPendingMicrotasks&&(n=!0,r.next(!0))})})});const h=e.onUnstable.subscribe(()=>{dn.assertInAngularZone(),n&&(n=!1,e.runOutsideAngular(()=>{r.next(!1)}))});return()=>{c.unsubscribe(),h.unsubscribe()}}).pipe(co()))}function uc(e){return e instanceof Function?e():e}let jv=(()=>{class e{constructor(){this.renderDepth=0,this.handler=null}begin(){this.handler?.validateBegin(),this.renderDepth++}end(){this.renderDepth--,0===this.renderDepth&&this.handler?.execute()}ngOnDestroy(){this.handler?.destroy(),this.handler=null}static#e=this.\u0275prov=ct({token:e,providedIn:"root",factory:()=>new e})}return e})();function Sf(e){for(;e;){e[Ot]|=64;const n=El(e);if(Xl(e)&&!n)return e;e=n}return null}const Aw=new Xe("",{providedIn:"root",factory:()=>!1});let Xg=null;function Ow(e,n){return e[n]??Nw()}function Fw(e,n){const t=Nw();t.producerNode?.length&&(e[n]=Xg,t.lView=e,Xg=Lw())}const zA={...zt,consumerIsAlwaysLive:!0,consumerMarkedDirty:e=>{Sf(e.lView)},lView:null};function Lw(){return Object.create(zA)}function Nw(){return Xg??=Lw(),Xg}const Vt={};function He(e){zw(nn(),Re(),Er()+e,!1)}function zw(e,n,t,i){if(!i)if(3==(3&n[Ot])){const c=e.preOrderCheckHooks;null!==c&&ih(n,c,t)}else{const c=e.preOrderHooks;null!==c&&rh(n,c,0,t)}Sa(t)}function xe(e,n=Ut.Default){const t=Re();return null===t?nt(e,n):lg(gi(),t,It(e),n)}function Kg(e,n,t,i,r,c,h,y,w,I,P){const z=n.blueprint.slice();return z[Gn]=r,z[Ot]=140|i,(null!==I||e&&2048&e[Ot])&&(z[Ot]|=2048),Hc(z),z[Xt]=z[ft]=e,z[qn]=t,z[ml]=h||e&&e[ml],z[wt]=y||e&&e[wt],z[po]=w||e&&e[po]||null,z[pi]=c,z[xs]=function Eh(){return Ch++}(),z[Gr]=P,z[ws]=I,z[Zn]=2==n.type?e[Zn]:z,z}function Nh(e,n,t,i,r){let c=e.data[n];if(null===c)c=function $v(e,n,t,i,r){const c=Gc(),h=Vp(),w=e.data[n]=function qA(e,n,t,i,r,c){let h=n?n.injectorIndex:-1,y=0;return Jl()&&(y|=128),{type:t,index:i,insertBeforeIndex:null,injectorIndex:h,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:y,providerIndexes:0,value:r,attrs:c,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:n,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,h?c:c&&c.parent,t,n,i,r);return null===e.firstChild&&(e.firstChild=w),null!==c&&(h?null==c.child&&null!==w.parent&&(c.child=w):null===c.next&&(c.next=w,w.prev=c)),w}(e,n,t,i,r),function Yd(){return kt.lFrame.inI18n}()&&(c.flags|=32);else if(64&c.type){c.type=t,c.value=i,c.attrs=r;const h=function td(){const e=kt.lFrame,n=e.currentTNode;return e.isParent?n:n.parent}();c.injectorIndex=null===h?-1:h.injectorIndex}return Xo(c,!0),c}function Mf(e,n,t,i){if(0===t)return-1;const r=n.length;for(let c=0;c<t;c++)n.push(i),e.blueprint.push(i),e.data.push(null);return r}function Vw(e,n,t,i,r){const c=Ow(n,Sn),h=Er(),y=2&i;try{Sa(-1),y&&n.length>Ht&&zw(e,n,Ht,!1),Ks(y?2:0,r);const I=y?c:null,P=ht(I);try{null!==I&&(I.dirty=!1),t(i,r)}finally{Lt(I,P)}}finally{y&&null===n[Sn]&&Fw(n,Sn),Sa(h),Ks(y?3:1,r)}}function Hv(e,n,t){if(Wl(n)){const i=We(null);try{const c=n.directiveEnd;for(let h=n.directiveStart;h<c;h++){const y=e.data[h];y.contentQueries&&y.contentQueries(1,t[h],h)}}finally{We(i)}}}function Gv(e,n,t){us()&&(function QA(e,n,t,i){const r=t.directiveStart,c=t.directiveEnd;mo(t)&&function a2(e,n,t){const i=wr(n,e),r=Uw(t);let h=16;t.signals?h=4096:t.onPush&&(h=64);const y=Yg(e,Kg(e,r,null,h,i,n,null,e[ml].rendererFactory.createRenderer(i,t),null,null,null));e[n.index]=y}(n,t,e.data[r+t.componentOffset]),e.firstCreatePass||sd(t,n),Ir(i,n);const h=t.initialInputs;for(let y=r;y<c;y++){const w=e.data[y],I=bo(n,e,y,t);Ir(I,n),null!==h&&l2(0,y-r,I,w,0,h),Or(w)&&(Ds(t.index,n)[qn]=bo(n,e,y,t))}}(e,n,t,wr(t,n)),64==(64&t.flags)&&qw(e,n,t))}function qv(e,n,t=wr){const i=n.localNames;if(null!==i){let r=n.index+1;for(let c=0;c<i.length;c+=2){const h=i[c+1],y=-1===h?t(n,e):e[h];e[r++]=y}}}function Uw(e){const n=e.tView;return null===n||n.incompleteFirstPass?e.tView=Zv(1,null,e.template,e.decls,e.vars,e.directiveDefs,e.pipeDefs,e.viewQuery,e.schemas,e.consts,e.id):n}function Zv(e,n,t,i,r,c,h,y,w,I,P){const z=Ht+i,G=z+r,re=function VA(e,n){const t=[];for(let i=0;i<n;i++)t.push(i<e?null:Vt);return t}(z,G),fe="function"==typeof I?I():I;return re[Qe]={type:e,blueprint:re,template:t,queries:null,viewQuery:y,declTNode:n,data:re.slice().fill(null,z),bindingStartIndex:z,expandoStartIndex:G,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof c?c():c,pipeRegistry:"function"==typeof h?h():h,firstChild:null,schemas:w,consts:fe,incompleteFirstPass:!1,ssrId:P}}let jw=e=>null;function $w(e,n,t,i){for(let r in e)if(e.hasOwnProperty(r)){t=null===t?{}:t;const c=e[r];null===i?Hw(t,n,r,c):i.hasOwnProperty(r)&&Hw(t,n,i[r],c)}return t}function Hw(e,n,t,i){e.hasOwnProperty(t)?e[t].push(n,i):e[t]=[n,i]}function Do(e,n,t,i,r,c,h,y){const w=wr(n,t);let P,I=n.inputs;!y&&null!=I&&(P=I[i])?(Jv(e,t,P,i,r),mo(n)&&function XA(e,n){const t=Ds(n,e);16&t[Ot]||(t[Ot]|=64)}(t,n.index)):3&n.type&&(i=function WA(e){return"class"===e?"className":"for"===e?"htmlFor":"formaction"===e?"formAction":"innerHtml"===e?"innerHTML":"readonly"===e?"readOnly":"tabindex"===e?"tabIndex":e}(i),r=null!=h?h(r,n.value||"",i):r,c.setProperty(w,i,r))}function Wv(e,n,t,i){if(us()){const r=null===i?null:{"":-1},c=function t2(e,n){const t=e.directiveRegistry;let i=null,r=null;if(t)for(let c=0;c<t.length;c++){const h=t[c];if(Gd(n,h.selectors,!1))if(i||(i=[]),Or(h))if(null!==h.findHostDirectiveDefs){const y=[];r=r||new Map,h.findHostDirectiveDefs(h,y,r),i.unshift(...y,h),Xv(e,n,y.length)}else i.unshift(h),Xv(e,n,0);else r=r||new Map,h.findHostDirectiveDefs?.(h,i,r),i.push(h)}return null===i?null:[i,r]}(e,t);let h,y;null===c?h=y=null:[h,y]=c,null!==h&&Gw(e,n,t,h,r,y),r&&function n2(e,n,t){if(n){const i=e.localNames=[];for(let r=0;r<n.length;r+=2){const c=t[n[r+1]];if(null==c)throw new Pe(-301,!1);i.push(n[r],c)}}}(t,i,r)}t.mergedAttrs=dl(t.mergedAttrs,t.attrs)}function Gw(e,n,t,i,r,c){for(let I=0;I<i.length;I++)Jp(sd(t,n),e,i[I].type);!function s2(e,n,t){e.flags|=1,e.directiveStart=n,e.directiveEnd=n+t,e.providerIndexes=n}(t,e.data.length,i.length);for(let I=0;I<i.length;I++){const P=i[I];P.providersResolver&&P.providersResolver(P)}let h=!1,y=!1,w=Mf(e,n,i.length,null);for(let I=0;I<i.length;I++){const P=i[I];t.mergedAttrs=dl(t.mergedAttrs,P.hostAttrs),o2(e,t,n,w,P),r2(w,P,r),null!==P.contentQueries&&(t.flags|=4),(null!==P.hostBindings||null!==P.hostAttrs||0!==P.hostVars)&&(t.flags|=64);const z=P.type.prototype;!h&&(z.ngOnChanges||z.ngOnInit||z.ngDoCheck)&&((e.preOrderHooks??=[]).push(t.index),h=!0),!y&&(z.ngOnChanges||z.ngDoCheck)&&((e.preOrderCheckHooks??=[]).push(t.index),y=!0),w++}!function ZA(e,n,t){const r=n.directiveEnd,c=e.data,h=n.attrs,y=[];let w=null,I=null;for(let P=n.directiveStart;P<r;P++){const z=c[P],G=t?t.get(z):null,fe=G?G.outputs:null;w=$w(z.inputs,P,w,G?G.inputs:null),I=$w(z.outputs,P,I,fe);const ge=null===w||null===h||Rr(n)?null:c2(w,P,h);y.push(ge)}null!==w&&(w.hasOwnProperty("class")&&(n.flags|=8),w.hasOwnProperty("style")&&(n.flags|=16)),n.initialInputs=y,n.inputs=w,n.outputs=I}(e,t,c)}function qw(e,n,t){const i=t.directiveStart,r=t.directiveEnd,c=t.index,h=function Qd(){return kt.lFrame.currentDirectiveIndex}();try{Sa(c);for(let y=i;y<r;y++){const w=e.data[y],I=n[y];ec(y),(null!==w.hostBindings||0!==w.hostVars||null!==w.hostAttrs)&&e2(w,I)}}finally{Sa(-1),ec(h)}}function e2(e,n){null!==e.hostBindings&&e.hostBindings(1,n)}function Xv(e,n,t){n.componentOffset=t,(e.components??=[]).push(n.index)}function r2(e,n,t){if(t){if(n.exportAs)for(let i=0;i<n.exportAs.length;i++)t[n.exportAs[i]]=e;Or(n)&&(t[""]=e)}}function o2(e,n,t,i,r){e.data[i]=r;const c=r.factory||(r.factory=ye(r.type)),h=new id(c,Or(r),xe);e.blueprint[i]=h,t[i]=h,function YA(e,n,t,i,r){const c=r.hostBindings;if(c){let h=e.hostBindingOpCodes;null===h&&(h=e.hostBindingOpCodes=[]);const y=~n.index;(function JA(e){let n=e.length;for(;n>0;){const t=e[--n];if("number"==typeof t&&t<0)return t}return 0})(h)!=y&&h.push(y),h.push(t,i,c)}}(e,n,i,Mf(e,t,r.hostVars,Vt),r)}function Dl(e,n,t,i,r,c){const h=wr(e,n);!function Kv(e,n,t,i,r,c,h){if(null==c)e.removeAttribute(n,r,t);else{const y=null==h?vt(c):h(c,i||"",r);e.setAttribute(n,r,y,t)}}(n[wt],h,c,e.value,t,i,r)}function l2(e,n,t,i,r,c){const h=c[n];if(null!==h)for(let y=0;y<h.length;)Zw(i,t,h[y++],h[y++],h[y++])}function Zw(e,n,t,i,r){const c=We(null);try{const h=e.inputTransforms;null!==h&&h.hasOwnProperty(i)&&(r=h[i].call(n,r)),null!==e.setInput?e.setInput(n,r,t,i):n[i]=r}finally{We(c)}}function c2(e,n,t){let i=null,r=0;for(;r<t.length;){const c=t[r];if(0!==c)if(5!==c){if("number"==typeof c)break;if(e.hasOwnProperty(c)){null===i&&(i=[]);const h=e[c];for(let y=0;y<h.length;y+=2)if(h[y]===n){i.push(c,h[y+1],t[r+1]);break}}r+=2}else r+=2;else r+=4}return i}function Ww(e,n,t,i){return[e,!0,!1,n,null,0,i,t,null,null,null]}function Xw(e,n){const t=e.contentQueries;if(null!==t)for(let i=0;i<t.length;i+=2){const c=t[i+1];if(-1!==c){const h=e.data[c];tc(t[i]),h.contentQueries(2,n[c],c)}}}function Yg(e,n){return e[fo]?e[lt][Kt]=n:e[fo]=n,e[lt]=n,n}function Yv(e,n,t){tc(0);const i=We(null);try{n(e,t)}finally{We(i)}}function Kw(e){return e[ya]||(e[ya]=[])}function Yw(e){return e.cleanup||(e.cleanup=[])}function Qw(e,n){const t=e[po],i=t?t.get(cc,null):null;i&&i.handleError(n)}function Jv(e,n,t,i,r){for(let c=0;c<t.length;){const h=t[c++],y=t[c++];Zw(e.data[h],n[h],i,y,r)}}function dc(e,n,t){const i=yl(n,e);!function l(e,n,t){e.setValue(n,t)}(e[wt],i,t)}function u2(e,n){const t=Ds(n,e),i=t[Qe];!function d2(e,n){for(let t=n.length;t<e.blueprint.length;t++)n.push(e.blueprint[t])}(i,t);const r=t[Gn];null!==r&&null===t[Gr]&&(t[Gr]=Pv(r,t[po])),Qv(i,t,t[qn])}function Qv(e,n,t){nh(n);try{const i=e.viewQuery;null!==i&&Yv(1,i,t);const r=e.template;null!==r&&Vw(e,n,r,1,t),e.firstCreatePass&&(e.firstCreatePass=!1),e.staticContentQueries&&Xw(e,n),e.staticViewQueries&&Yv(2,e.viewQuery,t);const c=e.components;null!==c&&function h2(e,n){for(let t=0;t<n.length;t++)u2(e,n[t])}(n,c)}catch(i){throw e.firstCreatePass&&(e.incompleteFirstPass=!0,e.firstCreatePass=!1),i}finally{n[Ot]&=-5,nd()}}let e1=(()=>{class e{constructor(){this.all=new Set,this.queue=new Map}create(t,i,r){const c=typeof Zone>"u"?null:Zone.current,h=function Ca(e,n,t){const i=Object.create(jc);t&&(i.consumerAllowSignalWrites=!0),i.fn=e,i.schedule=n;const r=h=>{i.cleanupFn=h};return i.ref={notify:()=>Bt(i),run:()=>{if(i.dirty=!1,i.hasRun&&!jn(i))return;i.hasRun=!0;const h=ht(i);try{i.cleanupFn(),i.cleanupFn=Xn,i.fn(r)}finally{Lt(i,h)}},cleanup:()=>i.cleanupFn()},i.ref}(t,I=>{this.all.has(I)&&this.queue.set(I,c)},r);let y;this.all.add(h),h.notify();const w=()=>{h.cleanup(),y?.(),this.all.delete(h),this.queue.delete(h)};return y=i?.onDestroy(w),{destroy:w}}flush(){if(0!==this.queue.size)for(const[t,i]of this.queue)this.queue.delete(t),i?i.run(()=>t.run()):t.run()}get isQueueEmpty(){return 0===this.queue.size}static#e=this.\u0275prov=ct({token:e,providedIn:"root",factory:()=>new e})}return e})();function Jg(e,n,t){let i=t?e.styles:null,r=t?e.classes:null,c=0;if(null!==n)for(let h=0;h<n.length;h++){const y=n[h];"number"==typeof y?c=y:1==c?r=Au(r,y):2==c&&(i=Au(i,y+": "+n[++h]+";"))}t?e.styles=i:e.stylesWithoutHost=i,t?e.classes=r:e.classesWithoutHost=r}function Tf(e,n,t,i,r=!1){for(;null!==t;){const c=n[t.index];null!==c&&i.push(xn(c)),fi(c)&&t1(c,i);const h=t.type;if(8&h)Tf(e,n,t.child,i);else if(32&h){const y=Sh(t,n);let w;for(;w=y();)i.push(w)}else if(16&h){const y=Nt(n,t);if(Array.isArray(y))i.push(...y);else{const w=El(n[Zn]);Tf(w[Qe],w,y,i,!0)}}t=r?t.projectionNext:t.next}return i}function t1(e,n){for(let t=ti;t<e.length;t++){const i=e[t],r=i[Qe].firstChild;null!==r&&Tf(i[Qe],i,r,n)}e[qr]!==e[Gn]&&n.push(e[qr])}function Qg(e,n,t,i=!0){const r=n[ml],c=r.rendererFactory,h=r.afterRenderEventManager;c.begin?.(),h?.begin();try{n1(e,n,e.template,t)}catch(w){throw i&&Qw(n,w),w}finally{c.end?.(),r.effectManager?.flush(),h?.end()}}function n1(e,n,t,i){const r=n[Ot];if(256!=(256&r)){n[ml].effectManager?.flush(),nh(n);try{Hc(n),function Ql(e){return kt.lFrame.bindingIndex=e}(e.bindingStartIndex),null!==t&&Vw(e,n,t,2,i);const h=3==(3&r);if(h){const I=e.preOrderCheckHooks;null!==I&&ih(n,I,null)}else{const I=e.preOrderHooks;null!==I&&rh(n,I,0,null),Zp(n,0)}if(function m2(e){for(let n=Mh(e);null!==n;n=Th(n)){if(!n[gl])continue;const t=n[qs];for(let i=0;i<t.length;i++){Sy(t[i])}}}(n),r1(n,2),null!==e.contentQueries&&Xw(e,n),h){const I=e.contentCheckHooks;null!==I&&ih(n,I)}else{const I=e.contentHooks;null!==I&&rh(n,I,1),Zp(n,1)}!function BA(e,n){const t=e.hostBindingOpCodes;if(null===t)return;const i=Ow(n,Un);try{for(let r=0;r<t.length;r++){const c=t[r];if(c<0)Sa(~c);else{const h=c,y=t[++r],w=t[++r];Jd(y,h),i.dirty=!1;const I=ht(i);try{w(2,n[h])}finally{Lt(i,I)}}}}finally{null===n[Un]&&Fw(n,Un),Sa(-1)}}(e,n);const y=e.components;null!==y&&o1(n,y,0);const w=e.viewQuery;if(null!==w&&Yv(2,w,i),h){const I=e.viewCheckHooks;null!==I&&ih(n,I)}else{const I=e.viewHooks;null!==I&&rh(n,I,2),Zp(n,2)}!0===e.firstUpdatePass&&(e.firstUpdatePass=!1),n[Ot]&=-73,Qu(n)}finally{nd()}}}function r1(e,n){for(let t=Mh(e);null!==t;t=Th(t))for(let i=ti;i<t.length;i++)s1(t[i],n)}function g2(e,n,t){s1(Ds(n,e),t)}function s1(e,n){if(!function $c(e){return 128==(128&e[Ot])}(e))return;const t=e[Qe],i=e[Ot];if(80&i&&0===n||1024&i||2===n)n1(t,e,t.template,e[qn]);else if(e[jo]>0){r1(e,1);const r=t.components;null!==r&&o1(e,r,1)}}function o1(e,n,t){for(let i=0;i<n.length;i++)g2(e,n[i],t)}class Af{get rootNodes(){const n=this._lView,t=n[Qe];return Tf(t,n,t.firstChild,[])}constructor(n,t){this._lView=n,this._cdRefInjectingView=t,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[qn]}set context(n){this._lView[qn]=n}get destroyed(){return 256==(256&this._lView[Ot])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const n=this._lView[Xt];if(fi(n)){const t=n[8],i=t?t.indexOf(this):-1;i>-1&&(B(n,i),Aa(t,i))}this._attachedToViewContainer=!1}j(this._lView[Qe],this._lView)}onDestroy(n){!function zp(e,n){if(256==(256&e[Ot]))throw new Pe(911,!1);null===e[Ho]&&(e[Ho]=[]),e[Ho].push(n)}(this._lView,n)}markForCheck(){Sf(this._cdRefInjectingView||this._lView)}detach(){this._lView[Ot]&=-129}reattach(){this._lView[Ot]|=128}detectChanges(){Qg(this._lView[Qe],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new Pe(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function C(e,n){ji(e,n,n[wt],2,null,null)}(this._lView[Qe],this._lView)}attachToAppRef(n){if(this._attachedToViewContainer)throw new Pe(902,!1);this._appRef=n}}class _2 extends Af{constructor(n){super(n),this._view=n}detectChanges(){const n=this._view;Qg(n[Qe],n,n[qn],!1)}checkNoChanges(){}get context(){return null}}class a1 extends Zg{constructor(n){super(),this.ngModule=n}resolveComponentFactory(n){const t=tn(n);return new kf(t,this.ngModule)}}function l1(e){const n=[];for(let t in e)e.hasOwnProperty(t)&&n.push({propName:e[t],templateName:t});return n}class v2{constructor(n,t){this.injector=n,this.parentInjector=t}get(n,t,i){i=al(i);const r=this.injector.get(n,Fv,i);return r!==Fv||t===Fv?r:this.parentInjector.get(n,t,i)}}class kf extends hw{get inputs(){const n=this.componentDef,t=n.inputTransforms,i=l1(n.inputs);if(null!==t)for(const r of i)t.hasOwnProperty(r.propName)&&(r.transform=t[r.propName]);return i}get outputs(){return l1(this.componentDef.outputs)}constructor(n,t){super(),this.componentDef=n,this.ngModule=t,this.componentType=n.type,this.selector=function pl(e){return e.map(Je).join(",")}(n.selectors),this.ngContentSelectors=n.ngContentSelectors?n.ngContentSelectors:[],this.isBoundToModule=!!t}create(n,t,i,r){let c=(r=r||this.ngModule)instanceof Co?r:r?.injector;c&&null!==this.componentDef.getStandaloneInjector&&(c=this.componentDef.getStandaloneInjector(c)||c);const h=c?new v2(n,c):n,y=h.get(fw,null);if(null===y)throw new Pe(407,!1);const z={rendererFactory:y,sanitizer:h.get(fA,null),effectManager:h.get(e1,null),afterRenderEventManager:h.get(jv,null)},G=y.createRenderer(null,this.componentDef),re=this.componentDef.selectors[0][0]||"div",fe=i?function UA(e,n,t,i){const c=i.get(Aw,!1)||t===Hr.ShadowDom,h=e.selectRootElement(n,c);return function jA(e){jw(e)}(h),h}(G,i,this.componentDef.encapsulation,h):f(G,re,function y2(e){const n=e.toLowerCase();return"svg"===n?"svg":"math"===n?"math":null}(re)),Fe=this.componentDef.signals?4608:this.componentDef.onPush?576:528;let Ce=null;null!==fe&&(Ce=Pv(fe,h,!0));const at=Zv(0,null,null,1,0,null,null,null,null,null,null),Tt=Kg(null,at,null,Fe,null,null,z,G,h,null,Ce);let Yt,Vr;nh(Tt);try{const Pl=this.componentDef;let zd,Lx=null;Pl.findHostDirectiveDefs?(zd=[],Lx=new Map,Pl.findHostDirectiveDefs(Pl,zd,Lx),zd.push(Pl)):zd=[Pl];const l5=function x2(e,n){const t=e[Qe],i=Ht;return e[i]=n,Nh(t,i,2,"#host",null)}(Tt,fe),c5=function w2(e,n,t,i,r,c,h){const y=r[Qe];!function C2(e,n,t,i){for(const r of e)n.mergedAttrs=dl(n.mergedAttrs,r.hostAttrs);null!==n.mergedAttrs&&(Jg(n,n.mergedAttrs,!0),null!==t&&Ii(i,t,n))}(i,e,n,h);let w=null;null!==n&&(w=Pv(n,r[po]));const I=c.rendererFactory.createRenderer(n,t);let P=16;t.signals?P=4096:t.onPush&&(P=64);const z=Kg(r,Uw(t),null,P,r[e.index],e,c,I,null,null,w);return y.firstCreatePass&&Xv(y,e,i.length-1),Yg(r,z),r[e.index]=z}(l5,fe,Pl,zd,Tt,z,G);Vr=Lp(at,Ht),fe&&function D2(e,n,t,i){if(i)_a(e,t,["ng-version",mA.full]);else{const{attrs:r,classes:c}=function Zl(e){const n=[],t=[];let i=1,r=2;for(;i<e.length;){let c=e[i];if("string"==typeof c)2===r?""!==c&&n.push(c,e[++i]):8===r&&t.push(c);else{if(!Ti(r))break;r=c}i++}return{attrs:n,classes:t}}(n.selectors[0]);r&&_a(e,t,r),c&&c.length>0&&_i(e,t,c.join(" "))}}(G,Pl,fe,i),void 0!==t&&function I2(e,n,t){const i=e.projection=[];for(let r=0;r<n.length;r++){const c=t[r];i.push(null!=c?Array.from(c):null)}}(Vr,this.ngContentSelectors,t),Yt=function E2(e,n,t,i,r,c){const h=gi(),y=r[Qe],w=wr(h,r);Gw(y,r,h,t,null,i);for(let P=0;P<t.length;P++)Ir(bo(r,y,h.directiveStart+P,h),r);qw(y,r,h),w&&Ir(w,r);const I=bo(r,y,h.directiveStart+h.componentOffset,h);if(e[qn]=r[qn]=I,null!==c)for(const P of c)P(I,n);return Hv(y,h,e),I}(c5,Pl,zd,Lx,Tt,[S2]),Qv(at,Tt,null)}finally{nd()}return new b2(this.componentType,Yt,Oh(Vr,Tt),Tt,Vr)}}class b2 extends lA{constructor(n,t,i,r,c){super(),this.location=i,this._rootLView=r,this._tNode=c,this.previousInputValues=null,this.instance=t,this.hostView=this.changeDetectorRef=new _2(r),this.componentType=n}setInput(n,t){const i=this._tNode.inputs;let r;if(null!==i&&(r=i[n])){if(this.previousInputValues??=new Map,this.previousInputValues.has(n)&&Object.is(this.previousInputValues.get(n),t))return;const c=this._rootLView;Jv(c[Qe],c,r,n,t),this.previousInputValues.set(n,t),Sf(Ds(this._tNode.index,c))}}get injector(){return new Dr(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(n){this.hostView.onDestroy(n)}}function S2(){const e=gi();Ma(Re()[Qe],e)}function Rn(e){let n=function c1(e){return Object.getPrototypeOf(e.prototype).constructor}(e.type),t=!0;const i=[e];for(;n;){let r;if(Or(e))r=n.\u0275cmp||n.\u0275dir;else{if(n.\u0275cmp)throw new Pe(903,!1);r=n.\u0275dir}if(r){if(t){i.push(r);const h=e;h.inputs=e_(e.inputs),h.inputTransforms=e_(e.inputTransforms),h.declaredInputs=e_(e.declaredInputs),h.outputs=e_(e.outputs);const y=r.hostBindings;y&&k2(e,y);const w=r.viewQuery,I=r.contentQueries;if(w&&T2(e,w),I&&A2(e,I),Ec(e.inputs,r.inputs),Ec(e.declaredInputs,r.declaredInputs),Ec(e.outputs,r.outputs),null!==r.inputTransforms&&(null===h.inputTransforms&&(h.inputTransforms={}),Ec(h.inputTransforms,r.inputTransforms)),Or(r)&&r.data.animation){const P=e.data;P.animation=(P.animation||[]).concat(r.data.animation)}}const c=r.features;if(c)for(let h=0;h<c.length;h++){const y=c[h];y&&y.ngInherit&&y(e),y===Rn&&(t=!1)}}n=Object.getPrototypeOf(n)}!function M2(e){let n=0,t=null;for(let i=e.length-1;i>=0;i--){const r=e[i];r.hostVars=n+=r.hostVars,r.hostAttrs=dl(r.hostAttrs,t=dl(t,r.hostAttrs))}}(i)}function e_(e){return e===Li?{}:e===Zt?[]:e}function T2(e,n){const t=e.viewQuery;e.viewQuery=t?(i,r)=>{n(i,r),t(i,r)}:n}function A2(e,n){const t=e.contentQueries;e.contentQueries=t?(i,r,c)=>{n(i,r,c),t(i,r,c)}:n}function k2(e,n){const t=e.hostBindings;e.hostBindings=t?(i,r)=>{n(i,r),t(i,r)}:n}function p1(e){const n=e.inputConfig,t={};for(const i in n)if(n.hasOwnProperty(i)){const r=n[i];Array.isArray(r)&&r[2]&&(t[i]=r[2])}e.inputTransforms=t}function t_(e){return!!eb(e)&&(Array.isArray(e)||!(e instanceof Map)&&Symbol.iterator in e)}function eb(e){return null!==e&&("function"==typeof e||"object"==typeof e)}function Il(e,n,t){return e[n]=t}function hs(e,n,t){return!Object.is(e[n],t)&&(e[n]=t,!0)}function yd(e,n,t,i){const r=hs(e,n,t);return hs(e,n+1,i)||r}function Ba(e,n,t,i){const r=Re();return hs(r,qc(),n)&&(nn(),Dl(si(),r,e,n,t,i)),Ba}function Bh(e,n,t,i){return hs(e,qc(),t)?n+vt(t)+i:Vt}function Vh(e,n,t,i,r,c){const y=yd(e,function Ia(){return kt.lFrame.bindingIndex}(),t,r);return wn(2),y?n+vt(t)+i+vt(r)+c:Vt}function An(e,n,t,i,r,c,h,y){const w=Re(),I=nn(),P=e+Ht,z=I.firstCreatePass?function nk(e,n,t,i,r,c,h,y,w){const I=n.consts,P=Nh(n,e,4,h||null,Da(I,y));Wv(n,t,P,Da(I,w)),Ma(n,P);const z=P.tView=Zv(2,P,i,r,c,n.directiveRegistry,n.pipeRegistry,null,n.schemas,I,null);return null!==n.queries&&(n.queries.template(n,P),z.queries=n.queries.embeddedTView(P)),P}(P,I,w,n,t,i,r,c,h):I.data[P];Xo(z,!1);const G=I1(I,w,z,e);vo()&&ut(I,w,G,z),Ir(G,w),Yg(w,w[P]=Ww(G,w,G,z)),xa(z)&&Gv(I,w,z),null!=h&&qv(w,z,y)}let I1=function S1(e,n,t,i){return bl(!0),n[wt].createComment("")};function mt(e,n,t){const i=Re();return hs(i,qc(),n)&&Do(nn(),si(),i,e,n,i[wt],t,!1),mt}function ob(e,n,t,i,r){const h=r?"class":"style";Jv(e,t,n.inputs[h],h,i)}function tt(e,n,t,i){const r=Re(),c=nn(),h=Ht+e,y=r[wt],w=c.firstCreatePass?function ak(e,n,t,i,r,c){const h=n.consts,w=Nh(n,e,2,i,Da(h,r));return Wv(n,t,w,Da(h,c)),null!==w.attrs&&Jg(w,w.attrs,!1),null!==w.mergedAttrs&&Jg(w,w.mergedAttrs,!0),null!==n.queries&&n.queries.elementStart(n,w),w}(h,c,r,n,t,i):c.data[h],I=M1(c,r,w,y,n,e);r[h]=I;const P=xa(w);return Xo(w,!0),Ii(y,I,w),32!=(32&w.flags)&&vo()&&ut(c,r,I,w),0===function jm(){return kt.lFrame.elementDepthCount}()&&Ir(I,r),function Bp(){kt.lFrame.elementDepthCount++}(),P&&(Gv(c,r,w),Hv(c,w,r)),null!==i&&qv(r,w),tt}function Ye(){let e=gi();Vp()?Up():(e=e.parent,Xo(e,!1));const n=e;(function My(e){return kt.skipHydrationRootTNode===e})(n)&&function ky(){kt.skipHydrationRootTNode=null}(),function ed(){kt.lFrame.elementDepthCount--}();const t=nn();return t.firstCreatePass&&(Ma(t,e),Wl(e)&&t.queries.elementEnd(e)),null!=n.classesWithoutHost&&function By(e){return 0!=(8&e.flags)}(n)&&ob(t,n,Re(),n.classesWithoutHost,!0),null!=n.stylesWithoutHost&&function Vy(e){return 0!=(16&e.flags)}(n)&&ob(t,n,Re(),n.stylesWithoutHost,!1),Ye}function sn(e,n,t,i){return tt(e,n,t,i),Ye(),sn}let M1=(e,n,t,i,r,c)=>(bl(!0),f(i,r,function Wm(){return kt.lFrame.currentNamespace}()));function vd(e,n,t){const i=Re(),r=nn(),c=e+Ht,h=r.firstCreatePass?function uk(e,n,t,i,r){const c=n.consts,h=Da(c,i),y=Nh(n,e,8,"ng-container",h);return null!==h&&Jg(y,h,!0),Wv(n,t,y,Da(c,r)),null!==n.queries&&n.queries.elementStart(n,y),y}(c,r,i,n,t):r.data[c];Xo(h,!0);const y=A1(r,i,h,e);return i[c]=y,vo()&&ut(r,i,y,h),Ir(y,i),xa(h)&&(Gv(r,i,h),Hv(r,h,i)),null!=t&&qv(i,h),vd}function bd(){let e=gi();const n=nn();return Vp()?Up():(e=e.parent,Xo(e,!1)),n.firstCreatePass&&(Ma(n,e),Wl(e)&&n.queries.elementEnd(e)),bd}let A1=(e,n,t,i)=>(bl(!0),d(n[wt],""));function o_(){return Re()}function Lf(e){return!!e&&"function"==typeof e.then}function k1(e){return!!e&&"function"==typeof e.subscribe}function yi(e,n,t,i){const r=Re(),c=nn(),h=gi();return function R1(e,n,t,i,r,c,h){const y=xa(i),I=e.firstCreatePass&&Yw(e),P=n[qn],z=Kw(n);let G=!0;if(3&i.type||h){const ge=wr(i,n),Ie=h?h(ge):ge,Fe=z.length,Ce=h?Tt=>h(xn(Tt[i.index])):i.index;let at=null;if(!h&&y&&(at=function pk(e,n,t,i){const r=e.cleanup;if(null!=r)for(let c=0;c<r.length-1;c+=2){const h=r[c];if(h===t&&r[c+1]===i){const y=n[ya],w=r[c+2];return y.length>w?y[w]:null}"string"==typeof h&&(c+=2)}return null}(e,n,r,i.index)),null!==at)(at.__ngLastListenerFn__||at).__ngNextListenerFn__=c,at.__ngLastListenerFn__=c,G=!1;else{c=F1(i,n,P,c,!1);const Tt=t.listen(Ie,r,c);z.push(c,Tt),I&&I.push(r,Ce,Fe,Fe+1)}}else c=F1(i,n,P,c,!1);const re=i.outputs;let fe;if(G&&null!==re&&(fe=re[r])){const ge=fe.length;if(ge)for(let Ie=0;Ie<ge;Ie+=2){const Yt=n[fe[Ie]][fe[Ie+1]].subscribe(c),Vr=z.length;z.push(c,Yt),I&&I.push(r,i.index,Vr,-(Vr+1))}}}(c,r,r[wt],h,e,n,i),yi}function O1(e,n,t,i){try{return Ks(6,n,t),!1!==t(i)}catch(r){return Qw(e,r),!1}finally{Ks(7,n,t)}}function F1(e,n,t,i,r){return function c(h){if(h===Function)return i;Sf(e.componentOffset>-1?Ds(e.index,n):n);let w=O1(n,t,i,h),I=c.__ngNextListenerFn__;for(;I;)w=O1(n,t,I,h)&&w,I=I.__ngNextListenerFn__;return r&&!1===w&&h.preventDefault(),w}}function En(e=1){return function Ry(e){return(kt.lFrame.contextLView=function qp(e,n){for(;e>0;)n=n[ft],e--;return n}(e,kt.lFrame.contextLView))[qn]}(e)}function fk(e,n){let t=null;const i=function Gl(e){const n=e.attrs;if(null!=n){const t=n.indexOf(5);if(!(1&t))return n[t+1]}return null}(e);for(let r=0;r<n.length;r++){const c=n[r];if("*"!==c){if(null===i?Gd(e,c,!0):ql(i,c))return r}else t=r}return t}function Nf(e){const n=Re()[Zn][pi];if(!n.projection){const i=n.projection=xl(e?e.length:1,null),r=i.slice();let c=n.child;for(;null!==c;){const h=e?fk(c,e):0;null!==h&&(r[h]?r[h].projectionNext=c:i[h]=c,r[h]=c),c=c.next}}}function zf(e,n=0,t){const i=Re(),r=nn(),c=Nh(r,Ht+e,16,null,t||null);null===c.projection&&(c.projection=n),Up(),(!i[Gr]||Jl())&&32!=(32&c.flags)&&function Di(e,n,t){Ri(n[wt],0,n,t,ne(e,t,n),je(t.parent||n[pi],t,n))}(r,i,c)}function Va(e,n,t,i,r){const c=Re(),h=Bh(c,n,t,i);return h!==Vt&&Do(nn(),si(),c,e,h,c[wt],r,!1),Va}function a_(e,n,t,i,r,c,h){const y=Re(),w=Vh(y,n,t,i,r,c);return w!==Vt&&Do(nn(),si(),y,e,w,y[wt],h,!1),a_}function l_(e,n){return e<<17|n<<2}function hu(e){return e>>17&32767}function ab(e){return 2|e}function xd(e){return(131068&e)>>2}function lb(e,n){return-131069&e|n<<2}function cb(e){return 1|e}function H1(e,n,t,i,r){const c=e[t+1],h=null===n;let y=i?hu(c):xd(c),w=!1;for(;0!==y&&(!1===w||h);){const P=e[y+1];bk(e[y],n)&&(w=!0,e[y+1]=i?cb(P):ab(P)),y=i?hu(P):xd(P)}w&&(e[t+1]=i?ab(c):cb(c))}function bk(e,n){return null===e||null==n||(Array.isArray(e)?e[1]:e)===n||!(!Array.isArray(e)||"string"!=typeof n)&&sc(e,n)>=0}const Tr={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function G1(e){return e.substring(Tr.key,Tr.keyEnd)}function xk(e){return e.substring(Tr.value,Tr.valueEnd)}function q1(e,n){const t=Tr.textEnd;return t===n?-1:(n=Tr.keyEnd=function Ek(e,n,t){for(;n<t&&e.charCodeAt(n)>32;)n++;return n}(e,Tr.key=n,t),Zh(e,n,t))}function Z1(e,n){const t=Tr.textEnd;let i=Tr.key=Zh(e,n,t);return t===i?-1:(i=Tr.keyEnd=function Dk(e,n,t){let i;for(;n<t&&(45===(i=e.charCodeAt(n))||95===i||(-33&i)>=65&&(-33&i)<=90||i>=48&&i<=57);)n++;return n}(e,i,t),i=X1(e,i,t),i=Tr.value=Zh(e,i,t),i=Tr.valueEnd=function Ik(e,n,t){let i=-1,r=-1,c=-1,h=n,y=h;for(;h<t;){const w=e.charCodeAt(h++);if(59===w)return y;34===w||39===w?y=h=K1(e,w,h,t):n===h-4&&85===c&&82===r&&76===i&&40===w?y=h=K1(e,41,h,t):w>32&&(y=h),c=r,r=i,i=-33&w}return y}(e,i,t),X1(e,i,t))}function W1(e){Tr.key=0,Tr.keyEnd=0,Tr.value=0,Tr.valueEnd=0,Tr.textEnd=e.length}function Zh(e,n,t){for(;n<t&&e.charCodeAt(n)<=32;)n++;return n}function X1(e,n,t,i){return(n=Zh(e,n,t))<t&&n++,n}function K1(e,n,t,i){let r=-1,c=t;for(;c<i;){const h=e.charCodeAt(c++);if(h==n&&92!==r)return c;r=92==h&&92===r?0:h}throw new Error}function ub(e,n,t){return Ua(e,n,t,!1),ub}function Wh(e,n){return Ua(e,n,null,!0),Wh}function ia(e){ja(Q1,Sk,e,!1)}function Sk(e,n){for(let t=function Ck(e){return W1(e),Z1(e,Zh(e,0,Tr.textEnd))}(n);t>=0;t=Z1(n,t))Q1(e,G1(n),xk(n))}function db(e){ja(Rk,Sl,e,!0)}function Sl(e,n){for(let t=function wk(e){return W1(e),q1(e,Zh(e,0,Tr.textEnd))}(n);t>=0;t=q1(n,t))Is(e,G1(n),!0)}function Ua(e,n,t,i){const r=Re(),c=nn(),h=wn(2);c.firstUpdatePass&&J1(c,e,h,i),n!==Vt&&hs(r,h,n)&&eC(c,c.data[Er()],r,r[wt],e,r[h+1]=function Fk(e,n){return null==e||""===e||("string"==typeof n?e+=n:"object"==typeof e&&(e=vi(Qo(e)))),e}(n,t),i,h)}function ja(e,n,t,i){const r=nn(),c=wn(2);r.firstUpdatePass&&J1(r,null,c,i);const h=Re();if(t!==Vt&&hs(h,c,t)){const y=r.data[Er()];if(nC(y,i)&&!Y1(r,c)){let w=i?y.classesWithoutHost:y.stylesWithoutHost;null!==w&&(t=Au(w,t||"")),ob(r,y,h,t,i)}else!function Ok(e,n,t,i,r,c,h,y){r===Vt&&(r=Zt);let w=0,I=0,P=0<r.length?r[0]:null,z=0<c.length?c[0]:null;for(;null!==P||null!==z;){const G=w<r.length?r[w+1]:void 0,re=I<c.length?c[I+1]:void 0;let ge,fe=null;P===z?(w+=2,I+=2,G!==re&&(fe=z,ge=re)):null===z||null!==P&&P<z?(w+=2,fe=P):(I+=2,fe=z,ge=re),null!==fe&&eC(e,n,t,i,fe,ge,h,y),P=w<r.length?r[w]:null,z=I<c.length?c[I]:null}}(r,y,h,h[wt],h[c+1],h[c+1]=function Pk(e,n,t){if(null==t||""===t)return Zt;const i=[],r=Qo(t);if(Array.isArray(r))for(let c=0;c<r.length;c++)e(i,r[c],!0);else if("object"==typeof r)for(const c in r)r.hasOwnProperty(c)&&e(i,c,r[c]);else"string"==typeof r&&n(i,r);return i}(e,n,t),i,c)}}function Y1(e,n){return n>=e.expandoStartIndex}function J1(e,n,t,i){const r=e.data;if(null===r[t+1]){const c=r[Er()],h=Y1(e,t);nC(c,i)&&null===n&&!h&&(n=!1),n=function Mk(e,n,t,i){const r=function eh(e){const n=kt.lFrame.currentDirectiveIndex;return-1===n?null:e[n]}(e);let c=i?n.residualClasses:n.residualStyles;if(null===r)0===(i?n.classBindings:n.styleBindings)&&(t=Bf(t=hb(null,e,n,t,i),n.attrs,i),c=null);else{const h=n.directiveStylingLast;if(-1===h||e[h]!==r)if(t=hb(r,e,n,t,i),null===c){let w=function Tk(e,n,t){const i=t?n.classBindings:n.styleBindings;if(0!==xd(i))return e[hu(i)]}(e,n,i);void 0!==w&&Array.isArray(w)&&(w=hb(null,e,n,w[1],i),w=Bf(w,n.attrs,i),function Ak(e,n,t,i){e[hu(t?n.classBindings:n.styleBindings)]=i}(e,n,i,w))}else c=function kk(e,n,t){let i;const r=n.directiveEnd;for(let c=1+n.directiveStylingLast;c<r;c++)i=Bf(i,e[c].hostAttrs,t);return Bf(i,n.attrs,t)}(e,n,i)}return void 0!==c&&(i?n.residualClasses=c:n.residualStyles=c),t}(r,c,n,i),function yk(e,n,t,i,r,c){let h=c?n.classBindings:n.styleBindings,y=hu(h),w=xd(h);e[i]=t;let P,I=!1;if(Array.isArray(t)?(P=t[1],(null===P||sc(t,P)>0)&&(I=!0)):P=t,r)if(0!==w){const G=hu(e[y+1]);e[i+1]=l_(G,y),0!==G&&(e[G+1]=lb(e[G+1],i)),e[y+1]=function gk(e,n){return 131071&e|n<<17}(e[y+1],i)}else e[i+1]=l_(y,0),0!==y&&(e[y+1]=lb(e[y+1],i)),y=i;else e[i+1]=l_(w,0),0===y?y=i:e[w+1]=lb(e[w+1],i),w=i;I&&(e[i+1]=ab(e[i+1])),H1(e,P,i,!0),H1(e,P,i,!1),function vk(e,n,t,i,r){const c=r?e.residualClasses:e.residualStyles;null!=c&&"string"==typeof n&&sc(c,n)>=0&&(t[i+1]=cb(t[i+1]))}(n,P,e,i,c),h=l_(y,w),c?n.classBindings=h:n.styleBindings=h}(r,c,n,t,h,i)}}function hb(e,n,t,i,r){let c=null;const h=t.directiveEnd;let y=t.directiveStylingLast;for(-1===y?y=t.directiveStart:y++;y<h&&(c=n[y],i=Bf(i,c.hostAttrs,r),c!==e);)y++;return null!==e&&(t.directiveStylingLast=y),i}function Bf(e,n,t){const i=t?1:2;let r=-1;if(null!==n)for(let c=0;c<n.length;c++){const h=n[c];"number"==typeof h?r=h:r===i&&(Array.isArray(e)||(e=void 0===e?[]:["",e]),Is(e,h,!!t||n[++c]))}return void 0===e?null:e}function Q1(e,n,t){Is(e,n,Qo(t))}function Rk(e,n,t){const i=String(n);""!==i&&!i.includes(" ")&&Is(e,i,t)}function eC(e,n,t,i,r,c,h,y){if(!(3&n.type))return;const w=e.data,I=w[y+1],P=function _k(e){return 1==(1&e)}(I)?tC(w,n,t,r,xd(I),h):void 0;c_(P)||(c_(c)||function mk(e){return 2==(2&e)}(I)&&(c=tC(w,null,t,r,y,h)),function Xr(e,n,t,i,r){if(n)r?e.addClass(t,i):e.removeClass(t,i);else{let c=-1===i.indexOf("-")?void 0:Oa.DashCase;null==r?e.removeStyle(t,i,c):("string"==typeof r&&r.endsWith("!important")&&(r=r.slice(0,-10),c|=Oa.Important),e.setStyle(t,i,r,c))}}(i,h,yl(Er(),t),r,c))}function tC(e,n,t,i,r,c){const h=null===n;let y;for(;r>0;){const w=e[r],I=Array.isArray(w),P=I?w[1]:w,z=null===P;let G=t[r+1];G===Vt&&(G=z?Zt:void 0);let re=z?uh(G,i):P===i?G:void 0;if(I&&!c_(re)&&(re=uh(w,i)),c_(re)&&(y=re,h))return y;const fe=e[r+1];r=h?hu(fe):xd(fe)}if(null!==n){let w=c?n.residualClasses:n.residualStyles;null!=w&&(y=uh(w,i))}return y}function c_(e){return void 0!==e}function nC(e,n){return 0!=(e.flags&(n?8:16))}function Rt(e,n=""){const t=Re(),i=nn(),r=e+Ht,c=i.firstCreatePass?Nh(i,r,1,n,null):i.data[r],h=iC(i,t,c,n,e);t[r]=h,vo()&&ut(i,t,h,c),Xo(c,!1)}let iC=(e,n,t,i,r)=>(bl(!0),function s(e,n){return e.createText(n)}(n[wt],i));function ra(e){return Qr("",e,""),ra}function Qr(e,n,t){const i=Re(),r=Bh(i,e,n,t);return r!==Vt&&dc(i,Er(),r),Qr}function pb(e,n,t,i,r){const c=Re(),h=Vh(c,e,n,t,i,r);return h!==Vt&&dc(c,Er(),h),pb}function fb(e,n,t){ja(Is,Sl,Bh(Re(),e,n,t),!0)}const wd=void 0;var nP=["en",[["a","p"],["AM","PM"],wd],[["AM","PM"],wd,wd],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],wd,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],wd,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",wd,"{1} 'at' {0}",wd],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function tP(e){const t=Math.floor(Math.abs(e)),i=e.toString().replace(/^[^.]*\.?/,"").length;return 1===t&&0===i?1:5}];let Xh={};function As(e){const n=function iP(e){return e.toLowerCase().replace(/_/g,"-")}(e);let t=CC(n);if(t)return t;const i=n.split("-")[0];if(t=CC(i),t)return t;if("en"===i)return nP;throw new Pe(701,!1)}function CC(e){return e in Xh||(Xh[e]=Dn.ng&&Dn.ng.common&&Dn.ng.common.locales&&Dn.ng.common.locales[e]),Xh[e]}var ai=function(e){return e[e.LocaleId=0]="LocaleId",e[e.DayPeriodsFormat=1]="DayPeriodsFormat",e[e.DayPeriodsStandalone=2]="DayPeriodsStandalone",e[e.DaysFormat=3]="DaysFormat",e[e.DaysStandalone=4]="DaysStandalone",e[e.MonthsFormat=5]="MonthsFormat",e[e.MonthsStandalone=6]="MonthsStandalone",e[e.Eras=7]="Eras",e[e.FirstDayOfWeek=8]="FirstDayOfWeek",e[e.WeekendRange=9]="WeekendRange",e[e.DateFormat=10]="DateFormat",e[e.TimeFormat=11]="TimeFormat",e[e.DateTimeFormat=12]="DateTimeFormat",e[e.NumberSymbols=13]="NumberSymbols",e[e.NumberFormats=14]="NumberFormats",e[e.CurrencyCode=15]="CurrencyCode",e[e.CurrencySymbol=16]="CurrencySymbol",e[e.CurrencyName=17]="CurrencyName",e[e.Currencies=18]="Currencies",e[e.Directionality=19]="Directionality",e[e.PluralCase=20]="PluralCase",e[e.ExtraData=21]="ExtraData",e}(ai||{});const Kh="en-US";let EC=Kh;function _b(e,n,t,i,r){if(e=It(e),Array.isArray(e))for(let c=0;c<e.length;c++)_b(e[c],n,t,i,r);else{const c=nn(),h=Re(),y=gi();let w=gd(e)?e:It(e.provide);const I=ow(e),P=1048575&y.providerIndexes,z=y.directiveStart,G=y.providerIndexes>>20;if(gd(e)||!e.multi){const re=new id(I,r,xe),fe=vb(w,n,r?P:P+G,z);-1===fe?(Jp(sd(y,h),c,w),yb(c,e,n.length),n.push(w),y.directiveStart++,y.directiveEnd++,r&&(y.providerIndexes+=1048576),t.push(re),h.push(re)):(t[fe]=re,h[fe]=re)}else{const re=vb(w,n,P+G,z),fe=vb(w,n,P,P+G),Ie=fe>=0&&t[fe];if(r&&!Ie||!r&&!(re>=0&&t[re])){Jp(sd(y,h),c,w);const Fe=function tR(e,n,t,i,r){const c=new id(e,t,xe);return c.multi=[],c.index=n,c.componentProviders=0,XC(c,r,i&&!t),c}(r?eR:QP,t.length,r,i,I);!r&&Ie&&(t[fe].providerFactory=Fe),yb(c,e,n.length,0),n.push(w),y.directiveStart++,y.directiveEnd++,r&&(y.providerIndexes+=1048576),t.push(Fe),h.push(Fe)}else yb(c,e,re>-1?re:fe,XC(t[r?fe:re],I,!r&&i));!r&&i&&Ie&&t[fe].componentProviders++}}}function yb(e,n,t,i){const r=gd(n),c=function GT(e){return!!e.useClass}(n);if(r||c){const w=(c?It(n.useClass):n).prototype.ngOnDestroy;if(w){const I=e.destroyHooks||(e.destroyHooks=[]);if(!r&&n.multi){const P=I.indexOf(t);-1===P?I.push(t,[i,w]):I[P+1].push(i,w)}else I.push(t,w)}}}function XC(e,n,t){return t&&e.componentProviders++,e.multi.push(n)-1}function vb(e,n,t,i){for(let r=t;r<i;r++)if(n[r]===e)return r;return-1}function QP(e,n,t,i){return bb(this.multi,[])}function eR(e,n,t,i){const r=this.multi;let c;if(this.providerFactory){const h=this.providerFactory.componentProviders,y=bo(t,t[Qe],this.providerFactory.index,i);c=y.slice(0,h),bb(r,c);for(let w=h;w<y.length;w++)c.push(y[w])}else c=[],bb(r,c);return c}function bb(e,n){for(let t=0;t<e.length;t++)n.push((0,e[t])());return n}function $n(e,n=[]){return t=>{t.providersResolver=(i,r)=>function JP(e,n,t){const i=nn();if(i.firstCreatePass){const r=Or(e);_b(t,i.data,i.blueprint,r,!0),_b(n,i.data,i.blueprint,r,!1)}}(i,r?r(e):e,n)}}class Cd{}class KC{}class xb extends Cd{constructor(n,t,i){super(),this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new a1(this);const r=vr(n);this._bootstrapComponents=uc(r.bootstrap),this._r3Injector=vw(n,t,[{provide:Cd,useValue:this},{provide:Zg,useValue:this.componentFactoryResolver},...i],vi(n),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(n)}get injector(){return this._r3Injector}destroy(){const n=this._r3Injector;!n.destroyed&&n.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(n){this.destroyCbs.push(n)}}class wb extends KC{constructor(n){super(),this.moduleType=n}create(n){return new xb(this.moduleType,n,[])}}class YC extends Cd{constructor(n){super(),this.componentFactoryResolver=new a1(this),this.instance=null;const t=new Vg([...n.providers,{provide:Cd,useValue:this},{provide:Zg,useValue:this.componentFactoryResolver}],n.parent||Bg(),n.debugName,new Set(["environment"]));this.injector=t,n.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(n){this.injector.onDestroy(n)}}function Cb(e,n,t=null){return new YC({providers:e,parent:n,debugName:t,runEnvironmentInitializers:!0}).injector}let rR=(()=>{class e{constructor(t){this._injector=t,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){const i=nw(0,t.type),r=i.length>0?Cb([i],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t,r)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(const t of this.cachedInjectors.values())null!==t&&t.destroy()}finally{this.cachedInjectors.clear()}}static#e=this.\u0275prov=ct({token:e,providedIn:"environment",factory:()=>new e(nt(Co))})}return e})();function JC(e){e.getStandaloneInjector=n=>n.get(rR).getOrCreateStandaloneInjector(e)}function es(e,n,t){const i=Cr()+e,r=Re();return r[i]===Vt?Il(r,i,t?n.call(t):n()):function Pf(e,n){return e[n]}(r,i)}function Yh(e,n,t,i){return sE(Re(),Cr(),e,n,t,i)}function Gf(e,n){const t=e[n];return t===Vt?void 0:t}function sE(e,n,t,i,r,c){const h=n+t;return hs(e,h,r)?Il(e,h+1,c?i.call(c,r):i(r)):Gf(e,h+1)}function no(e,n){const t=nn();let i;const r=e+Ht;t.firstCreatePass?(i=function xR(e,n){if(n)for(let t=n.length-1;t>=0;t--){const i=n[t];if(e===i.name)return i}}(n,t.pipeRegistry),t.data[r]=i,i.onDestroy&&(t.destroyHooks??=[]).push(r,i.onDestroy)):i=t.data[r];const c=i.factory||(i.factory=ye(i.type)),y=Mi(xe);try{const w=sh(!1),I=c();return sh(w),function sk(e,n,t,i){t>=e.data.length&&(e.data[t]=null,e.blueprint[t]=null),n[t]=i}(t,Re(),r,I),I}finally{Mi(y)}}function Io(e,n,t){const i=e+Ht,r=Re(),c=Yl(r,i);return qf(r,i)?sE(r,Cr(),n,c.transform,t,c):c.transform(t)}function uE(e,n,t,i){const r=e+Ht,c=Re(),h=Yl(c,r);return qf(c,r)?function oE(e,n,t,i,r,c,h){const y=n+t;return yd(e,y,r,c)?Il(e,y+2,h?i.call(h,r,c):i(r,c)):Gf(e,y+2)}(c,Cr(),n,h.transform,t,i,h):h.transform(t,i)}function qf(e,n){return e[Qe].data[n].pure}function DR(){return this._results[Symbol.iterator]()}class Db{static#e=Symbol.iterator;get changes(){return this._changes||(this._changes=new Ve)}constructor(n=!1){this._emitDistinctChangesOnly=n,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const t=Db.prototype;t[Symbol.iterator]||(t[Symbol.iterator]=DR)}get(n){return this._results[n]}map(n){return this._results.map(n)}filter(n){return this._results.filter(n)}find(n){return this._results.find(n)}reduce(n,t){return this._results.reduce(n,t)}forEach(n){this._results.forEach(n)}some(n){return this._results.some(n)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(n,t){const i=this;i.dirty=!1;const r=function nr(e){return e.flat(Number.POSITIVE_INFINITY)}(n);(this._changesDetected=!function fg(e,n,t){if(e.length!==n.length)return!1;for(let i=0;i<e.length;i++){let r=e[i],c=n[i];if(t&&(r=t(r),c=t(c)),c!==r)return!1}return!0}(i._results,r,t))&&(i._results=r,i.length=r.length,i.last=r[this.length-1],i.first=r[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}function SR(e,n,t,i=!0){const r=n[Qe];if(function T(e,n,t,i){const r=ti+i,c=t.length;i>0&&(t[r-1][Kt]=n),i<c-ti?(n[Kt]=t[r],nu(t,ti+i,n)):(t.push(n),n[Kt]=null),n[Xt]=t;const h=n[va];null!==h&&t!==h&&function O(e,n){const t=e[qs];n[Zn]!==n[Xt][Xt][Zn]&&(e[gl]=!0),null===t?e[qs]=[n]:t.push(n)}(h,n);const y=n[ei];null!==y&&y.insertView(e),n[Ot]|=128}(r,n,e,t),i){const c=Mn(t,e),h=n[wt],y=it(h,e[qr]);null!==y&&function x(e,n,t,i,r,c){i[Gn]=r,i[pi]=n,ji(e,i,t,1,r,c)}(r,e[pi],h,n,y,c)}}let hc=(()=>{class e{static#e=this.__NG_ELEMENT_ID__=AR}return e})();const MR=hc,TR=class extends MR{constructor(n,t,i){super(),this._declarationLView=n,this._declarationTContainer=t,this.elementRef=i}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(n,t){return this.createEmbeddedViewImpl(n,t)}createEmbeddedViewImpl(n,t,i){const r=function IR(e,n,t,i){const r=n.tView,y=Kg(e,r,t,4096&e[Ot]?4096:16,null,n,null,null,null,i?.injector??null,i?.hydrationInfo??null);y[va]=e[n.index];const I=e[ei];return null!==I&&(y[ei]=I.createEmbeddedView(r)),Qv(r,y,t),y}(this._declarationLView,this._declarationTContainer,n,{injector:t,hydrationInfo:i});return new Af(r)}};function AR(){return f_(gi(),Re())}function f_(e,n){return 4&e.type?new TR(n,e,Oh(e,n)):null}let $a=(()=>{class e{static#e=this.__NG_ELEMENT_ID__=LR}return e})();function LR(){return _E(gi(),Re())}const NR=$a,mE=class extends NR{constructor(n,t,i){super(),this._lContainer=n,this._hostTNode=t,this._hostLView=i}get element(){return Oh(this._hostTNode,this._hostLView)}get injector(){return new Dr(this._hostTNode,this._hostLView)}get parentInjector(){const n=ic(this._hostTNode,this._hostLView);if(Kp(n)){const t=rd(n,this._hostLView),i=Ta(n);return new Dr(t[Qe].data[i+8],t)}return new Dr(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(n){const t=gE(this._lContainer);return null!==t&&t[n]||null}get length(){return this._lContainer.length-ti}createEmbeddedView(n,t,i){let r,c;"number"==typeof i?r=i:null!=i&&(r=i.index,c=i.injector);const y=n.createEmbeddedViewImpl(t||{},c,null);return this.insertImpl(y,r,false),y}createComponent(n,t,i,r,c){const h=n&&!function rc(e){return"function"==typeof e}(n);let y;if(h)y=t;else{const ge=t||{};y=ge.index,i=ge.injector,r=ge.projectableNodes,c=ge.environmentInjector||ge.ngModuleRef}const w=h?n:new kf(tn(n)),I=i||this.parentInjector;if(!c&&null==w.ngModule){const Ie=(h?I:this.parentInjector).get(Co,null);Ie&&(c=Ie)}tn(w.componentType??{});const re=w.create(I,r,null,c);return this.insertImpl(re.hostView,y,false),re}insert(n,t){return this.insertImpl(n,t,!1)}insertImpl(n,t,i){const r=n._lView;if(function Np(e){return fi(e[Xt])}(r)){const w=this.indexOf(n);if(-1!==w)this.detach(w);else{const I=r[Xt],P=new mE(I,I[pi],I[Xt]);P.detach(P.indexOf(n))}}const h=this._adjustIndex(t),y=this._lContainer;return SR(y,r,h,!i),n.attachToViewContainerRef(),nu(Ib(y),h,n),n}move(n,t){return this.insert(n,t)}indexOf(n){const t=gE(this._lContainer);return null!==t?t.indexOf(n):-1}remove(n){const t=this._adjustIndex(n,-1),i=B(this._lContainer,t);i&&(Aa(Ib(this._lContainer),t),j(i[Qe],i))}detach(n){const t=this._adjustIndex(n,-1),i=B(this._lContainer,t);return i&&null!=Aa(Ib(this._lContainer),t)?new Af(i):null}_adjustIndex(n,t=0){return n??this.length+t}};function gE(e){return e[8]}function Ib(e){return e[8]||(e[8]=[])}function _E(e,n){let t;const i=n[e.index];return fi(i)?t=i:(t=Ww(i,n,null,e),n[e.index]=t,Yg(n,t)),yE(t,n,e,i),new mE(t,e,n)}let yE=function vE(e,n,t,i){if(e[qr])return;let r;r=8&t.type?xn(i):function zR(e,n){const t=e[wt],i=t.createComment(""),r=wr(n,e);return oe(t,it(t,r),i,function qe(e,n){return e.nextSibling(n)}(t,r),!1),i}(n,t),e[qr]=r};class Sb{constructor(n){this.queryList=n,this.matches=null}clone(){return new Sb(this.queryList)}setDirty(){this.queryList.setDirty()}}class Mb{constructor(n=[]){this.queries=n}createEmbeddedView(n){const t=n.queries;if(null!==t){const i=null!==n.contentQueries?n.contentQueries[0]:t.length,r=[];for(let c=0;c<i;c++){const h=t.getByIndex(c);r.push(this.queries[h.indexInDeclarationView].clone())}return new Mb(r)}return null}insertView(n){this.dirtyQueriesWithMatches(n)}detachView(n){this.dirtyQueriesWithMatches(n)}dirtyQueriesWithMatches(n){for(let t=0;t<this.queries.length;t++)null!==EE(n,t).matches&&this.queries[t].setDirty()}}class bE{constructor(n,t,i=null){this.predicate=n,this.flags=t,this.read=i}}class Tb{constructor(n=[]){this.queries=n}elementStart(n,t){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(n,t)}elementEnd(n){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(n)}embeddedTView(n){let t=null;for(let i=0;i<this.length;i++){const r=null!==t?t.length:0,c=this.getByIndex(i).embeddedTView(n,r);c&&(c.indexInDeclarationView=i,null!==t?t.push(c):t=[c])}return null!==t?new Tb(t):null}template(n,t){for(let i=0;i<this.queries.length;i++)this.queries[i].template(n,t)}getByIndex(n){return this.queries[n]}get length(){return this.queries.length}track(n){this.queries.push(n)}}class Ab{constructor(n,t=-1){this.metadata=n,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(n,t){this.isApplyingToNode(t)&&this.matchTNode(n,t)}elementEnd(n){this._declarationNodeIndex===n.index&&(this._appliesToNextNode=!1)}template(n,t){this.elementStart(n,t)}embeddedTView(n,t){return this.isApplyingToNode(n)?(this.crossesNgTemplate=!0,this.addMatch(-n.index,t),new Ab(this.metadata)):null}isApplyingToNode(n){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const t=this._declarationNodeIndex;let i=n.parent;for(;null!==i&&8&i.type&&i.index!==t;)i=i.parent;return t===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(n,t){const i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){const c=i[r];this.matchTNodeWithReadOption(n,t,UR(t,c)),this.matchTNodeWithReadOption(n,t,ah(t,n,c,!1,!1))}else i===hc?4&t.type&&this.matchTNodeWithReadOption(n,t,-1):this.matchTNodeWithReadOption(n,t,ah(t,n,i,!1,!1))}matchTNodeWithReadOption(n,t,i){if(null!==i){const r=this.metadata.read;if(null!==r)if(r===Mr||r===$a||r===hc&&4&t.type)this.addMatch(t.index,-2);else{const c=ah(t,n,r,!1,!1);null!==c&&this.addMatch(t.index,c)}else this.addMatch(t.index,i)}}addMatch(n,t){null===this.matches?this.matches=[n,t]:this.matches.push(n,t)}}function UR(e,n){const t=e.localNames;if(null!==t)for(let i=0;i<t.length;i+=2)if(t[i]===n)return t[i+1];return null}function $R(e,n,t,i){return-1===t?function jR(e,n){return 11&e.type?Oh(e,n):4&e.type?f_(e,n):null}(n,e):-2===t?function HR(e,n,t){return t===Mr?Oh(n,e):t===hc?f_(n,e):t===$a?_E(n,e):void 0}(e,n,i):bo(e,e[Qe],t,n)}function xE(e,n,t,i){const r=n[ei].queries[i];if(null===r.matches){const c=e.data,h=t.matches,y=[];for(let w=0;w<h.length;w+=2){const I=h[w];y.push(I<0?null:$R(n,c[I],h[w+1],t.metadata.read))}r.matches=y}return r.matches}function kb(e,n,t,i){const r=e.queries.getByIndex(t),c=r.matches;if(null!==c){const h=xE(e,n,r,t);for(let y=0;y<c.length;y+=2){const w=c[y];if(w>0)i.push(h[y/2]);else{const I=c[y+1],P=n[-w];for(let z=ti;z<P.length;z++){const G=P[z];G[va]===G[Xt]&&kb(G[Qe],G,I,i)}if(null!==P[qs]){const z=P[qs];for(let G=0;G<z.length;G++){const re=z[G];kb(re[Qe],re,I,i)}}}}}return i}function io(e){const n=Re(),t=nn(),i=$p();tc(i+1);const r=EE(t,i);if(e.dirty&&function Lr(e){return 4==(4&e[Ot])}(n)===(2==(2&r.metadata.flags))){if(null===r.matches)e.reset([]);else{const c=r.crossesNgTemplate?kb(t,n,i,[]):xE(t,n,r,i);e.reset(c,hA),e.notifyOnChanges()}return!0}return!1}function Ha(e,n,t){const i=nn();i.firstCreatePass&&(CE(i,new bE(e,n,t),-1),2==(2&n)&&(i.staticViewQueries=!0)),wE(i,Re(),n)}function g_(e,n,t,i){const r=nn();if(r.firstCreatePass){const c=gi();CE(r,new bE(n,t,i),c.index),function qR(e,n){const t=e.contentQueries||(e.contentQueries=[]);n!==(t.length?t[t.length-1]:-1)&&t.push(e.queries.length-1,n)}(r,e),2==(2&t)&&(r.staticContentQueries=!0)}wE(r,Re(),t)}function ro(){return function GR(e,n){return e[ei].queries[n].queryList}(Re(),$p())}function wE(e,n,t){const i=new Db(4==(4&t));(function GA(e,n,t,i){const r=Kw(n);r.push(t),e.firstCreatePass&&Yw(e).push(i,r.length-1)})(e,n,i,i.destroy),null===n[ei]&&(n[ei]=new Mb),n[ei].queries.push(new Sb(i))}function CE(e,n,t){null===e.queries&&(e.queries=new Tb),e.queries.track(new Ab(n,t))}function EE(e,n){return e.queries.getByIndex(n)}const Nb=new Xe("Application Initializer");let zb=(()=>{class e{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((t,i)=>{this.resolve=t,this.reject=i}),this.appInits=Ke(Nb,{optional:!0})??[]}runInitializers(){if(this.initialized)return;const t=[];for(const r of this.appInits){const c=r();if(Lf(c))t.push(c);else if(k1(c)){const h=new Promise((y,w)=>{c.subscribe({complete:y,error:w})});t.push(h)}}const i=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{i()}).catch(r=>{this.reject(r)}),0===t.length&&i(),this.initialized=!0}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=ct({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),UE=(()=>{class e{log(t){console.log(t)}warn(t){console.warn(t)}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=ct({token:e,factory:e.\u0275fac,providedIn:"platform"})}return e})();const Ml=new Xe("LocaleId",{providedIn:"root",factory:()=>Ke(Ml,Ut.Optional|Ut.SkipSelf)||function fO(){return typeof $localize<"u"&&$localize.locale||Kh}()});let y_=(()=>{class e{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new _r(!1)}add(){this.hasPendingTasks.next(!0);const t=this.taskId++;return this.pendingTasks.add(t),t}remove(t){this.pendingTasks.delete(t),0===this.pendingTasks.size&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks.next(!1)}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=ct({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();class _O{constructor(n,t){this.ngModuleFactory=n,this.componentFactories=t}}let jE=(()=>{class e{compileModuleSync(t){return new wb(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){const i=this.compileModuleSync(t),c=uc(vr(t).declarations).reduce((h,y)=>{const w=tn(y);return w&&h.push(new kf(w)),h},[]);return new _O(i,c)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=ct({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const qE=new Xe(""),b_=new Xe("");let $b,Ub=(()=>{class e{constructor(t,i,r){this._ngZone=t,this.registry=i,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,$b||(function NO(e){$b=e}(r),r.addToWindow(i)),this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{dn.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(this._didWork)}this._didWork=!1});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(t)||(clearTimeout(i.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,i,r){let c=-1;i&&i>0&&(c=setTimeout(()=>{this._callbacks=this._callbacks.filter(h=>h.timeoutId!==c),t(this._didWork,this.getPendingTasks())},i)),this._callbacks.push({doneCb:t,timeoutId:c,updateCb:r})}whenStable(t,i,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(t,i,r),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(t){this.registry.registerApplication(t,this)}unregisterApplication(t){this.registry.unregisterApplication(t)}findProviders(t,i,r){return[]}static#e=this.\u0275fac=function(i){return new(i||e)(nt(dn),nt(jb),nt(b_))};static#t=this.\u0275prov=ct({token:e,factory:e.\u0275fac})}return e})(),jb=(()=>{class e{constructor(){this._applications=new Map}registerApplication(t,i){this._applications.set(t,i)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,i=!0){return $b?.findTestabilityInTree(this,t,i)??null}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=ct({token:e,factory:e.\u0275fac,providedIn:"platform"})}return e})(),pu=null;const ZE=new Xe("AllowMultipleToken"),Hb=new Xe("PlatformDestroyListeners"),Gb=new Xe("appBootstrapListener");class XE{constructor(n,t){this.name=n,this.token=t}}function YE(e,n,t=[]){const i=`Platform: ${n}`,r=new Xe(i);return(c=[])=>{let h=qb();if(!h||h.injector.get(ZE,!1)){const y=[...t,...c,{provide:r,useValue:!0}];e?e(y):function VO(e){if(pu&&!pu.get(ZE,!1))throw new Pe(400,!1);(function WE(){!function _l(e){Ci=e}(()=>{throw new Pe(600,!1)})})(),pu=e;const n=e.get(QE);(function KE(e){e.get(aw,null)?.forEach(t=>t())})(e)}(function JE(e=[],n){return Eo.create({name:n,providers:[{provide:bv,useValue:"platform"},{provide:Hb,useValue:new Set([()=>pu=null])},...e]})}(y,i))}return function jO(e){const n=qb();if(!n)throw new Pe(401,!1);return n}()}}function qb(){return pu?.get(QE)??null}let QE=(()=>{class e{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,i){const r=function $O(e="zone.js",n){return"noop"===e?new SA:"zone.js"===e?new dn(n):e}(i?.ngZone,function eD(e){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:e?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:e?.runCoalescing??!1}}({eventCoalescing:i?.ngZoneEventCoalescing,runCoalescing:i?.ngZoneRunCoalescing}));return r.run(()=>{const c=function iR(e,n,t){return new xb(e,n,t)}(t.moduleType,this.injector,function sD(e){return[{provide:dn,useFactory:e},{provide:Ef,multi:!0,useFactory:()=>{const n=Ke(GO,{optional:!0});return()=>n.initialize()}},{provide:rD,useFactory:HO},{provide:Ew,useFactory:Dw}]}(()=>r)),h=c.injector.get(cc,null);return r.runOutsideAngular(()=>{const y=r.onError.subscribe({next:w=>{h.handleError(w)}});c.onDestroy(()=>{x_(this._modules,c),y.unsubscribe()})}),function tD(e,n,t){try{const i=t();return Lf(i)?i.catch(r=>{throw n.runOutsideAngular(()=>e.handleError(r)),r}):i}catch(i){throw n.runOutsideAngular(()=>e.handleError(i)),i}}(h,r,()=>{const y=c.injector.get(zb);return y.runInitializers(),y.donePromise.then(()=>(function DC(e){yr(e,"Expected localeId to be defined"),"string"==typeof e&&(EC=e.toLowerCase().replace(/_/g,"-"))}(c.injector.get(Ml,Kh)||Kh),this._moduleDoBootstrap(c),c))})})}bootstrapModule(t,i=[]){const r=nD({},i);return function zO(e,n,t){const i=new wb(t);return Promise.resolve(i)}(0,0,t).then(c=>this.bootstrapModuleFactory(c,r))}_moduleDoBootstrap(t){const i=t.injector.get(ep);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(r=>i.bootstrap(r));else{if(!t.instance.ngDoBootstrap)throw new Pe(-403,!1);t.instance.ngDoBootstrap(i)}this._modules.push(t)}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Pe(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());const t=this._injector.get(Hb,null);t&&(t.forEach(i=>i()),t.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}static#e=this.\u0275fac=function(i){return new(i||e)(nt(Eo))};static#t=this.\u0275prov=ct({token:e,factory:e.\u0275fac,providedIn:"platform"})}return e})();function nD(e,n){return Array.isArray(n)?n.reduce(nD,e):{...e,...n}}let ep=(()=>{class e{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=Ke(rD),this.zoneIsStable=Ke(Ew),this.componentTypes=[],this.components=[],this.isStable=Ke(y_).hasPendingTasks.pipe(lr(t=>t?Et(!1):this.zoneIsStable),function Cp(e,n=jr){return e=e??Vd,Vn((t,i)=>{let r,c=!0;t.subscribe(_n(i,h=>{const y=n(h);(c||!e(r,y))&&(c=!1,r=y,i.next(h))}))})}(),co()),this._injector=Ke(Co)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(t,i){const r=t instanceof hw;if(!this._injector.get(zb).done)throw!r&&function Gs(e){const n=tn(e)||zi(e)||er(e);return null!==n&&n.standalone}(t),new Pe(405,!1);let h;h=r?t:this._injector.get(Zg).resolveComponentFactory(t),this.componentTypes.push(h.componentType);const y=function BO(e){return e.isBoundToModule}(h)?void 0:this._injector.get(Cd),I=h.create(Eo.NULL,[],i||h.selector,y),P=I.location.nativeElement,z=I.injector.get(qE,null);return z?.registerApplication(P),I.onDestroy(()=>{this.detachView(I.hostView),x_(this.components,I),z?.unregisterApplication(P)}),this._loadComponent(I),I}tick(){if(this._runningTick)throw new Pe(101,!1);try{this._runningTick=!0;for(let t of this._views)t.detectChanges()}catch(t){this.internalErrorHandler(t)}finally{this._runningTick=!1}}attachView(t){const i=t;this._views.push(i),i.attachToAppRef(this)}detachView(t){const i=t;x_(this._views,i),i.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t);const i=this._injector.get(Gb,[]);i.push(...this._bootstrapListeners),i.forEach(r=>r(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>x_(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new Pe(406,!1);const t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=ct({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function x_(e,n){const t=e.indexOf(n);t>-1&&e.splice(t,1)}const rD=new Xe("",{providedIn:"root",factory:()=>Ke(cc).handleError.bind(void 0)});function HO(){const e=Ke(dn),n=Ke(cc);return t=>e.runOutsideAngular(()=>n.handleError(t))}let GO=(()=>{class e{constructor(){this.zone=Ke(dn),this.applicationRef=Ke(ep)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=ct({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();let fu=(()=>{class e{static#e=this.__NG_ELEMENT_ID__=ZO}return e})();function ZO(e){return function WO(e,n,t){if(mo(e)&&!t){const i=Ds(e.index,n);return new Af(i,i)}return 47&e.type?new Af(n[Zn],n):null}(gi(),Re(),16==(16&e))}class cD{constructor(){}supports(n){return t_(n)}create(n){return new eF(n)}}const QO=(e,n)=>n;class eF{constructor(n){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=n||QO}forEachItem(n){let t;for(t=this._itHead;null!==t;t=t._next)n(t)}forEachOperation(n){let t=this._itHead,i=this._removalsHead,r=0,c=null;for(;t||i;){const h=!i||t&&t.currentIndex<dD(i,r,c)?t:i,y=dD(h,r,c),w=h.currentIndex;if(h===i)r--,i=i._nextRemoved;else if(t=t._next,null==h.previousIndex)r++;else{c||(c=[]);const I=y-r,P=w-r;if(I!=P){for(let G=0;G<I;G++){const re=G<c.length?c[G]:c[G]=0,fe=re+G;P<=fe&&fe<I&&(c[G]=re+1)}c[h.previousIndex]=P-I}}y!==w&&n(h,y,w)}}forEachPreviousItem(n){let t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)n(t)}forEachAddedItem(n){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)n(t)}forEachMovedItem(n){let t;for(t=this._movesHead;null!==t;t=t._nextMoved)n(t)}forEachRemovedItem(n){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)n(t)}forEachIdentityChange(n){let t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)n(t)}diff(n){if(null==n&&(n=[]),!t_(n))throw new Pe(900,!1);return this.check(n)?this:null}onDestroy(){}check(n){this._reset();let r,c,h,t=this._itHead,i=!1;if(Array.isArray(n)){this.length=n.length;for(let y=0;y<this.length;y++)c=n[y],h=this._trackByFn(y,c),null!==t&&Object.is(t.trackById,h)?(i&&(t=this._verifyReinsertion(t,c,h,y)),Object.is(t.item,c)||this._addIdentityChange(t,c)):(t=this._mismatch(t,c,h,y),i=!0),t=t._next}else r=0,function z2(e,n){if(Array.isArray(e))for(let t=0;t<e.length;t++)n(e[t]);else{const t=e[Symbol.iterator]();let i;for(;!(i=t.next()).done;)n(i.value)}}(n,y=>{h=this._trackByFn(r,y),null!==t&&Object.is(t.trackById,h)?(i&&(t=this._verifyReinsertion(t,y,h,r)),Object.is(t.item,y)||this._addIdentityChange(t,y)):(t=this._mismatch(t,y,h,r),i=!0),t=t._next,r++}),this.length=r;return this._truncate(t),this.collection=n,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let n;for(n=this._previousItHead=this._itHead;null!==n;n=n._next)n._nextPrevious=n._next;for(n=this._additionsHead;null!==n;n=n._nextAdded)n.previousIndex=n.currentIndex;for(this._additionsHead=this._additionsTail=null,n=this._movesHead;null!==n;n=n._nextMoved)n.previousIndex=n.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(n,t,i,r){let c;return null===n?c=this._itTail:(c=n._prev,this._remove(n)),null!==(n=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null))?(Object.is(n.item,t)||this._addIdentityChange(n,t),this._reinsertAfter(n,c,r)):null!==(n=null===this._linkedRecords?null:this._linkedRecords.get(i,r))?(Object.is(n.item,t)||this._addIdentityChange(n,t),this._moveAfter(n,c,r)):n=this._addAfter(new tF(t,i),c,r),n}_verifyReinsertion(n,t,i,r){let c=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null);return null!==c?n=this._reinsertAfter(c,n._prev,r):n.currentIndex!=r&&(n.currentIndex=r,this._addToMoves(n,r)),n}_truncate(n){for(;null!==n;){const t=n._next;this._addToRemovals(this._unlink(n)),n=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(n,t,i){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(n);const r=n._prevRemoved,c=n._nextRemoved;return null===r?this._removalsHead=c:r._nextRemoved=c,null===c?this._removalsTail=r:c._prevRemoved=r,this._insertAfter(n,t,i),this._addToMoves(n,i),n}_moveAfter(n,t,i){return this._unlink(n),this._insertAfter(n,t,i),this._addToMoves(n,i),n}_addAfter(n,t,i){return this._insertAfter(n,t,i),this._additionsTail=null===this._additionsTail?this._additionsHead=n:this._additionsTail._nextAdded=n,n}_insertAfter(n,t,i){const r=null===t?this._itHead:t._next;return n._next=r,n._prev=t,null===r?this._itTail=n:r._prev=n,null===t?this._itHead=n:t._next=n,null===this._linkedRecords&&(this._linkedRecords=new uD),this._linkedRecords.put(n),n.currentIndex=i,n}_remove(n){return this._addToRemovals(this._unlink(n))}_unlink(n){null!==this._linkedRecords&&this._linkedRecords.remove(n);const t=n._prev,i=n._next;return null===t?this._itHead=i:t._next=i,null===i?this._itTail=t:i._prev=t,n}_addToMoves(n,t){return n.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=n:this._movesTail._nextMoved=n),n}_addToRemovals(n){return null===this._unlinkedRecords&&(this._unlinkedRecords=new uD),this._unlinkedRecords.put(n),n.currentIndex=null,n._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=n,n._prevRemoved=null):(n._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=n),n}_addIdentityChange(n,t){return n.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=n:this._identityChangesTail._nextIdentityChange=n,n}}class tF{constructor(n,t){this.item=n,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class nF{constructor(){this._head=null,this._tail=null}add(n){null===this._head?(this._head=this._tail=n,n._nextDup=null,n._prevDup=null):(this._tail._nextDup=n,n._prevDup=this._tail,n._nextDup=null,this._tail=n)}get(n,t){let i;for(i=this._head;null!==i;i=i._nextDup)if((null===t||t<=i.currentIndex)&&Object.is(i.trackById,n))return i;return null}remove(n){const t=n._prevDup,i=n._nextDup;return null===t?this._head=i:t._nextDup=i,null===i?this._tail=t:i._prevDup=t,null===this._head}}class uD{constructor(){this.map=new Map}put(n){const t=n.trackById;let i=this.map.get(t);i||(i=new nF,this.map.set(t,i)),i.add(n)}get(n,t){const r=this.map.get(n);return r?r.get(n,t):null}remove(n){const t=n.trackById;return this.map.get(t).remove(n)&&this.map.delete(t),n}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function dD(e,n,t){const i=e.previousIndex;if(null===i)return i;let r=0;return t&&i<t.length&&(r=t[i]),i+n+r}class hD{constructor(){}supports(n){return n instanceof Map||eb(n)}create(){return new iF}}class iF{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(n){let t;for(t=this._mapHead;null!==t;t=t._next)n(t)}forEachPreviousItem(n){let t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)n(t)}forEachChangedItem(n){let t;for(t=this._changesHead;null!==t;t=t._nextChanged)n(t)}forEachAddedItem(n){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)n(t)}forEachRemovedItem(n){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)n(t)}diff(n){if(n){if(!(n instanceof Map||eb(n)))throw new Pe(900,!1)}else n=new Map;return this.check(n)?this:null}onDestroy(){}check(n){this._reset();let t=this._mapHead;if(this._appendAfter=null,this._forEach(n,(i,r)=>{if(t&&t.key===r)this._maybeAddToChanges(t,i),this._appendAfter=t,t=t._next;else{const c=this._getOrCreateRecordForKey(r,i);t=this._insertBeforeOrAppend(t,c)}}),t){t._prev&&(t._prev._next=null),this._removalsHead=t;for(let i=t;null!==i;i=i._nextRemoved)i===this._mapHead&&(this._mapHead=null),this._records.delete(i.key),i._nextRemoved=i._next,i.previousValue=i.currentValue,i.currentValue=null,i._prev=null,i._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(n,t){if(n){const i=n._prev;return t._next=n,t._prev=i,n._prev=t,i&&(i._next=t),n===this._mapHead&&(this._mapHead=t),this._appendAfter=n,n}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}_getOrCreateRecordForKey(n,t){if(this._records.has(n)){const r=this._records.get(n);this._maybeAddToChanges(r,t);const c=r._prev,h=r._next;return c&&(c._next=h),h&&(h._prev=c),r._next=null,r._prev=null,r}const i=new rF(n);return this._records.set(n,i),i.currentValue=t,this._addToAdditions(i),i}_reset(){if(this.isDirty){let n;for(this._previousMapHead=this._mapHead,n=this._previousMapHead;null!==n;n=n._next)n._nextPrevious=n._next;for(n=this._changesHead;null!==n;n=n._nextChanged)n.previousValue=n.currentValue;for(n=this._additionsHead;null!=n;n=n._nextAdded)n.previousValue=n.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(n,t){Object.is(t,n.currentValue)||(n.previousValue=n.currentValue,n.currentValue=t,this._addToChanges(n))}_addToAdditions(n){null===this._additionsHead?this._additionsHead=this._additionsTail=n:(this._additionsTail._nextAdded=n,this._additionsTail=n)}_addToChanges(n){null===this._changesHead?this._changesHead=this._changesTail=n:(this._changesTail._nextChanged=n,this._changesTail=n)}_forEach(n,t){n instanceof Map?n.forEach(t):Object.keys(n).forEach(i=>t(n[i],i))}}class rF{constructor(n){this.key=n,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function pD(){return new E_([new cD])}let E_=(()=>{class e{static#e=this.\u0275prov=ct({token:e,providedIn:"root",factory:pD});constructor(t){this.factories=t}static create(t,i){if(null!=i){const r=i.factories.slice();t=t.concat(r)}return new e(t)}static extend(t){return{provide:e,useFactory:i=>e.create(t,i||pD()),deps:[[e,new ru,new ph]]}}find(t){const i=this.factories.find(r=>r.supports(t));if(null!=i)return i;throw new Pe(901,!1)}}return e})();function fD(){return new Xf([new hD])}let Xf=(()=>{class e{static#e=this.\u0275prov=ct({token:e,providedIn:"root",factory:fD});constructor(t){this.factories=t}static create(t,i){if(i){const r=i.factories.slice();t=t.concat(r)}return new e(t)}static extend(t){return{provide:e,useFactory:i=>e.create(t,i||fD()),deps:[[e,new ru,new ph]]}}find(t){const i=this.factories.find(r=>r.supports(t));if(i)return i;throw new Pe(901,!1)}}return e})();const aF=YE(null,"core",[]);let lF=(()=>{class e{constructor(t){}static#e=this.\u0275fac=function(i){return new(i||e)(nt(ep))};static#t=this.\u0275mod=Ni({type:e});static#n=this.\u0275inj=Fi({})}return e})();function tp(e){return"boolean"==typeof e?e:null!=e&&"false"!==e}let Jb=null;function mu(){return Jb}class wF{}const ps=new Xe("DocumentToken");let Qb=(()=>{class e{historyGo(t){throw new Error("Not implemented")}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=ct({token:e,factory:function(){return Ke(EF)},providedIn:"platform"})}return e})();const CF=new Xe("Location Initialized");let EF=(()=>{class e extends Qb{constructor(){super(),this._doc=Ke(ps),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return mu().getBaseHref(this._doc)}onPopState(t){const i=mu().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",t,!1),()=>i.removeEventListener("popstate",t)}onHashChange(t){const i=mu().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",t,!1),()=>i.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,i,r){this._history.pushState(t,i,r)}replaceState(t,i,r){this._history.replaceState(t,i,r)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=ct({token:e,factory:function(){return new e},providedIn:"platform"})}return e})();function e0(e,n){if(0==e.length)return n;if(0==n.length)return e;let t=0;return e.endsWith("/")&&t++,n.startsWith("/")&&t++,2==t?e+n.substring(1):1==t?e+n:e+"/"+n}function CD(e){const n=e.match(/#|\?|$/),t=n&&n.index||e.length;return e.slice(0,t-("/"===e[t-1]?1:0))+e.slice(t)}function pc(e){return e&&"?"!==e[0]?"?"+e:e}let Dd=(()=>{class e{historyGo(t){throw new Error("Not implemented")}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=ct({token:e,factory:function(){return Ke(DD)},providedIn:"root"})}return e})();const ED=new Xe("appBaseHref");let DD=(()=>{class e extends Dd{constructor(t,i){super(),this._platformLocation=t,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??Ke(ps).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return e0(this._baseHref,t)}path(t=!1){const i=this._platformLocation.pathname+pc(this._platformLocation.search),r=this._platformLocation.hash;return r&&t?`${i}${r}`:i}pushState(t,i,r,c){const h=this.prepareExternalUrl(r+pc(c));this._platformLocation.pushState(t,i,h)}replaceState(t,i,r,c){const h=this.prepareExternalUrl(r+pc(c));this._platformLocation.replaceState(t,i,h)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static#e=this.\u0275fac=function(i){return new(i||e)(nt(Qb),nt(ED,8))};static#t=this.\u0275prov=ct({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),DF=(()=>{class e extends Dd{constructor(t,i){super(),this._platformLocation=t,this._baseHref="",this._removeListenerFns=[],null!=i&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let i=this._platformLocation.hash;return null==i&&(i="#"),i.length>0?i.substring(1):i}prepareExternalUrl(t){const i=e0(this._baseHref,t);return i.length>0?"#"+i:i}pushState(t,i,r,c){let h=this.prepareExternalUrl(r+pc(c));0==h.length&&(h=this._platformLocation.pathname),this._platformLocation.pushState(t,i,h)}replaceState(t,i,r,c){let h=this.prepareExternalUrl(r+pc(c));0==h.length&&(h=this._platformLocation.pathname),this._platformLocation.replaceState(t,i,h)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static#e=this.\u0275fac=function(i){return new(i||e)(nt(Qb),nt(ED,8))};static#t=this.\u0275prov=ct({token:e,factory:e.\u0275fac})}return e})(),t0=(()=>{class e{constructor(t){this._subject=new Ve,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=t;const i=this._locationStrategy.getBaseHref();this._basePath=function MF(e){if(new RegExp("^(https?:)?//").test(e)){const[,t]=e.split(/\/\/[^\/]+/);return t}return e}(CD(ID(i))),this._locationStrategy.onPopState(r=>{this._subject.emit({url:this.path(!0),pop:!0,state:r.state,type:r.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,i=""){return this.path()==this.normalize(t+pc(i))}normalize(t){return e.stripTrailingSlash(function SF(e,n){if(!e||!n.startsWith(e))return n;const t=n.substring(e.length);return""===t||["/",";","?","#"].includes(t[0])?t:n}(this._basePath,ID(t)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,i="",r=null){this._locationStrategy.pushState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+pc(i)),r)}replaceState(t,i="",r=null){this._locationStrategy.replaceState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+pc(i)),r)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)})),()=>{const i=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(i,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",i){this._urlChangeListeners.forEach(r=>r(t,i))}subscribe(t,i,r){return this._subject.subscribe({next:t,error:i,complete:r})}static#e=this.normalizeQueryParams=pc;static#t=this.joinWithSlash=e0;static#n=this.stripTrailingSlash=CD;static#i=this.\u0275fac=function(i){return new(i||e)(nt(Dd))};static#r=this.\u0275prov=ct({token:e,factory:function(){return function IF(){return new t0(nt(Dd))}()},providedIn:"root"})}return e})();function ID(e){return e.replace(/\/index.html$/,"")}var Ps=function(e){return e[e.Format=0]="Format",e[e.Standalone=1]="Standalone",e}(Ps||{}),ni=function(e){return e[e.Narrow=0]="Narrow",e[e.Abbreviated=1]="Abbreviated",e[e.Wide=2]="Wide",e[e.Short=3]="Short",e}(ni||{}),So=function(e){return e[e.Short=0]="Short",e[e.Medium=1]="Medium",e[e.Long=2]="Long",e[e.Full=3]="Full",e}(So||{}),rr=function(e){return e[e.Decimal=0]="Decimal",e[e.Group=1]="Group",e[e.List=2]="List",e[e.PercentSign=3]="PercentSign",e[e.PlusSign=4]="PlusSign",e[e.MinusSign=5]="MinusSign",e[e.Exponential=6]="Exponential",e[e.SuperscriptingExponent=7]="SuperscriptingExponent",e[e.PerMille=8]="PerMille",e[e.Infinity=9]="Infinity",e[e.NaN=10]="NaN",e[e.TimeSeparator=11]="TimeSeparator",e[e.CurrencyDecimal=12]="CurrencyDecimal",e[e.CurrencyGroup=13]="CurrencyGroup",e}(rr||{});function S_(e,n){return oa(As(e)[ai.DateFormat],n)}function M_(e,n){return oa(As(e)[ai.TimeFormat],n)}function T_(e,n){return oa(As(e)[ai.DateTimeFormat],n)}function sa(e,n){const t=As(e),i=t[ai.NumberSymbols][n];if(typeof i>"u"){if(n===rr.CurrencyDecimal)return t[ai.NumberSymbols][rr.Decimal];if(n===rr.CurrencyGroup)return t[ai.NumberSymbols][rr.Group]}return i}function MD(e){if(!e[ai.ExtraData])throw new Error(`Missing extra locale data for the locale "${e[ai.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function oa(e,n){for(let t=n;t>-1;t--)if(typeof e[t]<"u")return e[t];throw new Error("Locale data API: locale data undefined")}function r0(e){const[n,t]=e.split(":");return{hours:+n,minutes:+t}}const jF=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,Kf={},$F=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;var fc=function(e){return e[e.Short=0]="Short",e[e.ShortGMT=1]="ShortGMT",e[e.Long=2]="Long",e[e.Extended=3]="Extended",e}(fc||{}),On=function(e){return e[e.FullYear=0]="FullYear",e[e.Month=1]="Month",e[e.Date=2]="Date",e[e.Hours=3]="Hours",e[e.Minutes=4]="Minutes",e[e.Seconds=5]="Seconds",e[e.FractionalSeconds=6]="FractionalSeconds",e[e.Day=7]="Day",e}(On||{}),Fn=function(e){return e[e.DayPeriods=0]="DayPeriods",e[e.Days=1]="Days",e[e.Months=2]="Months",e[e.Eras=3]="Eras",e}(Fn||{});function HF(e,n,t,i){let r=function QF(e){if(kD(e))return e;if("number"==typeof e&&!isNaN(e))return new Date(e);if("string"==typeof e){if(e=e.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(e)){const[r,c=1,h=1]=e.split("-").map(y=>+y);return A_(r,c-1,h)}const t=parseFloat(e);if(!isNaN(e-t))return new Date(t);let i;if(i=e.match(jF))return function eL(e){const n=new Date(0);let t=0,i=0;const r=e[8]?n.setUTCFullYear:n.setFullYear,c=e[8]?n.setUTCHours:n.setHours;e[9]&&(t=Number(e[9]+e[10]),i=Number(e[9]+e[11])),r.call(n,Number(e[1]),Number(e[2])-1,Number(e[3]));const h=Number(e[4]||0)-t,y=Number(e[5]||0)-i,w=Number(e[6]||0),I=Math.floor(1e3*parseFloat("0."+(e[7]||0)));return c.call(n,h,y,w,I),n}(i)}const n=new Date(e);if(!kD(n))throw new Error(`Unable to convert "${e}" into a date`);return n}(e);n=mc(t,n)||n;let y,h=[];for(;n;){if(y=$F.exec(n),!y){h.push(n);break}{h=h.concat(y.slice(1));const P=h.pop();if(!P)break;n=P}}let w=r.getTimezoneOffset();i&&(w=AD(i,w),r=function JF(e,n,t){const i=t?-1:1,r=e.getTimezoneOffset();return function YF(e,n){return(e=new Date(e.getTime())).setMinutes(e.getMinutes()+n),e}(e,i*(AD(n,r)-r))}(r,i,!0));let I="";return h.forEach(P=>{const z=function KF(e){if(o0[e])return o0[e];let n;switch(e){case"G":case"GG":case"GGG":n=li(Fn.Eras,ni.Abbreviated);break;case"GGGG":n=li(Fn.Eras,ni.Wide);break;case"GGGGG":n=li(Fn.Eras,ni.Narrow);break;case"y":n=fr(On.FullYear,1,0,!1,!0);break;case"yy":n=fr(On.FullYear,2,0,!0,!0);break;case"yyy":n=fr(On.FullYear,3,0,!1,!0);break;case"yyyy":n=fr(On.FullYear,4,0,!1,!0);break;case"Y":n=O_(1);break;case"YY":n=O_(2,!0);break;case"YYY":n=O_(3);break;case"YYYY":n=O_(4);break;case"M":case"L":n=fr(On.Month,1,1);break;case"MM":case"LL":n=fr(On.Month,2,1);break;case"MMM":n=li(Fn.Months,ni.Abbreviated);break;case"MMMM":n=li(Fn.Months,ni.Wide);break;case"MMMMM":n=li(Fn.Months,ni.Narrow);break;case"LLL":n=li(Fn.Months,ni.Abbreviated,Ps.Standalone);break;case"LLLL":n=li(Fn.Months,ni.Wide,Ps.Standalone);break;case"LLLLL":n=li(Fn.Months,ni.Narrow,Ps.Standalone);break;case"w":n=s0(1);break;case"ww":n=s0(2);break;case"W":n=s0(1,!0);break;case"d":n=fr(On.Date,1);break;case"dd":n=fr(On.Date,2);break;case"c":case"cc":n=fr(On.Day,1);break;case"ccc":n=li(Fn.Days,ni.Abbreviated,Ps.Standalone);break;case"cccc":n=li(Fn.Days,ni.Wide,Ps.Standalone);break;case"ccccc":n=li(Fn.Days,ni.Narrow,Ps.Standalone);break;case"cccccc":n=li(Fn.Days,ni.Short,Ps.Standalone);break;case"E":case"EE":case"EEE":n=li(Fn.Days,ni.Abbreviated);break;case"EEEE":n=li(Fn.Days,ni.Wide);break;case"EEEEE":n=li(Fn.Days,ni.Narrow);break;case"EEEEEE":n=li(Fn.Days,ni.Short);break;case"a":case"aa":case"aaa":n=li(Fn.DayPeriods,ni.Abbreviated);break;case"aaaa":n=li(Fn.DayPeriods,ni.Wide);break;case"aaaaa":n=li(Fn.DayPeriods,ni.Narrow);break;case"b":case"bb":case"bbb":n=li(Fn.DayPeriods,ni.Abbreviated,Ps.Standalone,!0);break;case"bbbb":n=li(Fn.DayPeriods,ni.Wide,Ps.Standalone,!0);break;case"bbbbb":n=li(Fn.DayPeriods,ni.Narrow,Ps.Standalone,!0);break;case"B":case"BB":case"BBB":n=li(Fn.DayPeriods,ni.Abbreviated,Ps.Format,!0);break;case"BBBB":n=li(Fn.DayPeriods,ni.Wide,Ps.Format,!0);break;case"BBBBB":n=li(Fn.DayPeriods,ni.Narrow,Ps.Format,!0);break;case"h":n=fr(On.Hours,1,-12);break;case"hh":n=fr(On.Hours,2,-12);break;case"H":n=fr(On.Hours,1);break;case"HH":n=fr(On.Hours,2);break;case"m":n=fr(On.Minutes,1);break;case"mm":n=fr(On.Minutes,2);break;case"s":n=fr(On.Seconds,1);break;case"ss":n=fr(On.Seconds,2);break;case"S":n=fr(On.FractionalSeconds,1);break;case"SS":n=fr(On.FractionalSeconds,2);break;case"SSS":n=fr(On.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":n=P_(fc.Short);break;case"ZZZZZ":n=P_(fc.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":n=P_(fc.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":n=P_(fc.Long);break;default:return null}return o0[e]=n,n}(P);I+=z?z(r,t,w):"''"===P?"'":P.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),I}function A_(e,n,t){const i=new Date(0);return i.setFullYear(e,n,t),i.setHours(0,0,0),i}function mc(e,n){const t=function AF(e){return As(e)[ai.LocaleId]}(e);if(Kf[t]=Kf[t]||{},Kf[t][n])return Kf[t][n];let i="";switch(n){case"shortDate":i=S_(e,So.Short);break;case"mediumDate":i=S_(e,So.Medium);break;case"longDate":i=S_(e,So.Long);break;case"fullDate":i=S_(e,So.Full);break;case"shortTime":i=M_(e,So.Short);break;case"mediumTime":i=M_(e,So.Medium);break;case"longTime":i=M_(e,So.Long);break;case"fullTime":i=M_(e,So.Full);break;case"short":const r=mc(e,"shortTime"),c=mc(e,"shortDate");i=k_(T_(e,So.Short),[r,c]);break;case"medium":const h=mc(e,"mediumTime"),y=mc(e,"mediumDate");i=k_(T_(e,So.Medium),[h,y]);break;case"long":const w=mc(e,"longTime"),I=mc(e,"longDate");i=k_(T_(e,So.Long),[w,I]);break;case"full":const P=mc(e,"fullTime"),z=mc(e,"fullDate");i=k_(T_(e,So.Full),[P,z])}return i&&(Kf[t][n]=i),i}function k_(e,n){return n&&(e=e.replace(/\{([^}]+)}/g,function(t,i){return null!=n&&i in n?n[i]:t})),e}function Ga(e,n,t="-",i,r){let c="";(e<0||r&&e<=0)&&(r?e=1-e:(e=-e,c=t));let h=String(e);for(;h.length<n;)h="0"+h;return i&&(h=h.slice(h.length-n)),c+h}function fr(e,n,t=0,i=!1,r=!1){return function(c,h){let y=function qF(e,n){switch(e){case On.FullYear:return n.getFullYear();case On.Month:return n.getMonth();case On.Date:return n.getDate();case On.Hours:return n.getHours();case On.Minutes:return n.getMinutes();case On.Seconds:return n.getSeconds();case On.FractionalSeconds:return n.getMilliseconds();case On.Day:return n.getDay();default:throw new Error(`Unknown DateType value "${e}".`)}}(e,c);if((t>0||y>-t)&&(y+=t),e===On.Hours)0===y&&-12===t&&(y=12);else if(e===On.FractionalSeconds)return function GF(e,n){return Ga(e,3).substring(0,n)}(y,n);const w=sa(h,rr.MinusSign);return Ga(y,n,w,i,r)}}function li(e,n,t=Ps.Format,i=!1){return function(r,c){return function ZF(e,n,t,i,r,c){switch(t){case Fn.Months:return function RF(e,n,t){const i=As(e),c=oa([i[ai.MonthsFormat],i[ai.MonthsStandalone]],n);return oa(c,t)}(n,r,i)[e.getMonth()];case Fn.Days:return function PF(e,n,t){const i=As(e),c=oa([i[ai.DaysFormat],i[ai.DaysStandalone]],n);return oa(c,t)}(n,r,i)[e.getDay()];case Fn.DayPeriods:const h=e.getHours(),y=e.getMinutes();if(c){const I=function NF(e){const n=As(e);return MD(n),(n[ai.ExtraData][2]||[]).map(i=>"string"==typeof i?r0(i):[r0(i[0]),r0(i[1])])}(n),P=function zF(e,n,t){const i=As(e);MD(i);const c=oa([i[ai.ExtraData][0],i[ai.ExtraData][1]],n)||[];return oa(c,t)||[]}(n,r,i),z=I.findIndex(G=>{if(Array.isArray(G)){const[re,fe]=G,ge=h>=re.hours&&y>=re.minutes,Ie=h<fe.hours||h===fe.hours&&y<fe.minutes;if(re.hours<fe.hours){if(ge&&Ie)return!0}else if(ge||Ie)return!0}else if(G.hours===h&&G.minutes===y)return!0;return!1});if(-1!==z)return P[z]}return function kF(e,n,t){const i=As(e),c=oa([i[ai.DayPeriodsFormat],i[ai.DayPeriodsStandalone]],n);return oa(c,t)}(n,r,i)[h<12?0:1];case Fn.Eras:return function OF(e,n){return oa(As(e)[ai.Eras],n)}(n,i)[e.getFullYear()<=0?0:1];default:throw new Error(`unexpected translation type ${t}`)}}(r,c,e,n,t,i)}}function P_(e){return function(n,t,i){const r=-1*i,c=sa(t,rr.MinusSign),h=r>0?Math.floor(r/60):Math.ceil(r/60);switch(e){case fc.Short:return(r>=0?"+":"")+Ga(h,2,c)+Ga(Math.abs(r%60),2,c);case fc.ShortGMT:return"GMT"+(r>=0?"+":"")+Ga(h,1,c);case fc.Long:return"GMT"+(r>=0?"+":"")+Ga(h,2,c)+":"+Ga(Math.abs(r%60),2,c);case fc.Extended:return 0===i?"Z":(r>=0?"+":"")+Ga(h,2,c)+":"+Ga(Math.abs(r%60),2,c);default:throw new Error(`Unknown zone width "${e}"`)}}}const WF=0,R_=4;function TD(e){return A_(e.getFullYear(),e.getMonth(),e.getDate()+(R_-e.getDay()))}function s0(e,n=!1){return function(t,i){let r;if(n){const c=new Date(t.getFullYear(),t.getMonth(),1).getDay()-1,h=t.getDate();r=1+Math.floor((h+c)/7)}else{const c=TD(t),h=function XF(e){const n=A_(e,WF,1).getDay();return A_(e,0,1+(n<=R_?R_:R_+7)-n)}(c.getFullYear()),y=c.getTime()-h.getTime();r=1+Math.round(y/6048e5)}return Ga(r,e,sa(i,rr.MinusSign))}}function O_(e,n=!1){return function(t,i){return Ga(TD(t).getFullYear(),e,sa(i,rr.MinusSign),n)}}const o0={};function AD(e,n){e=e.replace(/:/g,"");const t=Date.parse("Jan 01, 1970 00:00:00 "+e)/6e4;return isNaN(t)?n:t}function kD(e){return e instanceof Date&&!isNaN(e.valueOf())}function FD(e,n){n=encodeURIComponent(n);for(const t of e.split(";")){const i=t.indexOf("="),[r,c]=-1==i?[t,""]:[t.slice(0,i),t.slice(i+1)];if(r.trim()===n)return decodeURIComponent(c)}return null}class fL{constructor(n,t,i,r){this.$implicit=n,this.ngForOf=t,this.index=i,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let ip=(()=>{class e{set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}constructor(t,i,r){this._viewContainer=t,this._template=i,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){const t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){const i=this._viewContainer;t.forEachOperation((r,c,h)=>{if(null==r.previousIndex)i.createEmbeddedView(this._template,new fL(r.item,this._ngForOf,-1,-1),null===h?void 0:h);else if(null==h)i.remove(null===c?void 0:c);else if(null!==c){const y=i.get(c);i.move(y,h),zD(y,r)}});for(let r=0,c=i.length;r<c;r++){const y=i.get(r).context;y.index=r,y.count=c,y.ngForOf=this._ngForOf}t.forEachIdentityChange(r=>{zD(i.get(r.currentIndex),r)})}static ngTemplateContextGuard(t,i){return!0}static#e=this.\u0275fac=function(i){return new(i||e)(xe($a),xe(hc),xe(E_))};static#t=this.\u0275dir=xt({type:e,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0})}return e})();function zD(e,n){e.context.$implicit=n.item}let Id=(()=>{class e{constructor(t,i){this._viewContainer=t,this._context=new mL,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){BD("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){BD("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,i){return!0}static#e=this.\u0275fac=function(i){return new(i||e)(xe($a),xe(hc))};static#t=this.\u0275dir=xt({type:e,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0})}return e})();class mL{constructor(){this.$implicit=null,this.ngIf=null}}function BD(e,n){if(n&&!n.createEmbeddedView)throw new Error(`${e} must be a TemplateRef, but received '${vi(n)}'.`)}function qa(e,n){return new Pe(2100,!1)}const EL=/(?:[0-9A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CA\uA7D0\uA7D1\uA7D3\uA7D5-\uA7D9\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD50-\uDD52\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E]|\uD838[\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF38\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A])\S*/g;let rp=(()=>{class e{transform(t){if(null==t)return null;if("string"!=typeof t)throw qa();return t.replace(EL,i=>i[0].toUpperCase()+i.slice(1).toLowerCase())}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275pipe=Qi({name:"titlecase",type:e,pure:!0,standalone:!0})}return e})(),m0=(()=>{class e{transform(t){if(null==t)return null;if("string"!=typeof t)throw qa();return t.toUpperCase()}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275pipe=Qi({name:"uppercase",type:e,pure:!0,standalone:!0})}return e})();const IL=new Xe("DATE_PIPE_DEFAULT_TIMEZONE"),SL=new Xe("DATE_PIPE_DEFAULT_OPTIONS");let g0=(()=>{class e{constructor(t,i,r){this.locale=t,this.defaultTimezone=i,this.defaultOptions=r}transform(t,i,r,c){if(null==t||""===t||t!=t)return null;try{return HF(t,i??this.defaultOptions?.dateFormat??"mediumDate",c||this.locale,r??this.defaultOptions?.timezone??this.defaultTimezone??void 0)}catch(h){throw qa()}}static#e=this.\u0275fac=function(i){return new(i||e)(xe(Ml,16),xe(IL,24),xe(SL,24))};static#t=this.\u0275pipe=Qi({name:"date",type:e,pure:!0,standalone:!0})}return e})(),UD=(()=>{class e{constructor(t){this.differs=t,this.keyValues=[],this.compareFn=jD}transform(t,i=jD){if(!t||!(t instanceof Map)&&"object"!=typeof t)return null;this.differ||(this.differ=this.differs.find(t).create());const r=this.differ.diff(t),c=i!==this.compareFn;return r&&(this.keyValues=[],r.forEachItem(h=>{this.keyValues.push(function PL(e,n){return{key:e,value:n}}(h.key,h.currentValue))})),(r||c)&&(this.keyValues.sort(i),this.compareFn=i),this.keyValues}static#e=this.\u0275fac=function(i){return new(i||e)(xe(Xf,16))};static#t=this.\u0275pipe=Qi({name:"keyvalue",type:e,pure:!1,standalone:!0})}return e})();function jD(e,n){const t=e.key,i=n.key;if(t===i)return 0;if(void 0===t)return 1;if(void 0===i)return-1;if(null===t)return 1;if(null===i)return-1;if("string"==typeof t&&"string"==typeof i)return t<i?-1:1;if("number"==typeof t&&"number"==typeof i)return t-i;if("boolean"==typeof t&&"boolean"==typeof i)return t<i?-1:1;const r=String(t),c=String(i);return r==c?0:r<c?-1:1}let v0=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=Ni({type:e});static#n=this.\u0275inj=Fi({})}return e})();const $D="browser";function HD(e){return"server"===e}let VL=(()=>{class e{static#e=this.\u0275prov=ct({token:e,providedIn:"root",factory:()=>new UL(nt(ps),window)})}return e})();class UL{constructor(n,t){this.document=n,this.window=t,this.offset=()=>[0,0]}setOffset(n){this.offset=Array.isArray(n)?()=>n:n}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(n){this.supportsScrolling()&&this.window.scrollTo(n[0],n[1])}scrollToAnchor(n){if(!this.supportsScrolling())return;const t=function jL(e,n){const t=e.getElementById(n)||e.getElementsByName(n)[0];if(t)return t;if("function"==typeof e.createTreeWalker&&e.body&&"function"==typeof e.body.attachShadow){const i=e.createTreeWalker(e.body,NodeFilter.SHOW_ELEMENT);let r=i.currentNode;for(;r;){const c=r.shadowRoot;if(c){const h=c.getElementById(n)||c.querySelector(`[name="${n}"]`);if(h)return h}r=i.nextNode()}}return null}(this.document,n);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(n){this.supportsScrolling()&&(this.window.history.scrollRestoration=n)}scrollToElement(n){const t=n.getBoundingClientRect(),i=t.left+this.window.pageXOffset,r=t.top+this.window.pageYOffset,c=this.offset();this.window.scrollTo(i-c[0],r-c[1])}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}class GD{}class dN extends wF{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class w0 extends dN{static makeCurrent(){!function xF(e){Jb||(Jb=e)}(new w0)}onAndCancel(n,t,i){return n.addEventListener(t,i),()=>{n.removeEventListener(t,i)}}dispatchEvent(n,t){n.dispatchEvent(t)}remove(n){n.parentNode&&n.parentNode.removeChild(n)}createElement(n,t){return(t=t||this.getDefaultDocument()).createElement(n)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(n){return n.nodeType===Node.ELEMENT_NODE}isShadowRoot(n){return n instanceof DocumentFragment}getGlobalEventTarget(n,t){return"window"===t?window:"document"===t?n:"body"===t?n.body:null}getBaseHref(n){const t=function hN(){return Qf=Qf||document.querySelector("base"),Qf?Qf.getAttribute("href"):null}();return null==t?null:function pN(e){z_=z_||document.createElement("a"),z_.setAttribute("href",e);const n=z_.pathname;return"/"===n.charAt(0)?n:`/${n}`}(t)}resetBaseElement(){Qf=null}getUserAgent(){return window.navigator.userAgent}getCookie(n){return FD(document.cookie,n)}}let z_,Qf=null,mN=(()=>{class e{build(){return new XMLHttpRequest}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=ct({token:e,factory:e.\u0275fac})}return e})();const C0=new Xe("EventManagerPlugins");let KD=(()=>{class e{constructor(t,i){this._zone=i,this._eventNameToPlugin=new Map,t.forEach(r=>{r.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,i,r){return this._findPluginFor(i).addEventListener(t,i,r)}getZone(){return this._zone}_findPluginFor(t){let i=this._eventNameToPlugin.get(t);if(i)return i;if(i=this._plugins.find(c=>c.supports(t)),!i)throw new Pe(5101,!1);return this._eventNameToPlugin.set(t,i),i}static#e=this.\u0275fac=function(i){return new(i||e)(nt(C0),nt(dn))};static#t=this.\u0275prov=ct({token:e,factory:e.\u0275fac})}return e})();class YD{constructor(n){this._doc=n}}const E0="ng-app-id";let JD=(()=>{class e{constructor(t,i,r,c={}){this.doc=t,this.appId=i,this.nonce=r,this.platformId=c,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=HD(c),this.resetHostNodes()}addStyles(t){for(const i of t)1===this.changeUsageCount(i,1)&&this.onStyleAdded(i)}removeStyles(t){for(const i of t)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){const t=this.styleNodesInDOM;t&&(t.forEach(i=>i.remove()),t.clear());for(const i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(t){this.hostNodes.add(t);for(const i of this.getAllStyles())this.addStyleToHost(t,i)}removeHost(t){this.hostNodes.delete(t)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(t){for(const i of this.hostNodes)this.addStyleToHost(i,t)}onStyleRemoved(t){const i=this.styleRef;i.get(t)?.elements?.forEach(r=>r.remove()),i.delete(t)}collectServerRenderedStyles(){const t=this.doc.head?.querySelectorAll(`style[${E0}="${this.appId}"]`);if(t?.length){const i=new Map;return t.forEach(r=>{null!=r.textContent&&i.set(r.textContent,r)}),i}return null}changeUsageCount(t,i){const r=this.styleRef;if(r.has(t)){const c=r.get(t);return c.usage+=i,c.usage}return r.set(t,{usage:i,elements:[]}),i}getStyleElement(t,i){const r=this.styleNodesInDOM,c=r?.get(i);if(c?.parentNode===t)return r.delete(i),c.removeAttribute(E0),c;{const h=this.doc.createElement("style");return this.nonce&&h.setAttribute("nonce",this.nonce),h.textContent=i,this.platformIsServer&&h.setAttribute(E0,this.appId),h}}addStyleToHost(t,i){const r=this.getStyleElement(t,i);t.appendChild(r);const c=this.styleRef,h=c.get(i)?.elements;h?h.push(r):c.set(i,{elements:[r],usage:1})}resetHostNodes(){const t=this.hostNodes;t.clear(),t.add(this.doc.head)}static#e=this.\u0275fac=function(i){return new(i||e)(nt(ps),nt(Ug),nt(Ev,8),nt(du))};static#t=this.\u0275prov=ct({token:e,factory:e.\u0275fac})}return e})();const D0={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},I0=/%COMP%/g,vN=new Xe("RemoveStylesOnCompDestroy",{providedIn:"root",factory:()=>!1});function eI(e,n){return n.map(t=>t.replace(I0,e))}let tI=(()=>{class e{constructor(t,i,r,c,h,y,w,I=null){this.eventManager=t,this.sharedStylesHost=i,this.appId=r,this.removeStylesOnCompDestroy=c,this.doc=h,this.platformId=y,this.ngZone=w,this.nonce=I,this.rendererByCompId=new Map,this.platformIsServer=HD(y),this.defaultRenderer=new S0(t,h,w,this.platformIsServer)}createRenderer(t,i){if(!t||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===Hr.ShadowDom&&(i={...i,encapsulation:Hr.Emulated});const r=this.getOrCreateRenderer(t,i);return r instanceof iI?r.applyToHost(t):r instanceof M0&&r.applyStyles(),r}getOrCreateRenderer(t,i){const r=this.rendererByCompId;let c=r.get(i.id);if(!c){const h=this.doc,y=this.ngZone,w=this.eventManager,I=this.sharedStylesHost,P=this.removeStylesOnCompDestroy,z=this.platformIsServer;switch(i.encapsulation){case Hr.Emulated:c=new iI(w,I,i,this.appId,P,h,y,z);break;case Hr.ShadowDom:return new CN(w,I,t,i,h,y,this.nonce,z);default:c=new M0(w,I,i,P,h,y,z)}r.set(i.id,c)}return c}ngOnDestroy(){this.rendererByCompId.clear()}static#e=this.\u0275fac=function(i){return new(i||e)(nt(KD),nt(JD),nt(Ug),nt(vN),nt(ps),nt(du),nt(dn),nt(Ev))};static#t=this.\u0275prov=ct({token:e,factory:e.\u0275fac})}return e})();class S0{constructor(n,t,i,r){this.eventManager=n,this.doc=t,this.ngZone=i,this.platformIsServer=r,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(n,t){return t?this.doc.createElementNS(D0[t]||t,n):this.doc.createElement(n)}createComment(n){return this.doc.createComment(n)}createText(n){return this.doc.createTextNode(n)}appendChild(n,t){(nI(n)?n.content:n).appendChild(t)}insertBefore(n,t,i){n&&(nI(n)?n.content:n).insertBefore(t,i)}removeChild(n,t){n&&n.removeChild(t)}selectRootElement(n,t){let i="string"==typeof n?this.doc.querySelector(n):n;if(!i)throw new Pe(-5104,!1);return t||(i.textContent=""),i}parentNode(n){return n.parentNode}nextSibling(n){return n.nextSibling}setAttribute(n,t,i,r){if(r){t=r+":"+t;const c=D0[r];c?n.setAttributeNS(c,t,i):n.setAttribute(t,i)}else n.setAttribute(t,i)}removeAttribute(n,t,i){if(i){const r=D0[i];r?n.removeAttributeNS(r,t):n.removeAttribute(`${i}:${t}`)}else n.removeAttribute(t)}addClass(n,t){n.classList.add(t)}removeClass(n,t){n.classList.remove(t)}setStyle(n,t,i,r){r&(Oa.DashCase|Oa.Important)?n.style.setProperty(t,i,r&Oa.Important?"important":""):n.style[t]=i}removeStyle(n,t,i){i&Oa.DashCase?n.style.removeProperty(t):n.style[t]=""}setProperty(n,t,i){n[t]=i}setValue(n,t){n.nodeValue=t}listen(n,t,i){if("string"==typeof n&&!(n=mu().getGlobalEventTarget(this.doc,n)))throw new Error(`Unsupported event target ${n} for event ${t}`);return this.eventManager.addEventListener(n,t,this.decoratePreventDefault(i))}decoratePreventDefault(n){return t=>{if("__ngUnwrap__"===t)return n;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>n(t)):n(t))&&t.preventDefault()}}}function nI(e){return"TEMPLATE"===e.tagName&&void 0!==e.content}class CN extends S0{constructor(n,t,i,r,c,h,y,w){super(n,c,h,w),this.sharedStylesHost=t,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const I=eI(r.id,r.styles);for(const P of I){const z=document.createElement("style");y&&z.setAttribute("nonce",y),z.textContent=P,this.shadowRoot.appendChild(z)}}nodeOrShadowRoot(n){return n===this.hostEl?this.shadowRoot:n}appendChild(n,t){return super.appendChild(this.nodeOrShadowRoot(n),t)}insertBefore(n,t,i){return super.insertBefore(this.nodeOrShadowRoot(n),t,i)}removeChild(n,t){return super.removeChild(this.nodeOrShadowRoot(n),t)}parentNode(n){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(n)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class M0 extends S0{constructor(n,t,i,r,c,h,y,w){super(n,c,h,y),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=r,this.styles=w?eI(w,i.styles):i.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}}class iI extends M0{constructor(n,t,i,r,c,h,y,w){const I=r+"-"+i.id;super(n,t,i,c,h,y,w,I),this.contentAttr=function bN(e){return"_ngcontent-%COMP%".replace(I0,e)}(I),this.hostAttr=function xN(e){return"_nghost-%COMP%".replace(I0,e)}(I)}applyToHost(n){this.applyStyles(),this.setAttribute(n,this.hostAttr,"")}createElement(n,t){const i=super.createElement(n,t);return super.setAttribute(i,this.contentAttr,""),i}}let EN=(()=>{class e extends YD{constructor(t){super(t)}supports(t){return!0}addEventListener(t,i,r){return t.addEventListener(i,r,!1),()=>this.removeEventListener(t,i,r)}removeEventListener(t,i,r){return t.removeEventListener(i,r)}static#e=this.\u0275fac=function(i){return new(i||e)(nt(ps))};static#t=this.\u0275prov=ct({token:e,factory:e.\u0275fac})}return e})();const rI=["alt","control","meta","shift"],DN={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},IN={alt:e=>e.altKey,control:e=>e.ctrlKey,meta:e=>e.metaKey,shift:e=>e.shiftKey};let SN=(()=>{class e extends YD{constructor(t){super(t)}supports(t){return null!=e.parseEventName(t)}addEventListener(t,i,r){const c=e.parseEventName(i),h=e.eventCallback(c.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>mu().onAndCancel(t,c.domEventName,h))}static parseEventName(t){const i=t.toLowerCase().split("."),r=i.shift();if(0===i.length||"keydown"!==r&&"keyup"!==r)return null;const c=e._normalizeKey(i.pop());let h="",y=i.indexOf("code");if(y>-1&&(i.splice(y,1),h="code."),rI.forEach(I=>{const P=i.indexOf(I);P>-1&&(i.splice(P,1),h+=I+".")}),h+=c,0!=i.length||0===c.length)return null;const w={};return w.domEventName=r,w.fullKey=h,w}static matchEventFullKeyCode(t,i){let r=DN[t.key]||t.key,c="";return i.indexOf("code.")>-1&&(r=t.code,c="code."),!(null==r||!r)&&(r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),rI.forEach(h=>{h!==r&&(0,IN[h])(t)&&(c+=h+".")}),c+=r,c===i)}static eventCallback(t,i,r){return c=>{e.matchEventFullKeyCode(c,t)&&r.runGuarded(()=>i(c))}}static _normalizeKey(t){return"esc"===t?"escape":t}static#e=this.\u0275fac=function(i){return new(i||e)(nt(ps))};static#t=this.\u0275prov=ct({token:e,factory:e.\u0275fac})}return e})();const kN=YE(aF,"browser",[{provide:du,useValue:$D},{provide:aw,useValue:function MN(){w0.makeCurrent()},multi:!0},{provide:ps,useFactory:function AN(){return function hr(e){Br=e}(document),document},deps:[]}]),PN=new Xe(""),aI=[{provide:b_,useClass:class fN{addToWindow(n){Dn.getAngularTestability=(i,r=!0)=>{const c=n.findTestabilityInTree(i,r);if(null==c)throw new Pe(5103,!1);return c},Dn.getAllAngularTestabilities=()=>n.getAllTestabilities(),Dn.getAllAngularRootElements=()=>n.getAllRootElements(),Dn.frameworkStabilizers||(Dn.frameworkStabilizers=[]),Dn.frameworkStabilizers.push(i=>{const r=Dn.getAllAngularTestabilities();let c=r.length,h=!1;const y=function(w){h=h||w,c--,0==c&&i(h)};r.forEach(w=>{w.whenStable(y)})})}findTestabilityInTree(n,t,i){return null==t?null:n.getTestability(t)??(i?mu().isShadowRoot(t)?this.findTestabilityInTree(n,t.host,!0):this.findTestabilityInTree(n,t.parentElement,!0):null)}},deps:[]},{provide:qE,useClass:Ub,deps:[dn,jb,b_]},{provide:Ub,useClass:Ub,deps:[dn,jb,b_]}],lI=[{provide:bv,useValue:"root"},{provide:cc,useFactory:function TN(){return new cc},deps:[]},{provide:C0,useClass:EN,multi:!0,deps:[ps,dn,du]},{provide:C0,useClass:SN,multi:!0,deps:[ps]},tI,JD,KD,{provide:fw,useExisting:tI},{provide:GD,useClass:mN,deps:[]},[]];let RN=(()=>{class e{constructor(t){}static withServerTransition(t){return{ngModule:e,providers:[{provide:Ug,useValue:t.appId}]}}static#e=this.\u0275fac=function(i){return new(i||e)(nt(PN,12))};static#t=this.\u0275mod=Ni({type:e});static#n=this.\u0275inj=Fi({providers:[...lI,...aI],imports:[v0,lF]})}return e})(),cI=(()=>{class e{constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static#e=this.\u0275fac=function(i){return new(i||e)(nt(ps))};static#t=this.\u0275prov=ct({token:e,factory:function(i){let r=null;return r=i?new i:function FN(){return new cI(nt(ps))}(),r},providedIn:"root"})}return e})();function pI(e,n,t,i,r,c,h){try{var y=e[c](h),w=y.value}catch(I){return void t(I)}y.done?n(w):Promise.resolve(w).then(i,r)}function _u(e){return function(){var n=this,t=arguments;return new Promise(function(i,r){var c=e.apply(n,t);function h(w){pI(c,i,r,h,y,"next",w)}function y(w){pI(c,i,r,h,y,"throw",w)}h(void 0)})}}typeof window<"u"&&window;var B_=bc(624);class fI extends ci{constructor(){super(...arguments),this._value=null,this._hasValue=!1,this._isComplete=!1}_checkFinalizedStatuses(n){const{hasError:t,_hasValue:i,_value:r,thrownError:c,isStopped:h,_isComplete:y}=this;t?n.error(c):(h||y)&&(i&&n.next(r),n.complete())}next(n){this.isStopped||(this._value=n,this._hasValue=!0)}complete(){const{_hasValue:n,_value:t,_isComplete:i}=this;i||(this._isComplete=!0,n&&super.next(t),super.complete())}}const{isArray:VN}=Array;function A0(e){return Ft(n=>function UN(e,n){return VN(n)?e(...n):e(n)}(e,n))}const jN=["addListener","removeListener"],$N=["addEventListener","removeEventListener"],HN=["on","off"];function em(e,n,t,i){if(Jt(t)&&(i=t,t=void 0),i)return em(e,n,t).pipe(A0(i));const[r,c]=function ZN(e){return Jt(e.addEventListener)&&Jt(e.removeEventListener)}(e)?$N.map(h=>y=>e[h](n,y,t)):function GN(e){return Jt(e.addListener)&&Jt(e.removeListener)}(e)?jN.map(mI(e,n)):function qN(e){return Jt(e.on)&&Jt(e.off)}(e)?HN.map(mI(e,n)):[];if(!r&&V(e))return ln(h=>em(h,n,t))(Ee(e));if(!r)throw new TypeError("Invalid event target");return new Ln(h=>{const y=(...w)=>h.next(1<w.length?w:w[0]);return r(y),()=>c(y)})}function mI(e,n){return t=>i=>e[t](n,i)}const tm=Iu(e=>function(){e(this),this.name="EmptyError",this.message="no elements in sequence"});function Mo(e,n){return Vn((t,i)=>{let r=0;t.subscribe(_n(i,c=>e.call(n,c,r++)&&i.next(c)))})}function Sd(e){return e<=0?()=>bn:Vn((n,t)=>{let i=0;n.subscribe(_n(t,r=>{++i<=e&&(t.next(r),e<=i&&t.complete())}))})}function V_(e){return Vn((n,t)=>{let i=!1;n.subscribe(_n(t,r=>{i=!0,t.next(r)},()=>{i||t.next(e),t.complete()}))})}function gI(e=WN){return Vn((n,t)=>{let i=!1;n.subscribe(_n(t,r=>{i=!0,t.next(r)},()=>i?t.complete():t.error(e())))})}function WN(){return new tm}function yu(e,n){const t=arguments.length>=2;return i=>i.pipe(e?Mo((r,c)=>e(r,c,i)):jr,Sd(1),t?V_(n):gI(()=>new tm))}class XN extends mn{constructor(n,t){super()}schedule(n,t=0){return this}}const U_={setInterval(e,n,...t){const{delegate:i}=U_;return i?.setInterval?i.setInterval(e,n,...t):setInterval(e,n,...t)},clearInterval(e){const{delegate:n}=U_;return(n?.clearInterval||clearInterval)(e)},delegate:void 0},_I={now:()=>(_I.delegate||Date).now(),delegate:void 0};class nm{constructor(n,t=nm.now){this.schedulerActionCtor=n,this.now=t}schedule(n,t=0,i){return new this.schedulerActionCtor(this,n).schedule(i,t)}}nm.now=_I.now;const JN=new class YN extends nm{constructor(n,t=nm.now){super(n,t),this.actions=[],this._active=!1}flush(n){const{actions:t}=this;if(this._active)return void t.push(n);let i;this._active=!0;do{if(i=n.execute(n.state,n.delay))break}while(n=t.shift());if(this._active=!1,i){for(;n=t.shift();)n.unsubscribe();throw i}}}(class KN extends XN{constructor(n,t){super(n,t),this.scheduler=n,this.work=t,this.pending=!1}schedule(n,t=0){var i;if(this.closed)return this;this.state=n;const r=this.id,c=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(c,r,t)),this.pending=!0,this.delay=t,this.id=null!==(i=this.id)&&void 0!==i?i:this.requestAsyncId(c,this.id,t),this}requestAsyncId(n,t,i=0){return U_.setInterval(n.flush.bind(n,this),i)}recycleAsyncId(n,t,i=0){if(null!=i&&this.delay===i&&!1===this.pending)return t;null!=t&&U_.clearInterval(t)}execute(n,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(n,t);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(n,t){let r,i=!1;try{this.work(n)}catch(c){i=!0,r=c||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),r}unsubscribe(){if(!this.closed){const{id:n,scheduler:t}=this,{actions:i}=t;this.work=this.state=this.scheduler=null,this.pending=!1,g(i,this),null!=n&&(this.id=this.recycleAsyncId(t,n,null)),this.delay=null,super.unsubscribe()}}});function yI(e,n=JN){return Vn((t,i)=>{let r=null,c=null,h=null;const y=()=>{if(r){r.unsubscribe(),r=null;const I=c;c=null,i.next(I)}};function w(){const I=h+e,P=n.now();if(P<I)return r=this.schedule(void 0,I-P),void i.add(r);y()}t.subscribe(_n(i,I=>{c=I,h=n.now(),r||(r=n.schedule(w,e),i.add(r))},()=>{y(),i.complete()},void 0,()=>{c=r=null}))})}function j_(...e){return function QN(){return gt(1)}()(Qn(e,ar(e)))}function k0(...e){const n=ar(e);return Vn((t,i)=>{(n?j_(e,t,n):j_(e,t)).subscribe(i)})}const P0=["content"],R0=["*"],ez=["container"];let gc=(()=>{class e{constructor(t){this.zone=t,this.mapCreated=new fI,this.mapLoaded=new fI,this.markersToRemove=[],this.popupsToRemove=[],this.imageIdsToRemove=[],this.subscription=new mn,this.mapCreated$=this.mapCreated.asObservable(),this.mapLoaded$=this.mapLoaded.asObservable()}setup(t){this.zone.onStable.pipe(yu()).subscribe(()=>{this.createMap(t.mapOptions),this.hookEvents(t.mapEvents),this.mapEvents=t.mapEvents,this.mapCreated.next(void 0),this.mapCreated.complete(),t.mapOptions.terrain&&this.mapInstance.on("load",()=>{this.updateTerrain(t.mapOptions.terrain)})})}destroyMap(){this.mapInstance&&(this.subscription.unsubscribe(),this.mapInstance.remove())}updateMinZoom(t){return this.zone.runOutsideAngular(()=>{this.mapInstance.setMinZoom(t)})}updateMaxZoom(t){return this.zone.runOutsideAngular(()=>{this.mapInstance.setMaxZoom(t)})}updateMinPitch(t){return this.zone.runOutsideAngular(()=>{this.mapInstance.setMinPitch(t)})}updateMaxPitch(t){return this.zone.runOutsideAngular(()=>{this.mapInstance.setMaxPitch(t)})}updateRenderWorldCopies(t){return this.zone.runOutsideAngular(()=>{this.mapInstance.setRenderWorldCopies(t)})}updateScrollZoom(t){return this.zone.runOutsideAngular(()=>{t?this.mapInstance.scrollZoom.enable():this.mapInstance.scrollZoom.disable()})}updateDragRotate(t){return this.zone.runOutsideAngular(()=>{t?this.mapInstance.dragRotate.enable():this.mapInstance.dragRotate.disable()})}updateTouchPitch(t){return this.zone.runOutsideAngular(()=>{t?this.mapInstance.touchPitch.enable():this.mapInstance.touchPitch.disable()})}updateTouchZoomRotate(t){return this.zone.runOutsideAngular(()=>{t?this.mapInstance.touchZoomRotate.enable():this.mapInstance.touchZoomRotate.disable()})}updateDoubleClickZoom(t){return this.zone.runOutsideAngular(()=>{t?this.mapInstance.doubleClickZoom.enable():this.mapInstance.doubleClickZoom.disable()})}updateKeyboard(t){return this.zone.runOutsideAngular(()=>{t?this.mapInstance.keyboard.enable():this.mapInstance.keyboard.disable()})}updateDragPan(t){return this.zone.runOutsideAngular(()=>{t?this.mapInstance.dragPan.enable():this.mapInstance.dragPan.disable()})}updateBoxZoom(t){return this.zone.runOutsideAngular(()=>{t?this.mapInstance.boxZoom.enable():this.mapInstance.boxZoom.disable()})}updateStyle(t){return this.zone.runOutsideAngular(()=>{this.mapInstance.setStyle(t)})}updateMaxBounds(t){return this.zone.runOutsideAngular(()=>{this.mapInstance.setMaxBounds(t)})}updateTerrain(t){return this.zone.runOutsideAngular(()=>{this.mapInstance.setTerrain(t)})}getTerrain(){return this.zone.runOutsideAngular(()=>this.mapInstance.getTerrain())}changeCanvasCursor(t){this.mapInstance.getCanvasContainer().style.cursor=t}queryRenderedFeatures(t,i){return this.mapInstance.queryRenderedFeatures(t,i)}panTo(t,i){return this.zone.runOutsideAngular(()=>{this.mapInstance.panTo(t,i)})}move(t,i,r,c,h,y){return this.zone.runOutsideAngular(()=>{this.mapInstance[t]({...i,zoom:r??this.mapInstance.getZoom(),center:c??this.mapInstance.getCenter(),bearing:h??this.mapInstance.getBearing(),pitch:y??this.mapInstance.getPitch()})})}addLayer(t,i,r){this.zone.runOutsideAngular(()=>{Object.keys(t.layerOptions).forEach(c=>{void 0===t.layerOptions[c]&&delete t.layerOptions[c]}),this.mapInstance.addLayer(t.layerOptions,r),i&&(t.layerEvents.layerClick.observers.length&&this.mapInstance.on("click",t.layerOptions.id,c=>{this.zone.run(()=>{t.layerEvents.layerClick.emit(c)})}),t.layerEvents.layerDblClick.observers.length&&this.mapInstance.on("dblclick",t.layerOptions.id,c=>{this.zone.run(()=>{t.layerEvents.layerDblClick.emit(c)})}),t.layerEvents.layerMouseDown.observers.length&&this.mapInstance.on("mousedown",t.layerOptions.id,c=>{this.zone.run(()=>{t.layerEvents.layerMouseDown.emit(c)})}),t.layerEvents.layerMouseUp.observers.length&&this.mapInstance.on("mouseup",t.layerOptions.id,c=>{this.zone.run(()=>{t.layerEvents.layerMouseUp.emit(c)})}),t.layerEvents.layerMouseEnter.observers.length&&this.mapInstance.on("mouseenter",t.layerOptions.id,c=>{this.zone.run(()=>{t.layerEvents.layerMouseEnter.emit(c)})}),t.layerEvents.layerMouseLeave.observers.length&&this.mapInstance.on("mouseleave",t.layerOptions.id,c=>{this.zone.run(()=>{t.layerEvents.layerMouseLeave.emit(c)})}),t.layerEvents.layerMouseMove.observers.length&&this.mapInstance.on("mousemove",t.layerOptions.id,c=>{this.zone.run(()=>{t.layerEvents.layerMouseMove.emit(c)})}),t.layerEvents.layerMouseOver.observers.length&&this.mapInstance.on("mouseover",t.layerOptions.id,c=>{this.zone.run(()=>{t.layerEvents.layerMouseOver.emit(c)})}),t.layerEvents.layerMouseOut.observers.length&&this.mapInstance.on("mouseout",t.layerOptions.id,c=>{this.zone.run(()=>{t.layerEvents.layerMouseOut.emit(c)})}),t.layerEvents.layerContextMenu.observers.length&&this.mapInstance.on("contextmenu",t.layerOptions.id,c=>{this.zone.run(()=>{t.layerEvents.layerContextMenu.emit(c)})}),t.layerEvents.layerTouchStart.observers.length&&this.mapInstance.on("touchstart",t.layerOptions.id,c=>{this.zone.run(()=>{t.layerEvents.layerTouchStart.emit(c)})}),t.layerEvents.layerTouchEnd.observers.length&&this.mapInstance.on("touchend",t.layerOptions.id,c=>{this.zone.run(()=>{t.layerEvents.layerTouchEnd.emit(c)})}),t.layerEvents.layerTouchCancel.observers.length&&this.mapInstance.on("touchcancel",t.layerOptions.id,c=>{this.zone.run(()=>{t.layerEvents.layerTouchCancel.emit(c)})}))})}removeLayer(t){this.zone.runOutsideAngular(()=>{null!=this.mapInstance.getLayer(t)&&this.mapInstance.removeLayer(t)})}addMarker(t){const i={offset:t.markersOptions.offset,anchor:t.markersOptions.anchor,draggable:!!t.markersOptions.draggable,rotationAlignment:t.markersOptions.rotationAlignment,pitchAlignment:t.markersOptions.pitchAlignment,clickTolerance:t.markersOptions.clickTolerance};t.markersOptions.element.childNodes.length>0&&(i.element=t.markersOptions.element);const r=new B_.Marker(i);return t.markersEvents.markerDragStart.observers.length&&r.on("dragstart",h=>{if(h){const{target:y}=h;this.zone.run(()=>{t.markersEvents.markerDragStart.emit(y)})}}),t.markersEvents.markerDrag.observers.length&&r.on("drag",h=>{if(h){const{target:y}=h;this.zone.run(()=>{t.markersEvents.markerDrag.emit(y)})}}),t.markersEvents.markerDragEnd.observers.length&&r.on("dragend",h=>{if(h){const{target:y}=h;this.zone.run(()=>{t.markersEvents.markerDragEnd.emit(y)})}}),r.setLngLat(t.markersOptions.feature?t.markersOptions.feature.geometry.coordinates:t.markersOptions.lngLat),this.zone.runOutsideAngular(()=>(r.addTo(this.mapInstance),r))}removeMarker(t){this.markersToRemove.push(t)}createPopup(t,i){return this.zone.runOutsideAngular(()=>{Object.keys(t.popupOptions).forEach(c=>void 0===t.popupOptions[c]&&delete t.popupOptions[c]);const r=new B_.Popup(t.popupOptions);return r.setDOMContent(i),t.popupEvents.popupClose.observers.length&&r.on("close",()=>{this.zone.run(()=>{t.popupEvents.popupClose.emit()})}),t.popupEvents.popupOpen.observers.length&&r.on("open",()=>{this.zone.run(()=>{t.popupEvents.popupOpen.emit()})}),r})}addPopupToMap(t,i,r=!1){return this.zone.runOutsideAngular(()=>{r&&t._listeners&&delete t._listeners.open,t.setLngLat(i),t.addTo(this.mapInstance)})}addPopupToMarker(t,i){return this.zone.runOutsideAngular(()=>{t.setPopup(i)})}removePopupFromMap(t,i=!1){i&&t._listeners&&delete t._listeners.close,this.popupsToRemove.push(t)}removePopupFromMarker(t){return this.zone.runOutsideAngular(()=>{t.setPopup(void 0)})}addControl(t,i){return this.zone.runOutsideAngular(()=>{this.mapInstance.addControl(t,i)})}removeControl(t){return this.zone.runOutsideAngular(()=>{this.mapInstance.removeControl(t)})}loadAndAddImage(t,i,r){var c=this;return _u(function*(){return c.zone.runOutsideAngular(()=>new Promise((h,y)=>{c.mapInstance.loadImage(i,(w,I)=>{w?y(w):(c.addImage(t,I,r),h())})}))})()}addImage(t,i,r){return this.zone.runOutsideAngular(()=>{this.mapInstance.addImage(t,i,r)})}removeImage(t){this.imageIdsToRemove.push(t)}addSource(t,i){return this.zone.runOutsideAngular(()=>{Object.keys(i).forEach(r=>void 0===i[r]&&delete i[r]),this.mapInstance.addSource(t,i)})}getSource(t){return this.mapInstance.getSource(t)}removeSource(t){this.zone.runOutsideAngular(()=>{this.findLayersBySourceId(t).forEach(i=>this.mapInstance.removeLayer(i.id)),this.mapInstance.removeSource(t)})}setAllLayerPaintProperty(t,i){return this.zone.runOutsideAngular(()=>{Object.keys(i).forEach(r=>{this.mapInstance.setPaintProperty(t,r,i[r])})})}setAllLayerLayoutProperty(t,i){return this.zone.runOutsideAngular(()=>{Object.keys(i).forEach(r=>{this.mapInstance.setLayoutProperty(t,r,i[r])})})}setLayerFilter(t,i){return this.zone.runOutsideAngular(()=>{this.mapInstance.setFilter(t,i)})}setLayerBefore(t,i){return this.zone.runOutsideAngular(()=>{this.mapInstance.moveLayer(t,i)})}setLayerZoomRange(t,i,r){return this.zone.runOutsideAngular(()=>{this.mapInstance.setLayerZoomRange(t,i||0,r||20)})}fitBounds(t,i){return this.zone.runOutsideAngular(()=>{this.mapInstance.fitBounds(t,i)})}fitScreenCoordinates(t,i,r){return this.zone.runOutsideAngular(()=>{this.mapInstance.fitScreenCoordinates(t[0],t[1],i,r)})}applyChanges(){this.zone.runOutsideAngular(()=>{this.removeMarkers(),this.removePopups(),this.removeImages()})}createMap(t){dn.assertNotInAngularZone(),Object.keys(t).forEach(r=>{void 0===t[r]&&delete t[r]}),this.mapInstance=new B_.Map(t),window&&/msie\s|trident\/|edge\//i.test(window.navigator.userAgent)&&this.mapInstance.setStyle(t.style),this.subscription.add(this.zone.onMicrotaskEmpty.subscribe(()=>this.applyChanges()))}removeMarkers(){for(const t of this.markersToRemove)t.remove();this.markersToRemove=[]}removePopups(){for(const t of this.popupsToRemove)t.remove();this.popupsToRemove=[]}removeImages(){for(const t of this.imageIdsToRemove)this.mapInstance.removeImage(t);this.imageIdsToRemove=[]}findLayersBySourceId(t){const i=this.mapInstance.getStyle().layers;return null==i?[]:i.filter(r=>"source"in r&&r.source===t)}hookEvents(t){this.mapInstance.on("load",i=>{this.mapLoaded.next(void 0),this.mapLoaded.complete(),this.zone.run(()=>{t.mapLoad.emit(i.target)})}),t.mapResize.observers.length&&this.mapInstance.on("resize",i=>this.zone.run(()=>{t.mapResize.emit(i)})),t.mapRemove.observers.length&&this.mapInstance.on("remove",i=>this.zone.run(()=>{t.mapRemove.emit(i)})),t.mapMouseDown.observers.length&&this.mapInstance.on("mousedown",i=>this.zone.run(()=>{t.mapMouseDown.emit(i)})),t.mapMouseUp.observers.length&&this.mapInstance.on("mouseup",i=>this.zone.run(()=>{t.mapMouseUp.emit(i)})),t.mapMouseMove.observers.length&&this.mapInstance.on("mousemove",i=>this.zone.run(()=>{t.mapMouseMove.emit(i)})),t.mapClick.observers.length&&this.mapInstance.on("click",i=>this.zone.run(()=>{t.mapClick.emit(i)})),t.mapDblClick.observers.length&&this.mapInstance.on("dblclick",i=>this.zone.run(()=>{t.mapDblClick.emit(i)})),t.mapMouseOver.observers.length&&this.mapInstance.on("mouseover",i=>this.zone.run(()=>{t.mapMouseOver.emit(i)})),t.mapMouseOut.observers.length&&this.mapInstance.on("mouseout",i=>this.zone.run(()=>{t.mapMouseOut.emit(i)})),t.mapContextMenu.observers.length&&this.mapInstance.on("contextmenu",i=>this.zone.run(()=>{t.mapContextMenu.emit(i)})),t.mapTouchStart.observers.length&&this.mapInstance.on("touchstart",i=>this.zone.run(()=>{t.mapTouchStart.emit(i)})),t.mapTouchEnd.observers.length&&this.mapInstance.on("touchend",i=>this.zone.run(()=>{t.mapTouchEnd.emit(i)})),t.mapTouchMove.observers.length&&this.mapInstance.on("touchmove",i=>this.zone.run(()=>{t.mapTouchMove.emit(i)})),t.mapTouchCancel.observers.length&&this.mapInstance.on("touchcancel",i=>this.zone.run(()=>{t.mapTouchCancel.emit(i)})),t.mapWheel.observers.length&&this.mapInstance.on("wheel",i=>this.zone.run(()=>{t.mapWheel.emit(i)})),t.moveStart.observers.length&&this.mapInstance.on("movestart",i=>this.zone.run(()=>t.moveStart.emit(i))),t.move.observers.length&&this.mapInstance.on("move",i=>this.zone.run(()=>t.move.emit(i))),t.moveEnd.observers.length&&this.mapInstance.on("moveend",i=>this.zone.run(()=>t.moveEnd.emit(i))),t.mapDragStart.observers.length&&this.mapInstance.on("dragstart",i=>this.zone.run(()=>{t.mapDragStart.emit(i)})),t.mapDrag.observers.length&&this.mapInstance.on("drag",i=>this.zone.run(()=>{t.mapDrag.emit(i)})),t.mapDragEnd.observers.length&&this.mapInstance.on("dragend",i=>this.zone.run(()=>{t.mapDragEnd.emit(i)})),t.zoomStart.observers.length&&this.mapInstance.on("zoomstart",i=>this.zone.run(()=>t.zoomStart.emit(i))),t.zoomEvt.observers.length&&this.mapInstance.on("zoom",i=>this.zone.run(()=>t.zoomEvt.emit(i))),t.zoomEnd.observers.length&&this.mapInstance.on("zoomend",i=>this.zone.run(()=>t.zoomEnd.emit(i))),t.rotateStart.observers.length&&this.mapInstance.on("rotatestart",i=>this.zone.run(()=>t.rotateStart.emit(i))),t.rotate.observers.length&&this.mapInstance.on("rotate",i=>this.zone.run(()=>t.rotate.emit(i))),t.rotateEnd.observers.length&&this.mapInstance.on("rotateend",i=>this.zone.run(()=>t.rotateEnd.emit(i))),t.pitchStart.observers.length&&this.mapInstance.on("pitchstart",i=>this.zone.run(()=>t.pitchStart.emit(i))),t.pitchEvt.observers.length&&this.mapInstance.on("pitch",i=>this.zone.run(()=>t.pitchEvt.emit(i))),t.pitchEnd.observers.length&&this.mapInstance.on("pitchend",i=>this.zone.run(()=>t.pitchEnd.emit(i))),t.boxZoomStart.observers.length&&this.mapInstance.on("boxzoomstart",i=>this.zone.run(()=>t.boxZoomStart.emit(i))),t.boxZoomEnd.observers.length&&this.mapInstance.on("boxzoomend",i=>this.zone.run(()=>t.boxZoomEnd.emit(i))),t.boxZoomCancel.observers.length&&this.mapInstance.on("boxzoomcancel",i=>this.zone.run(()=>t.boxZoomCancel.emit(i))),t.webGlContextLost.observers.length&&this.mapInstance.on("webglcontextlost",i=>this.zone.run(()=>t.webGlContextLost.emit(i))),t.webGlContextRestored.observers.length&&this.mapInstance.on("webglcontextrestored",i=>this.zone.run(()=>t.webGlContextRestored.emit(i))),t.render.observers.length&&this.mapInstance.on("render",i=>this.zone.run(()=>t.render.emit(i))),t.mapError.observers.length&&this.mapInstance.on("error",i=>this.zone.run(()=>{t.mapError.emit(i)})),t.data.observers.length&&this.mapInstance.on("data",i=>this.zone.run(()=>t.data.emit(i))),t.styleData.observers.length&&this.mapInstance.on("styledata",i=>this.zone.run(()=>t.styleData.emit(i))),t.sourceData.observers.length&&this.mapInstance.on("sourcedata",i=>this.zone.run(()=>t.sourceData.emit(i))),t.dataLoading.observers.length&&this.mapInstance.on("dataloading",i=>this.zone.run(()=>t.dataLoading.emit(i))),t.styleDataLoading.observers.length&&this.mapInstance.on("styledataloading",i=>this.zone.run(()=>t.styleDataLoading.emit(i))),t.sourceDataLoading.observers.length&&this.mapInstance.on("sourcedataloading",i=>this.zone.run(()=>t.sourceDataLoading.emit(i))),t.styleImageMissing.observers.length&&this.mapInstance.on("styleimagemissing",i=>this.zone.run(()=>t.styleImageMissing.emit(i))),t.idle.observers.length&&this.mapInstance.on("idle",i=>this.zone.run(()=>t.idle.emit(i)))}static#e=this.\u0275fac=function(i){return new(i||e)(nt(dn))};static#t=this.\u0275prov=ct({token:e,factory:e.\u0275fac})}return e})();class sz{constructor(n){this.container=n}onAdd(){return this.container}onRemove(){return this.container.parentNode.removeChild(this.container)}getDefaultPosition(){return"top-right"}}let O0=(()=>{class e{constructor(t){this.mapService=t}ngAfterContentInit(){this.content.nativeElement.childNodes.length&&(this.control=new sz(this.content.nativeElement),this.mapService.mapCreated$.subscribe(()=>{this.mapService.addControl(this.control,this.position)}))}ngOnDestroy(){this.mapService.mapInstance.hasControl(this.control)&&this.mapService.removeControl(this.control)}static#e=this.\u0275fac=function(i){return new(i||e)(xe(gc))};static#t=this.\u0275cmp=Nn({type:e,selectors:[["mgl-control"]],viewQuery:function(i,r){if(1&i&&Ha(P0,7),2&i){let c;io(c=ro())&&(r.content=c.first)}},inputs:{position:"position"},ngContentSelectors:R0,decls:3,vars:0,consts:[[1,"maplibregl-ctrl"],["content",""]],template:function(i,r){1&i&&(Nf(),tt(0,"div",0,1),zf(2),Ye())},encapsulation:2,changeDetection:0})}return e})(),bI=(()=>{class e{constructor(t,i){this.mapService=t,this.controlComponent=i}ngAfterContentInit(){this.mapService.mapCreated$.subscribe(()=>{if(this.controlComponent.control)throw new Error("Another control is already set for this control");const t={};void 0!==this.showCompass&&(t.showCompass=this.showCompass),void 0!==this.showZoom&&(t.showZoom=this.showZoom),null!=this.visualizePitch&&(t.visualizePitch=this.visualizePitch),this.controlComponent.control=new B_.NavigationControl(t),this.mapService.addControl(this.controlComponent.control,this.controlComponent.position)})}static#e=this.\u0275fac=function(i){return new(i||e)(xe(gc),xe(O0,1))};static#t=this.\u0275dir=xt({type:e,selectors:[["","mglNavigation",""]],inputs:{showCompass:"showCompass",showZoom:"showZoom",visualizePitch:"visualizePitch"}})}return e})(),xI=(()=>{class e{constructor(t,i){this.mapService=t,this.zone=i,this.type="geojson",this.updateFeatureData=new ci,this.sub=new mn,this.sourceAdded=!1,this.featureIdCounter=0}ngOnInit(){this.data||(this.data={type:"FeatureCollection",features:[]});const t=this.mapService.mapLoaded$.subscribe(()=>{this.init();const i=em(this.mapService.mapInstance,"styledata").pipe(Mo(()=>!this.mapService.mapInstance.getSource(this.id))).subscribe(()=>{this.init()});this.sub.add(i)});this.sub.add(t)}ngOnChanges(t){if(this.sourceAdded&&((t.maxzoom&&!t.maxzoom.isFirstChange()||t.attribution&&!t.attribution.isFirstChange()||t.buffer&&!t.buffer.isFirstChange()||t.tolerance&&!t.tolerance.isFirstChange()||t.cluster&&!t.cluster.isFirstChange()||t.clusterRadius&&!t.clusterRadius.isFirstChange()||t.clusterMaxZoom&&!t.clusterMaxZoom.isFirstChange()||t.clusterMinPoints&&!t.clusterMinPoints.isFirstChange()||t.clusterProperties&&!t.clusterProperties.isFirstChange()||t.lineMetrics&&!t.lineMetrics.isFirstChange()||t.generateId&&!t.generateId.isFirstChange()||t.promoteId&&!t.promoteId.isFirstChange()||t.filter&&!t.filter.isFirstChange())&&(this.ngOnDestroy(),this.ngOnInit()),t.data&&!t.data.isFirstChange())){const i=this.mapService.getSource(this.id);if(void 0===i)return;i.setData(this.data)}}ngOnDestroy(){this.sub.unsubscribe(),this.sourceAdded&&(this.mapService.removeSource(this.id),this.sourceAdded=!1)}getClusterExpansionZoom(t){var i=this;return _u(function*(){const r=i.mapService.getSource(i.id);return i.zone.run(_u(function*(){return new Promise((c,h)=>{r.getClusterExpansionZoom(t,(y,w)=>{y?h(y):c(w)})})}))})()}getClusterChildren(t){var i=this;return _u(function*(){const r=i.mapService.getSource(i.id);return i.zone.run(_u(function*(){return new Promise((c,h)=>{r.getClusterChildren(t,(y,w)=>{y?h(y):c(w)})})}))})()}getClusterLeaves(t,i,r){var c=this;return _u(function*(){const h=c.mapService.getSource(c.id);return c.zone.run(_u(function*(){return new Promise((y,w)=>{h.getClusterLeaves(t,i,r,(I,P)=>{I?w(I):y(P)})})}))})()}_addFeature(t){this.data.features.push(t),this.updateFeatureData.next(void 0)}_removeFeature(t){const i=this.data,r=i.features.indexOf(t);r>-1&&i.features.splice(r,1),this.updateFeatureData.next(void 0)}_getNewFeatureId(){return++this.featureIdCounter}init(){this.mapService.addSource(this.id,{type:"geojson",data:this.data,maxzoom:this.maxzoom,attribution:this.attribution,buffer:this.buffer,tolerance:this.tolerance,cluster:this.cluster,clusterRadius:this.clusterRadius,clusterMaxZoom:this.clusterMaxZoom,clusterMinPoints:this.clusterMinPoints,clusterProperties:this.clusterProperties,lineMetrics:this.lineMetrics,generateId:this.generateId,promoteId:this.promoteId,filter:this.filter});const i=this.updateFeatureData.pipe(yI(0)).subscribe(()=>{const r=this.mapService.getSource(this.id);void 0!==r&&r.setData(this.data)});this.sub.add(i),this.sourceAdded=!0}static#e=this.\u0275fac=function(i){return new(i||e)(xe(gc),xe(dn))};static#t=this.\u0275cmp=Nn({type:e,selectors:[["mgl-geojson-source"]],inputs:{id:"id",data:"data",maxzoom:"maxzoom",attribution:"attribution",buffer:"buffer",tolerance:"tolerance",cluster:"cluster",clusterRadius:"clusterRadius",clusterMaxZoom:"clusterMaxZoom",clusterMinPoints:"clusterMinPoints",clusterProperties:"clusterProperties",lineMetrics:"lineMetrics",generateId:"generateId",promoteId:"promoteId",filter:"filter"},features:[Bn],decls:0,vars:0,template:function(i,r){},encapsulation:2,changeDetection:0})}return e})(),oz=(()=>{class e{constructor(t){this.geoJSONSourceComponent=t,this.type="Feature"}ngOnInit(){this.id||(this.id=this.geoJSONSourceComponent._getNewFeatureId()),this.feature={type:this.type,geometry:this.geometry,properties:this.properties?this.properties:{}},this.feature.id=this.id,this.geoJSONSourceComponent._addFeature(this.feature)}ngOnDestroy(){this.geoJSONSourceComponent._removeFeature(this.feature)}updateCoordinates(t){this.feature.geometry.coordinates=t,this.geoJSONSourceComponent.updateFeatureData.next(void 0)}static#e=this.\u0275fac=function(i){return new(i||e)(xe(pn(()=>xI)))};static#t=this.\u0275cmp=Nn({type:e,selectors:[["mgl-feature"]],inputs:{id:"id",geometry:"geometry",properties:"properties"},decls:0,vars:0,template:function(i,r){},encapsulation:2,changeDetection:0})}return e})(),az=(()=>{class e{constructor(t){this.mapService=t,this.layerClick=new Ve,this.layerDblClick=new Ve,this.layerMouseDown=new Ve,this.layerMouseUp=new Ve,this.layerMouseEnter=new Ve,this.layerMouseLeave=new Ve,this.layerMouseMove=new Ve,this.layerMouseOver=new Ve,this.layerMouseOut=new Ve,this.layerContextMenu=new Ve,this.layerTouchStart=new Ve,this.layerTouchEnd=new Ve,this.layerTouchCancel=new Ve,this.layerAdded=!1}ngOnInit(){this.sub=this.mapService.mapLoaded$.pipe(lr(()=>em(this.mapService.mapInstance,"styledata").pipe(Ft(()=>!1),Mo(()=>!this.mapService.mapInstance.getLayer(this.id)),k0(!0)))).subscribe(t=>this.init(t))}ngOnChanges(t){this.layerAdded&&(t.paint&&!t.paint.isFirstChange()&&this.mapService.setAllLayerPaintProperty(this.id,t.paint.currentValue),t.layout&&!t.layout.isFirstChange()&&this.mapService.setAllLayerLayoutProperty(this.id,t.layout.currentValue),t.filter&&!t.filter.isFirstChange()&&this.mapService.setLayerFilter(this.id,t.filter.currentValue),t.before&&!t.before.isFirstChange()&&this.mapService.setLayerBefore(this.id,t.before.currentValue),(t.minzoom&&!t.minzoom.isFirstChange()||t.maxzoom&&!t.maxzoom.isFirstChange())&&this.mapService.setLayerZoomRange(this.id,this.minzoom,this.maxzoom))}ngOnDestroy(){this.layerAdded&&(this.mapService.removeLayer(this.id),void 0!==this.sourceIdAdded&&this.mapService.getSource(this.sourceIdAdded)&&this.mapService.removeSource(this.sourceIdAdded)),this.sub&&this.sub.unsubscribe()}init(t){const i={layerOptions:{id:this.id,type:this.type,source:this.source,metadata:this.metadata,"source-layer":this.sourceLayer,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this.layout,paint:this.paint},layerEvents:{layerClick:this.layerClick,layerDblClick:this.layerDblClick,layerMouseDown:this.layerMouseDown,layerMouseUp:this.layerMouseUp,layerMouseEnter:this.layerMouseEnter,layerMouseLeave:this.layerMouseLeave,layerMouseMove:this.layerMouseMove,layerMouseOver:this.layerMouseOver,layerMouseOut:this.layerMouseOut,layerContextMenu:this.layerContextMenu,layerTouchStart:this.layerTouchStart,layerTouchEnd:this.layerTouchEnd,layerTouchCancel:this.layerTouchCancel}};this.removeSource&&"string"!=typeof this.source&&void 0===this.mapService.getSource(this.id)&&(this.sourceIdAdded=this.id),this.mapService.addLayer(i,t,this.before),void 0!==this.sourceIdAdded&&void 0===this.mapService.getSource(this.sourceIdAdded)&&(this.sourceIdAdded=void 0),this.layerAdded=!0}static#e=this.\u0275fac=function(i){return new(i||e)(xe(gc))};static#t=this.\u0275cmp=Nn({type:e,selectors:[["mgl-layer"]],inputs:{id:"id",source:"source",type:"type",metadata:"metadata",sourceLayer:"sourceLayer",removeSource:"removeSource",filter:"filter",layout:"layout",paint:"paint",before:"before",minzoom:"minzoom",maxzoom:"maxzoom"},outputs:{layerClick:"layerClick",layerDblClick:"layerDblClick",layerMouseDown:"layerMouseDown",layerMouseUp:"layerMouseUp",layerMouseEnter:"layerMouseEnter",layerMouseLeave:"layerMouseLeave",layerMouseMove:"layerMouseMove",layerMouseOver:"layerMouseOver",layerMouseOut:"layerMouseOut",layerContextMenu:"layerContextMenu",layerTouchStart:"layerTouchStart",layerTouchEnd:"layerTouchEnd",layerTouchCancel:"layerTouchCancel"},features:[Bn],decls:0,vars:0,template:function(i,r){},encapsulation:2})}return e})(),wI=(()=>{class e{get mapInstance(){return this.mapService.mapInstance}constructor(t){this.mapService=t,this.movingMethod="flyTo",this.mapResize=new Ve,this.mapRemove=new Ve,this.mapMouseDown=new Ve,this.mapMouseUp=new Ve,this.mapMouseMove=new Ve,this.mapClick=new Ve,this.mapDblClick=new Ve,this.mapMouseOver=new Ve,this.mapMouseOut=new Ve,this.mapContextMenu=new Ve,this.mapTouchStart=new Ve,this.mapTouchEnd=new Ve,this.mapTouchMove=new Ve,this.mapTouchCancel=new Ve,this.mapWheel=new Ve,this.moveStart=new Ve,this.move=new Ve,this.moveEnd=new Ve,this.mapDragStart=new Ve,this.mapDrag=new Ve,this.mapDragEnd=new Ve,this.zoomStart=new Ve,this.zoomEvt=new Ve,this.zoomEnd=new Ve,this.rotateStart=new Ve,this.rotate=new Ve,this.rotateEnd=new Ve,this.pitchStart=new Ve,this.pitchEvt=new Ve,this.pitchEnd=new Ve,this.boxZoomStart=new Ve,this.boxZoomEnd=new Ve,this.boxZoomCancel=new Ve,this.webGlContextLost=new Ve,this.webGlContextRestored=new Ve,this.mapLoad=new Ve,this.idle=new Ve,this.render=new Ve,this.mapError=new Ve,this.data=new Ve,this.styleData=new Ve,this.sourceData=new Ve,this.dataLoading=new Ve,this.styleDataLoading=new Ve,this.sourceDataLoading=new Ve,this.styleImageMissing=new Ve}ngAfterViewInit(){this.mapService.setup({mapOptions:{collectResourceTiming:this.collectResourceTiming,container:this.mapContainer.nativeElement,crossSourceCollisions:this.crossSourceCollisions,fadeDuration:this.fadeDuration,minZoom:this.minZoom,maxZoom:this.maxZoom,minPitch:this.minPitch,maxPitch:this.maxPitch,style:this.style,hash:this.hash,interactive:this.interactive,bearingSnap:this.bearingSnap,pitchWithRotate:this.pitchWithRotate,clickTolerance:this.clickTolerance,attributionControl:this.attributionControl,logoPosition:this.logoPosition,failIfMajorPerformanceCaveat:this.failIfMajorPerformanceCaveat,preserveDrawingBuffer:this.preserveDrawingBuffer,refreshExpiredTiles:this.refreshExpiredTiles,maxBounds:this.maxBounds,scrollZoom:this.scrollZoom,boxZoom:this.boxZoom,dragRotate:this.dragRotate,dragPan:this.dragPan,keyboard:this.keyboard,doubleClickZoom:this.doubleClickZoom,touchPitch:this.touchPitch,touchZoomRotate:this.touchZoomRotate,trackResize:this.trackResize,center:this.center,zoom:this.zoom,bearing:this.bearing,pitch:this.pitch,renderWorldCopies:this.renderWorldCopies,maxTileCacheSize:this.maxTileCacheSize,localIdeographFontFamily:this.localIdeographFontFamily,transformRequest:this.transformRequest,bounds:this.bounds?this.bounds:this.fitBounds,fitBoundsOptions:this.fitBoundsOptions,antialias:this.antialias,locale:this.locale,cooperativeGestures:this.cooperativeGestures,terrain:this.terrain},mapEvents:this}),this.cursorStyle&&this.mapService.changeCanvasCursor(this.cursorStyle)}ngOnDestroy(){this.mapService.destroyMap()}ngOnChanges(t){var i=this;return _u(function*(){yield i.mapService.mapCreated$.toPromise(),t.cursorStyle&&!t.cursorStyle.isFirstChange()&&i.mapService.changeCanvasCursor(t.cursorStyle.currentValue),t.minZoom&&!t.minZoom.isFirstChange()&&i.mapService.updateMinZoom(t.minZoom.currentValue),t.maxZoom&&!t.maxZoom.isFirstChange()&&i.mapService.updateMaxZoom(t.maxZoom.currentValue),t.minPitch&&!t.minPitch.isFirstChange()&&i.mapService.updateMinPitch(t.minPitch.currentValue),t.maxPitch&&!t.maxPitch.isFirstChange()&&i.mapService.updateMaxPitch(t.maxPitch.currentValue),t.renderWorldCopies&&!t.renderWorldCopies.isFirstChange()&&i.mapService.updateRenderWorldCopies(t.renderWorldCopies.currentValue),t.scrollZoom&&!t.scrollZoom.isFirstChange()&&i.mapService.updateScrollZoom(t.scrollZoom.currentValue),t.dragRotate&&!t.dragRotate.isFirstChange()&&i.mapService.updateDragRotate(t.dragRotate.currentValue),t.touchPitch&&!t.touchPitch.isFirstChange()&&i.mapService.updateTouchPitch(t.touchPitch.currentValue),t.touchZoomRotate&&!t.touchZoomRotate.isFirstChange()&&i.mapService.updateTouchZoomRotate(t.touchZoomRotate.currentValue),t.doubleClickZoom&&!t.doubleClickZoom.isFirstChange()&&i.mapService.updateDoubleClickZoom(t.doubleClickZoom.currentValue),t.keyboard&&!t.keyboard.isFirstChange()&&i.mapService.updateKeyboard(t.keyboard.currentValue),t.dragPan&&!t.dragPan.isFirstChange()&&i.mapService.updateDragPan(t.dragPan.currentValue),t.boxZoom&&!t.boxZoom.isFirstChange()&&i.mapService.updateBoxZoom(t.boxZoom.currentValue),t.style&&!t.style.isFirstChange()&&i.mapService.updateStyle(t.style.currentValue),t.maxBounds&&!t.maxBounds.isFirstChange()&&i.mapService.updateMaxBounds(t.maxBounds.currentValue),t.fitBounds&&t.fitBounds.currentValue&&!t.fitBounds.isFirstChange()&&i.mapService.fitBounds(t.fitBounds.currentValue,i.fitBoundsOptions),t.fitScreenCoordinates&&t.fitScreenCoordinates.currentValue&&((i.center||i.zoom||i.pitch||i.fitBounds)&&t.fitScreenCoordinates.isFirstChange()&&console.warn("[ngx-maplibre-gl] center / zoom / pitch / fitBounds inputs are being overridden by fitScreenCoordinates input"),i.mapService.fitScreenCoordinates(t.fitScreenCoordinates.currentValue,i.bearing?i.bearing[0]:0,i.movingOptions)),!i.centerWithPanTo||!t.center||t.center.isFirstChange()||t.zoom||t.bearing||t.pitch?(t.center&&!t.center.isFirstChange()||t.zoom&&!t.zoom.isFirstChange()||t.bearing&&!t.bearing.isFirstChange()&&!t.fitScreenCoordinates||t.pitch&&!t.pitch.isFirstChange())&&i.mapService.move(i.movingMethod,i.movingOptions,t.zoom&&i.zoom?i.zoom[0]:void 0,t.center?i.center:void 0,t.bearing&&i.bearing?i.bearing[0]:void 0,t.pitch&&i.pitch?i.pitch[0]:void 0):i.mapService.panTo(i.center,i.panToOptions),t.terrain&&!t.terrain.isFirstChange()&&i.mapService.updateTerrain(t.terrain.currentValue)})()}static#e=this.\u0275fac=function(i){return new(i||e)(xe(gc))};static#t=this.\u0275cmp=Nn({type:e,selectors:[["mgl-map"]],viewQuery:function(i,r){if(1&i&&Ha(ez,7),2&i){let c;io(c=ro())&&(r.mapContainer=c.first)}},inputs:{collectResourceTiming:"collectResourceTiming",crossSourceCollisions:"crossSourceCollisions",customMapboxApiUrl:"customMapboxApiUrl",fadeDuration:"fadeDuration",hash:"hash",refreshExpiredTiles:"refreshExpiredTiles",failIfMajorPerformanceCaveat:"failIfMajorPerformanceCaveat",bearingSnap:"bearingSnap",interactive:"interactive",pitchWithRotate:"pitchWithRotate",clickTolerance:"clickTolerance",attributionControl:"attributionControl",logoPosition:"logoPosition",maxTileCacheSize:"maxTileCacheSize",localIdeographFontFamily:"localIdeographFontFamily",preserveDrawingBuffer:"preserveDrawingBuffer",trackResize:"trackResize",transformRequest:"transformRequest",bounds:"bounds",antialias:"antialias",locale:"locale",cooperativeGestures:"cooperativeGestures",minZoom:"minZoom",maxZoom:"maxZoom",minPitch:"minPitch",maxPitch:"maxPitch",scrollZoom:"scrollZoom",dragRotate:"dragRotate",touchPitch:"touchPitch",touchZoomRotate:"touchZoomRotate",doubleClickZoom:"doubleClickZoom",keyboard:"keyboard",dragPan:"dragPan",boxZoom:"boxZoom",style:"style",center:"center",maxBounds:"maxBounds",zoom:"zoom",bearing:"bearing",pitch:"pitch",fitBoundsOptions:"fitBoundsOptions",renderWorldCopies:"renderWorldCopies",movingMethod:"movingMethod",movingOptions:"movingOptions",terrain:"terrain",fitBounds:"fitBounds",fitScreenCoordinates:"fitScreenCoordinates",centerWithPanTo:"centerWithPanTo",panToOptions:"panToOptions",cursorStyle:"cursorStyle"},outputs:{mapResize:"mapResize",mapRemove:"mapRemove",mapMouseDown:"mapMouseDown",mapMouseUp:"mapMouseUp",mapMouseMove:"mapMouseMove",mapClick:"mapClick",mapDblClick:"mapDblClick",mapMouseOver:"mapMouseOver",mapMouseOut:"mapMouseOut",mapContextMenu:"mapContextMenu",mapTouchStart:"mapTouchStart",mapTouchEnd:"mapTouchEnd",mapTouchMove:"mapTouchMove",mapTouchCancel:"mapTouchCancel",mapWheel:"mapWheel",moveStart:"moveStart",move:"move",moveEnd:"moveEnd",mapDragStart:"mapDragStart",mapDrag:"mapDrag",mapDragEnd:"mapDragEnd",zoomStart:"zoomStart",zoomEvt:"zoomEvt",zoomEnd:"zoomEnd",rotateStart:"rotateStart",rotate:"rotate",rotateEnd:"rotateEnd",pitchStart:"pitchStart",pitchEvt:"pitchEvt",pitchEnd:"pitchEnd",boxZoomStart:"boxZoomStart",boxZoomEnd:"boxZoomEnd",boxZoomCancel:"boxZoomCancel",webGlContextLost:"webGlContextLost",webGlContextRestored:"webGlContextRestored",mapLoad:"mapLoad",idle:"idle",render:"render",mapError:"mapError",data:"data",styleData:"styleData",sourceData:"sourceData",dataLoading:"dataLoading",styleDataLoading:"styleDataLoading",sourceDataLoading:"sourceDataLoading",styleImageMissing:"styleImageMissing"},features:[$n([gc]),Bn],decls:2,vars:0,consts:[["container",""]],template:function(i,r){1&i&&sn(0,"div",null,0)},styles:["[_nghost-%COMP%]{display:block}div[_ngcontent-%COMP%]{height:100%;width:100%}"],changeDetection:0})}return e})(),CI=(()=>{class e{constructor(t){this.mapService=t,this.markerDragStart=new Ve,this.markerDragEnd=new Ve,this.markerDrag=new Ve}ngOnInit(){if(this.feature&&this.lngLat)throw new Error("feature and lngLat input are mutually exclusive")}ngOnChanges(t){t.lngLat&&!t.lngLat.isFirstChange()&&this.markerInstance.setLngLat(this.lngLat),t.feature&&!t.feature.isFirstChange()&&this.markerInstance.setLngLat(this.feature.geometry.coordinates),t.draggable&&!t.draggable.isFirstChange()&&this.markerInstance.setDraggable(!!this.draggable),t.popupShown&&!t.popupShown.isFirstChange()&&(t.popupShown.currentValue?this.markerInstance.getPopup().addTo(this.mapService.mapInstance):this.markerInstance.getPopup().remove()),t.pitchAlignment&&!t.pitchAlignment.isFirstChange()&&this.markerInstance.setPitchAlignment(t.pitchAlignment.currentValue),t.rotationAlignment&&!t.rotationAlignment.isFirstChange()&&this.markerInstance.setRotationAlignment(t.rotationAlignment.currentValue)}ngAfterViewInit(){this.mapService.mapCreated$.subscribe(()=>{this.markerInstance=this.mapService.addMarker({markersOptions:{offset:this.offset,anchor:this.anchor,pitchAlignment:this.pitchAlignment,rotationAlignment:this.rotationAlignment,draggable:!!this.draggable,element:this.content.nativeElement,feature:this.feature,lngLat:this.lngLat,clickTolerance:this.clickTolerance},markersEvents:{markerDragStart:this.markerDragStart,markerDrag:this.markerDrag,markerDragEnd:this.markerDragEnd}})})}ngOnDestroy(){this.mapService.removeMarker(this.markerInstance),this.markerInstance=void 0}togglePopup(){this.markerInstance.togglePopup()}updateCoordinates(t){this.markerInstance.setLngLat(t)}static#e=this.\u0275fac=function(i){return new(i||e)(xe(gc))};static#t=this.\u0275cmp=Nn({type:e,selectors:[["mgl-marker"]],viewQuery:function(i,r){if(1&i&&Ha(P0,7),2&i){let c;io(c=ro())&&(r.content=c.first)}},inputs:{offset:"offset",anchor:"anchor",clickTolerance:"clickTolerance",feature:"feature",lngLat:"lngLat",draggable:"draggable",popupShown:"popupShown",className:"className",pitchAlignment:"pitchAlignment",rotationAlignment:"rotationAlignment"},outputs:{markerDragStart:"markerDragStart",markerDragEnd:"markerDragEnd",markerDrag:"markerDrag"},features:[Bn],ngContentSelectors:R0,decls:3,vars:2,consts:[["content",""]],template:function(i,r){1&i&&(Nf(),tt(0,"div",null,0),zf(2),Ye()),2&i&&db(r.className)},encapsulation:2,changeDetection:0})}return e})(),lz=(()=>{class e{constructor(t){this.mapService=t,this.popupClose=new Ve,this.popupOpen=new Ve}ngOnInit(){if(this.lngLat&&this.marker||this.feature&&this.lngLat||this.feature&&this.marker)throw new Error("marker, lngLat, feature input are mutually exclusive")}ngOnChanges(t){if(t.feature&&!t.feature.isFirstChange()){const i=t.lngLat?this.lngLat:this.feature.geometry.coordinates;this.mapService.removePopupFromMap(this.popupInstance,!0);const r=this.createPopup();this.mapService.addPopupToMap(r,i,this.popupInstance.isOpen()),this.popupInstance=r}if(t.lngLat&&!t.lngLat.isFirstChange()&&this.popupInstance.setLngLat(this.lngLat),t.marker&&!t.marker.isFirstChange()){const i=t.marker.previousValue;i.markerInstance&&this.mapService.removePopupFromMarker(i.markerInstance),this.marker&&this.marker.markerInstance&&this.popupInstance&&this.mapService.addPopupToMarker(this.marker.markerInstance,this.popupInstance)}t.offset&&!t.offset.isFirstChange()&&this.popupInstance&&this.popupInstance.setOffset(this.offset)}ngAfterViewInit(){this.popupInstance=this.createPopup(),this.addPopup(this.popupInstance)}ngOnDestroy(){this.popupInstance&&(this.lngLat||this.feature?this.mapService.removePopupFromMap(this.popupInstance):this.marker&&this.marker.markerInstance&&this.mapService.removePopupFromMarker(this.marker.markerInstance)),this.popupInstance=void 0}createPopup(){return this.mapService.createPopup({popupOptions:{closeButton:this.closeButton,closeOnClick:this.closeOnClick,closeOnMove:this.closeOnMove,focusAfterOpen:this.focusAfterOpen,anchor:this.anchor,offset:this.offset,className:this.className,maxWidth:this.maxWidth},popupEvents:{popupOpen:this.popupOpen,popupClose:this.popupClose}},this.content.nativeElement)}addPopup(t){this.mapService.mapCreated$.subscribe(()=>{if(this.lngLat||this.feature)this.mapService.addPopupToMap(t,this.lngLat?this.lngLat:this.feature.geometry.coordinates);else{if(!this.marker||!this.marker.markerInstance)throw new Error("mgl-popup need either lngLat/marker/feature to be set");this.mapService.addPopupToMarker(this.marker.markerInstance,t)}})}static#e=this.\u0275fac=function(i){return new(i||e)(xe(gc))};static#t=this.\u0275cmp=Nn({type:e,selectors:[["mgl-popup"]],viewQuery:function(i,r){if(1&i&&Ha(P0,7),2&i){let c;io(c=ro())&&(r.content=c.first)}},inputs:{closeButton:"closeButton",closeOnClick:"closeOnClick",closeOnMove:"closeOnMove",focusAfterOpen:"focusAfterOpen",anchor:"anchor",className:"className",maxWidth:"maxWidth",feature:"feature",lngLat:"lngLat",marker:"marker",offset:"offset"},outputs:{popupClose:"popupClose",popupOpen:"popupOpen"},features:[Bn],ngContentSelectors:R0,decls:3,vars:0,consts:[["content",""]],template:function(i,r){1&i&&(Nf(),tt(0,"div",null,0),zf(2),Ye())},encapsulation:2,changeDetection:0})}return e})(),EI=(()=>{class e{constructor(t){this.mapService=t,this.type="raster-dem",this.sourceAdded=!1,this.sub=new mn}ngOnInit(){const t=this.mapService.mapLoaded$.subscribe(()=>{this.init();const i=em(this.mapService.mapInstance,"styledata").pipe(Mo(()=>!this.mapService.mapInstance.getSource(this.id))).subscribe(()=>{this.init()});this.sub.add(i)});this.sub.add(t)}ngOnChanges(t){this.sourceAdded&&(t.url&&!t.url.isFirstChange()||t.tiles&&!t.tiles.isFirstChange()||t.bounds&&!t.bounds.isFirstChange()||t.minzoom&&!t.minzoom.isFirstChange()||t.maxzoom&&!t.maxzoom.isFirstChange()||t.tileSize&&!t.tileSize.isFirstChange()||t.attribution&&!t.attribution.isFirstChange()||t.encoding&&!t.encoding.isFirstChange())&&(this.ngOnDestroy(),this.ngOnInit())}ngOnDestroy(){this.sub.unsubscribe(),this.sourceAdded&&(this.mapService.removeSource(this.id),this.sourceAdded=!1)}init(){this.mapService.addSource(this.id,{type:this.type,url:this.url,tiles:this.tiles,bounds:this.bounds,minzoom:this.minzoom,maxzoom:this.maxzoom,tileSize:this.tileSize,attribution:this.attribution,encoding:this.encoding}),this.sourceAdded=!0}static#e=this.\u0275fac=function(i){return new(i||e)(xe(gc))};static#t=this.\u0275cmp=Nn({type:e,selectors:[["mgl-raster-dem-source"]],inputs:{id:"id",url:"url",tiles:"tiles",bounds:"bounds",minzoom:"minzoom",maxzoom:"maxzoom",tileSize:"tileSize",attribution:"attribution",encoding:"encoding"},features:[Bn],decls:0,vars:0,template:function(i,r){},encapsulation:2,changeDetection:0})}return e})(),cz=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=Ni({type:e});static#n=this.\u0275inj=Fi({imports:[v0]})}return e})();const uz=new Xe("cdk-dir-doc",{providedIn:"root",factory:function dz(){return Ke(ps)}}),hz=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;let F0,fz=(()=>{class e{constructor(t){this.value="ltr",this.change=new Ve,t&&(this.value=function pz(e){const n=e?.toLowerCase()||"";return"auto"===n&&typeof navigator<"u"&&navigator?.language?hz.test(navigator.language)?"rtl":"ltr":"rtl"===n?"rtl":"ltr"}((t.body?t.body.dir:null)||(t.documentElement?t.documentElement.dir:null)||"ltr"))}ngOnDestroy(){this.change.complete()}static#e=this.\u0275fac=function(i){return new(i||e)(nt(uz,8))};static#t=this.\u0275prov=ct({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),DI=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=Ni({type:e});static#n=this.\u0275inj=Fi({})}return e})();function sp(e){return null!=e&&"false"!=`${e}`}function Za(e,n=0){return function mz(e){return!isNaN(parseFloat(e))&&!isNaN(Number(e))}(e)?Number(e):n}function II(e){return Array.isArray(e)?e:[e]}function SI(e){return e instanceof Mr?e.nativeElement:e}try{F0=typeof Intl<"u"&&Intl.v8BreakIterator}catch{F0=!1}let rm,im=(()=>{class e{constructor(t){this._platformId=t,this.isBrowser=this._platformId?function BL(e){return e===$D}(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!F0)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}static#e=this.\u0275fac=function(i){return new(i||e)(nt(du))};static#t=this.\u0275prov=ct({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function $_(e){return function gz(){if(null==rm&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>rm=!0}))}finally{rm=rm||!1}return rm}()?e:!!e.capture}const{isArray:Dz}=Array,{getPrototypeOf:Iz,prototype:Sz,keys:Mz}=Object;function TI(e){if(1===e.length){const n=e[0];if(Dz(n))return{args:n,keys:null};if(function Tz(e){return e&&"object"==typeof e&&Iz(e)===Sz}(n)){const t=Mz(n);return{args:t.map(i=>n[i]),keys:t}}}return{args:e,keys:null}}function AI(e,n){return e.reduce((t,i,r)=>(t[i]=n[r],t),{})}function G_(...e){const n=ar(e),t=Ki(e),{args:i,keys:r}=TI(e);if(0===i.length)return Qn([],n);const c=new Ln(function Az(e,n,t=jr){return i=>{kI(n,()=>{const{length:r}=e,c=new Array(r);let h=r,y=r;for(let w=0;w<r;w++)kI(n,()=>{const I=Qn(e[w],n);let P=!1;I.subscribe(_n(i,z=>{c[w]=z,P||(P=!0,y--),y||i.next(t(c.slice()))},()=>{--h||i.complete()}))},i)},i)}}(i,n,r?h=>AI(r,h):jr));return t?c.pipe(A0(t)):c}function kI(e,n,t){e?At(t,e,n):n()}function PI(e){return Vn((n,t)=>{Ee(e).subscribe(_n(t,()=>t.complete(),Ao)),!t.closed&&n.subscribe(t)})}const RI=new Set;let Td,Pz=(()=>{class e{constructor(t,i){this._platform=t,this._nonce=i,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):Oz}matchMedia(t){return(this._platform.WEBKIT||this._platform.BLINK)&&function Rz(e,n){if(!RI.has(e))try{Td||(Td=document.createElement("style"),n&&(Td.nonce=n),Td.setAttribute("type","text/css"),document.head.appendChild(Td)),Td.sheet&&(Td.sheet.insertRule(`@media ${e} {body{ }}`,0),RI.add(e))}catch(t){console.error(t)}}(t,this._nonce),this._matchMedia(t)}static#e=this.\u0275fac=function(i){return new(i||e)(nt(im),nt(Ev,8))};static#t=this.\u0275prov=ct({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function Oz(e){return{matches:"all"===e||""===e,media:e,addListener:()=>{},removeListener:()=>{}}}let Fz=(()=>{class e{constructor(t,i){this._mediaMatcher=t,this._zone=i,this._queries=new Map,this._destroySubject=new ci}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(t){return OI(II(t)).some(r=>this._registerQuery(r).mql.matches)}observe(t){let c=G_(OI(II(t)).map(h=>this._registerQuery(h).observable));return c=j_(c.pipe(Sd(1)),c.pipe(function kz(e){return Mo((n,t)=>e<=t)}(1),yI(0))),c.pipe(Ft(h=>{const y={matches:!1,breakpoints:{}};return h.forEach(({matches:w,query:I})=>{y.matches=y.matches||w,y.breakpoints[I]=w}),y}))}_registerQuery(t){if(this._queries.has(t))return this._queries.get(t);const i=this._mediaMatcher.matchMedia(t),c={observable:new Ln(h=>{const y=w=>this._zone.run(()=>h.next(w));return i.addListener(y),()=>{i.removeListener(y)}}).pipe(k0(i),Ft(({matches:h})=>({query:t,matches:h})),PI(this._destroySubject)),mql:i};return this._queries.set(t,c),c}static#e=this.\u0275fac=function(i){return new(i||e)(nt(Pz),nt(dn))};static#t=this.\u0275prov=ct({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function OI(e){return e.map(n=>n.split(",")).reduce((n,t)=>n.concat(t)).map(n=>n.trim())}const zI="cdk-high-contrast-black-on-white",BI="cdk-high-contrast-white-on-black",N0="cdk-high-contrast-active";let qz=(()=>{class e{constructor(t,i){this._platform=t,this._document=i,this._breakpointSubscription=Ke(Fz).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return 0;const t=this._document.createElement("div");t.style.backgroundColor="rgb(1,2,3)",t.style.position="absolute",this._document.body.appendChild(t);const i=this._document.defaultView||window,r=i&&i.getComputedStyle?i.getComputedStyle(t):null,c=(r&&r.backgroundColor||"").replace(/ /g,"");switch(t.remove(),c){case"rgb(0,0,0)":case"rgb(45,50,54)":case"rgb(32,32,32)":return 2;case"rgb(255,255,255)":case"rgb(255,250,239)":return 1}return 0}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){const t=this._document.body.classList;t.remove(N0,zI,BI),this._hasCheckedHighContrastMode=!0;const i=this.getHighContrastMode();1===i?t.add(N0,zI):2===i&&t.add(N0,BI)}}static#e=this.\u0275fac=function(i){return new(i||e)(nt(im),nt(ps))};static#t=this.\u0275prov=ct({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const Wz=new Xe("mat-sanity-checks",{providedIn:"root",factory:function Zz(){return!0}});let z0=(()=>{class e{constructor(t,i,r){this._sanityChecks=i,this._document=r,this._hasDoneGlobalChecks=!1,t._applyBodyHighContrastModeCssClasses(),this._hasDoneGlobalChecks||(this._hasDoneGlobalChecks=!0)}_checkIsEnabled(t){return!function vz(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}()&&("boolean"==typeof this._sanityChecks?this._sanityChecks:!!this._sanityChecks[t])}static#e=this.\u0275fac=function(i){return new(i||e)(nt(qz),nt(Wz,8),nt(ps))};static#t=this.\u0275mod=Ni({type:e});static#n=this.\u0275inj=Fi({imports:[DI,DI]})}return e})();function Xz(e,n){return class extends e{get color(){return this._color}set color(t){const i=t||this.defaultColor;i!==this._color&&(this._color&&this._elementRef.nativeElement.classList.remove(`mat-${this._color}`),i&&this._elementRef.nativeElement.classList.add(`mat-${i}`),this._color=i)}constructor(...t){super(...t),this.defaultColor=n,this.color=n}}}function Kz(e){return class extends e{get disableRipple(){return this._disableRipple}set disableRipple(n){this._disableRipple=sp(n)}constructor(...n){super(...n),this._disableRipple=!1}}}class Jz{constructor(n,t,i,r=!1){this._renderer=n,this.element=t,this.config=i,this._animationForciblyDisabledThroughCss=r,this.state=3}fadeOut(){this._renderer.fadeOutRipple(this)}}const jI=$_({passive:!0,capture:!0});class Qz{constructor(){this._events=new Map,this._delegateEventHandler=n=>{const t=function yz(e){return e.composedPath?e.composedPath()[0]:e.target}(n);t&&this._events.get(n.type)?.forEach((i,r)=>{(r===t||r.contains(t))&&i.forEach(c=>c.handleEvent(n))})}}addHandler(n,t,i,r){const c=this._events.get(t);if(c){const h=c.get(i);h?h.add(r):c.set(i,new Set([r]))}else this._events.set(t,new Map([[i,new Set([r])]])),n.runOutsideAngular(()=>{document.addEventListener(t,this._delegateEventHandler,jI)})}removeHandler(n,t,i){const r=this._events.get(n);if(!r)return;const c=r.get(t);c&&(c.delete(i),0===c.size&&r.delete(t),0===r.size&&(this._events.delete(n),document.removeEventListener(n,this._delegateEventHandler,jI)))}}const $I={enterDuration:225,exitDuration:150},HI=$_({passive:!0,capture:!0}),GI=["mousedown","touchstart"],qI=["mouseup","mouseleave","touchend","touchcancel"];class q_{static#e=this._eventManager=new Qz;constructor(n,t,i,r){this._target=n,this._ngZone=t,this._platform=r,this._isPointerDown=!1,this._activeRipples=new Map,this._pointerUpEventsRegistered=!1,r.isBrowser&&(this._containerElement=SI(i))}fadeInRipple(n,t,i={}){const r=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),c={...$I,...i.animation};i.centered&&(n=r.left+r.width/2,t=r.top+r.height/2);const h=i.radius||function tB(e,n,t){const i=Math.max(Math.abs(e-t.left),Math.abs(e-t.right)),r=Math.max(Math.abs(n-t.top),Math.abs(n-t.bottom));return Math.sqrt(i*i+r*r)}(n,t,r),y=n-r.left,w=t-r.top,I=c.enterDuration,P=document.createElement("div");P.classList.add("mat-ripple-element"),P.style.left=y-h+"px",P.style.top=w-h+"px",P.style.height=2*h+"px",P.style.width=2*h+"px",null!=i.color&&(P.style.backgroundColor=i.color),P.style.transitionDuration=`${I}ms`,this._containerElement.appendChild(P);const z=window.getComputedStyle(P),re=z.transitionDuration,fe="none"===z.transitionProperty||"0s"===re||"0s, 0s"===re||0===r.width&&0===r.height,ge=new Jz(this,P,i,fe);P.style.transform="scale3d(1, 1, 1)",ge.state=0,i.persistent||(this._mostRecentTransientRipple=ge);let Ie=null;return!fe&&(I||c.exitDuration)&&this._ngZone.runOutsideAngular(()=>{const Fe=()=>this._finishRippleTransition(ge),Ce=()=>this._destroyRipple(ge);P.addEventListener("transitionend",Fe),P.addEventListener("transitioncancel",Ce),Ie={onTransitionEnd:Fe,onTransitionCancel:Ce}}),this._activeRipples.set(ge,Ie),(fe||!I)&&this._finishRippleTransition(ge),ge}fadeOutRipple(n){if(2===n.state||3===n.state)return;const t=n.element,i={...$I,...n.config.animation};t.style.transitionDuration=`${i.exitDuration}ms`,t.style.opacity="0",n.state=2,(n._animationForciblyDisabledThroughCss||!i.exitDuration)&&this._finishRippleTransition(n)}fadeOutAll(){this._getActiveRipples().forEach(n=>n.fadeOut())}fadeOutAllNonPersistent(){this._getActiveRipples().forEach(n=>{n.config.persistent||n.fadeOut()})}setupTriggerEvents(n){const t=SI(n);!this._platform.isBrowser||!t||t===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=t,GI.forEach(i=>{q_._eventManager.addHandler(this._ngZone,i,t,this)}))}handleEvent(n){"mousedown"===n.type?this._onMousedown(n):"touchstart"===n.type?this._onTouchStart(n):this._onPointerUp(),this._pointerUpEventsRegistered||(this._ngZone.runOutsideAngular(()=>{qI.forEach(t=>{this._triggerElement.addEventListener(t,this,HI)})}),this._pointerUpEventsRegistered=!0)}_finishRippleTransition(n){0===n.state?this._startFadeOutTransition(n):2===n.state&&this._destroyRipple(n)}_startFadeOutTransition(n){const t=n===this._mostRecentTransientRipple,{persistent:i}=n.config;n.state=1,!i&&(!t||!this._isPointerDown)&&n.fadeOut()}_destroyRipple(n){const t=this._activeRipples.get(n)??null;this._activeRipples.delete(n),this._activeRipples.size||(this._containerRect=null),n===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),n.state=3,null!==t&&(n.element.removeEventListener("transitionend",t.onTransitionEnd),n.element.removeEventListener("transitioncancel",t.onTransitionCancel)),n.element.remove()}_onMousedown(n){const t=function $z(e){return 0===e.buttons||0===e.offsetX&&0===e.offsetY}(n),i=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+800;!this._target.rippleDisabled&&!t&&!i&&(this._isPointerDown=!0,this.fadeInRipple(n.clientX,n.clientY,this._target.rippleConfig))}_onTouchStart(n){if(!this._target.rippleDisabled&&!function Hz(e){const n=e.touches&&e.touches[0]||e.changedTouches&&e.changedTouches[0];return!(!n||-1!==n.identifier||null!=n.radiusX&&1!==n.radiusX||null!=n.radiusY&&1!==n.radiusY)}(n)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;const t=n.changedTouches;if(t)for(let i=0;i<t.length;i++)this.fadeInRipple(t[i].clientX,t[i].clientY,this._target.rippleConfig)}}_onPointerUp(){this._isPointerDown&&(this._isPointerDown=!1,this._getActiveRipples().forEach(n=>{!n.config.persistent&&(1===n.state||n.config.terminateOnPointerUp&&0===n.state)&&n.fadeOut()}))}_getActiveRipples(){return Array.from(this._activeRipples.keys())}_removeTriggerEvents(){const n=this._triggerElement;n&&(GI.forEach(t=>q_._eventManager.removeHandler(t,n,this)),this._pointerUpEventsRegistered&&qI.forEach(t=>n.removeEventListener(t,this,HI)))}}const ZI=new Xe("mat-ripple-global-options");let WI=(()=>{class e{get disabled(){return this._disabled}set disabled(t){t&&this.fadeOutAllNonPersistent(),this._disabled=t,this._setupTriggerEventsIfEnabled()}get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(t){this._trigger=t,this._setupTriggerEventsIfEnabled()}constructor(t,i,r,c,h){this._elementRef=t,this._animationMode=h,this.radius=0,this._disabled=!1,this._isInitialized=!1,this._globalOptions=c||{},this._rippleRenderer=new q_(this,i,t,r)}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}fadeOutAllNonPersistent(){this._rippleRenderer.fadeOutAllNonPersistent()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:{...this._globalOptions.animation,..."NoopAnimations"===this._animationMode?{enterDuration:0,exitDuration:0}:{},...this.animation},terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(t,i=0,r){return"number"==typeof t?this._rippleRenderer.fadeInRipple(t,i,{...this.rippleConfig,...r}):this._rippleRenderer.fadeInRipple(0,0,{...this.rippleConfig,...t})}static#e=this.\u0275fac=function(i){return new(i||e)(xe(Mr),xe(dn),xe(im),xe(ZI,8),xe(lw,8))};static#t=this.\u0275dir=xt({type:e,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(i,r){2&i&&Wh("mat-ripple-unbounded",r.unbounded)},inputs:{color:["matRippleColor","color"],unbounded:["matRippleUnbounded","unbounded"],centered:["matRippleCentered","centered"],radius:["matRippleRadius","radius"],animation:["matRippleAnimation","animation"],disabled:["matRippleDisabled","disabled"],trigger:["matRippleTrigger","trigger"]},exportAs:["matRipple"]})}return e})(),nB=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=Ni({type:e});static#n=this.\u0275inj=Fi({imports:[z0,z0]})}return e})(),XI=(()=>{class e{constructor(t,i){this._renderer=t,this._elementRef=i,this.onChange=r=>{},this.onTouched=()=>{}}setProperty(t,i){this._renderer.setProperty(this._elementRef.nativeElement,t,i)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}static#e=this.\u0275fac=function(i){return new(i||e)(xe(lc),xe(Mr))};static#t=this.\u0275dir=xt({type:e})}return e})(),Ad=(()=>{class e extends XI{static#e=this.\u0275fac=function(){let t;return function(r){return(t||(t=cr(e)))(r||e)}}();static#t=this.\u0275dir=xt({type:e,features:[Rn]})}return e})();const aa=new Xe("NgValueAccessor"),sB={provide:aa,useExisting:pn(()=>om),multi:!0},aB=new Xe("CompositionEventMode");let om=(()=>{class e extends XI{constructor(t,i,r){super(t,i),this._compositionMode=r,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function oB(){const e=mu()?mu().getUserAgent():"";return/android (\d+)/.test(e.toLowerCase())}())}writeValue(t){this.setProperty("value",t??"")}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}static#e=this.\u0275fac=function(i){return new(i||e)(xe(lc),xe(Mr),xe(aB,8))};static#t=this.\u0275dir=xt({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,r){1&i&&yi("input",function(h){return r._handleInput(h.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(h){return r._compositionEnd(h.target.value)})},features:[$n([sB]),Rn]})}return e})();const fs=new Xe("NgValidators"),bu=new Xe("NgAsyncValidators");function oS(e){return null!=e}function aS(e){return Lf(e)?Qn(e):e}function lS(e){let n={};return e.forEach(t=>{n=null!=t?{...n,...t}:n}),0===Object.keys(n).length?null:n}function cS(e,n){return n.map(t=>t(e))}function uS(e){return e.map(n=>function cB(e){return!e.validate}(n)?n:t=>n.validate(t))}function B0(e){return null!=e?function dS(e){if(!e)return null;const n=e.filter(oS);return 0==n.length?null:function(t){return lS(cS(t,n))}}(uS(e)):null}function V0(e){return null!=e?function hS(e){if(!e)return null;const n=e.filter(oS);return 0==n.length?null:function(t){return function iB(...e){const n=Ki(e),{args:t,keys:i}=TI(e),r=new Ln(c=>{const{length:h}=t;if(!h)return void c.complete();const y=new Array(h);let w=h,I=h;for(let P=0;P<h;P++){let z=!1;Ee(t[P]).subscribe(_n(c,G=>{z||(z=!0,I--),y[P]=G},()=>w--,void 0,()=>{(!w||!z)&&(I||c.next(i?AI(i,y):y),c.complete())}))}});return n?r.pipe(A0(n)):r}(cS(t,n).map(aS)).pipe(Ft(lS))}}(uS(e)):null}function pS(e,n){return null===e?[n]:Array.isArray(e)?[...e,n]:[e,n]}function fS(e){return e._rawValidators}function mS(e){return e._rawAsyncValidators}function U0(e){return e?Array.isArray(e)?e:[e]:[]}function W_(e,n){return Array.isArray(e)?e.includes(n):e===n}function gS(e,n){const t=U0(n);return U0(e).forEach(r=>{W_(t,r)||t.push(r)}),t}function _S(e,n){return U0(n).filter(t=>!W_(e,t))}class yS{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(n){this._rawValidators=n||[],this._composedValidatorFn=B0(this._rawValidators)}_setAsyncValidators(n){this._rawAsyncValidators=n||[],this._composedAsyncValidatorFn=V0(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(n){this._onDestroyCallbacks.push(n)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(n=>n()),this._onDestroyCallbacks=[]}reset(n=void 0){this.control&&this.control.reset(n)}hasError(n,t){return!!this.control&&this.control.hasError(n,t)}getError(n,t){return this.control?this.control.getError(n,t):null}}class Rs extends yS{get formDirective(){return null}get path(){return null}}class xu extends yS{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class vS{constructor(n){this._cd=n}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let j0=(()=>{class e extends vS{constructor(t){super(t)}static#e=this.\u0275fac=function(i){return new(i||e)(xe(xu,2))};static#t=this.\u0275dir=xt({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,r){2&i&&Wh("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)},features:[Rn]})}return e})(),bS=(()=>{class e extends vS{constructor(t){super(t)}static#e=this.\u0275fac=function(i){return new(i||e)(xe(Rs,10))};static#t=this.\u0275dir=xt({type:e,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(i,r){2&i&&Wh("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)("ng-submitted",r.isSubmitted)},features:[Rn]})}return e})();const am="VALID",K_="INVALID",ap="PENDING",lm="DISABLED";function G0(e){return(Y_(e)?e.validators:e)||null}function q0(e,n){return(Y_(n)?n.asyncValidators:e)||null}function Y_(e){return null!=e&&!Array.isArray(e)&&"object"==typeof e}function wS(e,n,t){const i=e.controls;if(!(n?Object.keys(i):i).length)throw new Pe(1e3,"");if(!i[t])throw new Pe(1001,"")}function CS(e,n,t){e._forEachChild((i,r)=>{if(void 0===t[r])throw new Pe(1002,"")})}class J_{constructor(n,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(n),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(n){this._rawValidators=this._composedValidatorFn=n}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(n){this._rawAsyncValidators=this._composedAsyncValidatorFn=n}get parent(){return this._parent}get valid(){return this.status===am}get invalid(){return this.status===K_}get pending(){return this.status==ap}get disabled(){return this.status===lm}get enabled(){return this.status!==lm}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(n){this._assignValidators(n)}setAsyncValidators(n){this._assignAsyncValidators(n)}addValidators(n){this.setValidators(gS(n,this._rawValidators))}addAsyncValidators(n){this.setAsyncValidators(gS(n,this._rawAsyncValidators))}removeValidators(n){this.setValidators(_S(n,this._rawValidators))}removeAsyncValidators(n){this.setAsyncValidators(_S(n,this._rawAsyncValidators))}hasValidator(n){return W_(this._rawValidators,n)}hasAsyncValidator(n){return W_(this._rawAsyncValidators,n)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(n={}){this.touched=!0,this._parent&&!n.onlySelf&&this._parent.markAsTouched(n)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(n=>n.markAllAsTouched())}markAsUntouched(n={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!n.onlySelf&&this._parent._updateTouched(n)}markAsDirty(n={}){this.pristine=!1,this._parent&&!n.onlySelf&&this._parent.markAsDirty(n)}markAsPristine(n={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!n.onlySelf&&this._parent._updatePristine(n)}markAsPending(n={}){this.status=ap,!1!==n.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!n.onlySelf&&this._parent.markAsPending(n)}disable(n={}){const t=this._parentMarkedDirty(n.onlySelf);this.status=lm,this.errors=null,this._forEachChild(i=>{i.disable({...n,onlySelf:!0})}),this._updateValue(),!1!==n.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...n,skipPristineCheck:t}),this._onDisabledChange.forEach(i=>i(!0))}enable(n={}){const t=this._parentMarkedDirty(n.onlySelf);this.status=am,this._forEachChild(i=>{i.enable({...n,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:n.emitEvent}),this._updateAncestors({...n,skipPristineCheck:t}),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(n){this._parent&&!n.onlySelf&&(this._parent.updateValueAndValidity(n),n.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(n){this._parent=n}getRawValue(){return this.value}updateValueAndValidity(n={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===am||this.status===ap)&&this._runAsyncValidator(n.emitEvent)),!1!==n.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!n.onlySelf&&this._parent.updateValueAndValidity(n)}_updateTreeValidity(n={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(n)),this.updateValueAndValidity({onlySelf:!0,emitEvent:n.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?lm:am}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(n){if(this.asyncValidator){this.status=ap,this._hasOwnPendingAsyncValidator=!0;const t=aS(this.asyncValidator(this));this._asyncValidationSubscription=t.subscribe(i=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(i,{emitEvent:n})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(n,t={}){this.errors=n,this._updateControlsErrors(!1!==t.emitEvent)}get(n){let t=n;return null==t||(Array.isArray(t)||(t=t.split(".")),0===t.length)?null:t.reduce((i,r)=>i&&i._find(r),this)}getError(n,t){const i=t?this.get(t):this;return i&&i.errors?i.errors[n]:null}hasError(n,t){return!!this.getError(n,t)}get root(){let n=this;for(;n._parent;)n=n._parent;return n}_updateControlsErrors(n){this.status=this._calculateStatus(),n&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(n)}_initObservables(){this.valueChanges=new Ve,this.statusChanges=new Ve}_calculateStatus(){return this._allControlsDisabled()?lm:this.errors?K_:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(ap)?ap:this._anyControlsHaveStatus(K_)?K_:am}_anyControlsHaveStatus(n){return this._anyControls(t=>t.status===n)}_anyControlsDirty(){return this._anyControls(n=>n.dirty)}_anyControlsTouched(){return this._anyControls(n=>n.touched)}_updatePristine(n={}){this.pristine=!this._anyControlsDirty(),this._parent&&!n.onlySelf&&this._parent._updatePristine(n)}_updateTouched(n={}){this.touched=this._anyControlsTouched(),this._parent&&!n.onlySelf&&this._parent._updateTouched(n)}_registerOnCollectionChange(n){this._onCollectionChange=n}_setUpdateStrategy(n){Y_(n)&&null!=n.updateOn&&(this._updateOn=n.updateOn)}_parentMarkedDirty(n){return!n&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(n){return null}_assignValidators(n){this._rawValidators=Array.isArray(n)?n.slice():n,this._composedValidatorFn=function pB(e){return Array.isArray(e)?B0(e):e||null}(this._rawValidators)}_assignAsyncValidators(n){this._rawAsyncValidators=Array.isArray(n)?n.slice():n,this._composedAsyncValidatorFn=function fB(e){return Array.isArray(e)?V0(e):e||null}(this._rawAsyncValidators)}}class cm extends J_{constructor(n,t,i){super(G0(t),q0(i,t)),this.controls=n,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(n,t){return this.controls[n]?this.controls[n]:(this.controls[n]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(n,t,i={}){this.registerControl(n,t),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}removeControl(n,t={}){this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),delete this.controls[n],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(n,t,i={}){this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),delete this.controls[n],t&&this.registerControl(n,t),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}contains(n){return this.controls.hasOwnProperty(n)&&this.controls[n].enabled}setValue(n,t={}){CS(this,0,n),Object.keys(n).forEach(i=>{wS(this,!0,i),this.controls[i].setValue(n[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(n,t={}){null!=n&&(Object.keys(n).forEach(i=>{const r=this.controls[i];r&&r.patchValue(n[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(n={},t={}){this._forEachChild((i,r)=>{i.reset(n[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this._reduceChildren({},(n,t,i)=>(n[i]=t.getRawValue(),n))}_syncPendingControls(){let n=this._reduceChildren(!1,(t,i)=>!!i._syncPendingControls()||t);return n&&this.updateValueAndValidity({onlySelf:!0}),n}_forEachChild(n){Object.keys(this.controls).forEach(t=>{const i=this.controls[t];i&&n(i,t)})}_setUpControls(){this._forEachChild(n=>{n.setParent(this),n._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(n){for(const[t,i]of Object.entries(this.controls))if(this.contains(t)&&n(i))return!0;return!1}_reduceValue(){return this._reduceChildren({},(t,i,r)=>((i.enabled||this.disabled)&&(t[r]=i.value),t))}_reduceChildren(n,t){let i=n;return this._forEachChild((r,c)=>{i=t(i,r,c)}),i}_allControlsDisabled(){for(const n of Object.keys(this.controls))if(this.controls[n].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(n){return this.controls.hasOwnProperty(n)?this.controls[n]:null}}class ES extends cm{}const kd=new Xe("CallSetDisabledState",{providedIn:"root",factory:()=>um}),um="always";function Q_(e,n){return[...n.path,e]}function dm(e,n,t=um){Z0(e,n),n.valueAccessor.writeValue(e.value),(e.disabled||"always"===t)&&n.valueAccessor.setDisabledState?.(e.disabled),function gB(e,n){n.valueAccessor.registerOnChange(t=>{e._pendingValue=t,e._pendingChange=!0,e._pendingDirty=!0,"change"===e.updateOn&&DS(e,n)})}(e,n),function yB(e,n){const t=(i,r)=>{n.valueAccessor.writeValue(i),r&&n.viewToModelUpdate(i)};e.registerOnChange(t),n._registerOnDestroy(()=>{e._unregisterOnChange(t)})}(e,n),function _B(e,n){n.valueAccessor.registerOnTouched(()=>{e._pendingTouched=!0,"blur"===e.updateOn&&e._pendingChange&&DS(e,n),"submit"!==e.updateOn&&e.markAsTouched()})}(e,n),function mB(e,n){if(n.valueAccessor.setDisabledState){const t=i=>{n.valueAccessor.setDisabledState(i)};e.registerOnDisabledChange(t),n._registerOnDestroy(()=>{e._unregisterOnDisabledChange(t)})}}(e,n)}function ey(e,n,t=!0){const i=()=>{};n.valueAccessor&&(n.valueAccessor.registerOnChange(i),n.valueAccessor.registerOnTouched(i)),ny(e,n),e&&(n._invokeOnDestroyCallbacks(),e._registerOnCollectionChange(()=>{}))}function ty(e,n){e.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(n)})}function Z0(e,n){const t=fS(e);null!==n.validator?e.setValidators(pS(t,n.validator)):"function"==typeof t&&e.setValidators([t]);const i=mS(e);null!==n.asyncValidator?e.setAsyncValidators(pS(i,n.asyncValidator)):"function"==typeof i&&e.setAsyncValidators([i]);const r=()=>e.updateValueAndValidity();ty(n._rawValidators,r),ty(n._rawAsyncValidators,r)}function ny(e,n){let t=!1;if(null!==e){if(null!==n.validator){const r=fS(e);if(Array.isArray(r)&&r.length>0){const c=r.filter(h=>h!==n.validator);c.length!==r.length&&(t=!0,e.setValidators(c))}}if(null!==n.asyncValidator){const r=mS(e);if(Array.isArray(r)&&r.length>0){const c=r.filter(h=>h!==n.asyncValidator);c.length!==r.length&&(t=!0,e.setAsyncValidators(c))}}}const i=()=>{};return ty(n._rawValidators,i),ty(n._rawAsyncValidators,i),t}function DS(e,n){e._pendingDirty&&e.markAsDirty(),e.setValue(e._pendingValue,{emitModelToViewChange:!1}),n.viewToModelUpdate(e._pendingValue),e._pendingChange=!1}function X0(e,n){if(!e.hasOwnProperty("model"))return!1;const t=e.model;return!!t.isFirstChange()||!Object.is(n,t.currentValue)}function K0(e,n){if(!n)return null;let t,i,r;return Array.isArray(n),n.forEach(c=>{c.constructor===om?t=c:function xB(e){return Object.getPrototypeOf(e.constructor)===Ad}(c)?i=c:r=c}),r||i||t||null}function MS(e,n){const t=e.indexOf(n);t>-1&&e.splice(t,1)}function TS(e){return"object"==typeof e&&null!==e&&2===Object.keys(e).length&&"value"in e&&"disabled"in e}const lp=class extends J_{constructor(n=null,t,i){super(G0(t),q0(i,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(n),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Y_(t)&&(t.nonNullable||t.initialValueIsDefault)&&(this.defaultValue=TS(n)?n.value:n)}setValue(n,t={}){this.value=this._pendingValue=n,this._onChange.length&&!1!==t.emitModelToViewChange&&this._onChange.forEach(i=>i(this.value,!1!==t.emitViewToModelChange)),this.updateValueAndValidity(t)}patchValue(n,t={}){this.setValue(n,t)}reset(n=this.defaultValue,t={}){this._applyFormState(n),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(n){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(n){this._onChange.push(n)}_unregisterOnChange(n){MS(this._onChange,n)}registerOnDisabledChange(n){this._onDisabledChange.push(n)}_unregisterOnDisabledChange(n){MS(this._onDisabledChange,n)}_forEachChild(n){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(n){TS(n)?(this.value=this._pendingValue=n.value,n.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=n}},IB={provide:xu,useExisting:pn(()=>J0)},PS=(()=>Promise.resolve())();let J0=(()=>{class e extends xu{constructor(t,i,r,c,h,y){super(),this._changeDetectorRef=h,this.callSetDisabledState=y,this.control=new lp,this._registered=!1,this.name="",this.update=new Ve,this._parent=t,this._setValidators(i),this._setAsyncValidators(r),this.valueAccessor=K0(0,c)}ngOnChanges(t){if(this._checkForErrors(),!this._registered||"name"in t){if(this._registered&&(this._checkName(),this.formDirective)){const i=t.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in t&&this._updateDisabled(t),X0(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){dm(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(t){PS.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(t){const i=t.isDisabled.currentValue,r=0!==i&&tp(i);PS.then(()=>{r&&!this.control.disabled?this.control.disable():!r&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(t){return this._parent?Q_(t,this._parent):[t]}static#e=this.\u0275fac=function(i){return new(i||e)(xe(Rs,9),xe(fs,10),xe(bu,10),xe(aa,10),xe(fu,8),xe(kd,8))};static#t=this.\u0275dir=xt({type:e,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[$n([IB]),Rn,Bn]})}return e})(),RS=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275dir=xt({type:e,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]})}return e})(),FS=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=Ni({type:e});static#n=this.\u0275inj=Fi({})}return e})();const Q0=new Xe("NgModelWithFormControlWarning"),PB={provide:Rs,useExisting:pn(()=>iy)};let iy=(()=>{class e extends Rs{constructor(t,i,r){super(),this.callSetDisabledState=r,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new Ve,this._setValidators(t),this._setAsyncValidators(i)}ngOnChanges(t){this._checkFormPresent(),t.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(ny(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(t){const i=this.form.get(t.path);return dm(i,t,this.callSetDisabledState),i.updateValueAndValidity({emitEvent:!1}),this.directives.push(t),i}getControl(t){return this.form.get(t.path)}removeControl(t){ey(t.control||null,t,!1),function wB(e,n){const t=e.indexOf(n);t>-1&&e.splice(t,1)}(this.directives,t)}addFormGroup(t){this._setUpFormContainer(t)}removeFormGroup(t){this._cleanUpFormContainer(t)}getFormGroup(t){return this.form.get(t.path)}addFormArray(t){this._setUpFormContainer(t)}removeFormArray(t){this._cleanUpFormContainer(t)}getFormArray(t){return this.form.get(t.path)}updateModel(t,i){this.form.get(t.path).setValue(i)}onSubmit(t){return this.submitted=!0,function SS(e,n){e._syncPendingControls(),n.forEach(t=>{const i=t.control;"submit"===i.updateOn&&i._pendingChange&&(t.viewToModelUpdate(i._pendingValue),i._pendingChange=!1)})}(this.form,this.directives),this.ngSubmit.emit(t),"dialog"===t?.target?.method}onReset(){this.resetForm()}resetForm(t=void 0){this.form.reset(t),this.submitted=!1}_updateDomValue(){this.directives.forEach(t=>{const i=t.control,r=this.form.get(t.path);i!==r&&(ey(i||null,t),(e=>e instanceof lp)(r)&&(dm(r,t,this.callSetDisabledState),t.control=r))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(t){const i=this.form.get(t.path);(function IS(e,n){Z0(e,n)})(i,t),i.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(t){if(this.form){const i=this.form.get(t.path);i&&function vB(e,n){return ny(e,n)}(i,t)&&i.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){Z0(this.form,this),this._oldForm&&ny(this._oldForm,this)}_checkFormPresent(){}static#e=this.\u0275fac=function(i){return new(i||e)(xe(fs,10),xe(bu,10),xe(kd,8))};static#t=this.\u0275dir=xt({type:e,selectors:[["","formGroup",""]],hostBindings:function(i,r){1&i&&yi("submit",function(h){return r.onSubmit(h)})("reset",function(){return r.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[$n([PB]),Rn,Bn]})}return e})();const FB={provide:xu,useExisting:pn(()=>nx)};let nx=(()=>{class e extends xu{set isDisabled(t){}static#e=this._ngModelWarningSentOnce=!1;constructor(t,i,r,c,h){super(),this._ngModelWarningConfig=h,this._added=!1,this.name=null,this.update=new Ve,this._ngModelWarningSent=!1,this._parent=t,this._setValidators(i),this._setAsyncValidators(r),this.valueAccessor=K0(0,c)}ngOnChanges(t){this._added||this._setUpControl(),X0(t,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}get path(){return Q_(null==this.name?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}static#t=this.\u0275fac=function(i){return new(i||e)(xe(Rs,13),xe(fs,10),xe(bu,10),xe(aa,10),xe(Q0,8))};static#n=this.\u0275dir=xt({type:e,selectors:[["","formControlName",""]],inputs:{name:["formControlName","name"],isDisabled:["disabled","isDisabled"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},features:[$n([FB]),Rn,Bn]})}return e})(),YS=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=Ni({type:e});static#n=this.\u0275inj=Fi({imports:[FS]})}return e})();class JS extends J_{constructor(n,t,i){super(G0(t),q0(i,t)),this.controls=n,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(n){return this.controls[this._adjustIndex(n)]}push(n,t={}){this.controls.push(n),this._registerControl(n),this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}insert(n,t,i={}){this.controls.splice(n,0,t),this._registerControl(t),this.updateValueAndValidity({emitEvent:i.emitEvent})}removeAt(n,t={}){let i=this._adjustIndex(n);i<0&&(i=0),this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),this.controls.splice(i,1),this.updateValueAndValidity({emitEvent:t.emitEvent})}setControl(n,t,i={}){let r=this._adjustIndex(n);r<0&&(r=0),this.controls[r]&&this.controls[r]._registerOnCollectionChange(()=>{}),this.controls.splice(r,1),t&&(this.controls.splice(r,0,t),this._registerControl(t)),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(n,t={}){CS(this,0,n),n.forEach((i,r)=>{wS(this,!1,r),this.at(r).setValue(i,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(n,t={}){null!=n&&(n.forEach((i,r)=>{this.at(r)&&this.at(r).patchValue(i,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(n=[],t={}){this._forEachChild((i,r)=>{i.reset(n[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this.controls.map(n=>n.getRawValue())}clear(n={}){this.controls.length<1||(this._forEachChild(t=>t._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:n.emitEvent}))}_adjustIndex(n){return n<0?n+this.length:n}_syncPendingControls(){let n=this.controls.reduce((t,i)=>!!i._syncPendingControls()||t,!1);return n&&this.updateValueAndValidity({onlySelf:!0}),n}_forEachChild(n){this.controls.forEach((t,i)=>{n(t,i)})}_updateValue(){this.value=this.controls.filter(n=>n.enabled||this.disabled).map(n=>n.value)}_anyControls(n){return this.controls.some(t=>t.enabled&&n(t))}_setUpControls(){this._forEachChild(n=>this._registerControl(n))}_allControlsDisabled(){for(const n of this.controls)if(n.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(n){n.setParent(this),n._registerOnCollectionChange(this._onCollectionChange)}_find(n){return this.at(n)??null}}function QS(e){return!!e&&(void 0!==e.asyncValidators||void 0!==e.validators||void 0!==e.updateOn)}let KB=(()=>{class e{constructor(){this.useNonNullable=!1}get nonNullable(){const t=new e;return t.useNonNullable=!0,t}group(t,i=null){const r=this._reduceControls(t);let c={};return QS(i)?c=i:null!==i&&(c.validators=i.validator,c.asyncValidators=i.asyncValidator),new cm(r,c)}record(t,i=null){const r=this._reduceControls(t);return new ES(r,i)}control(t,i,r){let c={};return this.useNonNullable?(QS(i)?c=i:(c.validators=i,c.asyncValidators=r),new lp(t,{...c,nonNullable:!0})):new lp(t,i,r)}array(t,i,r){const c=t.map(h=>this._createControl(h));return new JS(c,i,r)}_reduceControls(t){const i={};return Object.keys(t).forEach(r=>{i[r]=this._createControl(t[r])}),i}_createControl(t){return t instanceof lp||t instanceof J_?t:Array.isArray(t)?this.control(t[0],t.length>1?t[1]:null,t.length>2?t[2]:null):this.control(t)}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=ct({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),YB=(()=>{class e{static withConfig(t){return{ngModule:e,providers:[{provide:kd,useValue:t.callSetDisabledState??um}]}}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=Ni({type:e});static#n=this.\u0275inj=Fi({imports:[YS]})}return e})(),JB=(()=>{class e{static withConfig(t){return{ngModule:e,providers:[{provide:Q0,useValue:t.warnOnNgModelWithFormControl??"always"},{provide:kd,useValue:t.callSetDisabledState??um}]}}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=Ni({type:e});static#n=this.\u0275inj=Fi({imports:[YS]})}return e})();const QB=["knob"],eV=["valueIndicatorContainer"];function tV(e,n){if(1&e&&(tt(0,"div",4,5)(2,"div",6)(3,"span",7),Rt(4),Ye()()()),2&e){const t=En();He(4),ra(t.valueIndicatorText)}}const nV=["trackActive"];function iV(e,n){if(1&e&&sn(0,"div"),2&e){const t=n.$implicit,i=n.index,r=En(3);db(0===t?"mdc-slider__tick-mark--active":"mdc-slider__tick-mark--inactive"),ub("transform",r._calcTickMarkTransform(i))}}function rV(e,n){if(1&e&&(vd(0),An(1,iV,1,4,"div",11),bd()),2&e){const t=En(2);He(1),mt("ngForOf",t._tickMarks)}}function sV(e,n){if(1&e&&(tt(0,"div",8,9),An(2,rV,2,1,"ng-container",10),Ye()),2&e){const t=En();He(2),mt("ngIf",t._cachedWidth)}}function oV(e,n){if(1&e&&sn(0,"mat-slider-visual-thumb",7),2&e){const t=En();mt("discrete",t.discrete)("thumbPosition",1)("valueIndicatorText",t.startValueIndicatorText)}}const aV=["*"],ry=new Xe("_MatSlider"),eM=new Xe("_MatSliderThumb"),tM=new Xe("_MatSliderRangeThumb"),nM=new Xe("_MatSliderVisualThumb");let lV=(()=>{class e{constructor(t,i,r,c){this._cdr=t,this._ngZone=i,this._slider=c,this._isHovered=!1,this._isActive=!1,this._isValueIndicatorVisible=!1,this._onPointerMove=h=>{if(this._sliderInput._isFocused)return;const y=this._hostElement.getBoundingClientRect(),w=this._slider._isCursorOnSliderThumb(h,y);this._isHovered=w,w?this._showHoverRipple():this._hideRipple(this._hoverRippleRef)},this._onMouseLeave=()=>{this._isHovered=!1,this._hideRipple(this._hoverRippleRef)},this._onFocus=()=>{this._hideRipple(this._hoverRippleRef),this._showFocusRipple(),this._hostElement.classList.add("mdc-slider__thumb--focused")},this._onBlur=()=>{this._isActive||this._hideRipple(this._focusRippleRef),this._isHovered&&this._showHoverRipple(),this._hostElement.classList.remove("mdc-slider__thumb--focused")},this._onDragStart=h=>{0===h.button&&(this._isActive=!0,this._showActiveRipple())},this._onDragEnd=()=>{this._isActive=!1,this._hideRipple(this._activeRippleRef),this._sliderInput._isFocused||this._hideRipple(this._focusRippleRef)},this._hostElement=r.nativeElement}ngAfterViewInit(){this._ripple.radius=24,this._sliderInput=this._slider._getInput(this.thumbPosition),this._sliderInputEl=this._sliderInput._hostElement;const t=this._sliderInputEl;this._ngZone.runOutsideAngular(()=>{t.addEventListener("pointermove",this._onPointerMove),t.addEventListener("pointerdown",this._onDragStart),t.addEventListener("pointerup",this._onDragEnd),t.addEventListener("pointerleave",this._onMouseLeave),t.addEventListener("focus",this._onFocus),t.addEventListener("blur",this._onBlur)})}ngOnDestroy(){const t=this._sliderInputEl;t.removeEventListener("pointermove",this._onPointerMove),t.removeEventListener("pointerdown",this._onDragStart),t.removeEventListener("pointerup",this._onDragEnd),t.removeEventListener("pointerleave",this._onMouseLeave),t.removeEventListener("focus",this._onFocus),t.removeEventListener("blur",this._onBlur)}_showHoverRipple(){this._isShowingRipple(this._hoverRippleRef)||(this._hoverRippleRef=this._showRipple({enterDuration:0,exitDuration:0}),this._hoverRippleRef?.element.classList.add("mat-mdc-slider-hover-ripple"))}_showFocusRipple(){this._isShowingRipple(this._focusRippleRef)||(this._focusRippleRef=this._showRipple({enterDuration:0,exitDuration:0},!0),this._focusRippleRef?.element.classList.add("mat-mdc-slider-focus-ripple"))}_showActiveRipple(){this._isShowingRipple(this._activeRippleRef)||(this._activeRippleRef=this._showRipple({enterDuration:225,exitDuration:400}),this._activeRippleRef?.element.classList.add("mat-mdc-slider-active-ripple"))}_isShowingRipple(t){return 0===t?.state||1===t?.state}_showRipple(t,i){if(!this._slider.disabled&&(this._showValueIndicator(),this._slider._isRange&&this._slider._getThumb(1===this.thumbPosition?2:1)._showValueIndicator(),!this._slider._globalRippleOptions?.disabled||i))return this._ripple.launch({animation:this._slider._noopAnimations?{enterDuration:0,exitDuration:0}:t,centered:!0,persistent:!0})}_hideRipple(t){if(t?.fadeOut(),this._isShowingAnyRipple())return;this._slider._isRange||this._hideValueIndicator();const i=this._getSibling();i._isShowingAnyRipple()||(this._hideValueIndicator(),i._hideValueIndicator())}_showValueIndicator(){this._hostElement.classList.add("mdc-slider__thumb--with-indicator")}_hideValueIndicator(){this._hostElement.classList.remove("mdc-slider__thumb--with-indicator")}_getSibling(){return this._slider._getThumb(1===this.thumbPosition?2:1)}_getValueIndicatorContainer(){return this._valueIndicatorContainer?.nativeElement}_getKnob(){return this._knob.nativeElement}_isShowingAnyRipple(){return this._isShowingRipple(this._hoverRippleRef)||this._isShowingRipple(this._focusRippleRef)||this._isShowingRipple(this._activeRippleRef)}static#e=this.\u0275fac=function(i){return new(i||e)(xe(fu),xe(dn),xe(Mr),xe(ry))};static#t=this.\u0275cmp=Nn({type:e,selectors:[["mat-slider-visual-thumb"]],viewQuery:function(i,r){if(1&i&&(Ha(WI,5),Ha(QB,5),Ha(eV,5)),2&i){let c;io(c=ro())&&(r._ripple=c.first),io(c=ro())&&(r._knob=c.first),io(c=ro())&&(r._valueIndicatorContainer=c.first)}},hostAttrs:[1,"mdc-slider__thumb","mat-mdc-slider-visual-thumb"],inputs:{discrete:"discrete",thumbPosition:"thumbPosition",valueIndicatorText:"valueIndicatorText"},features:[$n([{provide:nM,useExisting:e}])],decls:4,vars:2,consts:[["class","mdc-slider__value-indicator-container",4,"ngIf"],[1,"mdc-slider__thumb-knob"],["knob",""],["matRipple","",1,"mat-mdc-focus-indicator",3,"matRippleDisabled"],[1,"mdc-slider__value-indicator-container"],["valueIndicatorContainer",""],[1,"mdc-slider__value-indicator"],[1,"mdc-slider__value-indicator-text"]],template:function(i,r){1&i&&(An(0,tV,5,1,"div",0),sn(1,"div",1,2)(3,"div",3)),2&i&&(mt("ngIf",r.discrete),He(3),mt("matRippleDisabled",!0))},dependencies:[Id,WI],styles:[".mat-mdc-slider-visual-thumb .mat-ripple{height:100%;width:100%}.mat-mdc-slider .mdc-slider__tick-marks{justify-content:start}.mat-mdc-slider .mdc-slider__tick-marks .mdc-slider__tick-mark--active,.mat-mdc-slider .mdc-slider__tick-marks .mdc-slider__tick-mark--inactive{position:absolute;left:2px}"],encapsulation:2,changeDetection:0})}return e})();const cV=Xz(Kz(class{constructor(e){this._elementRef=e}}),"primary");let uV=(()=>{class e extends cV{get disabled(){return this._disabled}set disabled(t){this._disabled=sp(t);const i=this._getInput(2),r=this._getInput(1);i&&(i.disabled=this._disabled),r&&(r.disabled=this._disabled)}get discrete(){return this._discrete}set discrete(t){this._discrete=sp(t),this._updateValueIndicatorUIs()}get showTickMarks(){return this._showTickMarks}set showTickMarks(t){this._showTickMarks=sp(t)}get min(){return this._min}set min(t){const i=Za(t,this._min);this._min!==i&&this._updateMin(i)}_updateMin(t){const i=this._min;this._min=t,this._isRange?this._updateMinRange({old:i,new:t}):this._updateMinNonRange(t),this._onMinMaxOrStepChange()}_updateMinRange(t){const i=this._getInput(2),r=this._getInput(1),c=i.value,h=r.value;r.min=t.new,i.min=Math.max(t.new,r.value),r.max=Math.min(i.max,i.value),r._updateWidthInactive(),i._updateWidthInactive(),t.new<t.old?this._onTranslateXChangeBySideEffect(i,r):this._onTranslateXChangeBySideEffect(r,i),c!==i.value&&this._onValueChange(i),h!==r.value&&this._onValueChange(r)}_updateMinNonRange(t){const i=this._getInput(2);if(i){const r=i.value;i.min=t,i._updateThumbUIByValue(),this._updateTrackUI(i),r!==i.value&&this._onValueChange(i)}}get max(){return this._max}set max(t){const i=Za(t,this._max);this._max!==i&&this._updateMax(i)}_updateMax(t){const i=this._max;this._max=t,this._isRange?this._updateMaxRange({old:i,new:t}):this._updateMaxNonRange(t),this._onMinMaxOrStepChange()}_updateMaxRange(t){const i=this._getInput(2),r=this._getInput(1),c=i.value,h=r.value;i.max=t.new,r.max=Math.min(t.new,i.value),i.min=r.value,i._updateWidthInactive(),r._updateWidthInactive(),t.new>t.old?this._onTranslateXChangeBySideEffect(r,i):this._onTranslateXChangeBySideEffect(i,r),c!==i.value&&this._onValueChange(i),h!==r.value&&this._onValueChange(r)}_updateMaxNonRange(t){const i=this._getInput(2);if(i){const r=i.value;i.max=t,i._updateThumbUIByValue(),this._updateTrackUI(i),r!==i.value&&this._onValueChange(i)}}get step(){return this._step}set step(t){const i=Za(t,this._step);this._step!==i&&this._updateStep(i)}_updateStep(t){this._step=t,this._isRange?this._updateStepRange():this._updateStepNonRange(),this._onMinMaxOrStepChange()}_updateStepRange(){const t=this._getInput(2),i=this._getInput(1),r=t.value,c=i.value,h=i.value;t.min=this._min,i.max=this._max,t.step=this._step,i.step=this._step,this._platform.SAFARI&&(t.value=t.value,i.value=i.value),t.min=Math.max(this._min,i.value),i.max=Math.min(this._max,t.value),i._updateWidthInactive(),t._updateWidthInactive(),t.value<h?this._onTranslateXChangeBySideEffect(i,t):this._onTranslateXChangeBySideEffect(t,i),r!==t.value&&this._onValueChange(t),c!==i.value&&this._onValueChange(i)}_updateStepNonRange(){const t=this._getInput(2);if(t){const i=t.value;t.step=this._step,this._platform.SAFARI&&(t.value=t.value),t._updateThumbUIByValue(),i!==t.value&&this._onValueChange(t)}}constructor(t,i,r,c,h,y){super(r),this._ngZone=t,this._cdr=i,this._dir=c,this._globalRippleOptions=h,this._disabled=!1,this._discrete=!1,this._showTickMarks=!1,this._min=0,this._max=100,this._step=1,this.displayWith=w=>`${w}`,this._rippleRadius=24,this.startValueIndicatorText="",this.endValueIndicatorText="",this._isRange=!1,this._isRtl=!1,this._hasViewInitialized=!1,this._tickMarkTrackWidth=0,this._hasAnimation=!1,this._resizeTimer=null,this._platform=Ke(im),this._knobRadius=8,this._thumbsOverlap=!1,this._noopAnimations="NoopAnimations"===y,this._dirChangeSubscription=this._dir.change.subscribe(()=>this._onDirChange()),this._isRtl="rtl"===this._dir.value}ngAfterViewInit(){this._platform.isBrowser&&this._updateDimensions();const t=this._getInput(2),i=this._getInput(1);this._isRange=!!t&&!!i,this._cdr.detectChanges();const r=this._getThumb(2);this._rippleRadius=r._ripple.radius,this._inputPadding=this._rippleRadius-this._knobRadius,this._inputOffset=this._knobRadius,this._isRange?this._initUIRange(t,i):this._initUINonRange(t),this._updateTrackUI(t),this._updateTickMarkUI(),this._updateTickMarkTrackUI(),this._observeHostResize(),this._cdr.detectChanges()}_initUINonRange(t){t.initProps(),t.initUI(),this._updateValueIndicatorUI(t),this._hasViewInitialized=!0,t._updateThumbUIByValue()}_initUIRange(t,i){t.initProps(),t.initUI(),i.initProps(),i.initUI(),t._updateMinMax(),i._updateMinMax(),t._updateStaticStyles(),i._updateStaticStyles(),this._updateValueIndicatorUIs(),this._hasViewInitialized=!0,t._updateThumbUIByValue(),i._updateThumbUIByValue()}ngOnDestroy(){this._dirChangeSubscription.unsubscribe(),this._resizeObserver?.disconnect(),this._resizeObserver=null}_onDirChange(){this._isRtl="rtl"===this._dir.value,this._isRange?this._onDirChangeRange():this._onDirChangeNonRange(),this._updateTickMarkUI()}_onDirChangeRange(){const t=this._getInput(2),i=this._getInput(1);t._setIsLeftThumb(),i._setIsLeftThumb(),t.translateX=t._calcTranslateXByValue(),i.translateX=i._calcTranslateXByValue(),t._updateStaticStyles(),i._updateStaticStyles(),t._updateWidthInactive(),i._updateWidthInactive(),t._updateThumbUIByValue(),i._updateThumbUIByValue()}_onDirChangeNonRange(){this._getInput(2)._updateThumbUIByValue()}_observeHostResize(){typeof ResizeObserver>"u"||!ResizeObserver||this._ngZone.runOutsideAngular(()=>{this._resizeObserver=new ResizeObserver(()=>{this._isActive()||(this._resizeTimer&&clearTimeout(this._resizeTimer),this._onResize())}),this._resizeObserver.observe(this._elementRef.nativeElement)})}_isActive(){return this._getThumb(1)._isActive||this._getThumb(2)._isActive}_getValue(t=2){const i=this._getInput(t);return i?i.value:this.min}_skipUpdate(){return!(!this._getInput(1)?._skipUIUpdate&&!this._getInput(2)?._skipUIUpdate)}_updateDimensions(){this._cachedWidth=this._elementRef.nativeElement.offsetWidth,this._cachedLeft=this._elementRef.nativeElement.getBoundingClientRect().left}_setTrackActiveStyles(t){const i=this._trackActive.nativeElement.style;i.left=t.left,i.right=t.right,i.transformOrigin=t.transformOrigin,i.transform=t.transform}_calcTickMarkTransform(t){return`translateX(${t*(this._tickMarkTrackWidth/(this._tickMarks.length-1))}px`}_onTranslateXChange(t){this._hasViewInitialized&&(this._updateThumbUI(t),this._updateTrackUI(t),this._updateOverlappingThumbUI(t))}_onTranslateXChangeBySideEffect(t,i){this._hasViewInitialized&&(t._updateThumbUIByValue(),i._updateThumbUIByValue())}_onValueChange(t){this._hasViewInitialized&&(this._updateValueIndicatorUI(t),this._updateTickMarkUI(),this._cdr.detectChanges())}_onMinMaxOrStepChange(){this._hasViewInitialized&&(this._updateTickMarkUI(),this._updateTickMarkTrackUI(),this._cdr.markForCheck())}_onResize(){if(this._hasViewInitialized){if(this._updateDimensions(),this._isRange){const t=this._getInput(2),i=this._getInput(1);t._updateThumbUIByValue(),i._updateThumbUIByValue(),t._updateStaticStyles(),i._updateStaticStyles(),t._updateMinMax(),i._updateMinMax(),t._updateWidthInactive(),i._updateWidthInactive()}else{const t=this._getInput(2);t&&t._updateThumbUIByValue()}this._updateTickMarkUI(),this._updateTickMarkTrackUI(),this._cdr.detectChanges()}}_areThumbsOverlapping(){const t=this._getInput(1),i=this._getInput(2);return!(!t||!i)&&i.translateX-t.translateX<20}_updateOverlappingThumbClassNames(t){const i=t.getSibling(),r=this._getThumb(t.thumbPosition);this._getThumb(i.thumbPosition)._hostElement.classList.remove("mdc-slider__thumb--top"),r._hostElement.classList.toggle("mdc-slider__thumb--top",this._thumbsOverlap)}_updateOverlappingThumbUI(t){!this._isRange||this._skipUpdate()||this._thumbsOverlap!==this._areThumbsOverlapping()&&(this._thumbsOverlap=!this._thumbsOverlap,this._updateOverlappingThumbClassNames(t))}_updateThumbUI(t){this._skipUpdate()||(this._getThumb(2===t.thumbPosition?2:1)._hostElement.style.transform=`translateX(${t.translateX}px)`)}_updateValueIndicatorUI(t){if(this._skipUpdate())return;const i=this.displayWith(t.value);if(this._hasViewInitialized?t._valuetext=i:t._hostElement.setAttribute("aria-valuetext",i),this.discrete){1===t.thumbPosition?this.startValueIndicatorText=i:this.endValueIndicatorText=i;const r=this._getThumb(t.thumbPosition);i.length<3?r._hostElement.classList.add("mdc-slider__thumb--short-value"):r._hostElement.classList.remove("mdc-slider__thumb--short-value")}}_updateValueIndicatorUIs(){const t=this._getInput(2),i=this._getInput(1);t&&this._updateValueIndicatorUI(t),i&&this._updateValueIndicatorUI(i)}_updateTickMarkTrackUI(){if(!this.showTickMarks||this._skipUpdate())return;const t=this._step&&this._step>0?this._step:1,r=(Math.floor(this.max/t)*t-this.min)/(this.max-this.min);this._tickMarkTrackWidth=this._cachedWidth*r-6}_updateTrackUI(t){this._skipUpdate()||(this._isRange?this._updateTrackUIRange(t):this._updateTrackUINonRange(t))}_updateTrackUIRange(t){const i=t.getSibling();if(!i||!this._cachedWidth)return;const r=Math.abs(i.translateX-t.translateX)/this._cachedWidth;this._setTrackActiveStyles(t._isLeftThumb&&this._cachedWidth?{left:"auto",right:this._cachedWidth-i.translateX+"px",transformOrigin:"right",transform:`scaleX(${r})`}:{left:`${i.translateX}px`,right:"auto",transformOrigin:"left",transform:`scaleX(${r})`})}_updateTrackUINonRange(t){this._setTrackActiveStyles(this._isRtl?{left:"auto",right:"0px",transformOrigin:"right",transform:`scaleX(${1-t.fillPercentage})`}:{left:"0px",right:"auto",transformOrigin:"left",transform:`scaleX(${t.fillPercentage})`})}_updateTickMarkUI(){if(!this.showTickMarks||void 0===this.step||void 0===this.min||void 0===this.max)return;const t=this.step>0?this.step:1;this._isRange?this._updateTickMarkUIRange(t):this._updateTickMarkUINonRange(t),this._isRtl&&this._tickMarks.reverse()}_updateTickMarkUINonRange(t){const i=this._getValue();let r=Math.max(Math.round((i-this.min)/t),0),c=Math.max(Math.round((this.max-i)/t),0);this._isRtl?r++:c++,this._tickMarks=Array(r).fill(0).concat(Array(c).fill(1))}_updateTickMarkUIRange(t){const i=this._getValue(),r=this._getValue(1),c=Math.max(Math.floor((r-this.min)/t),0),h=Math.max(Math.floor((i-r)/t)+1,0),y=Math.max(Math.floor((this.max-i)/t),0);this._tickMarks=Array(c).fill(1).concat(Array(h).fill(0),Array(y).fill(1))}_getInput(t){return 2===t&&this._input?this._input:this._inputs?.length?1===t?this._inputs.first:this._inputs.last:void 0}_getThumb(t){return 2===t?this._thumbs?.last:this._thumbs?.first}_setTransition(t){this._hasAnimation=!this._platform.IOS&&t&&!this._noopAnimations,this._elementRef.nativeElement.classList.toggle("mat-mdc-slider-with-animation",this._hasAnimation)}_isCursorOnSliderThumb(t,i){const r=i.width/2,w=t.clientY-(i.y+r);return Math.pow(t.clientX-(i.x+r),2)+Math.pow(w,2)<Math.pow(r,2)}static#e=this.\u0275fac=function(i){return new(i||e)(xe(dn),xe(fu),xe(Mr),xe(fz,8),xe(ZI,8),xe(lw,8))};static#t=this.\u0275cmp=Nn({type:e,selectors:[["mat-slider"]],contentQueries:function(i,r,c){if(1&i&&(g_(c,eM,5),g_(c,tM,4)),2&i){let h;io(h=ro())&&(r._input=h.first),io(h=ro())&&(r._inputs=h)}},viewQuery:function(i,r){if(1&i&&(Ha(nV,5),Ha(nM,5)),2&i){let c;io(c=ro())&&(r._trackActive=c.first),io(c=ro())&&(r._thumbs=c)}},hostAttrs:[1,"mat-mdc-slider","mdc-slider"],hostVars:10,hostBindings:function(i,r){2&i&&Wh("mdc-slider--range",r._isRange)("mdc-slider--disabled",r.disabled)("mdc-slider--discrete",r.discrete)("mdc-slider--tick-marks",r.showTickMarks)("_mat-animation-noopable",r._noopAnimations)},inputs:{color:"color",disableRipple:"disableRipple",disabled:"disabled",discrete:"discrete",showTickMarks:"showTickMarks",min:"min",max:"max",step:"step",displayWith:"displayWith"},exportAs:["matSlider"],features:[$n([{provide:ry,useExisting:e}]),Rn],ngContentSelectors:aV,decls:9,vars:5,consts:[[1,"mdc-slider__track"],[1,"mdc-slider__track--inactive"],[1,"mdc-slider__track--active"],[1,"mdc-slider__track--active_fill"],["trackActive",""],["class","mdc-slider__tick-marks",4,"ngIf"],[3,"discrete","thumbPosition","valueIndicatorText",4,"ngIf"],[3,"discrete","thumbPosition","valueIndicatorText"],[1,"mdc-slider__tick-marks"],["tickMarkContainer",""],[4,"ngIf"],[3,"class","transform",4,"ngFor","ngForOf"]],template:function(i,r){1&i&&(Nf(),zf(0),tt(1,"div",0),sn(2,"div",1),tt(3,"div",2),sn(4,"div",3,4),Ye(),An(6,sV,3,1,"div",5),Ye(),An(7,oV,1,3,"mat-slider-visual-thumb",6),sn(8,"mat-slider-visual-thumb",7)),2&i&&(He(6),mt("ngIf",r.showTickMarks),He(1),mt("ngIf",r._isRange),He(1),mt("discrete",r.discrete)("thumbPosition",2)("valueIndicatorText",r.endValueIndicatorText))},dependencies:[ip,Id,lV],styles:['.mdc-slider{cursor:pointer;height:48px;margin:0 24px;position:relative;touch-action:pan-y}.mdc-slider .mdc-slider__track{position:absolute;top:50%;transform:translateY(-50%);width:100%}.mdc-slider .mdc-slider__track--active,.mdc-slider .mdc-slider__track--inactive{display:flex;height:100%;position:absolute;width:100%}.mdc-slider .mdc-slider__track--active{overflow:hidden}.mdc-slider .mdc-slider__track--active_fill{border-top-style:solid;box-sizing:border-box;height:100%;width:100%;position:relative;-webkit-transform-origin:left;transform-origin:left}[dir=rtl] .mdc-slider .mdc-slider__track--active_fill,.mdc-slider .mdc-slider__track--active_fill[dir=rtl]{-webkit-transform-origin:right;transform-origin:right}.mdc-slider .mdc-slider__track--inactive{left:0;top:0}.mdc-slider .mdc-slider__track--inactive::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:1px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}@media screen and (forced-colors: active){.mdc-slider .mdc-slider__track--inactive::before{border-color:CanvasText}}.mdc-slider .mdc-slider__value-indicator-container{bottom:44px;left:var(--slider-value-indicator-container-left, 50%);pointer-events:none;position:absolute;right:var(--slider-value-indicator-container-right);transform:var(--slider-value-indicator-container-transform, translateX(-50%))}.mdc-slider .mdc-slider__value-indicator{transition:transform 100ms 0ms cubic-bezier(0.4, 0, 1, 1);align-items:center;border-radius:4px;display:flex;height:32px;padding:0 12px;transform:scale(0);transform-origin:bottom}.mdc-slider .mdc-slider__value-indicator::before{border-left:6px solid rgba(0,0,0,0);border-right:6px solid rgba(0,0,0,0);border-top:6px solid;bottom:-5px;content:"";height:0;left:var(--slider-value-indicator-caret-left, 50%);position:absolute;right:var(--slider-value-indicator-caret-right);transform:var(--slider-value-indicator-caret-transform, translateX(-50%));width:0}.mdc-slider .mdc-slider__value-indicator::after{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:1px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}@media screen and (forced-colors: active){.mdc-slider .mdc-slider__value-indicator::after{border-color:CanvasText}}.mdc-slider .mdc-slider__thumb--with-indicator .mdc-slider__value-indicator-container{pointer-events:auto}.mdc-slider .mdc-slider__thumb--with-indicator .mdc-slider__value-indicator{transition:transform 100ms 0ms cubic-bezier(0, 0, 0.2, 1);transform:scale(1)}@media(prefers-reduced-motion){.mdc-slider .mdc-slider__value-indicator,.mdc-slider .mdc-slider__thumb--with-indicator .mdc-slider__value-indicator{transition:none}}.mdc-slider .mdc-slider__thumb{display:flex;left:-24px;outline:none;position:absolute;user-select:none;height:48px;width:48px}.mdc-slider .mdc-slider__thumb--top{z-index:1}.mdc-slider .mdc-slider__thumb--top .mdc-slider__thumb-knob,.mdc-slider .mdc-slider__thumb--top.mdc-slider__thumb:hover .mdc-slider__thumb-knob,.mdc-slider .mdc-slider__thumb--top.mdc-slider__thumb--focused .mdc-slider__thumb-knob{border-style:solid;border-width:1px;box-sizing:content-box}.mdc-slider .mdc-slider__thumb-knob{box-sizing:border-box;left:50%;position:absolute;top:50%;transform:translate(-50%, -50%)}.mdc-slider .mdc-slider__tick-marks{align-items:center;box-sizing:border-box;display:flex;height:100%;justify-content:space-between;padding:0 1px;position:absolute;width:100%}.mdc-slider--discrete .mdc-slider__thumb,.mdc-slider--discrete .mdc-slider__track--active_fill{transition:transform 80ms ease}@media(prefers-reduced-motion){.mdc-slider--discrete .mdc-slider__thumb,.mdc-slider--discrete .mdc-slider__track--active_fill{transition:none}}.mdc-slider--disabled{cursor:auto}.mdc-slider--disabled .mdc-slider__thumb{pointer-events:none}.mdc-slider__input{cursor:pointer;left:2px;margin:0;height:44px;opacity:0;pointer-events:none;position:absolute;top:2px;width:44px}.mat-mdc-slider{display:inline-block;box-sizing:border-box;outline:none;vertical-align:middle;margin-left:8px;margin-right:8px;width:auto;min-width:112px;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-slider .mdc-slider__thumb-knob{background-color:var(--mdc-slider-handle-color, var(--mdc-theme-primary, #6200ee));border-color:var(--mdc-slider-handle-color, var(--mdc-theme-primary, #6200ee))}.mat-mdc-slider .mdc-slider__thumb--top .mdc-slider__thumb-knob,.mat-mdc-slider .mdc-slider__thumb--top.mdc-slider__thumb:hover .mdc-slider__thumb-knob,.mat-mdc-slider .mdc-slider__thumb--top.mdc-slider__thumb--focused .mdc-slider__thumb-knob{border-color:#fff}.mat-mdc-slider.mdc-slider--disabled .mdc-slider__thumb-knob{background-color:var(--mdc-slider-disabled-handle-color, var(--mdc-theme-on-surface, #000));border-color:var(--mdc-slider-disabled-handle-color, var(--mdc-theme-on-surface, #000))}.mat-mdc-slider.mdc-slider--disabled .mdc-slider__thumb--top .mdc-slider__thumb-knob,.mat-mdc-slider.mdc-slider--disabled .mdc-slider__thumb--top.mdc-slider__thumb:hover .mdc-slider__thumb-knob,.mat-mdc-slider.mdc-slider--disabled .mdc-slider__thumb--top.mdc-slider__thumb--focused .mdc-slider__thumb-knob{border-color:#fff}.mat-mdc-slider .mdc-slider__thumb::before,.mat-mdc-slider .mdc-slider__thumb::after{background-color:var(--mdc-slider-handle-color, var(--mdc-theme-primary, #6200ee))}.mat-mdc-slider .mdc-slider__thumb:hover::before,.mat-mdc-slider .mdc-slider__thumb.mdc-ripple-surface--hover::before{opacity:var(--mdc-ripple-hover-opacity, 0.04)}.mat-mdc-slider .mdc-slider__thumb.mdc-ripple-upgraded--background-focused::before,.mat-mdc-slider .mdc-slider__thumb:not(.mdc-ripple-upgraded):focus::before{transition-duration:75ms;opacity:var(--mdc-ripple-focus-opacity, 0.12)}.mat-mdc-slider .mdc-slider__thumb:not(.mdc-ripple-upgraded)::after{transition:opacity 150ms linear}.mat-mdc-slider .mdc-slider__thumb:not(.mdc-ripple-upgraded):active::after{transition-duration:75ms;opacity:var(--mdc-ripple-press-opacity, 0.12)}.mat-mdc-slider .mdc-slider__thumb.mdc-ripple-upgraded{--mdc-ripple-fg-opacity:var(--mdc-ripple-press-opacity, 0.12)}.mat-mdc-slider .mdc-slider__track--active_fill{border-color:var(--mdc-slider-active-track-color, var(--mdc-theme-primary, #6200ee))}.mat-mdc-slider.mdc-slider--disabled .mdc-slider__track--active_fill{border-color:var(--mdc-slider-disabled-active-track-color, var(--mdc-theme-on-surface, #000))}.mat-mdc-slider .mdc-slider__track--inactive{background-color:var(--mdc-slider-inactive-track-color, var(--mdc-theme-primary, #6200ee));opacity:.24}.mat-mdc-slider.mdc-slider--disabled .mdc-slider__track--inactive{background-color:var(--mdc-slider-disabled-inactive-track-color, var(--mdc-theme-on-surface, #000));opacity:.24}.mat-mdc-slider .mdc-slider__tick-mark--active{background-color:var(--mdc-slider-with-tick-marks-active-container-color, var(--mdc-theme-on-primary, #fff));opacity:var(--mdc-slider-with-tick-marks-active-container-opacity, 0.6)}.mat-mdc-slider.mdc-slider--disabled .mdc-slider__tick-mark--active{background-color:var(--mdc-slider-with-tick-marks-active-container-color, var(--mdc-theme-on-primary, #fff));opacity:var(--mdc-slider-with-tick-marks-active-container-opacity, 0.6)}.mat-mdc-slider .mdc-slider__tick-mark--inactive{background-color:var(--mdc-slider-with-tick-marks-inactive-container-color, var(--mdc-theme-primary, #6200ee));opacity:var(--mdc-slider-with-tick-marks-inactive-container-opacity, 0.6)}.mat-mdc-slider.mdc-slider--disabled .mdc-slider__tick-mark--inactive{background-color:var(--mdc-slider-with-tick-marks-disabled-container-color, var(--mdc-theme-on-surface, #000));opacity:var(--mdc-slider-with-tick-marks-inactive-container-opacity, 0.6)}.mat-mdc-slider .mdc-slider__value-indicator{background-color:var(--mdc-slider-label-container-color, #666666);opacity:1}.mat-mdc-slider .mdc-slider__value-indicator::before{border-top-color:var(--mdc-slider-label-container-color, #666666)}.mat-mdc-slider .mdc-slider__value-indicator{color:var(--mdc-slider-label-label-text-color, var(--mdc-theme-on-primary, #fff))}.mat-mdc-slider .mdc-slider__track{height:var(--mdc-slider-inactive-track-height, 4px)}.mat-mdc-slider .mdc-slider__track--active{height:var(--mdc-slider-active-track-height, 6px);top:calc((var(--mdc-slider-inactive-track-height, 4px) - var(--mdc-slider-active-track-height, 6px)) / 2)}.mat-mdc-slider .mdc-slider__track--active_fill{border-top-width:var(--mdc-slider-active-track-height, 6px)}.mat-mdc-slider .mdc-slider__track--inactive{height:var(--mdc-slider-inactive-track-height, 4px)}.mat-mdc-slider .mdc-slider__tick-mark--active,.mat-mdc-slider .mdc-slider__tick-mark--inactive{height:var(--mdc-slider-with-tick-marks-container-size, 2px);width:var(--mdc-slider-with-tick-marks-container-size, 2px)}.mat-mdc-slider.mdc-slider--disabled{opacity:0.38}.mat-mdc-slider .mdc-slider__value-indicator-text{letter-spacing:var(--mdc-slider-label-label-text-tracking, 0.0071428571em);font-size:var(--mdc-slider-label-label-text-size, 0.875rem);font-family:var(--mdc-slider-label-label-text-font, Roboto, sans-serif);font-weight:var(--mdc-slider-label-label-text-weight, 500);line-height:var(--mdc-slider-label-label-text-line-height, 1.375rem)}.mat-mdc-slider .mdc-slider__track--active{border-radius:var(--mdc-slider-active-track-shape, 9999px)}.mat-mdc-slider .mdc-slider__track--inactive{border-radius:var(--mdc-slider-inactive-track-shape, 9999px)}.mat-mdc-slider .mdc-slider__thumb-knob{border-radius:var(--mdc-slider-handle-shape, 50%);width:var(--mdc-slider-handle-width, 20px);height:var(--mdc-slider-handle-height, 20px);border-style:solid;border-width:calc(var(--mdc-slider-handle-height, 20px) / 2) calc(var(--mdc-slider-handle-width, 20px) / 2)}.mat-mdc-slider .mdc-slider__tick-mark--active,.mat-mdc-slider .mdc-slider__tick-mark--inactive{border-radius:var(--mdc-slider-with-tick-marks-container-shape, 50%)}.mat-mdc-slider .mdc-slider__thumb-knob{box-shadow:var(--mdc-slider-handle-elevation, 0px 2px 1px -1px rgba(0, 0, 0, 0.2), 0px 1px 1px 0px rgba(0, 0, 0, 0.14), 0px 1px 3px 0px rgba(0, 0, 0, 0.12))}.mat-mdc-slider .mdc-slider__thumb:hover .mdc-slider__thumb-knob{background-color:var(--mdc-slider-hover-handle-color, var(--mdc-theme-primary, #6200ee));border-color:var(--mdc-slider-hover-handle-color, var(--mdc-theme-primary, #6200ee))}.mat-mdc-slider .mdc-slider__thumb:hover .mdc-slider__thumb--top .mdc-slider__thumb-knob,.mat-mdc-slider .mdc-slider__thumb:hover .mdc-slider__thumb--top.mdc-slider__thumb:hover .mdc-slider__thumb-knob,.mat-mdc-slider .mdc-slider__thumb:hover .mdc-slider__thumb--top.mdc-slider__thumb--focused .mdc-slider__thumb-knob{border-color:#fff}.mat-mdc-slider .mdc-slider__thumb--focused .mdc-slider__thumb-knob{background-color:var(--mdc-slider-focus-handle-color, var(--mdc-theme-primary, #6200ee));border-color:var(--mdc-slider-focus-handle-color, var(--mdc-theme-primary, #6200ee))}.mat-mdc-slider .mdc-slider__thumb--focused .mdc-slider__thumb--top .mdc-slider__thumb-knob,.mat-mdc-slider .mdc-slider__thumb--focused .mdc-slider__thumb--top.mdc-slider__thumb:hover .mdc-slider__thumb-knob,.mat-mdc-slider .mdc-slider__thumb--focused .mdc-slider__thumb--top.mdc-slider__thumb--focused .mdc-slider__thumb-knob{border-color:#fff}.mat-mdc-slider .mdc-slider__thumb:not(:disabled):active .mdc-slider__thumb--top .mdc-slider__thumb-knob,.mat-mdc-slider .mdc-slider__thumb:not(:disabled):active .mdc-slider__thumb--top.mdc-slider__thumb:hover .mdc-slider__thumb-knob,.mat-mdc-slider .mdc-slider__thumb:not(:disabled):active .mdc-slider__thumb--top.mdc-slider__thumb--focused .mdc-slider__thumb-knob{border-color:#fff}.mat-mdc-slider .mdc-slider__thumb--top .mdc-slider__thumb-knob,.mat-mdc-slider .mdc-slider__thumb--top.mdc-slider__thumb:hover .mdc-slider__thumb-knob,.mat-mdc-slider .mdc-slider__thumb--top.mdc-slider__thumb--focused .mdc-slider__thumb-knob{border-color:var(--mdc-slider-with-overlap-handle-outline-color, #fff);border-width:var(--mdc-slider-with-overlap-handle-outline-width, 1px)}.mat-mdc-slider .mdc-slider__input{box-sizing:content-box;pointer-events:auto}.mat-mdc-slider .mdc-slider__input.mat-mdc-slider-input-no-pointer-events{pointer-events:none}.mat-mdc-slider .mdc-slider__input.mat-slider__right-input{left:auto;right:0}.mat-mdc-slider .mdc-slider__thumb,.mat-mdc-slider .mdc-slider__track--active_fill{transition-duration:0ms}.mat-mdc-slider.mat-mdc-slider-with-animation .mdc-slider__thumb,.mat-mdc-slider.mat-mdc-slider-with-animation .mdc-slider__track--active_fill{transition-duration:80ms}.mat-mdc-slider.mdc-slider--discrete .mdc-slider__thumb,.mat-mdc-slider.mdc-slider--discrete .mdc-slider__track--active_fill{transition-duration:0ms}.mat-mdc-slider.mat-mdc-slider-with-animation .mdc-slider__thumb,.mat-mdc-slider.mat-mdc-slider-with-animation .mdc-slider__track--active_fill{transition-duration:80ms}.mat-mdc-slider.mat-mdc-slider-with-animation .mdc-slider__value-indicator{word-break:normal}.mat-mdc-slider .mdc-slider__track,.mat-mdc-slider .mdc-slider__thumb{pointer-events:none}.mat-mdc-slider .mdc-slider__value-indicator{opacity:var(--mat-mdc-slider-value-indicator-opacity, 1)}.mat-mdc-slider .mat-ripple .mat-ripple-element{background-color:var(--mat-mdc-slider-ripple-color, transparent)}.mat-mdc-slider .mat-ripple .mat-mdc-slider-hover-ripple{background-color:var(--mat-mdc-slider-hover-ripple-color, transparent)}.mat-mdc-slider .mat-ripple .mat-mdc-slider-focus-ripple,.mat-mdc-slider .mat-ripple .mat-mdc-slider-active-ripple{background-color:var(--mat-mdc-slider-focus-ripple-color, transparent)}.mat-mdc-slider._mat-animation-noopable.mdc-slider--discrete .mdc-slider__thumb,.mat-mdc-slider._mat-animation-noopable.mdc-slider--discrete .mdc-slider__track--active_fill,.mat-mdc-slider._mat-animation-noopable .mdc-slider__value-indicator{transition:none}.mat-mdc-slider .mat-mdc-focus-indicator::before{border-radius:50%}.mdc-slider__thumb--focused .mat-mdc-focus-indicator::before{content:""}'],encapsulation:2,changeDetection:0})}return e})();const hV={provide:aa,useExisting:pn(()=>iM),multi:!0},pV={provide:aa,useExisting:pn(()=>rM),multi:!0};let iM=(()=>{class e{get value(){return Za(this._hostElement.value)}set value(t){const i=Za(t).toString();this._hasSetInitialValue?this._isActive||(this._hostElement.value=i,this._updateThumbUIByValue(),this._slider._onValueChange(this),this._cdr.detectChanges(),this._slider._cdr.markForCheck()):this._initialValue=i}get translateX(){return this._slider.min>=this._slider.max?(this._translateX=0,this._translateX):(void 0===this._translateX&&(this._translateX=this._calcTranslateXByValue()),this._translateX)}set translateX(t){this._translateX=t}get min(){return Za(this._hostElement.min)}set min(t){this._hostElement.min=Za(t).toString(),this._cdr.detectChanges()}get max(){return Za(this._hostElement.max)}set max(t){this._hostElement.max=Za(t).toString(),this._cdr.detectChanges()}get step(){return Za(this._hostElement.step)}set step(t){this._hostElement.step=Za(t).toString(),this._cdr.detectChanges()}get disabled(){return sp(this._hostElement.disabled)}set disabled(t){this._hostElement.disabled=sp(t),this._cdr.detectChanges(),this._slider.disabled!==this.disabled&&(this._slider.disabled=this.disabled)}get percentage(){return this._slider.min>=this._slider.max?this._slider._isRtl?1:0:(this.value-this._slider.min)/(this._slider.max-this._slider.min)}get fillPercentage(){return this._slider._cachedWidth?0===this._translateX?0:this.translateX/this._slider._cachedWidth:this._slider._isRtl?1:0}_setIsFocused(t){this._isFocused=t}constructor(t,i,r,c){this._ngZone=t,this._elementRef=i,this._cdr=r,this._slider=c,this.valueChange=new Ve,this.dragStart=new Ve,this.dragEnd=new Ve,this.thumbPosition=2,this._knobRadius=8,this._isActive=!1,this._isFocused=!1,this._hasSetInitialValue=!1,this._destroyed=new ci,this._skipUIUpdate=!1,this._onTouchedFn=()=>{},this._isControlInitialized=!1,this._platform=Ke(im),this._hostElement=i.nativeElement,this._ngZone.runOutsideAngular(()=>{this._hostElement.addEventListener("pointerdown",this._onPointerDown.bind(this)),this._hostElement.addEventListener("pointermove",this._onPointerMove.bind(this)),this._hostElement.addEventListener("pointerup",this._onPointerUp.bind(this))})}ngOnDestroy(){this._hostElement.removeEventListener("pointerdown",this._onPointerDown),this._hostElement.removeEventListener("pointermove",this._onPointerMove),this._hostElement.removeEventListener("pointerup",this._onPointerUp),this._destroyed.next(),this._destroyed.complete(),this.dragStart.complete(),this.dragEnd.complete()}initProps(){this._updateWidthInactive(),this.disabled!==this._slider.disabled&&(this._slider.disabled=!0),this.step=this._slider.step,this.min=this._slider.min,this.max=this._slider.max,this._initValue()}initUI(){this._updateThumbUIByValue()}_initValue(){this._hasSetInitialValue=!0,void 0===this._initialValue?this.value=this._getDefaultValue():(this._hostElement.value=this._initialValue,this._updateThumbUIByValue(),this._slider._onValueChange(this),this._cdr.detectChanges())}_getDefaultValue(){return this.min}_onBlur(){this._setIsFocused(!1),this._onTouchedFn()}_onFocus(){this._setIsFocused(!0)}_onChange(){this.valueChange.emit(this.value),this._isActive&&this._updateThumbUIByValue({withAnimation:!0})}_onInput(){this._onChangeFn?.(this.value),(this._slider.step||!this._isActive)&&this._updateThumbUIByValue({withAnimation:!0}),this._slider._onValueChange(this)}_onNgControlValueChange(){(!this._isActive||!this._isFocused)&&(this._slider._onValueChange(this),this._updateThumbUIByValue()),this._slider.disabled=this._formControl.disabled}_onPointerDown(t){if(!this.disabled&&0===t.button){if(this._platform.IOS){const i=this._slider._isCursorOnSliderThumb(t,this._slider._getThumb(this.thumbPosition)._hostElement.getBoundingClientRect());return this._isActive=i,this._updateWidthActive(),void this._slider._updateDimensions()}this._isActive=!0,this._setIsFocused(!0),this._updateWidthActive(),this._slider._updateDimensions(),this._slider.step||this._updateThumbUIByPointerEvent(t,{withAnimation:!0}),this.disabled||(this._handleValueCorrection(t),this.dragStart.emit({source:this,parent:this._slider,value:this.value}))}}_handleValueCorrection(t){this._skipUIUpdate=!0,setTimeout(()=>{this._skipUIUpdate=!1,this._fixValue(t)},0)}_fixValue(t){const i=t.clientX-this._slider._cachedLeft,r=this._slider._cachedWidth,c=0===this._slider.step?1:this._slider.step,h=Math.floor((this._slider.max-this._slider.min)/c),I=Math.round((this._slider._isRtl?1-i/r:i/r)*h)/h*(this._slider.max-this._slider.min)+this._slider.min,P=Math.round(I/c)*c;if(P===this.value)return this._slider._onValueChange(this),void(this._slider.step>0?this._updateThumbUIByValue():this._updateThumbUIByPointerEvent(t,{withAnimation:this._slider._hasAnimation}));this.value=P,this.valueChange.emit(this.value),this._onChangeFn?.(this.value),this._slider._onValueChange(this),this._slider.step>0?this._updateThumbUIByValue():this._updateThumbUIByPointerEvent(t,{withAnimation:this._slider._hasAnimation})}_onPointerMove(t){!this._slider.step&&this._isActive&&this._updateThumbUIByPointerEvent(t)}_onPointerUp(){this._isActive&&(this._isActive=!1,this.dragEnd.emit({source:this,parent:this._slider,value:this.value}),setTimeout(()=>this._updateWidthInactive(),this._platform.IOS?10:0))}_clamp(t){return Math.max(Math.min(t,this._slider._cachedWidth),0)}_calcTranslateXByValue(){return this._slider._isRtl?(1-this.percentage)*this._slider._cachedWidth:this.percentage*this._slider._cachedWidth}_calcTranslateXByPointerEvent(t){return t.clientX-this._slider._cachedLeft}_updateWidthActive(){this._hostElement.style.padding=`0 ${this._slider._inputPadding}px`,this._hostElement.style.width=`calc(100% + ${this._slider._inputPadding}px)`}_updateWidthInactive(){this._hostElement.style.padding="0px",this._hostElement.style.width="calc(100% + 48px)",this._hostElement.style.left="-24px"}_updateThumbUIByValue(t){this.translateX=this._clamp(this._calcTranslateXByValue()),this._updateThumbUI(t)}_updateThumbUIByPointerEvent(t,i){this.translateX=this._clamp(this._calcTranslateXByPointerEvent(t)),this._updateThumbUI(i)}_updateThumbUI(t){this._slider._setTransition(!!t?.withAnimation),this._slider._onTranslateXChange(this)}writeValue(t){(this._isControlInitialized||null!==t)&&(this.value=t)}registerOnChange(t){this._onChangeFn=t,this._isControlInitialized=!0}registerOnTouched(t){this._onTouchedFn=t}setDisabledState(t){this.disabled=t}focus(){this._hostElement.focus()}blur(){this._hostElement.blur()}static#e=this.\u0275fac=function(i){return new(i||e)(xe(dn),xe(Mr),xe(fu),xe(ry))};static#t=this.\u0275dir=xt({type:e,selectors:[["input","matSliderThumb",""]],hostAttrs:["type","range",1,"mdc-slider__input"],hostVars:1,hostBindings:function(i,r){1&i&&yi("change",function(){return r._onChange()})("input",function(){return r._onInput()})("blur",function(){return r._onBlur()})("focus",function(){return r._onFocus()}),2&i&&Ba("aria-valuetext",r._valuetext)},inputs:{value:"value"},outputs:{valueChange:"valueChange",dragStart:"dragStart",dragEnd:"dragEnd"},exportAs:["matSliderThumb"],features:[$n([hV,{provide:eM,useExisting:e}])]})}return e})(),rM=(()=>{class e extends iM{getSibling(){return this._sibling||(this._sibling=this._slider._getInput(this._isEndThumb?1:2)),this._sibling}getMinPos(){const t=this.getSibling();return!this._isLeftThumb&&t?t.translateX:0}getMaxPos(){const t=this.getSibling();return this._isLeftThumb&&t?t.translateX:this._slider._cachedWidth}_setIsLeftThumb(){this._isLeftThumb=this._isEndThumb&&this._slider._isRtl||!this._isEndThumb&&!this._slider._isRtl}constructor(t,i,r,c){super(t,r,c,i),this._cdr=c,this._isEndThumb=this._hostElement.hasAttribute("matSliderEndThumb"),this._setIsLeftThumb(),this.thumbPosition=this._isEndThumb?2:1}_getDefaultValue(){return this._isEndThumb&&this._slider._isRange?this.max:this.min}_onInput(){super._onInput(),this._updateSibling(),this._isActive||this._updateWidthInactive()}_onNgControlValueChange(){super._onNgControlValueChange(),this.getSibling()?._updateMinMax()}_onPointerDown(t){this.disabled||0!==t.button||(this._sibling&&(this._sibling._updateWidthActive(),this._sibling._hostElement.classList.add("mat-mdc-slider-input-no-pointer-events")),super._onPointerDown(t))}_onPointerUp(){super._onPointerUp(),this._sibling&&setTimeout(()=>{this._sibling._updateWidthInactive(),this._sibling._hostElement.classList.remove("mat-mdc-slider-input-no-pointer-events")})}_onPointerMove(t){super._onPointerMove(t),!this._slider.step&&this._isActive&&this._updateSibling()}_fixValue(t){super._fixValue(t),this._sibling?._updateMinMax()}_clamp(t){return Math.max(Math.min(t,this.getMaxPos()),this.getMinPos())}_updateMinMax(){const t=this.getSibling();t&&(this._isEndThumb?(this.min=Math.max(this._slider.min,t.value),this.max=this._slider.max):(this.min=this._slider.min,this.max=Math.min(this._slider.max,t.value)))}_updateWidthActive(){const t=2*this._slider._rippleRadius-2*this._slider._inputPadding;this._hostElement.style.width=`${(this._slider._cachedWidth+this._slider._inputPadding-t)*(this._slider.min<this._slider.max?(this.max-this.min)/(this._slider.max-this._slider.min):1)+t}px`,this._hostElement.style.padding=`0 ${this._slider._inputPadding}px`}_updateWidthInactive(){const t=this.getSibling();if(!t)return;const r=this._isEndThumb?this.value-(this.value-t.value)/2:this.value+(t.value-this.value)/2,h=this._slider.min<this._slider.max?this._isEndThumb?(this.max-r)/(this._slider.max-this._slider.min):(r-this.min)/(this._slider.max-this._slider.min):1;let y=this._slider._rippleRadius;1===h?y=48:0===h&&(y=0),this._hostElement.style.width=`${this._slider._cachedWidth*h+y}px`,this._hostElement.style.padding="0px",this._isLeftThumb?(this._hostElement.style.left="-24px",this._hostElement.style.right="auto"):(this._hostElement.style.left="auto",this._hostElement.style.right="-24px")}_updateStaticStyles(){this._hostElement.classList.toggle("mat-slider__right-input",!this._isLeftThumb)}_updateSibling(){const t=this.getSibling();t&&(t._updateMinMax(),this._isActive?t._updateWidthActive():t._updateWidthInactive())}writeValue(t){(this._isControlInitialized||null!==t)&&(this.value=t,this._updateWidthInactive(),this._updateSibling())}static#e=this.\u0275fac=function(i){return new(i||e)(xe(dn),xe(ry),xe(Mr),xe(fu))};static#t=this.\u0275dir=xt({type:e,selectors:[["input","matSliderStartThumb",""],["input","matSliderEndThumb",""]],exportAs:["matSliderRangeThumb"],features:[$n([pV,{provide:tM,useExisting:e}]),Rn]})}return e})(),fV=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=Ni({type:e});static#n=this.\u0275inj=Fi({imports:[z0,v0,nB]})}return e})();function cp(e,n){return Jt(n)?ln(e,n,1):ln(e,1)}function pm(e){return Vn((n,t)=>{try{n.subscribe(t)}finally{t.add(e)}})}class sy{}class oy{}class Tl{constructor(n){this.normalizedNames=new Map,this.lazyUpdate=null,n?"string"==typeof n?this.lazyInit=()=>{this.headers=new Map,n.split("\n").forEach(t=>{const i=t.indexOf(":");if(i>0){const r=t.slice(0,i),c=r.toLowerCase(),h=t.slice(i+1).trim();this.maybeSetNormalizedName(r,c),this.headers.has(c)?this.headers.get(c).push(h):this.headers.set(c,[h])}})}:typeof Headers<"u"&&n instanceof Headers?(this.headers=new Map,n.forEach((t,i)=>{this.setHeaderEntries(i,t)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(n).forEach(([t,i])=>{this.setHeaderEntries(t,i)})}:this.headers=new Map}has(n){return this.init(),this.headers.has(n.toLowerCase())}get(n){this.init();const t=this.headers.get(n.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(n){return this.init(),this.headers.get(n.toLowerCase())||null}append(n,t){return this.clone({name:n,value:t,op:"a"})}set(n,t){return this.clone({name:n,value:t,op:"s"})}delete(n,t){return this.clone({name:n,value:t,op:"d"})}maybeSetNormalizedName(n,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,n)}init(){this.lazyInit&&(this.lazyInit instanceof Tl?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(n=>this.applyUpdate(n)),this.lazyUpdate=null))}copyFrom(n){n.init(),Array.from(n.headers.keys()).forEach(t=>{this.headers.set(t,n.headers.get(t)),this.normalizedNames.set(t,n.normalizedNames.get(t))})}clone(n){const t=new Tl;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof Tl?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([n]),t}applyUpdate(n){const t=n.name.toLowerCase();switch(n.op){case"a":case"s":let i=n.value;if("string"==typeof i&&(i=[i]),0===i.length)return;this.maybeSetNormalizedName(n.name,t);const r=("a"===n.op?this.headers.get(t):void 0)||[];r.push(...i),this.headers.set(t,r);break;case"d":const c=n.value;if(c){let h=this.headers.get(t);if(!h)return;h=h.filter(y=>-1===c.indexOf(y)),0===h.length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,h)}else this.headers.delete(t),this.normalizedNames.delete(t)}}setHeaderEntries(n,t){const i=(Array.isArray(t)?t:[t]).map(c=>c.toString()),r=n.toLowerCase();this.headers.set(r,i),this.maybeSetNormalizedName(n,r)}forEach(n){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>n(this.normalizedNames.get(t),this.headers.get(t)))}}class mV{encodeKey(n){return sM(n)}encodeValue(n){return sM(n)}decodeKey(n){return decodeURIComponent(n)}decodeValue(n){return decodeURIComponent(n)}}const _V=/%(\d[a-f0-9])/gi,yV={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function sM(e){return encodeURIComponent(e).replace(_V,(n,t)=>yV[t]??n)}function ay(e){return`${e}`}class wu{constructor(n={}){if(this.updates=null,this.cloneFrom=null,this.encoder=n.encoder||new mV,n.fromString){if(n.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function gV(e,n){const t=new Map;return e.length>0&&e.replace(/^\?/,"").split("&").forEach(r=>{const c=r.indexOf("="),[h,y]=-1==c?[n.decodeKey(r),""]:[n.decodeKey(r.slice(0,c)),n.decodeValue(r.slice(c+1))],w=t.get(h)||[];w.push(y),t.set(h,w)}),t}(n.fromString,this.encoder)}else n.fromObject?(this.map=new Map,Object.keys(n.fromObject).forEach(t=>{const i=n.fromObject[t],r=Array.isArray(i)?i.map(ay):[ay(i)];this.map.set(t,r)})):this.map=null}has(n){return this.init(),this.map.has(n)}get(n){this.init();const t=this.map.get(n);return t?t[0]:null}getAll(n){return this.init(),this.map.get(n)||null}keys(){return this.init(),Array.from(this.map.keys())}append(n,t){return this.clone({param:n,value:t,op:"a"})}appendAll(n){const t=[];return Object.keys(n).forEach(i=>{const r=n[i];Array.isArray(r)?r.forEach(c=>{t.push({param:i,value:c,op:"a"})}):t.push({param:i,value:r,op:"a"})}),this.clone(t)}set(n,t){return this.clone({param:n,value:t,op:"s"})}delete(n,t){return this.clone({param:n,value:t,op:"d"})}toString(){return this.init(),this.keys().map(n=>{const t=this.encoder.encodeKey(n);return this.map.get(n).map(i=>t+"="+this.encoder.encodeValue(i)).join("&")}).filter(n=>""!==n).join("&")}clone(n){const t=new wu({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(n),t}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(n=>this.map.set(n,this.cloneFrom.map.get(n))),this.updates.forEach(n=>{switch(n.op){case"a":case"s":const t=("a"===n.op?this.map.get(n.param):void 0)||[];t.push(ay(n.value)),this.map.set(n.param,t);break;case"d":if(void 0===n.value){this.map.delete(n.param);break}{let i=this.map.get(n.param)||[];const r=i.indexOf(ay(n.value));-1!==r&&i.splice(r,1),i.length>0?this.map.set(n.param,i):this.map.delete(n.param)}}}),this.cloneFrom=this.updates=null)}}class vV{constructor(){this.map=new Map}set(n,t){return this.map.set(n,t),this}get(n){return this.map.has(n)||this.map.set(n,n.defaultValue()),this.map.get(n)}delete(n){return this.map.delete(n),this}has(n){return this.map.has(n)}keys(){return this.map.keys()}}function oM(e){return typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer}function aM(e){return typeof Blob<"u"&&e instanceof Blob}function lM(e){return typeof FormData<"u"&&e instanceof FormData}class fm{constructor(n,t,i,r){let c;if(this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=n.toUpperCase(),function bV(e){switch(e){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||r?(this.body=void 0!==i?i:null,c=r):c=i,c&&(this.reportProgress=!!c.reportProgress,this.withCredentials=!!c.withCredentials,c.responseType&&(this.responseType=c.responseType),c.headers&&(this.headers=c.headers),c.context&&(this.context=c.context),c.params&&(this.params=c.params)),this.headers||(this.headers=new Tl),this.context||(this.context=new vV),this.params){const h=this.params.toString();if(0===h.length)this.urlWithParams=t;else{const y=t.indexOf("?");this.urlWithParams=t+(-1===y?"?":y<t.length-1?"&":"")+h}}else this.params=new wu,this.urlWithParams=t}serializeBody(){return null===this.body?null:oM(this.body)||aM(this.body)||lM(this.body)||function xV(e){return typeof URLSearchParams<"u"&&e instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof wu?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||lM(this.body)?null:aM(this.body)?this.body.type||null:oM(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof wu?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(n={}){const t=n.method||this.method,i=n.url||this.url,r=n.responseType||this.responseType,c=void 0!==n.body?n.body:this.body,h=void 0!==n.withCredentials?n.withCredentials:this.withCredentials,y=void 0!==n.reportProgress?n.reportProgress:this.reportProgress;let w=n.headers||this.headers,I=n.params||this.params;const P=n.context??this.context;return void 0!==n.setHeaders&&(w=Object.keys(n.setHeaders).reduce((z,G)=>z.set(G,n.setHeaders[G]),w)),n.setParams&&(I=Object.keys(n.setParams).reduce((z,G)=>z.set(G,n.setParams[G]),I)),new fm(t,i,c,{params:I,headers:w,context:P,reportProgress:y,responseType:r,withCredentials:h})}}var up=function(e){return e[e.Sent=0]="Sent",e[e.UploadProgress=1]="UploadProgress",e[e.ResponseHeader=2]="ResponseHeader",e[e.DownloadProgress=3]="DownloadProgress",e[e.Response=4]="Response",e[e.User=5]="User",e}(up||{});class ox{constructor(n,t=200,i="OK"){this.headers=n.headers||new Tl,this.status=void 0!==n.status?n.status:t,this.statusText=n.statusText||i,this.url=n.url||null,this.ok=this.status>=200&&this.status<300}}class ax extends ox{constructor(n={}){super(n),this.type=up.ResponseHeader}clone(n={}){return new ax({headers:n.headers||this.headers,status:void 0!==n.status?n.status:this.status,statusText:n.statusText||this.statusText,url:n.url||this.url||void 0})}}class dp extends ox{constructor(n={}){super(n),this.type=up.Response,this.body=void 0!==n.body?n.body:null}clone(n={}){return new dp({body:void 0!==n.body?n.body:this.body,headers:n.headers||this.headers,status:void 0!==n.status?n.status:this.status,statusText:n.statusText||this.statusText,url:n.url||this.url||void 0})}}class cM extends ox{constructor(n){super(n,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${n.url||"(unknown url)"}`:`Http failure response for ${n.url||"(unknown url)"}: ${n.status} ${n.statusText}`,this.error=n.error||null}}function lx(e,n){return{body:n,headers:e.headers,context:e.context,observe:e.observe,params:e.params,reportProgress:e.reportProgress,responseType:e.responseType,withCredentials:e.withCredentials}}let uM=(()=>{class e{constructor(t){this.handler=t}request(t,i,r={}){let c;if(t instanceof fm)c=t;else{let w,I;w=r.headers instanceof Tl?r.headers:new Tl(r.headers),r.params&&(I=r.params instanceof wu?r.params:new wu({fromObject:r.params})),c=new fm(t,i,void 0!==r.body?r.body:null,{headers:w,context:r.context,params:I,reportProgress:r.reportProgress,responseType:r.responseType||"json",withCredentials:r.withCredentials})}const h=Et(c).pipe(cp(w=>this.handler.handle(w)));if(t instanceof fm||"events"===r.observe)return h;const y=h.pipe(Mo(w=>w instanceof dp));switch(r.observe||"body"){case"body":switch(c.responseType){case"arraybuffer":return y.pipe(Ft(w=>{if(null!==w.body&&!(w.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return w.body}));case"blob":return y.pipe(Ft(w=>{if(null!==w.body&&!(w.body instanceof Blob))throw new Error("Response is not a Blob.");return w.body}));case"text":return y.pipe(Ft(w=>{if(null!==w.body&&"string"!=typeof w.body)throw new Error("Response is not a string.");return w.body}));default:return y.pipe(Ft(w=>w.body))}case"response":return y;default:throw new Error(`Unreachable: unhandled observe type ${r.observe}}`)}}delete(t,i={}){return this.request("DELETE",t,i)}get(t,i={}){return this.request("GET",t,i)}head(t,i={}){return this.request("HEAD",t,i)}jsonp(t,i){return this.request("JSONP",t,{params:(new wu).append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,i={}){return this.request("OPTIONS",t,i)}patch(t,i,r={}){return this.request("PATCH",t,lx(r,i))}post(t,i,r={}){return this.request("POST",t,lx(r,i))}put(t,i,r={}){return this.request("PUT",t,lx(r,i))}static#e=this.\u0275fac=function(i){return new(i||e)(nt(sy))};static#t=this.\u0275prov=ct({token:e,factory:e.\u0275fac})}return e})();function pM(e,n){return n(e)}function CV(e,n){return(t,i)=>n.intercept(t,{handle:r=>e(r,i)})}const DV=new Xe(""),mm=new Xe(""),fM=new Xe("");function IV(){let e=null;return(n,t)=>{null===e&&(e=(Ke(DV,{optional:!0})??[]).reduceRight(CV,pM));const i=Ke(y_),r=i.add();return e(n,t).pipe(pm(()=>i.remove(r)))}}let mM=(()=>{class e extends sy{constructor(t,i){super(),this.backend=t,this.injector=i,this.chain=null,this.pendingTasks=Ke(y_)}handle(t){if(null===this.chain){const r=Array.from(new Set([...this.injector.get(mm),...this.injector.get(fM,[])]));this.chain=r.reduceRight((c,h)=>function EV(e,n,t){return(i,r)=>t.runInContext(()=>n(i,c=>e(c,r)))}(c,h,this.injector),pM)}const i=this.pendingTasks.add();return this.chain(t,r=>this.backend.handle(r)).pipe(pm(()=>this.pendingTasks.remove(i)))}static#e=this.\u0275fac=function(i){return new(i||e)(nt(oy),nt(Co))};static#t=this.\u0275prov=ct({token:e,factory:e.\u0275fac})}return e})();const AV=/^\)\]\}',?\n/;let _M=(()=>{class e{constructor(t){this.xhrFactory=t}handle(t){if("JSONP"===t.method)throw new Pe(-2800,!1);const i=this.xhrFactory;return(i.\u0275loadImpl?Qn(i.\u0275loadImpl()):Et(null)).pipe(lr(()=>new Ln(c=>{const h=i.build();if(h.open(t.method,t.urlWithParams),t.withCredentials&&(h.withCredentials=!0),t.headers.forEach((ge,Ie)=>h.setRequestHeader(ge,Ie.join(","))),t.headers.has("Accept")||h.setRequestHeader("Accept","application/json, text/plain, */*"),!t.headers.has("Content-Type")){const ge=t.detectContentTypeHeader();null!==ge&&h.setRequestHeader("Content-Type",ge)}if(t.responseType){const ge=t.responseType.toLowerCase();h.responseType="json"!==ge?ge:"text"}const y=t.serializeBody();let w=null;const I=()=>{if(null!==w)return w;const ge=h.statusText||"OK",Ie=new Tl(h.getAllResponseHeaders()),Fe=function kV(e){return"responseURL"in e&&e.responseURL?e.responseURL:/^X-Request-URL:/m.test(e.getAllResponseHeaders())?e.getResponseHeader("X-Request-URL"):null}(h)||t.url;return w=new ax({headers:Ie,status:h.status,statusText:ge,url:Fe}),w},P=()=>{let{headers:ge,status:Ie,statusText:Fe,url:Ce}=I(),at=null;204!==Ie&&(at=typeof h.response>"u"?h.responseText:h.response),0===Ie&&(Ie=at?200:0);let Tt=Ie>=200&&Ie<300;if("json"===t.responseType&&"string"==typeof at){const Yt=at;at=at.replace(AV,"");try{at=""!==at?JSON.parse(at):null}catch(Vr){at=Yt,Tt&&(Tt=!1,at={error:Vr,text:at})}}Tt?(c.next(new dp({body:at,headers:ge,status:Ie,statusText:Fe,url:Ce||void 0})),c.complete()):c.error(new cM({error:at,headers:ge,status:Ie,statusText:Fe,url:Ce||void 0}))},z=ge=>{const{url:Ie}=I(),Fe=new cM({error:ge,status:h.status||0,statusText:h.statusText||"Unknown Error",url:Ie||void 0});c.error(Fe)};let G=!1;const re=ge=>{G||(c.next(I()),G=!0);let Ie={type:up.DownloadProgress,loaded:ge.loaded};ge.lengthComputable&&(Ie.total=ge.total),"text"===t.responseType&&h.responseText&&(Ie.partialText=h.responseText),c.next(Ie)},fe=ge=>{let Ie={type:up.UploadProgress,loaded:ge.loaded};ge.lengthComputable&&(Ie.total=ge.total),c.next(Ie)};return h.addEventListener("load",P),h.addEventListener("error",z),h.addEventListener("timeout",z),h.addEventListener("abort",z),t.reportProgress&&(h.addEventListener("progress",re),null!==y&&h.upload&&h.upload.addEventListener("progress",fe)),h.send(y),c.next({type:up.Sent}),()=>{h.removeEventListener("error",z),h.removeEventListener("abort",z),h.removeEventListener("load",P),h.removeEventListener("timeout",z),t.reportProgress&&(h.removeEventListener("progress",re),null!==y&&h.upload&&h.upload.removeEventListener("progress",fe)),h.readyState!==h.DONE&&h.abort()}})))}static#e=this.\u0275fac=function(i){return new(i||e)(nt(GD))};static#t=this.\u0275prov=ct({token:e,factory:e.\u0275fac})}return e})();const cx=new Xe("XSRF_ENABLED"),yM=new Xe("XSRF_COOKIE_NAME",{providedIn:"root",factory:()=>"XSRF-TOKEN"}),vM=new Xe("XSRF_HEADER_NAME",{providedIn:"root",factory:()=>"X-XSRF-TOKEN"});class bM{}let OV=(()=>{class e{constructor(t,i,r){this.doc=t,this.platform=i,this.cookieName=r,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=FD(t,this.cookieName),this.lastCookieString=t),this.lastToken}static#e=this.\u0275fac=function(i){return new(i||e)(nt(ps),nt(du),nt(yM))};static#t=this.\u0275prov=ct({token:e,factory:e.\u0275fac})}return e})();function FV(e,n){const t=e.url.toLowerCase();if(!Ke(cx)||"GET"===e.method||"HEAD"===e.method||t.startsWith("http://")||t.startsWith("https://"))return n(e);const i=Ke(bM).getToken(),r=Ke(vM);return null!=i&&!e.headers.has(r)&&(e=e.clone({headers:e.headers.set(r,i)})),n(e)}var Cu=function(e){return e[e.Interceptors=0]="Interceptors",e[e.LegacyInterceptors=1]="LegacyInterceptors",e[e.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",e[e.NoXsrfProtection=3]="NoXsrfProtection",e[e.JsonpSupport=4]="JsonpSupport",e[e.RequestsMadeViaParent=5]="RequestsMadeViaParent",e[e.Fetch=6]="Fetch",e}(Cu||{});function LV(...e){const n=[uM,_M,mM,{provide:sy,useExisting:mM},{provide:oy,useExisting:_M},{provide:mm,useValue:FV,multi:!0},{provide:cx,useValue:!0},{provide:bM,useClass:OV}];for(const t of e)n.push(...t.\u0275providers);return function _v(e){return{\u0275providers:e}}(n)}const xM=new Xe("LEGACY_INTERCEPTOR_FN");function NV(){return function Rd(e,n){return{\u0275kind:e,\u0275providers:n}}(Cu.LegacyInterceptors,[{provide:xM,useFactory:IV},{provide:mm,useExisting:xM,multi:!0}])}let zV=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=Ni({type:e});static#n=this.\u0275inj=Fi({providers:[LV(NV())]})}return e})();function wM(e){return new Ln(n=>{Ee(e()).subscribe(n)})}function gm(e,n){const t=Jt(e)?e:()=>e,i=r=>r.error(t());return new Ln(n?r=>n.schedule(i,0,r):i)}function ux(){return Vn((e,n)=>{let t=null;e._refCount++;const i=_n(n,void 0,void 0,void 0,()=>{if(!e||e._refCount<=0||0<--e._refCount)return void(t=null);const r=e._connection,c=t;t=null,r&&(!c||r===c)&&r.unsubscribe(),n.unsubscribe()});e.subscribe(i),i.closed||(t=e.connect())})}class CM extends Ln{constructor(n,t){super(),this.source=n,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,Oo(n)&&(this.lift=n.lift)}_subscribe(n){return this.getSubject().subscribe(n)}getSubject(){const n=this._subject;return(!n||n.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:n}=this;this._subject=this._connection=null,n?.unsubscribe()}connect(){let n=this._connection;if(!n){n=this._connection=new mn;const t=this.getSubject();n.add(this.source.subscribe(_n(t,void 0,()=>{this._teardown(),t.complete()},i=>{this._teardown(),t.error(i)},()=>this._teardown()))),n.closed&&(this._connection=null,n=mn.EMPTY)}return n}refCount(){return ux()(this)}}function ms(e,n,t){const i=Jt(e)||n||t?{next:e,error:n,complete:t}:e;return i?Vn((r,c)=>{var h;null===(h=i.subscribe)||void 0===h||h.call(i);let y=!0;r.subscribe(_n(c,w=>{var I;null===(I=i.next)||void 0===I||I.call(i,w),c.next(w)},()=>{var w;y=!1,null===(w=i.complete)||void 0===w||w.call(i),c.complete()},w=>{var I;y=!1,null===(I=i.error)||void 0===I||I.call(i,w),c.error(w)},()=>{var w,I;y&&(null===(w=i.unsubscribe)||void 0===w||w.call(i)),null===(I=i.finalize)||void 0===I||I.call(i)}))}):jr}function Od(e){return Vn((n,t)=>{let c,i=null,r=!1;i=n.subscribe(_n(t,void 0,void 0,h=>{c=Ee(e(h,Od(e)(n))),i?(i.unsubscribe(),i=null,c.subscribe(t)):r=!0})),r&&(i.unsubscribe(),i=null,c.subscribe(t))})}function dx(e){return e<=0?()=>bn:Vn((n,t)=>{let i=[];n.subscribe(_n(t,r=>{i.push(r),e<i.length&&i.shift()},()=>{for(const r of i)t.next(r);t.complete()},void 0,()=>{i=null}))})}const Gt="primary",_m=Symbol("RouteTitle");class XV{constructor(n){this.params=n||{}}has(n){return Object.prototype.hasOwnProperty.call(this.params,n)}get(n){if(this.has(n)){const t=this.params[n];return Array.isArray(t)?t[0]:t}return null}getAll(n){if(this.has(n)){const t=this.params[n];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function hp(e){return new XV(e)}function KV(e,n,t){const i=t.path.split("/");if(i.length>e.length||"full"===t.pathMatch&&(n.hasChildren()||i.length<e.length))return null;const r={};for(let c=0;c<i.length;c++){const h=i[c],y=e[c];if(h.startsWith(":"))r[h.substring(1)]=y;else if(h!==y.path)return null}return{consumed:e.slice(0,i.length),posParams:r}}function Al(e,n){const t=e?Object.keys(e):void 0,i=n?Object.keys(n):void 0;if(!t||!i||t.length!=i.length)return!1;let r;for(let c=0;c<t.length;c++)if(r=t[c],!EM(e[r],n[r]))return!1;return!0}function EM(e,n){if(Array.isArray(e)&&Array.isArray(n)){if(e.length!==n.length)return!1;const t=[...e].sort(),i=[...n].sort();return t.every((r,c)=>i[c]===r)}return e===n}function DM(e){return e.length>0?e[e.length-1]:null}function Eu(e){return function HV(e){return!!e&&(e instanceof Ln||Jt(e.lift)&&Jt(e.subscribe))}(e)?e:Lf(e)?Qn(Promise.resolve(e)):Et(e)}const JV={exact:function MM(e,n,t){if(!Fd(e.segments,n.segments)||!cy(e.segments,n.segments,t)||e.numberOfChildren!==n.numberOfChildren)return!1;for(const i in n.children)if(!e.children[i]||!MM(e.children[i],n.children[i],t))return!1;return!0},subset:TM},IM={exact:function QV(e,n){return Al(e,n)},subset:function eU(e,n){return Object.keys(n).length<=Object.keys(e).length&&Object.keys(n).every(t=>EM(e[t],n[t]))},ignored:()=>!0};function SM(e,n,t){return JV[t.paths](e.root,n.root,t.matrixParams)&&IM[t.queryParams](e.queryParams,n.queryParams)&&!("exact"===t.fragment&&e.fragment!==n.fragment)}function TM(e,n,t){return AM(e,n,n.segments,t)}function AM(e,n,t,i){if(e.segments.length>t.length){const r=e.segments.slice(0,t.length);return!(!Fd(r,t)||n.hasChildren()||!cy(r,t,i))}if(e.segments.length===t.length){if(!Fd(e.segments,t)||!cy(e.segments,t,i))return!1;for(const r in n.children)if(!e.children[r]||!TM(e.children[r],n.children[r],i))return!1;return!0}{const r=t.slice(0,e.segments.length),c=t.slice(e.segments.length);return!!(Fd(e.segments,r)&&cy(e.segments,r,i)&&e.children[Gt])&&AM(e.children[Gt],n,c,i)}}function cy(e,n,t){return n.every((i,r)=>IM[t](e[r].parameters,i.parameters))}class pp{constructor(n=new Hn([],{}),t={},i=null){this.root=n,this.queryParams=t,this.fragment=i}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=hp(this.queryParams)),this._queryParamMap}toString(){return iU.serialize(this)}}class Hn{constructor(n,t){this.segments=n,this.children=t,this.parent=null,Object.values(t).forEach(i=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return uy(this)}}class ym{constructor(n,t){this.path=n,this.parameters=t}get parameterMap(){return this._parameterMap||(this._parameterMap=hp(this.parameters)),this._parameterMap}toString(){return RM(this)}}function Fd(e,n){return e.length===n.length&&e.every((t,i)=>t.path===n[i].path)}let vm=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=ct({token:e,factory:function(){return new hx},providedIn:"root"})}return e})();class hx{parse(n){const t=new fU(n);return new pp(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(n){const t=`/${bm(n.root,!0)}`,i=function oU(e){const n=Object.keys(e).map(t=>{const i=e[t];return Array.isArray(i)?i.map(r=>`${dy(t)}=${dy(r)}`).join("&"):`${dy(t)}=${dy(i)}`}).filter(t=>!!t);return n.length?`?${n.join("&")}`:""}(n.queryParams);return`${t}${i}${"string"==typeof n.fragment?`#${function rU(e){return encodeURI(e)}(n.fragment)}`:""}`}}const iU=new hx;function uy(e){return e.segments.map(n=>RM(n)).join("/")}function bm(e,n){if(!e.hasChildren())return uy(e);if(n){const t=e.children[Gt]?bm(e.children[Gt],!1):"",i=[];return Object.entries(e.children).forEach(([r,c])=>{r!==Gt&&i.push(`${r}:${bm(c,!1)}`)}),i.length>0?`${t}(${i.join("//")})`:t}{const t=function nU(e,n){let t=[];return Object.entries(e.children).forEach(([i,r])=>{i===Gt&&(t=t.concat(n(r,i)))}),Object.entries(e.children).forEach(([i,r])=>{i!==Gt&&(t=t.concat(n(r,i)))}),t}(e,(i,r)=>r===Gt?[bm(e.children[Gt],!1)]:[`${r}:${bm(i,!1)}`]);return 1===Object.keys(e.children).length&&null!=e.children[Gt]?`${uy(e)}/${t[0]}`:`${uy(e)}/(${t.join("//")})`}}function kM(e){return encodeURIComponent(e).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function dy(e){return kM(e).replace(/%3B/gi,";")}function px(e){return kM(e).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function hy(e){return decodeURIComponent(e)}function PM(e){return hy(e.replace(/\+/g,"%20"))}function RM(e){return`${px(e.path)}${function sU(e){return Object.keys(e).map(n=>`;${px(n)}=${px(e[n])}`).join("")}(e.parameters)}`}const aU=/^[^\/()?;#]+/;function fx(e){const n=e.match(aU);return n?n[0]:""}const lU=/^[^\/()?;=#]+/,uU=/^[^=?&#]+/,hU=/^[^&#]+/;class fU{constructor(n){this.url=n,this.remaining=n}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Hn([],{}):new Hn([],this.parseChildren())}parseQueryParams(){const n={};if(this.consumeOptional("?"))do{this.parseQueryParam(n)}while(this.consumeOptional("&"));return n}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const n=[];for(this.peekStartsWith("(")||n.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),n.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(n.length>0||Object.keys(t).length>0)&&(i[Gt]=new Hn(n,t)),i}parseSegment(){const n=fx(this.remaining);if(""===n&&this.peekStartsWith(";"))throw new Pe(4009,!1);return this.capture(n),new ym(hy(n),this.parseMatrixParams())}parseMatrixParams(){const n={};for(;this.consumeOptional(";");)this.parseParam(n);return n}parseParam(n){const t=function cU(e){const n=e.match(lU);return n?n[0]:""}(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const r=fx(this.remaining);r&&(i=r,this.capture(i))}n[hy(t)]=hy(i)}parseQueryParam(n){const t=function dU(e){const n=e.match(uU);return n?n[0]:""}(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const h=function pU(e){const n=e.match(hU);return n?n[0]:""}(this.remaining);h&&(i=h,this.capture(i))}const r=PM(t),c=PM(i);if(n.hasOwnProperty(r)){let h=n[r];Array.isArray(h)||(h=[h],n[r]=h),h.push(c)}else n[r]=c}parseParens(n){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const i=fx(this.remaining),r=this.remaining[i.length];if("/"!==r&&")"!==r&&";"!==r)throw new Pe(4010,!1);let c;i.indexOf(":")>-1?(c=i.slice(0,i.indexOf(":")),this.capture(c),this.capture(":")):n&&(c=Gt);const h=this.parseChildren();t[c]=1===Object.keys(h).length?h[Gt]:new Hn([],h),this.consumeOptional("//")}return t}peekStartsWith(n){return this.remaining.startsWith(n)}consumeOptional(n){return!!this.peekStartsWith(n)&&(this.remaining=this.remaining.substring(n.length),!0)}capture(n){if(!this.consumeOptional(n))throw new Pe(4011,!1)}}function OM(e){return e.segments.length>0?new Hn([],{[Gt]:e}):e}function FM(e){const n={};for(const i of Object.keys(e.children)){const c=FM(e.children[i]);if(i===Gt&&0===c.segments.length&&c.hasChildren())for(const[h,y]of Object.entries(c.children))n[h]=y;else(c.segments.length>0||c.hasChildren())&&(n[i]=c)}return function mU(e){if(1===e.numberOfChildren&&e.children[Gt]){const n=e.children[Gt];return new Hn(e.segments.concat(n.segments),n.children)}return e}(new Hn(e.segments,n))}function Ld(e){return e instanceof pp}function LM(e){let n;const r=OM(function t(c){const h={};for(const w of c.children){const I=t(w);h[w.outlet]=I}const y=new Hn(c.url,h);return c===e&&(n=y),y}(e.root));return n??r}function NM(e,n,t,i){let r=e;for(;r.parent;)r=r.parent;if(0===n.length)return mx(r,r,r,t,i);const c=function _U(e){if("string"==typeof e[0]&&1===e.length&&"/"===e[0])return new BM(!0,0,e);let n=0,t=!1;const i=e.reduce((r,c,h)=>{if("object"==typeof c&&null!=c){if(c.outlets){const y={};return Object.entries(c.outlets).forEach(([w,I])=>{y[w]="string"==typeof I?I.split("/"):I}),[...r,{outlets:y}]}if(c.segmentPath)return[...r,c.segmentPath]}return"string"!=typeof c?[...r,c]:0===h?(c.split("/").forEach((y,w)=>{0==w&&"."===y||(0==w&&""===y?t=!0:".."===y?n++:""!=y&&r.push(y))}),r):[...r,c]},[]);return new BM(t,n,i)}(n);if(c.toRoot())return mx(r,r,new Hn([],{}),t,i);const h=function yU(e,n,t){if(e.isAbsolute)return new fy(n,!0,0);if(!t)return new fy(n,!1,NaN);if(null===t.parent)return new fy(t,!0,0);const i=py(e.commands[0])?0:1;return function vU(e,n,t){let i=e,r=n,c=t;for(;c>r;){if(c-=r,i=i.parent,!i)throw new Pe(4005,!1);r=i.segments.length}return new fy(i,!1,r-c)}(t,t.segments.length-1+i,e.numberOfDoubleDots)}(c,r,e),y=h.processChildren?wm(h.segmentGroup,h.index,c.commands):VM(h.segmentGroup,h.index,c.commands);return mx(r,h.segmentGroup,y,t,i)}function py(e){return"object"==typeof e&&null!=e&&!e.outlets&&!e.segmentPath}function xm(e){return"object"==typeof e&&null!=e&&e.outlets}function mx(e,n,t,i,r){let h,c={};i&&Object.entries(i).forEach(([w,I])=>{c[w]=Array.isArray(I)?I.map(P=>`${P}`):`${I}`}),h=e===n?t:zM(e,n,t);const y=OM(FM(h));return new pp(y,c,r)}function zM(e,n,t){const i={};return Object.entries(e.children).forEach(([r,c])=>{i[r]=c===n?t:zM(c,n,t)}),new Hn(e.segments,i)}class BM{constructor(n,t,i){if(this.isAbsolute=n,this.numberOfDoubleDots=t,this.commands=i,n&&i.length>0&&py(i[0]))throw new Pe(4003,!1);const r=i.find(xm);if(r&&r!==DM(i))throw new Pe(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class fy{constructor(n,t,i){this.segmentGroup=n,this.processChildren=t,this.index=i}}function VM(e,n,t){if(e||(e=new Hn([],{})),0===e.segments.length&&e.hasChildren())return wm(e,n,t);const i=function xU(e,n,t){let i=0,r=n;const c={match:!1,pathIndex:0,commandIndex:0};for(;r<e.segments.length;){if(i>=t.length)return c;const h=e.segments[r],y=t[i];if(xm(y))break;const w=`${y}`,I=i<t.length-1?t[i+1]:null;if(r>0&&void 0===w)break;if(w&&I&&"object"==typeof I&&void 0===I.outlets){if(!jM(w,I,h))return c;i+=2}else{if(!jM(w,{},h))return c;i++}r++}return{match:!0,pathIndex:r,commandIndex:i}}(e,n,t),r=t.slice(i.commandIndex);if(i.match&&i.pathIndex<e.segments.length){const c=new Hn(e.segments.slice(0,i.pathIndex),{});return c.children[Gt]=new Hn(e.segments.slice(i.pathIndex),e.children),wm(c,0,r)}return i.match&&0===r.length?new Hn(e.segments,{}):i.match&&!e.hasChildren()?gx(e,n,t):i.match?wm(e,0,r):gx(e,n,t)}function wm(e,n,t){if(0===t.length)return new Hn(e.segments,{});{const i=function bU(e){return xm(e[0])?e[0].outlets:{[Gt]:e}}(t),r={};if(Object.keys(i).some(c=>c!==Gt)&&e.children[Gt]&&1===e.numberOfChildren&&0===e.children[Gt].segments.length){const c=wm(e.children[Gt],n,t);return new Hn(e.segments,c.children)}return Object.entries(i).forEach(([c,h])=>{"string"==typeof h&&(h=[h]),null!==h&&(r[c]=VM(e.children[c],n,h))}),Object.entries(e.children).forEach(([c,h])=>{void 0===i[c]&&(r[c]=h)}),new Hn(e.segments,r)}}function gx(e,n,t){const i=e.segments.slice(0,n);let r=0;for(;r<t.length;){const c=t[r];if(xm(c)){const w=wU(c.outlets);return new Hn(i,w)}if(0===r&&py(t[0])){i.push(new ym(e.segments[n].path,UM(t[0]))),r++;continue}const h=xm(c)?c.outlets[Gt]:`${c}`,y=r<t.length-1?t[r+1]:null;h&&y&&py(y)?(i.push(new ym(h,UM(y))),r+=2):(i.push(new ym(h,{})),r++)}return new Hn(i,{})}function wU(e){const n={};return Object.entries(e).forEach(([t,i])=>{"string"==typeof i&&(i=[i]),null!==i&&(n[t]=gx(new Hn([],{}),0,i))}),n}function UM(e){const n={};return Object.entries(e).forEach(([t,i])=>n[t]=`${i}`),n}function jM(e,n,t){return e==t.path&&Al(n,t.parameters)}const Cm="imperative";class kl{constructor(n,t){this.id=n,this.url=t}}class my extends kl{constructor(n,t,i="imperative",r=null){super(n,t),this.type=0,this.navigationTrigger=i,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Du extends kl{constructor(n,t,i){super(n,t),this.urlAfterRedirects=i,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class Em extends kl{constructor(n,t,i,r){super(n,t),this.reason=i,this.code=r,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class fp extends kl{constructor(n,t,i,r){super(n,t),this.reason=i,this.code=r,this.type=16}}class gy extends kl{constructor(n,t,i,r){super(n,t),this.error=i,this.target=r,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class $M extends kl{constructor(n,t,i,r){super(n,t),this.urlAfterRedirects=i,this.state=r,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class CU extends kl{constructor(n,t,i,r){super(n,t),this.urlAfterRedirects=i,this.state=r,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class EU extends kl{constructor(n,t,i,r,c){super(n,t),this.urlAfterRedirects=i,this.state=r,this.shouldActivate=c,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class DU extends kl{constructor(n,t,i,r){super(n,t),this.urlAfterRedirects=i,this.state=r,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class IU extends kl{constructor(n,t,i,r){super(n,t),this.urlAfterRedirects=i,this.state=r,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class SU{constructor(n){this.route=n,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class MU{constructor(n){this.route=n,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class TU{constructor(n){this.snapshot=n,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class AU{constructor(n){this.snapshot=n,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class kU{constructor(n){this.snapshot=n,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class PU{constructor(n){this.snapshot=n,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class HM{constructor(n,t,i){this.routerEvent=n,this.position=t,this.anchor=i,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class _x{}class yx{constructor(n){this.url=n}}class RU{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new Dm,this.attachRef=null}}let Dm=(()=>{class e{constructor(){this.contexts=new Map}onChildOutletCreated(t,i){const r=this.getOrCreateContext(t);r.outlet=i,this.contexts.set(t,r)}onChildOutletDestroyed(t){const i=this.getContext(t);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){const t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let i=this.getContext(t);return i||(i=new RU,this.contexts.set(t,i)),i}getContext(t){return this.contexts.get(t)||null}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=ct({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();class GM{constructor(n){this._root=n}get root(){return this._root.value}parent(n){const t=this.pathFromRoot(n);return t.length>1?t[t.length-2]:null}children(n){const t=vx(n,this._root);return t?t.children.map(i=>i.value):[]}firstChild(n){const t=vx(n,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(n){const t=bx(n,this._root);return t.length<2?[]:t[t.length-2].children.map(r=>r.value).filter(r=>r!==n)}pathFromRoot(n){return bx(n,this._root).map(t=>t.value)}}function vx(e,n){if(e===n.value)return n;for(const t of n.children){const i=vx(e,t);if(i)return i}return null}function bx(e,n){if(e===n.value)return[n];for(const t of n.children){const i=bx(e,t);if(i.length)return i.unshift(n),i}return[]}class _c{constructor(n,t){this.value=n,this.children=t}toString(){return`TreeNode(${this.value})`}}function mp(e){const n={};return e&&e.children.forEach(t=>n[t.value.outlet]=t),n}class qM extends GM{constructor(n,t){super(n),this.snapshot=t,xx(this,n)}toString(){return this.snapshot.toString()}}function ZM(e,n){const t=function OU(e,n){const h=new _y([],{},{},"",{},Gt,n,null,{});return new XM("",new _c(h,[]))}(0,n),i=new _r([new ym("",{})]),r=new _r({}),c=new _r({}),h=new _r({}),y=new _r(""),w=new Nd(i,r,h,y,c,Gt,n,t.root);return w.snapshot=t.root,new qM(new _c(w,[]),t)}class Nd{constructor(n,t,i,r,c,h,y,w){this.urlSubject=n,this.paramsSubject=t,this.queryParamsSubject=i,this.fragmentSubject=r,this.dataSubject=c,this.outlet=h,this.component=y,this._futureSnapshot=w,this.title=this.dataSubject?.pipe(Ft(I=>I[_m]))??Et(void 0),this.url=n,this.params=t,this.queryParams=i,this.fragment=r,this.data=c}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(Ft(n=>hp(n)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(Ft(n=>hp(n)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function WM(e,n="emptyOnly"){const t=e.pathFromRoot;let i=0;if("always"!==n)for(i=t.length-1;i>=1;){const r=t[i],c=t[i-1];if(r.routeConfig&&""===r.routeConfig.path)i--;else{if(c.component)break;i--}}return function FU(e){return e.reduce((n,t)=>({params:{...n.params,...t.params},data:{...n.data,...t.data},resolve:{...t.data,...n.resolve,...t.routeConfig?.data,...t._resolvedData}}),{params:{},data:{},resolve:{}})}(t.slice(i))}class _y{get title(){return this.data?.[_m]}constructor(n,t,i,r,c,h,y,w,I){this.url=n,this.params=t,this.queryParams=i,this.fragment=r,this.data=c,this.outlet=h,this.component=y,this.routeConfig=w,this._resolve=I}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=hp(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=hp(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(i=>i.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class XM extends GM{constructor(n,t){super(t),this.url=n,xx(this,t)}toString(){return KM(this._root)}}function xx(e,n){n.value._routerState=e,n.children.forEach(t=>xx(e,t))}function KM(e){const n=e.children.length>0?` { ${e.children.map(KM).join(", ")} } `:"";return`${e.value}${n}`}function wx(e){if(e.snapshot){const n=e.snapshot,t=e._futureSnapshot;e.snapshot=t,Al(n.queryParams,t.queryParams)||e.queryParamsSubject.next(t.queryParams),n.fragment!==t.fragment&&e.fragmentSubject.next(t.fragment),Al(n.params,t.params)||e.paramsSubject.next(t.params),function YV(e,n){if(e.length!==n.length)return!1;for(let t=0;t<e.length;++t)if(!Al(e[t],n[t]))return!1;return!0}(n.url,t.url)||e.urlSubject.next(t.url),Al(n.data,t.data)||e.dataSubject.next(t.data)}else e.snapshot=e._futureSnapshot,e.dataSubject.next(e._futureSnapshot.data)}function Cx(e,n){const t=Al(e.params,n.params)&&function tU(e,n){return Fd(e,n)&&e.every((t,i)=>Al(t.parameters,n[i].parameters))}(e.url,n.url);return t&&!(!e.parent!=!n.parent)&&(!e.parent||Cx(e.parent,n.parent))}let Ex=(()=>{class e{constructor(){this.activated=null,this._activatedRoute=null,this.name=Gt,this.activateEvents=new Ve,this.deactivateEvents=new Ve,this.attachEvents=new Ve,this.detachEvents=new Ve,this.parentContexts=Ke(Dm),this.location=Ke($a),this.changeDetector=Ke(fu),this.environmentInjector=Ke(Co),this.inputBinder=Ke(yy,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(t){if(t.name){const{firstChange:i,previousValue:r}=t.name;if(i)return;this.isTrackedInParentContexts(r)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(r)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Pe(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Pe(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Pe(4012,!1);this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,i){this.activated=t,this._activatedRoute=i,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,i){if(this.isActivated)throw new Pe(4013,!1);this._activatedRoute=t;const r=this.location,h=t.snapshot.component,y=this.parentContexts.getOrCreateContext(this.name).children,w=new LU(t,y,r.injector);this.activated=r.createComponent(h,{index:r.length,injector:w,environmentInjector:i??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275dir=xt({type:e,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[Bn]})}return e})();class LU{constructor(n,t,i){this.route=n,this.childContexts=t,this.parent=i}get(n,t){return n===Nd?this.route:n===Dm?this.childContexts:this.parent.get(n,t)}}const yy=new Xe("");let YM=(()=>{class e{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(t){this.unsubscribeFromRouteData(t),this.subscribeToRouteData(t)}unsubscribeFromRouteData(t){this.outletDataSubscriptions.get(t)?.unsubscribe(),this.outletDataSubscriptions.delete(t)}subscribeToRouteData(t){const{activatedRoute:i}=t,r=G_([i.queryParams,i.params,i.data]).pipe(lr(([c,h,y],w)=>(y={...c,...h,...y},0===w?Et(y):Promise.resolve(y)))).subscribe(c=>{if(!t.isActivated||!t.activatedComponentRef||t.activatedRoute!==i||null===i.component)return void this.unsubscribeFromRouteData(t);const h=function bF(e){const n=tn(e);if(!n)return null;const t=new kf(n);return{get selector(){return t.selector},get type(){return t.componentType},get inputs(){return t.inputs},get outputs(){return t.outputs},get ngContentSelectors(){return t.ngContentSelectors},get isStandalone(){return n.standalone},get isSignal(){return n.signals}}}(i.component);if(h)for(const{templateName:y}of h.inputs)t.activatedComponentRef.setInput(y,c[y]);else this.unsubscribeFromRouteData(t)});this.outletDataSubscriptions.set(t,r)}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=ct({token:e,factory:e.\u0275fac})}return e})();function Im(e,n,t){if(t&&e.shouldReuseRoute(n.value,t.value.snapshot)){const i=t.value;i._futureSnapshot=n.value;const r=function zU(e,n,t){return n.children.map(i=>{for(const r of t.children)if(e.shouldReuseRoute(i.value,r.value.snapshot))return Im(e,i,r);return Im(e,i)})}(e,n,t);return new _c(i,r)}{if(e.shouldAttach(n.value)){const c=e.retrieve(n.value);if(null!==c){const h=c.route;return h.value._futureSnapshot=n.value,h.children=n.children.map(y=>Im(e,y)),h}}const i=function BU(e){return new Nd(new _r(e.url),new _r(e.params),new _r(e.queryParams),new _r(e.fragment),new _r(e.data),e.outlet,e.component,e)}(n.value),r=n.children.map(c=>Im(e,c));return new _c(i,r)}}const Dx="ngNavigationCancelingError";function JM(e,n){const{redirectTo:t,navigationBehaviorOptions:i}=Ld(n)?{redirectTo:n,navigationBehaviorOptions:void 0}:n,r=QM(!1,0,n);return r.url=t,r.navigationBehaviorOptions=i,r}function QM(e,n,t){const i=new Error("NavigationCancelingError: "+(e||""));return i[Dx]=!0,i.cancellationCode=n,t&&(i.url=t),i}function eT(e){return e&&e[Dx]}let tT=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275cmp=Nn({type:e,selectors:[["ng-component"]],standalone:!0,features:[JC],decls:1,vars:0,template:function(i,r){1&i&&sn(0,"router-outlet")},dependencies:[Ex],encapsulation:2})}return e})();function Ix(e){const n=e.children&&e.children.map(Ix),t=n?{...e,children:n}:{...e};return!t.component&&!t.loadComponent&&(n||t.loadChildren)&&t.outlet&&t.outlet!==Gt&&(t.component=tT),t}function Wa(e){return e.outlet||Gt}function Sm(e){if(!e)return null;if(e.routeConfig?._injector)return e.routeConfig._injector;for(let n=e.parent;n;n=n.parent){const t=n.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}class ZU{constructor(n,t,i,r,c){this.routeReuseStrategy=n,this.futureState=t,this.currState=i,this.forwardEvent=r,this.inputBindingEnabled=c}activate(n){const t=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,i,n),wx(this.futureState.root),this.activateChildRoutes(t,i,n)}deactivateChildRoutes(n,t,i){const r=mp(t);n.children.forEach(c=>{const h=c.value.outlet;this.deactivateRoutes(c,r[h],i),delete r[h]}),Object.values(r).forEach(c=>{this.deactivateRouteAndItsChildren(c,i)})}deactivateRoutes(n,t,i){const r=n.value,c=t?t.value:null;if(r===c)if(r.component){const h=i.getContext(r.outlet);h&&this.deactivateChildRoutes(n,t,h.children)}else this.deactivateChildRoutes(n,t,i);else c&&this.deactivateRouteAndItsChildren(t,i)}deactivateRouteAndItsChildren(n,t){n.value.component&&this.routeReuseStrategy.shouldDetach(n.value.snapshot)?this.detachAndStoreRouteSubtree(n,t):this.deactivateRouteAndOutlet(n,t)}detachAndStoreRouteSubtree(n,t){const i=t.getContext(n.value.outlet),r=i&&n.value.component?i.children:t,c=mp(n);for(const h of Object.keys(c))this.deactivateRouteAndItsChildren(c[h],r);if(i&&i.outlet){const h=i.outlet.detach(),y=i.children.onOutletDeactivated();this.routeReuseStrategy.store(n.value.snapshot,{componentRef:h,route:n,contexts:y})}}deactivateRouteAndOutlet(n,t){const i=t.getContext(n.value.outlet),r=i&&n.value.component?i.children:t,c=mp(n);for(const h of Object.keys(c))this.deactivateRouteAndItsChildren(c[h],r);i&&(i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated()),i.attachRef=null,i.route=null)}activateChildRoutes(n,t,i){const r=mp(t);n.children.forEach(c=>{this.activateRoutes(c,r[c.value.outlet],i),this.forwardEvent(new PU(c.value.snapshot))}),n.children.length&&this.forwardEvent(new AU(n.value.snapshot))}activateRoutes(n,t,i){const r=n.value,c=t?t.value:null;if(wx(r),r===c)if(r.component){const h=i.getOrCreateContext(r.outlet);this.activateChildRoutes(n,t,h.children)}else this.activateChildRoutes(n,t,i);else if(r.component){const h=i.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){const y=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),h.children.onOutletReAttached(y.contexts),h.attachRef=y.componentRef,h.route=y.route.value,h.outlet&&h.outlet.attach(y.componentRef,y.route.value),wx(y.route.value),this.activateChildRoutes(n,null,h.children)}else{const y=Sm(r.snapshot);h.attachRef=null,h.route=r,h.injector=y,h.outlet&&h.outlet.activateWith(r,h.injector),this.activateChildRoutes(n,null,h.children)}}else this.activateChildRoutes(n,null,i)}}class nT{constructor(n){this.path=n,this.route=this.path[this.path.length-1]}}class vy{constructor(n,t){this.component=n,this.route=t}}function WU(e,n,t){const i=e._root;return Mm(i,n?n._root:null,t,[i.value])}function gp(e,n){const t=Symbol(),i=n.get(e,t);return i===t?"function"!=typeof e||function Dp(e){return null!==Ac(e)}(e)?n.get(e):e:i}function Mm(e,n,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const c=mp(n);return e.children.forEach(h=>{(function KU(e,n,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const c=e.value,h=n?n.value:null,y=t?t.getContext(e.value.outlet):null;if(h&&c.routeConfig===h.routeConfig){const w=function YU(e,n,t){if("function"==typeof t)return t(e,n);switch(t){case"pathParamsChange":return!Fd(e.url,n.url);case"pathParamsOrQueryParamsChange":return!Fd(e.url,n.url)||!Al(e.queryParams,n.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Cx(e,n)||!Al(e.queryParams,n.queryParams);default:return!Cx(e,n)}}(h,c,c.routeConfig.runGuardsAndResolvers);w?r.canActivateChecks.push(new nT(i)):(c.data=h.data,c._resolvedData=h._resolvedData),Mm(e,n,c.component?y?y.children:null:t,i,r),w&&y&&y.outlet&&y.outlet.isActivated&&r.canDeactivateChecks.push(new vy(y.outlet.component,h))}else h&&Tm(n,y,r),r.canActivateChecks.push(new nT(i)),Mm(e,null,c.component?y?y.children:null:t,i,r)})(h,c[h.value.outlet],t,i.concat([h.value]),r),delete c[h.value.outlet]}),Object.entries(c).forEach(([h,y])=>Tm(y,t.getContext(h),r)),r}function Tm(e,n,t){const i=mp(e),r=e.value;Object.entries(i).forEach(([c,h])=>{Tm(h,r.component?n?n.children.getContext(c):null:n,t)}),t.canDeactivateChecks.push(new vy(r.component&&n&&n.outlet&&n.outlet.isActivated?n.outlet.component:null,r))}function Am(e){return"function"==typeof e}function iT(e){return e instanceof tm||"EmptyError"===e?.name}const by=Symbol("INITIAL_VALUE");function _p(){return lr(e=>G_(e.map(n=>n.pipe(Sd(1),k0(by)))).pipe(Ft(n=>{for(const t of n)if(!0!==t){if(t===by)return by;if(!1===t||t instanceof pp)return t}return!0}),Mo(n=>n!==by),Sd(1)))}function rT(e){return function la(...e){return ca(e)}(ms(n=>{if(Ld(n))throw JM(0,n)}),Ft(n=>!0===n))}class xy{constructor(n){this.segmentGroup=n||null}}class sT{constructor(n){this.urlTree=n}}function yp(e){return gm(new xy(e))}function oT(e){return gm(new sT(e))}class y3{constructor(n,t){this.urlSerializer=n,this.urlTree=t}noMatchError(n){return new Pe(4002,!1)}lineralizeSegments(n,t){let i=[],r=t.root;for(;;){if(i=i.concat(r.segments),0===r.numberOfChildren)return Et(i);if(r.numberOfChildren>1||!r.children[Gt])return gm(new Pe(4e3,!1));r=r.children[Gt]}}applyRedirectCommands(n,t,i){return this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),n,i)}applyRedirectCreateUrlTree(n,t,i,r){const c=this.createSegmentGroup(n,t.root,i,r);return new pp(c,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(n,t){const i={};return Object.entries(n).forEach(([r,c])=>{if("string"==typeof c&&c.startsWith(":")){const y=c.substring(1);i[r]=t[y]}else i[r]=c}),i}createSegmentGroup(n,t,i,r){const c=this.createSegments(n,t.segments,i,r);let h={};return Object.entries(t.children).forEach(([y,w])=>{h[y]=this.createSegmentGroup(n,w,i,r)}),new Hn(c,h)}createSegments(n,t,i,r){return t.map(c=>c.path.startsWith(":")?this.findPosParam(n,c,r):this.findOrReturn(c,i))}findPosParam(n,t,i){const r=i[t.path.substring(1)];if(!r)throw new Pe(4001,!1);return r}findOrReturn(n,t){let i=0;for(const r of t){if(r.path===n.path)return t.splice(i),r;i++}return n}}const Sx={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function v3(e,n,t,i,r){const c=Mx(e,n,t);return c.matched?(i=function UU(e,n){return e.providers&&!e._injector&&(e._injector=Cb(e.providers,n,`Route: ${e.path}`)),e._injector??n}(n,i),function m3(e,n,t,i){const r=n.canMatch;return r&&0!==r.length?Et(r.map(h=>{const y=gp(h,e);return Eu(function r3(e){return e&&Am(e.canMatch)}(y)?y.canMatch(n,t):e.runInContext(()=>y(n,t)))})).pipe(_p(),rT()):Et(!0)}(i,n,t).pipe(Ft(h=>!0===h?c:{...Sx}))):Et(c)}function Mx(e,n,t){if(""===n.path)return"full"===n.pathMatch&&(e.hasChildren()||t.length>0)?{...Sx}:{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};const r=(n.matcher||KV)(t,e,n);if(!r)return{...Sx};const c={};Object.entries(r.posParams??{}).forEach(([y,w])=>{c[y]=w.path});const h=r.consumed.length>0?{...c,...r.consumed[r.consumed.length-1].parameters}:c;return{matched:!0,consumedSegments:r.consumed,remainingSegments:t.slice(r.consumed.length),parameters:h,positionalParamSegments:r.posParams??{}}}function aT(e,n,t,i){return t.length>0&&function w3(e,n,t){return t.some(i=>wy(e,n,i)&&Wa(i)!==Gt)}(e,t,i)?{segmentGroup:new Hn(n,x3(i,new Hn(t,e.children))),slicedSegments:[]}:0===t.length&&function C3(e,n,t){return t.some(i=>wy(e,n,i))}(e,t,i)?{segmentGroup:new Hn(e.segments,b3(e,0,t,i,e.children)),slicedSegments:t}:{segmentGroup:new Hn(e.segments,e.children),slicedSegments:t}}function b3(e,n,t,i,r){const c={};for(const h of i)if(wy(e,t,h)&&!r[Wa(h)]){const y=new Hn([],{});c[Wa(h)]=y}return{...r,...c}}function x3(e,n){const t={};t[Gt]=n;for(const i of e)if(""===i.path&&Wa(i)!==Gt){const r=new Hn([],{});t[Wa(i)]=r}return t}function wy(e,n,t){return(!(e.hasChildren()||n.length>0)||"full"!==t.pathMatch)&&""===t.path}class S3{constructor(n,t,i,r,c,h,y){this.injector=n,this.configLoader=t,this.rootComponentType=i,this.config=r,this.urlTree=c,this.paramsInheritanceStrategy=h,this.urlSerializer=y,this.allowRedirects=!0,this.applyRedirects=new y3(this.urlSerializer,this.urlTree)}noMatchError(n){return new Pe(4002,!1)}recognize(){const n=aT(this.urlTree.root,[],[],this.config).segmentGroup;return this.processSegmentGroup(this.injector,this.config,n,Gt).pipe(Od(t=>{if(t instanceof sT)return this.allowRedirects=!1,this.urlTree=t.urlTree,this.match(t.urlTree);throw t instanceof xy?this.noMatchError(t):t}),Ft(t=>{const i=new _y([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},Gt,this.rootComponentType,null,{}),r=new _c(i,t),c=new XM("",r),h=function gU(e,n,t=null,i=null){return NM(LM(e),n,t,i)}(i,[],this.urlTree.queryParams,this.urlTree.fragment);return h.queryParams=this.urlTree.queryParams,c.url=this.urlSerializer.serialize(h),this.inheritParamsAndData(c._root),{state:c,tree:h}}))}match(n){return this.processSegmentGroup(this.injector,this.config,n.root,Gt).pipe(Od(i=>{throw i instanceof xy?this.noMatchError(i):i}))}inheritParamsAndData(n){const t=n.value,i=WM(t,this.paramsInheritanceStrategy);t.params=Object.freeze(i.params),t.data=Object.freeze(i.data),n.children.forEach(r=>this.inheritParamsAndData(r))}processSegmentGroup(n,t,i,r){return 0===i.segments.length&&i.hasChildren()?this.processChildren(n,t,i):this.processSegment(n,t,i,i.segments,r,!0)}processChildren(n,t,i){const r=[];for(const c of Object.keys(i.children))"primary"===c?r.unshift(c):r.push(c);return Qn(r).pipe(cp(c=>{const h=i.children[c],y=function GU(e,n){const t=e.filter(i=>Wa(i)===n);return t.push(...e.filter(i=>Wa(i)!==n)),t}(t,c);return this.processSegmentGroup(n,y,h,c)}),function qV(e,n){return Vn(function GV(e,n,t,i,r){return(c,h)=>{let y=t,w=n,I=0;c.subscribe(_n(h,P=>{const z=I++;w=y?e(w,P,z):(y=!0,P),i&&h.next(w)},r&&(()=>{y&&h.next(w),h.complete()})))}}(e,n,arguments.length>=2,!0))}((c,h)=>(c.push(...h),c)),V_(null),function ZV(e,n){const t=arguments.length>=2;return i=>i.pipe(e?Mo((r,c)=>e(r,c,i)):jr,dx(1),t?V_(n):gI(()=>new tm))}(),ln(c=>{if(null===c)return yp(i);const h=lT(c);return function M3(e){e.sort((n,t)=>n.value.outlet===Gt?-1:t.value.outlet===Gt?1:n.value.outlet.localeCompare(t.value.outlet))}(h),Et(h)}))}processSegment(n,t,i,r,c,h){return Qn(t).pipe(cp(y=>this.processSegmentAgainstRoute(y._injector??n,t,y,i,r,c,h).pipe(Od(w=>{if(w instanceof xy)return Et(null);throw w}))),yu(y=>!!y),Od(y=>{if(iT(y))return function D3(e,n,t){return 0===n.length&&!e.children[t]}(i,r,c)?Et([]):yp(i);throw y}))}processSegmentAgainstRoute(n,t,i,r,c,h,y){return function E3(e,n,t,i){return!!(Wa(e)===i||i!==Gt&&wy(n,t,e))&&("**"===e.path||Mx(n,e,t).matched)}(i,r,c,h)?void 0===i.redirectTo?this.matchSegmentAgainstRoute(n,r,i,c,h,y):y&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(n,r,t,i,c,h):yp(r):yp(r)}expandSegmentAgainstRouteUsingRedirect(n,t,i,r,c,h){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(n,i,r,h):this.expandRegularSegmentAgainstRouteUsingRedirect(n,t,i,r,c,h)}expandWildCardWithParamsAgainstRouteUsingRedirect(n,t,i,r){const c=this.applyRedirects.applyRedirectCommands([],i.redirectTo,{});return i.redirectTo.startsWith("/")?oT(c):this.applyRedirects.lineralizeSegments(i,c).pipe(ln(h=>{const y=new Hn(h,{});return this.processSegment(n,t,y,h,r,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(n,t,i,r,c,h){const{matched:y,consumedSegments:w,remainingSegments:I,positionalParamSegments:P}=Mx(t,r,c);if(!y)return yp(t);const z=this.applyRedirects.applyRedirectCommands(w,r.redirectTo,P);return r.redirectTo.startsWith("/")?oT(z):this.applyRedirects.lineralizeSegments(r,z).pipe(ln(G=>this.processSegment(n,i,t,G.concat(I),h,!1)))}matchSegmentAgainstRoute(n,t,i,r,c,h){let y;if("**"===i.path){const w=r.length>0?DM(r).parameters:{};y=Et({snapshot:new _y(r,w,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,cT(i),Wa(i),i.component??i._loadedComponent??null,i,uT(i)),consumedSegments:[],remainingSegments:[]}),t.children={}}else y=v3(t,i,r,n).pipe(Ft(({matched:w,consumedSegments:I,remainingSegments:P,parameters:z})=>w?{snapshot:new _y(I,z,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,cT(i),Wa(i),i.component??i._loadedComponent??null,i,uT(i)),consumedSegments:I,remainingSegments:P}:null));return y.pipe(lr(w=>null===w?yp(t):this.getChildConfig(n=i._injector??n,i,r).pipe(lr(({routes:I})=>{const P=i._loadedInjector??n,{snapshot:z,consumedSegments:G,remainingSegments:re}=w,{segmentGroup:fe,slicedSegments:ge}=aT(t,G,re,I);if(0===ge.length&&fe.hasChildren())return this.processChildren(P,I,fe).pipe(Ft(Fe=>null===Fe?null:[new _c(z,Fe)]));if(0===I.length&&0===ge.length)return Et([new _c(z,[])]);const Ie=Wa(i)===c;return this.processSegment(P,I,fe,ge,Ie?Gt:c,!0).pipe(Ft(Fe=>[new _c(z,Fe)]))}))))}getChildConfig(n,t,i){return t.children?Et({routes:t.children,injector:n}):t.loadChildren?void 0!==t._loadedRoutes?Et({routes:t._loadedRoutes,injector:t._loadedInjector}):function f3(e,n,t,i){const r=n.canLoad;return void 0===r||0===r.length?Et(!0):Et(r.map(h=>{const y=gp(h,e);return Eu(function QU(e){return e&&Am(e.canLoad)}(y)?y.canLoad(n,t):e.runInContext(()=>y(n,t)))})).pipe(_p(),rT())}(n,t,i).pipe(ln(r=>r?this.configLoader.loadChildren(n,t).pipe(ms(c=>{t._loadedRoutes=c.routes,t._loadedInjector=c.injector})):function _3(e){return gm(QM(!1,3))}())):Et({routes:[],injector:n})}}function T3(e){const n=e.value.routeConfig;return n&&""===n.path}function lT(e){const n=[],t=new Set;for(const i of e){if(!T3(i)){n.push(i);continue}const r=n.find(c=>i.value.routeConfig===c.value.routeConfig);void 0!==r?(r.children.push(...i.children),t.add(r)):n.push(i)}for(const i of t){const r=lT(i.children);n.push(new _c(i.value,r))}return n.filter(i=>!t.has(i))}function cT(e){return e.data||{}}function uT(e){return e.resolve||{}}function dT(e){return"string"==typeof e.title||null===e.title}function Tx(e){return lr(n=>{const t=e(n);return t?Qn(t).pipe(Ft(()=>n)):Et(n)})}const vp=new Xe("ROUTES");let Ax=(()=>{class e{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=Ke(jE)}loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return Et(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);const i=Eu(t.loadComponent()).pipe(Ft(hT),ms(c=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=c}),pm(()=>{this.componentLoaders.delete(t)})),r=new CM(i,()=>new ci).pipe(ux());return this.componentLoaders.set(t,r),r}loadChildren(t,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return Et({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);const c=function L3(e,n,t,i){return Eu(e.loadChildren()).pipe(Ft(hT),ln(r=>r instanceof KC||Array.isArray(r)?Et(r):Qn(n.compileModuleAsync(r))),Ft(r=>{i&&i(e);let c,h,y=!1;return Array.isArray(r)?(h=r,!0):(c=r.create(t).injector,h=c.get(vp,[],{optional:!0,self:!0}).flat()),{routes:h.map(Ix),injector:c}}))}(i,this.compiler,t,this.onLoadEndListener).pipe(pm(()=>{this.childrenLoaders.delete(i)})),h=new CM(c,()=>new ci).pipe(ux());return this.childrenLoaders.set(i,h),h}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=ct({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function hT(e){return function N3(e){return e&&"object"==typeof e&&"default"in e}(e)?e.default:e}let Cy=(()=>{class e{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new ci,this.transitionAbortSubject=new ci,this.configLoader=Ke(Ax),this.environmentInjector=Ke(Co),this.urlSerializer=Ke(vm),this.rootContexts=Ke(Dm),this.inputBindingEnabled=null!==Ke(yy,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>Et(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=r=>this.events.next(new MU(r)),this.configLoader.onLoadStartListener=r=>this.events.next(new SU(r))}complete(){this.transitions?.complete()}handleNavigationRequest(t){const i=++this.navigationId;this.transitions?.next({...this.transitions.value,...t,id:i})}setupNavigations(t,i,r){return this.transitions=new _r({id:0,currentUrlTree:i,currentRawUrl:i,currentBrowserUrl:i,extractedUrl:t.urlHandlingStrategy.extract(i),urlAfterRedirects:t.urlHandlingStrategy.extract(i),rawUrl:i,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:Cm,restoredState:null,currentSnapshot:r.snapshot,targetSnapshot:null,currentRouterState:r,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Mo(c=>0!==c.id),Ft(c=>({...c,extractedUrl:t.urlHandlingStrategy.extract(c.rawUrl)})),lr(c=>{this.currentTransition=c;let h=!1,y=!1;return Et(c).pipe(ms(w=>{this.currentNavigation={id:w.id,initialUrl:w.rawUrl,extractedUrl:w.extractedUrl,trigger:w.source,extras:w.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),lr(w=>{const I=w.currentBrowserUrl.toString(),P=!t.navigated||w.extractedUrl.toString()!==I||I!==w.currentUrlTree.toString();if(!P&&"reload"!==(w.extras.onSameUrlNavigation??t.onSameUrlNavigation)){const G="";return this.events.next(new fp(w.id,this.urlSerializer.serialize(w.rawUrl),G,0)),w.resolve(null),bn}if(t.urlHandlingStrategy.shouldProcessUrl(w.rawUrl))return Et(w).pipe(lr(G=>{const re=this.transitions?.getValue();return this.events.next(new my(G.id,this.urlSerializer.serialize(G.extractedUrl),G.source,G.restoredState)),re!==this.transitions?.getValue()?bn:Promise.resolve(G)}),function A3(e,n,t,i,r,c){return ln(h=>function I3(e,n,t,i,r,c,h="emptyOnly"){return new S3(e,n,t,i,r,h,c).recognize()}(e,n,t,i,h.extractedUrl,r,c).pipe(Ft(({state:y,tree:w})=>({...h,targetSnapshot:y,urlAfterRedirects:w}))))}(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,t.paramsInheritanceStrategy),ms(G=>{c.targetSnapshot=G.targetSnapshot,c.urlAfterRedirects=G.urlAfterRedirects,this.currentNavigation={...this.currentNavigation,finalUrl:G.urlAfterRedirects};const re=new $M(G.id,this.urlSerializer.serialize(G.extractedUrl),this.urlSerializer.serialize(G.urlAfterRedirects),G.targetSnapshot);this.events.next(re)}));if(P&&t.urlHandlingStrategy.shouldProcessUrl(w.currentRawUrl)){const{id:G,extractedUrl:re,source:fe,restoredState:ge,extras:Ie}=w,Fe=new my(G,this.urlSerializer.serialize(re),fe,ge);this.events.next(Fe);const Ce=ZM(0,this.rootComponentType).snapshot;return this.currentTransition=c={...w,targetSnapshot:Ce,urlAfterRedirects:re,extras:{...Ie,skipLocationChange:!1,replaceUrl:!1}},Et(c)}{const G="";return this.events.next(new fp(w.id,this.urlSerializer.serialize(w.extractedUrl),G,1)),w.resolve(null),bn}}),ms(w=>{const I=new CU(w.id,this.urlSerializer.serialize(w.extractedUrl),this.urlSerializer.serialize(w.urlAfterRedirects),w.targetSnapshot);this.events.next(I)}),Ft(w=>(this.currentTransition=c={...w,guards:WU(w.targetSnapshot,w.currentSnapshot,this.rootContexts)},c)),function o3(e,n){return ln(t=>{const{targetSnapshot:i,currentSnapshot:r,guards:{canActivateChecks:c,canDeactivateChecks:h}}=t;return 0===h.length&&0===c.length?Et({...t,guardsResult:!0}):function a3(e,n,t,i){return Qn(e).pipe(ln(r=>function p3(e,n,t,i,r){const c=n&&n.routeConfig?n.routeConfig.canDeactivate:null;return c&&0!==c.length?Et(c.map(y=>{const w=Sm(n)??r,I=gp(y,w);return Eu(function n3(e){return e&&Am(e.canDeactivate)}(I)?I.canDeactivate(e,n,t,i):w.runInContext(()=>I(e,n,t,i))).pipe(yu())})).pipe(_p()):Et(!0)}(r.component,r.route,t,n,i)),yu(r=>!0!==r,!0))}(h,i,r,e).pipe(ln(y=>y&&function JU(e){return"boolean"==typeof e}(y)?function l3(e,n,t,i){return Qn(n).pipe(cp(r=>j_(function u3(e,n){return null!==e&&n&&n(new TU(e)),Et(!0)}(r.route.parent,i),function c3(e,n){return null!==e&&n&&n(new kU(e)),Et(!0)}(r.route,i),function h3(e,n,t){const i=n[n.length-1],c=n.slice(0,n.length-1).reverse().map(h=>function XU(e){const n=e.routeConfig?e.routeConfig.canActivateChild:null;return n&&0!==n.length?{node:e,guards:n}:null}(h)).filter(h=>null!==h).map(h=>wM(()=>Et(h.guards.map(w=>{const I=Sm(h.node)??t,P=gp(w,I);return Eu(function t3(e){return e&&Am(e.canActivateChild)}(P)?P.canActivateChild(i,e):I.runInContext(()=>P(i,e))).pipe(yu())})).pipe(_p())));return Et(c).pipe(_p())}(e,r.path,t),function d3(e,n,t){const i=n.routeConfig?n.routeConfig.canActivate:null;if(!i||0===i.length)return Et(!0);const r=i.map(c=>wM(()=>{const h=Sm(n)??t,y=gp(c,h);return Eu(function e3(e){return e&&Am(e.canActivate)}(y)?y.canActivate(n,e):h.runInContext(()=>y(n,e))).pipe(yu())}));return Et(r).pipe(_p())}(e,r.route,t))),yu(r=>!0!==r,!0))}(i,c,e,n):Et(y)),Ft(y=>({...t,guardsResult:y})))})}(this.environmentInjector,w=>this.events.next(w)),ms(w=>{if(c.guardsResult=w.guardsResult,Ld(w.guardsResult))throw JM(0,w.guardsResult);const I=new EU(w.id,this.urlSerializer.serialize(w.extractedUrl),this.urlSerializer.serialize(w.urlAfterRedirects),w.targetSnapshot,!!w.guardsResult);this.events.next(I)}),Mo(w=>!!w.guardsResult||(this.cancelNavigationTransition(w,"",3),!1)),Tx(w=>{if(w.guards.canActivateChecks.length)return Et(w).pipe(ms(I=>{const P=new DU(I.id,this.urlSerializer.serialize(I.extractedUrl),this.urlSerializer.serialize(I.urlAfterRedirects),I.targetSnapshot);this.events.next(P)}),lr(I=>{let P=!1;return Et(I).pipe(function k3(e,n){return ln(t=>{const{targetSnapshot:i,guards:{canActivateChecks:r}}=t;if(!r.length)return Et(t);let c=0;return Qn(r).pipe(cp(h=>function P3(e,n,t,i){const r=e.routeConfig,c=e._resolve;return void 0!==r?.title&&!dT(r)&&(c[_m]=r.title),function R3(e,n,t,i){const r=function O3(e){return[...Object.keys(e),...Object.getOwnPropertySymbols(e)]}(e);if(0===r.length)return Et({});const c={};return Qn(r).pipe(ln(h=>function F3(e,n,t,i){const r=Sm(n)??i,c=gp(e,r);return Eu(c.resolve?c.resolve(n,t):r.runInContext(()=>c(n,t)))}(e[h],n,t,i).pipe(yu(),ms(y=>{c[h]=y}))),dx(1),function WV(e){return Ft(()=>e)}(c),Od(h=>iT(h)?bn:gm(h)))}(c,e,n,i).pipe(Ft(h=>(e._resolvedData=h,e.data=WM(e,t).resolve,r&&dT(r)&&(e.data[_m]=r.title),null)))}(h.route,i,e,n)),ms(()=>c++),dx(1),ln(h=>c===r.length?Et(t):bn))})}(t.paramsInheritanceStrategy,this.environmentInjector),ms({next:()=>P=!0,complete:()=>{P||this.cancelNavigationTransition(I,"",2)}}))}),ms(I=>{const P=new IU(I.id,this.urlSerializer.serialize(I.extractedUrl),this.urlSerializer.serialize(I.urlAfterRedirects),I.targetSnapshot);this.events.next(P)}))}),Tx(w=>{const I=P=>{const z=[];P.routeConfig?.loadComponent&&!P.routeConfig._loadedComponent&&z.push(this.configLoader.loadComponent(P.routeConfig).pipe(ms(G=>{P.component=G}),Ft(()=>{})));for(const G of P.children)z.push(...I(G));return z};return G_(I(w.targetSnapshot.root)).pipe(V_(),Sd(1))}),Tx(()=>this.afterPreactivation()),Ft(w=>{const I=function NU(e,n,t){const i=Im(e,n._root,t?t._root:void 0);return new qM(i,n)}(t.routeReuseStrategy,w.targetSnapshot,w.currentRouterState);return this.currentTransition=c={...w,targetRouterState:I},c}),ms(()=>{this.events.next(new _x)}),((e,n,t,i)=>Ft(r=>(new ZU(n,r.targetRouterState,r.currentRouterState,t,i).activate(e),r)))(this.rootContexts,t.routeReuseStrategy,w=>this.events.next(w),this.inputBindingEnabled),Sd(1),ms({next:w=>{h=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new Du(w.id,this.urlSerializer.serialize(w.extractedUrl),this.urlSerializer.serialize(w.urlAfterRedirects))),t.titleStrategy?.updateTitle(w.targetRouterState.snapshot),w.resolve(!0)},complete:()=>{h=!0}}),PI(this.transitionAbortSubject.pipe(ms(w=>{throw w}))),pm(()=>{h||y||this.cancelNavigationTransition(c,"",1),this.currentNavigation?.id===c.id&&(this.currentNavigation=null)}),Od(w=>{if(y=!0,eT(w))this.events.next(new Em(c.id,this.urlSerializer.serialize(c.extractedUrl),w.message,w.cancellationCode)),function VU(e){return eT(e)&&Ld(e.url)}(w)?this.events.next(new yx(w.url)):c.resolve(!1);else{this.events.next(new gy(c.id,this.urlSerializer.serialize(c.extractedUrl),w,c.targetSnapshot??void 0));try{c.resolve(t.errorHandler(w))}catch(I){c.reject(I)}}return bn}))}))}cancelNavigationTransition(t,i,r){const c=new Em(t.id,this.urlSerializer.serialize(t.extractedUrl),i,r);this.events.next(c),t.resolve(!1)}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=ct({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function pT(e){return e!==Cm}let fT=(()=>{class e{buildTitle(t){let i,r=t.root;for(;void 0!==r;)i=this.getResolvedTitleForRoute(r)??i,r=r.children.find(c=>c.outlet===Gt);return i}getResolvedTitleForRoute(t){return t.data[_m]}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=ct({token:e,factory:function(){return Ke(z3)},providedIn:"root"})}return e})(),z3=(()=>{class e extends fT{constructor(t){super(),this.title=t}updateTitle(t){const i=this.buildTitle(t);void 0!==i&&this.title.setTitle(i)}static#e=this.\u0275fac=function(i){return new(i||e)(nt(cI))};static#t=this.\u0275prov=ct({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),B3=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=ct({token:e,factory:function(){return Ke(U3)},providedIn:"root"})}return e})();class V3{shouldDetach(n){return!1}store(n,t){}shouldAttach(n){return!1}retrieve(n){return null}shouldReuseRoute(n,t){return n.routeConfig===t.routeConfig}}let U3=(()=>{class e extends V3{static#e=this.\u0275fac=function(){let t;return function(r){return(t||(t=cr(e)))(r||e)}}();static#t=this.\u0275prov=ct({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const Ey=new Xe("",{providedIn:"root",factory:()=>({})});let j3=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=ct({token:e,factory:function(){return Ke($3)},providedIn:"root"})}return e})(),$3=(()=>{class e{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,i){return t}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=ct({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var km=function(e){return e[e.COMPLETE=0]="COMPLETE",e[e.FAILED=1]="FAILED",e[e.REDIRECTING=2]="REDIRECTING",e}(km||{});function mT(e,n){e.events.pipe(Mo(t=>t instanceof Du||t instanceof Em||t instanceof gy||t instanceof fp),Ft(t=>t instanceof Du||t instanceof fp?km.COMPLETE:t instanceof Em&&(0===t.code||1===t.code)?km.REDIRECTING:km.FAILED),Mo(t=>t!==km.REDIRECTING),Sd(1)).subscribe(()=>{n()})}function H3(e){throw e}function G3(e,n,t){return n.parse("/")}const q3={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},Z3={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let To=(()=>{class e{get navigationId(){return this.navigationTransitions.navigationId}get browserPageId(){return"computed"!==this.canceledNavigationResolution?this.currentPageId:this.location.getState()?.\u0275routerPageId??this.currentPageId}get events(){return this._events}constructor(){this.disposed=!1,this.currentPageId=0,this.console=Ke(UE),this.isNgZoneEnabled=!1,this._events=new ci,this.options=Ke(Ey,{optional:!0})||{},this.pendingTasks=Ke(y_),this.errorHandler=this.options.errorHandler||H3,this.malformedUriErrorHandler=this.options.malformedUriErrorHandler||G3,this.navigated=!1,this.lastSuccessfulId=-1,this.urlHandlingStrategy=Ke(j3),this.routeReuseStrategy=Ke(B3),this.titleStrategy=Ke(fT),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.config=Ke(vp,{optional:!0})?.flat()??[],this.navigationTransitions=Ke(Cy),this.urlSerializer=Ke(vm),this.location=Ke(t0),this.componentInputBindingEnabled=!!Ke(yy,{optional:!0}),this.eventsSubscription=new mn,this.isNgZoneEnabled=Ke(dn)instanceof dn&&dn.isInAngularZone(),this.resetConfig(this.config),this.currentUrlTree=new pp,this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=ZM(0,null),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe(t=>{this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId},t=>{this.console.warn(`Unhandled Navigation Error: ${t}`)}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){const t=this.navigationTransitions.events.subscribe(i=>{try{const{currentTransition:r}=this.navigationTransitions;if(null===r)return void(gT(i)&&this._events.next(i));if(i instanceof my)pT(r.source)&&(this.browserUrlTree=r.extractedUrl);else if(i instanceof fp)this.rawUrlTree=r.rawUrl;else if(i instanceof $M){if("eager"===this.urlUpdateStrategy){if(!r.extras.skipLocationChange){const c=this.urlHandlingStrategy.merge(r.urlAfterRedirects,r.rawUrl);this.setBrowserUrl(c,r)}this.browserUrlTree=r.urlAfterRedirects}}else if(i instanceof _x)this.currentUrlTree=r.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(r.urlAfterRedirects,r.rawUrl),this.routerState=r.targetRouterState,"deferred"===this.urlUpdateStrategy&&(r.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,r),this.browserUrlTree=r.urlAfterRedirects);else if(i instanceof Em)0!==i.code&&1!==i.code&&(this.navigated=!0),(3===i.code||2===i.code)&&this.restoreHistory(r);else if(i instanceof yx){const c=this.urlHandlingStrategy.merge(i.url,r.currentRawUrl),h={skipLocationChange:r.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||pT(r.source)};this.scheduleNavigation(c,Cm,null,h,{resolve:r.resolve,reject:r.reject,promise:r.promise})}i instanceof gy&&this.restoreHistory(r,!0),i instanceof Du&&(this.navigated=!0),gT(i)&&this._events.next(i)}catch(r){this.navigationTransitions.transitionAbortSubject.next(r)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){if(this.setUpLocationChangeListener(),!this.navigationTransitions.hasRequestedNavigation){const t=this.location.getState();this.navigateToSyncWithBrowser(this.location.path(!0),Cm,t)}}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(t=>{const i="popstate"===t.type?"popstate":"hashchange";"popstate"===i&&setTimeout(()=>{this.navigateToSyncWithBrowser(t.url,i,t.state)},0)}))}navigateToSyncWithBrowser(t,i,r){const c={replaceUrl:!0},h=r?.navigationId?r:null;if(r){const w={...r};delete w.navigationId,delete w.\u0275routerPageId,0!==Object.keys(w).length&&(c.state=w)}const y=this.parseUrl(t);this.scheduleNavigation(y,i,h,c)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(Ix),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,i={}){const{relativeTo:r,queryParams:c,fragment:h,queryParamsHandling:y,preserveFragment:w}=i,I=w?this.currentUrlTree.fragment:h;let z,P=null;switch(y){case"merge":P={...this.currentUrlTree.queryParams,...c};break;case"preserve":P=this.currentUrlTree.queryParams;break;default:P=c||null}null!==P&&(P=this.removeEmptyProps(P));try{z=LM(r?r.snapshot:this.routerState.snapshot.root)}catch{("string"!=typeof t[0]||!t[0].startsWith("/"))&&(t=[]),z=this.currentUrlTree.root}return NM(z,t,P,I??null)}navigateByUrl(t,i={skipLocationChange:!1}){const r=Ld(t)?t:this.parseUrl(t),c=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(c,Cm,null,i)}navigate(t,i={skipLocationChange:!1}){return function W3(e){for(let n=0;n<e.length;n++)if(null==e[n])throw new Pe(4008,!1)}(t),this.navigateByUrl(this.createUrlTree(t,i),i)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){let i;try{i=this.urlSerializer.parse(t)}catch(r){i=this.malformedUriErrorHandler(r,this.urlSerializer,t)}return i}isActive(t,i){let r;if(r=!0===i?{...q3}:!1===i?{...Z3}:i,Ld(t))return SM(this.currentUrlTree,t,r);const c=this.parseUrl(t);return SM(this.currentUrlTree,c,r)}removeEmptyProps(t){return Object.keys(t).reduce((i,r)=>{const c=t[r];return null!=c&&(i[r]=c),i},{})}scheduleNavigation(t,i,r,c,h){if(this.disposed)return Promise.resolve(!1);let y,w,I;h?(y=h.resolve,w=h.reject,I=h.promise):I=new Promise((z,G)=>{y=z,w=G});const P=this.pendingTasks.add();return mT(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(P))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,currentBrowserUrl:this.browserUrlTree,rawUrl:t,extras:c,resolve:y,reject:w,promise:I,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),I.catch(z=>Promise.reject(z))}setBrowserUrl(t,i){const r=this.urlSerializer.serialize(t);if(this.location.isCurrentPathEqualTo(r)||i.extras.replaceUrl){const h={...i.extras.state,...this.generateNgRouterState(i.id,this.browserPageId)};this.location.replaceState(r,"",h)}else{const c={...i.extras.state,...this.generateNgRouterState(i.id,this.browserPageId+1)};this.location.go(r,"",c)}}restoreHistory(t,i=!1){if("computed"===this.canceledNavigationResolution){const c=this.currentPageId-this.browserPageId;0!==c?this.location.historyGo(c):this.currentUrlTree===this.getCurrentNavigation()?.finalUrl&&0===c&&(this.resetState(t),this.browserUrlTree=t.currentUrlTree,this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(i&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=t.currentRouterState,this.currentUrlTree=t.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,i){return"computed"===this.canceledNavigationResolution?{navigationId:t,\u0275routerPageId:i}:{navigationId:t}}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=ct({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function gT(e){return!(e instanceof _x||e instanceof yx)}let bp=(()=>{class e{constructor(t,i,r,c,h,y){this.router=t,this.route=i,this.tabIndexAttribute=r,this.renderer=c,this.el=h,this.locationStrategy=y,this.href=null,this.commands=null,this.onChanges=new ci,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1;const w=h.nativeElement.tagName?.toLowerCase();this.isAnchorElement="a"===w||"area"===w,this.isAnchorElement?this.subscription=t.events.subscribe(I=>{I instanceof Du&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(t){null!=this.tabIndexAttribute||this.isAnchorElement||this.applyAttributeValue("tabindex",t)}ngOnChanges(t){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(t){null!=t?(this.commands=Array.isArray(t)?t:[t],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(t,i,r,c,h){return!!(null===this.urlTree||this.isAnchorElement&&(0!==t||i||r||c||h||"string"==typeof this.target&&"_self"!=this.target))||(this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!this.isAnchorElement)}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){this.href=null!==this.urlTree&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null;const t=null===this.href?null:function Qx(e,n,t){return function jT(e,n){return"src"===n&&("embed"===e||"frame"===e||"iframe"===e||"media"===e||"script"===e)||"href"===n&&("base"===e||"link"===e)?Jx:za}(n,t)(e)}(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",t)}applyAttributeValue(t,i){const r=this.renderer,c=this.el.nativeElement;null!==i?r.setAttribute(c,t,i):r.removeAttribute(c,t)}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}static#e=this.\u0275fac=function(i){return new(i||e)(xe(To),xe(Nd),function lh(e){return function sg(e,n){if("class"===n)return e.classes;if("style"===n)return e.styles;const t=e.attrs;if(t){const i=t.length;let r=0;for(;r<i;){const c=t[r];if(qu(c))break;if(0===c)r+=2;else if("number"==typeof c)for(r++;r<i&&"string"==typeof t[r];)r++;else{if(c===n)return t[r+1];r+=2}}}return null}(gi(),e)}("tabindex"),xe(lc),xe(Mr),xe(Dd))};static#t=this.\u0275dir=xt({type:e,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(i,r){1&i&&yi("click",function(h){return r.onClick(h.button,h.ctrlKey,h.shiftKey,h.altKey,h.metaKey)}),2&i&&Ba("target",r.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:["preserveFragment","preserveFragment",tp],skipLocationChange:["skipLocationChange","skipLocationChange",tp],replaceUrl:["replaceUrl","replaceUrl",tp],routerLink:"routerLink"},standalone:!0,features:[p1,Bn]})}return e})();class _T{}let Y3=(()=>{class e{constructor(t,i,r,c,h){this.router=t,this.injector=r,this.preloadingStrategy=c,this.loader=h}setUpPreloading(){this.subscription=this.router.events.pipe(Mo(t=>t instanceof Du),cp(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,i){const r=[];for(const c of i){c.providers&&!c._injector&&(c._injector=Cb(c.providers,t,`Route: ${c.path}`));const h=c._injector??t,y=c._loadedInjector??h;(c.loadChildren&&!c._loadedRoutes&&void 0===c.canLoad||c.loadComponent&&!c._loadedComponent)&&r.push(this.preloadConfig(h,c)),(c.children||c._loadedRoutes)&&r.push(this.processRoutes(y,c.children??c._loadedRoutes))}return Qn(r).pipe(gt())}preloadConfig(t,i){return this.preloadingStrategy.preload(i,()=>{let r;r=i.loadChildren&&void 0===i.canLoad?this.loader.loadChildren(t,i):Et(null);const c=r.pipe(ln(h=>null===h?Et(void 0):(i._loadedRoutes=h.routes,i._loadedInjector=h.injector,this.processRoutes(h.injector??t,h.routes))));return i.loadComponent&&!i._loadedComponent?Qn([c,this.loader.loadComponent(i)]).pipe(gt()):c})}static#e=this.\u0275fac=function(i){return new(i||e)(nt(To),nt(jE),nt(Co),nt(_T),nt(Ax))};static#t=this.\u0275prov=ct({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const kx=new Xe("");let yT=(()=>{class e{constructor(t,i,r,c,h={}){this.urlSerializer=t,this.transitions=i,this.viewportScroller=r,this.zone=c,this.options=h,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},h.scrollPositionRestoration=h.scrollPositionRestoration||"disabled",h.anchorScrolling=h.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof my?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof Du?(this.lastId=t.id,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.urlAfterRedirects).fragment)):t instanceof fp&&0===t.code&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof HM&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,i){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new HM(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,i))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static#e=this.\u0275fac=function(i){!function Bw(){throw new Error("invalid")}()};static#t=this.\u0275prov=ct({token:e,factory:e.\u0275fac})}return e})();function yc(e,n){return{\u0275kind:e,\u0275providers:n}}function bT(){const e=Ke(Eo);return n=>{const t=e.get(ep);if(n!==t.components[0])return;const i=e.get(To),r=e.get(xT);1===e.get(Px)&&i.initialNavigation(),e.get(wT,null,Ut.Optional)?.setUpPreloading(),e.get(kx,null,Ut.Optional)?.init(),i.resetRootComponentType(t.componentTypes[0]),r.closed||(r.next(),r.complete(),r.unsubscribe())}}const xT=new Xe("",{factory:()=>new ci}),Px=new Xe("",{providedIn:"root",factory:()=>1}),wT=new Xe("");function t4(e){return yc(0,[{provide:wT,useExisting:Y3},{provide:_T,useExisting:e}])}const CT=new Xe("ROUTER_FORROOT_GUARD"),i4=[t0,{provide:vm,useClass:hx},To,Dm,{provide:Nd,useFactory:function vT(e){return e.routerState.root},deps:[To]},Ax,[]];function r4(){return new XE("Router",To)}let ET=(()=>{class e{constructor(t){}static forRoot(t,i){return{ngModule:e,providers:[i4,[],{provide:vp,multi:!0,useValue:t},{provide:CT,useFactory:l4,deps:[[To,new ph,new ru]]},{provide:Ey,useValue:i||{}},i?.useHash?{provide:Dd,useClass:DF}:{provide:Dd,useClass:DD},{provide:kx,useFactory:()=>{const e=Ke(VL),n=Ke(dn),t=Ke(Ey),i=Ke(Cy),r=Ke(vm);return t.scrollOffset&&e.setOffset(t.scrollOffset),new yT(r,i,e,n,t)}},i?.preloadingStrategy?t4(i.preloadingStrategy).\u0275providers:[],{provide:XE,multi:!0,useFactory:r4},i?.initialNavigation?c4(i):[],i?.bindToComponentInputs?yc(8,[YM,{provide:yy,useExisting:YM}]).\u0275providers:[],[{provide:DT,useFactory:bT},{provide:Gb,multi:!0,useExisting:DT}]]}}static forChild(t){return{ngModule:e,providers:[{provide:vp,multi:!0,useValue:t}]}}static#e=this.\u0275fac=function(i){return new(i||e)(nt(CT,8))};static#t=this.\u0275mod=Ni({type:e});static#n=this.\u0275inj=Fi({})}return e})();function l4(e){return"guarded"}function c4(e){return["disabled"===e.initialNavigation?yc(3,[{provide:Nb,multi:!0,useFactory:()=>{const n=Ke(To);return()=>{n.setUpLocationChangeListener()}}},{provide:Px,useValue:2}]).\u0275providers:[],"enabledBlocking"===e.initialNavigation?yc(2,[{provide:Px,useValue:0},{provide:Nb,multi:!0,deps:[Eo],useFactory:n=>{const t=n.get(CF,Promise.resolve());return()=>t.then(()=>new Promise(i=>{const r=n.get(To),c=n.get(xT);mT(r,()=>{i(!0)}),n.get(Cy).afterPreactivation=()=>(i(!0),c.closed?Et(void 0):c),r.initialNavigation()}))}}]).\u0275providers:[]]}const DT=new Xe("");function Pm(e,n){const t="object"==typeof n;return new Promise((i,r)=>{let h,c=!1;e.subscribe({next:y=>{h=y,c=!0},error:r,complete:()=>{c?i(h):t?i(n.defaultValue):r(new tm)}})})}let Rx=(()=>{class e{constructor(){}generatePoints(t,i,r,c,h){const y=[];for(let P=0;P<t;P++){var w=Math.random()*(r-i)+i,I=Math.random()*(h-c)+c;y.push([w,I])}return y}generateEastIndia(t=10){return this.generatePoints(t,85,95,11.3,19.7)}generateSouthEastIndia(t=10){return this.generatePoints(t,80,95,-5,13)}generateSouthWestIndia(t=10){return this.generatePoints(t,49,75,-13,11.7)}generateWestIndia(t=10){return this.generatePoints(t,60,69,8,25)}generateRandomPoints(t=10){return this.generatePoints(t,84,95,13,21)}generatePoint(t,i,r){return{type:"Feature",geometry:{type:"Point",coordinates:i},id:r,properties:{asset:t,iconType:t.icon}}}plotPoints(t,i,r){t.loadImage(`assets/icons/${r}.png`,(c,h)=>{if(h){const y=`${r}-id`;t.addImage(r,h).addSource(y,{type:"geojson",data:this.createLayer(i,r)}).addLayer({id:y+"1",type:"symbol",source:y,layout:{"icon-image":["concat","icon-",["get","type"]]}})}})}createLayer(t,i){t.map((c,h)=>({type:"Feature",properties:{description:`<strong>${h}</strong> point`,type:i},geometry:{type:"Point",coordinates:c.reverse()}}))}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=ct({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),Ox=(()=>{class e{constructor(t,i){this.geo=t,this.http=i,this.assets=[],this.path=[[85.77109,19.745055],[86.606956,19.66231],[87.772268,20.343661],[88.739697,20.611256],[90.102892,20.796239],[91.136282,20.343661],[91.949802,19.620922],[92.499477,18.957272],[93.159088,18.103108],[93.730751,17.076805],[94.060297,16.498735],[94.236193,15.992449]],this.bpath=[[85.77109,19.745055],[86.606956,19.66231],[87.772268,20.343661],[88.739697,20.611256],[90.102892,20.796239],[90.074607,21.844372],[91.949802,19.620922],[92.499477,18.957272],[93.159088,18.103108],[93.730751,17.076805],[94.060297,16.498735],[94.236193,15.992449]]}search(t,i){return new Promise(r=>{this.getAssets().then(c=>{const h=t&&""!=t?c.filter(w=>JSON.stringify(w).includes(t)):c,y=i.length>0?h.filter(w=>i.includes(w.type)):h;r({facets:[this.count(h,"type",i)],results:y,total:y.length})})})}count(t,i,r){const c={};return t.forEach(h=>{if(i in h){const y=h[i];c[y]=y in c?c[y]+1:1}}),{name:i,values:Object.keys(c).map(h=>({value:h,count:c[h],label:h,$selected:r.includes(h)}))}}getAssets(){return new Promise(t=>{Promise.all([Pm(this.http.get("assets/data/ships.json")),Pm(this.http.get("assets/data/mammals.json")),Pm(this.http.get("assets/data/trackers.json")),Pm(this.http.get("assets/data/paths.json"))]).then(i=>{this.assets=[];const r=i[i.length-1];i.slice(0,3).forEach(c=>{c.forEach(h=>{if(!h.position){const y=r.filter(I=>I.item===h.uid),w=y&&y.length>0?y[y.length-1]:void 0;h.position=w?w.position:void 0}this.assets.push(h)})}),t(this.assets)})})}getPaths(t,i=void 0,r=void 0){return new Promise(c=>{Pm(this.http.get("assets/data/paths.json")).then(h=>{let y=h.filter(z=>z.item===t);y=i?y.filter(z=>new Date(z.timestamp)>=i):y,y=r?y.filter(z=>new Date(z.timestamp)<=r):y;const w=y.filter(z=>"official"===z.type),I=y.filter(z=>"actual"===z.type),P=y.map(z=>new Date(z.timestamp).getTime());c({official:w.map(z=>z.position),actual:I.map(z=>z.position),start:new Date(Math.min(...P)),end:new Date(Math.max(...P))})})})}get(t){return new Promise(i=>{this.getAssets().then(r=>{i(r.find(c=>c.uid===t))})})}mockPaths(){const t=[{official:this.path,actual:this.bpath,item:"imo_9176656"}],i=[];let r=new Date("2023-09-20T00:00:00");t.forEach(c=>{for(let h=0;h<c.official.length;h++){const y=this.generateRandomDate(r);r=y,i.push({type:"official",timestamp:y,position:c.official[h],item:c.item}),i.push({type:"actual",timestamp:y,position:c.actual.length>h?c.actual[h]:c.official[h],item:c.item})}}),console.log(JSON.stringify(i))}mockDevices(){const t=[];[...Array(10)].forEach((i,r)=>{t.push({uid:`r_${r}`,type:"tracker",icon:"recorder",name:`AK00${101+r}`,position:this.geo.generateEastIndia(1)[0]})}),[...Array(10)].forEach((i,r)=>{t.push({uid:`r_${r+100}`,type:"tracker",icon:"recorder",name:`AK00${201+r}`,position:this.geo.generateSouthEastIndia(1)[0]})}),[...Array(10)].forEach((i,r)=>{t.push({uid:`r_${r+200}`,type:"tracker",icon:"recorder",name:`AK00${301+r}`,position:this.geo.generateSouthWestIndia(1)[0]})}),[...Array(10)].forEach((i,r)=>{t.push({uid:`r_${r+300}`,type:"tracker",icon:"recorder",name:`AK00${401+r}`,position:this.geo.generateSouthWestIndia(1)[0]})}),console.log(JSON.stringify(t))}generateRandomDate(t=new Date("2023-09-20T00:00:00"),i=new Date){return this.getRandomDate(t,i)}getRandomDate(t,i){const r=t.getTime(),c=i.getTime();return new Date(r+Math.random()*(c-r))}static#e=this.\u0275fac=function(i){return new(i||e)(nt(Rx),nt(uM))};static#t=this.\u0275prov=ct({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),IT=(()=>{class e{constructor(t){this.formBuilder=t,this.query=new Ve,this.searchControl=new lp(""),this.form=this.formBuilder.group({query:this.searchControl})}search(){this.query.emit(this.searchControl.value)}static#e=this.\u0275fac=function(i){return new(i||e)(xe(KB))};static#t=this.\u0275cmp=Nn({type:e,selectors:[["app-search-box"]],outputs:{query:"query"},decls:5,vars:1,consts:[["novalidate","",3,"formGroup","ngSubmit"],[1,"w-100","input-group"],["type","text","formControlName","query",1,"form-control","form-control-lg","rounded-start-5","border-end-0"],[1,"btn","btn-primary","rounded-end-5",3,"click"],[1,"far","fas","fa","fa-search"]],template:function(i,r){1&i&&(tt(0,"form",0),yi("ngSubmit",function(){return r.search()}),tt(1,"div",1),sn(2,"input",2),tt(3,"button",3),yi("click",function(){return r.search()}),sn(4,"i",4),Ye()()()),2&i&&mt("formGroup",r.form)},dependencies:[RS,om,j0,bS,iy,nx]})}return e})(),d4=(()=>{class e{constructor(){}getFacetCategory(t,i){if(i&&Array.isArray(i)){const r=i.find(h=>h.name===t);return r?r.values:[]}return[]}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=ct({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function h4(e,n){if(1&e){const t=o_();tt(0,"div",4)(1,"div",5)(2,"input",6),yi("change",function(r){const h=Wo(t).$implicit;return vl(En(2).filter(h,r))}),Ye(),tt(3,"label",7),Rt(4),no(5,"titlecase"),Ye()(),tt(6,"div",8)(7,"span"),Rt(8),Ye()()()}if(2&e){const t=n.$implicit,i=En(2);He(2),a_("id","",i.category,"-",t.value,""),mt("value",t.value)("checked",t.$selected),He(1),a_("for","",i.category,"-",t.value,""),He(1),Qr(" ",Io(5,8,t.label||t.value)," "),He(4),ra(t.count)}}function p4(e,n){if(1&e&&(vd(0),tt(1,"div",1)(2,"span",2),Rt(3),no(4,"uppercase"),Ye()(),An(5,h4,9,10,"div",3),bd()),2&e){const t=En();He(3),Qr(" ",Io(4,2,t.category)," "),He(2),mt("ngForOf",t.items)}}let f4=(()=>{class e{constructor(t){this.facetService=t,this.filtered=new Ve}ngOnChanges(t){(t.facets||t.category)&&this.handleFacetCategory()}handleFacetCategory(){this.items=this.facetService.getFacetCategory(this.category,this.facets)}filter(t,i){t.$selected=!t.$selected,this.filtered.emit(this.items?.filter(r=>r.$selected).map(r=>r.value))}static#e=this.\u0275fac=function(i){return new(i||e)(xe(d4))};static#t=this.\u0275cmp=Nn({type:e,selectors:[["app-search-facet"]],inputs:{category:"category",facets:"facets"},outputs:{filtered:"filtered"},features:[Bn],decls:1,vars:1,consts:[[4,"ngIf"],[1,"d-flex","justify-content-between","align-items-baseline"],[1,"h6","flex-grow-0"],["class","d-flex justify-content-between align-items-center",4,"ngFor","ngForOf"],[1,"d-flex","justify-content-between","align-items-center"],[1,"form-check"],["type","checkbox",1,"form-check-input",3,"value","checked","id","change"],[1,"form-check-label","mt-1",3,"for"],[1,"count","xs"]],template:function(i,r){1&i&&An(0,p4,6,4,"ng-container",0),2&i&&mt("ngIf",!!r.category&&!!r.items)},dependencies:[ip,Id,m0,rp]})}return e})(),ST=(()=>{class e{constructor(){this.facets=[],this.filtered=new Ve}onFilter(t){this.filtered.emit(t)}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275cmp=Nn({type:e,selectors:[["app-search-filters"]],inputs:{facets:"facets"},outputs:{filtered:"filtered"},decls:3,vars:2,consts:[[1,"h3"],[3,"category","facets","filtered"]],template:function(i,r){1&i&&(tt(0,"h2",0),Rt(1,"Refine"),Ye(),tt(2,"app-search-facet",1),yi("filtered",function(h){return r.onFilter(h)}),Ye()),2&i&&(He(2),mt("category","type")("facets",r.facets))},dependencies:[f4]})}return e})();function m4(e,n){1&e&&sn(0,"img",18),2&e&&Va("src","assets/tmp/",En(2).$implicit.image,"",za)}const Fx=function(e){return["/details",e]};function g4(e,n){if(1&e&&(tt(0,"div",11)(1,"div"),An(2,m4,1,1,"img",12),Ye(),tt(3,"div",13)(4,"div"),sn(5,"span"),Rt(6,"\xa0\xa0 "),tt(7,"a",14)(8,"span",15),Rt(9),Ye()()(),tt(10,"div",16),Rt(11),no(12,"titlecase"),Ye(),tt(13,"div",16),Rt(14," Sizing: "),tt(15,"span",17),Rt(16),Ye(),Rt(17," \xa0 "),tt(18,"span",17),Rt(19),Ye(),Rt(20," \xa0 "),tt(21,"span",17),Rt(22),Ye(),Rt(23," \xa0 "),Ye(),tt(24,"div",16),Rt(25," Speed: "),tt(26,"span",17),Rt(27),Ye(),Rt(28," \xa0 "),tt(29,"span",17),Rt(30),Ye(),Rt(31," \xa0 "),Ye()()()),2&e){const t=En().$implicit;He(2),mt("ngIf",!!t.image),He(3),fb("fi fi-",t.country,""),He(2),mt("routerLink",Yh(14,Fx,t.uid)),He(2),ra(t.name),He(2),Qr(" ",Io(12,12,t.shipType)," "),He(5),Qr("Beam: ",t.beam_size,""),He(3),Qr("Draught: ",t.draught_size,""),He(3),Qr("Dimensions: ",t.dimension,""),He(5),Qr("Design speed: ",t.design_speed,""),He(3),Qr("Engine RPM at design speed: ",t.engine_rpm_design,"")}}function _4(e,n){1&e&&sn(0,"img",22),2&e&&Va("src","assets/tmp/",En(2).$implicit.image,"",za)}function y4(e,n){if(1&e&&(tt(0,"span"),Rt(1),no(2,"titlecase"),Ye()),2&e){const t=En(2).$implicit;He(1),Qr(" > ",Io(2,1,t.mammalSubType),"")}}function v4(e,n){1&e&&(tt(0,"a",23),sn(1,"i",24),Ye()),2&e&&mt("href",n.$implicit,za)}function b4(e,n){if(1&e&&(tt(0,"div",11)(1,"div"),An(2,_4,1,1,"img",19),Ye(),tt(3,"div",13)(4,"div")(5,"a",14)(6,"span",15),Rt(7),no(8,"titlecase"),An(9,y4,3,3,"span",20),Ye()(),An(10,v4,2,1,"a",21),Ye(),tt(11,"div",16),Rt(12," Sizing: "),tt(13,"span",17),Rt(14),Ye(),Rt(15," \xa0 "),Ye(),tt(16,"div",16),Rt(17," Sounds: "),tt(18,"span",17),Rt(19),Ye(),Rt(20," \xa0 "),Ye()()()),2&e){const t=En().$implicit;He(2),mt("ngIf",!!t.image),He(3),mt("routerLink",Yh(9,Fx,t.uid)),He(2),Qr("",Io(8,7,t.mammalType)," "),He(2),mt("ngIf",t.mammalSubType),He(1),mt("ngForOf",t.sources),He(4),Qr("Weight: ",t.weight,""),He(5),ra(t.soundTypes.join(", "))}}function x4(e,n){if(1&e&&(tt(0,"div",11)(1,"div"),sn(2,"img",25),Ye(),tt(3,"div",13)(4,"div")(5,"a",14)(6,"span",15),Rt(7),Ye()()(),tt(8,"div",16)(9,"span",17),Rt(10,"Position: "),Ye(),Rt(11),Ye()()()),2&e){const t=En().$implicit;He(5),mt("routerLink",Yh(3,Fx,t.uid)),He(2),ra(t.name),He(4),Qr(" ",t.position," ")}}function w4(e,n){if(1&e&&(tt(0,"div",9),An(1,g4,32,16,"div",10),An(2,b4,21,11,"div",10),An(3,x4,12,5,"div",10),Ye()),2&e){const t=n.$implicit;He(1),mt("ngIf","ship"===t.type),He(1),mt("ngIf","mammal"===t.type),He(1),mt("ngIf","tracker"===t.type)}}let C4=(()=>{class e{constructor(t){this.dataService=t,this.items=[],this.facets=[],this.query="",this.search("",[])}onQuery(t){this.query=t,this.search(t,[])}onFilter(t){this.search(this.query,t)}search(t,i){this.dataService.search(t,i).then(r=>{this.items=r.results,this.facets=r.facets})}static#e=this.\u0275fac=function(i){return new(i||e)(xe(Ox))};static#t=this.\u0275cmp=Nn({type:e,selectors:[["app-assets"]],decls:10,vars:2,consts:[[1,"container"],[1,"row","my-4"],[1,"col-3","pe-5"],[3,"facets","filtered"],[1,"col-9"],[3,"query"],[1,"my-5"],[1,"row"],["class","my-2 border rounded-5 col-12",4,"ngFor","ngForOf"],[1,"my-2","border","rounded-5","col-12"],["class","d-flex p-3",4,"ngIf"],[1,"d-flex","p-3"],["class","img-fluid","width","200",3,"src",4,"ngIf"],[1,"ps-2"],[1,"text-reset",3,"routerLink"],[1,"h5"],[1,"mt-2"],[1,"text-secondary"],["width","200",1,"img-fluid",3,"src"],["width","200",3,"src",4,"ngIf"],[4,"ngIf"],["target","_blank","class","px-2",3,"href",4,"ngFor","ngForOf"],["width","200",3,"src"],["target","_blank",1,"px-2",3,"href"],[1,"fas","fa-external-link-alt"],["src","assets/icons/recorder.svg","width","200",1,"img-fluid"]],template:function(i,r){1&i&&(tt(0,"div")(1,"div",0)(2,"div",1)(3,"div",2)(4,"app-search-filters",3),yi("filtered",function(h){return r.onFilter(h)}),Ye()(),tt(5,"div",4)(6,"app-search-box",5),yi("query",function(h){return r.onQuery(h)}),Ye(),sn(7,"div",6),tt(8,"div",7),An(9,w4,4,3,"div",8),Ye()()()()()),2&i&&(He(4),mt("facets",r.facets),He(5),mt("ngForOf",r.items))},dependencies:[ip,Id,bp,IT,ST,rp]})}return e})();const MT={key:"8kFttyiouBsoIJZMZXyM",style:"https://api.maptiler.com/maps/ocean/style.json?key=",raster:"https://api.maptiler.com/tiles/ocean-rgb/tiles.json?key="},E4=["marker"];function D4(e,n){if(1&e){const t=o_();tt(0,"mgl-marker",12,13)(2,"div",14),yi("click",function(){const r=Wo(t),c=r.$implicit,h=r.index;return vl(En().onClick(c,h))}),sn(3,"img",15),Ye()()}if(2&e){const t=n.$implicit;mt("feature",t),He(3),Va("src","assets/icons/",(null==t.properties?null:t.properties.iconType)||"",".svg",za)}}function I4(e,n){if(1&e&&(tt(0,"strong"),Rt(1),no(2,"uppercase"),Ye()),2&e){const t=En(2);He(1),ra(Io(2,1,null==t.asset?null:t.asset.name))}}function S4(e,n){if(1&e&&(tt(0,"strong"),Rt(1),no(2,"uppercase"),no(3,"uppercase"),Ye()),2&e){const t=En(2);He(1),pb(" ",Io(2,2,null==t.asset?null:t.asset.mammalType)," > ",Io(3,4,null==t.asset?null:t.asset.mammalSubType)," ")}}const M4=function(){return["ship","tracker"]},T4=function(e){return["/details",e]};function A4(e,n){if(1&e&&(tt(0,"mgl-popup",16)(1,"div"),sn(2,"img",15),Rt(3," \xa0 "),An(4,I4,3,3,"strong",17),An(5,S4,4,6,"strong",17),tt(6,"a",18),Rt(7,"Track"),Ye()()()),2&e){const t=En();mt("marker",t.getSelectedMarker()),He(2),Va("src","assets/icons/",(null==t.selectedMarker.properties?null:t.selectedMarker.properties.iconType)||"",".svg",za),He(2),mt("ngIf",es(5,M4).includes(null==t.asset?null:t.asset.type)),He(1),mt("ngIf","mammal"===(null==t.asset?null:t.asset.type)),He(1),mt("routerLink",Yh(6,T4,null==t.asset?null:t.asset.uid))}}const k4=function(){return[2]},P4=function(){return[77.62259,12.60418]},TT=function(){return[0]},R4=function(){return{source:"bathymetry",exaggeration:1.5}};let O4=(()=>{class e{constructor(t,i){this.geoService=t,this.dataService=i,this.CONFIG=MT,this.query="",this.facets=[],this.features=[],this.selectedMarker=void 0,this.selectedMarkerIndex=void 0}ngOnInit(){this.search("",[])}mapLoaded(t){this.map=t}onQuery(t){this.query=t,this.search(t,[])}onFilter(t){this.search(this.query,t)}search(t,i){this.dataService.search(t,i).then(r=>{this.features=[],r.results.filter(c=>!!c.position).forEach((c,h)=>{this.features.push(this.geoService.generatePoint(c,c.position||this.geoService.generateRandomPoints(1)[0],h))}),this.facets=r.facets})}onClick(t,i){void 0!==i&&t?(this.selectedMarker=t,this.selectedMarkerIndex=i):(this.selectedMarker=void 0,this.selectedMarkerIndex=void 0)}getSelectedMarker(){return this.selectedMarker&&void 0!==this.selectedMarkerIndex&&this.markers&&this.markers.length>this.selectedMarkerIndex?this.markers.get(this.selectedMarkerIndex):void 0}get asset(){return this.selectedMarker?.properties?.asset}static#e=this.\u0275fac=function(i){return new(i||e)(xe(Rx),xe(Ox))};static#t=this.\u0275cmp=Nn({type:e,selectors:[["app-dashboard"]],viewQuery:function(i,r){if(1&i&&Ha(E4,5),2&i){let c;io(c=ro())&&(r.markers=c)}},decls:14,vars:19,consts:[[1,"container"],[1,"row","my-4"],[1,"col-2"],[3,"facets","filtered"],[1,"col-10"],[3,"query"],[1,"w-100","my-3","vh-75"],[1,"vh-75","w-100",3,"zoom","center","maxPitch","bearing","pitch","terrain","mapLoad"],["mglNavigation","","position","top-left",3,"visualizePitch","showCompass"],["id","bathymetry",3,"url"],[3,"feature",4,"ngFor","ngForOf"],[3,"marker",4,"ngIf"],[3,"feature"],["marker",""],[1,"marker",3,"click"],[3,"src"],[3,"marker"],[4,"ngIf"],[1,"d-block",3,"routerLink"]],template:function(i,r){1&i&&(tt(0,"div")(1,"div",0)(2,"div",1)(3,"div",2)(4,"app-search-filters",3),yi("filtered",function(h){return r.onFilter(h)}),Ye()(),tt(5,"div",4)(6,"app-search-box",5),yi("query",function(h){return r.onQuery(h)}),Ye(),tt(7,"div",6)(8,"mgl-map",7),yi("mapLoad",function(h){return r.mapLoaded(h)}),sn(9,"mgl-control",8)(10,"mgl-raster-dem-source",9),An(11,D4,4,2,"mgl-marker",10),An(12,A4,8,8,"mgl-popup",11),Ye()(),sn(13,"div"),Ye()()()()),2&i&&(He(4),mt("facets",r.facets),He(4),ia(r.CONFIG.style+r.CONFIG.key),mt("zoom",es(14,k4))("center",es(15,P4))("maxPitch",85)("bearing",es(16,TT))("pitch",es(17,TT))("terrain",es(18,R4)),He(1),mt("visualizePitch",!0)("showCompass",!0),He(1),mt("url",r.CONFIG.raster+r.CONFIG.key),He(1),mt("ngForOf",r.features),He(1),mt("ngIf",!!r.selectedMarker&&!!r.asset&&r.asset.uid))},dependencies:[ip,Id,bp,wI,EI,CI,lz,O0,bI,IT,ST,m0],styles:["#msg[_ngcontent-%COMP%]{text-align:center;position:relative;top:20px;z-index:15;background-color:#00000080;padding:5px;color:#fff}.marker[_ngcontent-%COMP%]{cursor:pointer}"]})}return e})(),F4=(()=>{class e{constructor(t){this.titlePipe=t}transform(t){return t&&t.split("_").map(r=>this.titlePipe.transform(r)).join(" ")}static#e=this.\u0275fac=function(i){return new(i||e)(xe(rp,16))};static#t=this.\u0275pipe=Qi({name:"propcase",type:e,pure:!0})}return e})();function L4(e,n){if(1&e&&(tt(0,"span"),sn(1,"span"),Rt(2,"\xa0\xa0 "),tt(3,"span",15),Rt(4),Ye()()),2&e){const t=En(2);He(1),fb("fi fi-",t.item.country,""),He(3),ra(t.item.name)}}function N4(e,n){if(1&e&&(tt(0,"span"),Rt(1),no(2,"titlecase"),Ye()),2&e){const t=En(3);He(1),Qr(" > ",Io(2,1,t.item.mammalSubType),"")}}function z4(e,n){if(1&e&&(tt(0,"span")(1,"span",15),Rt(2),no(3,"titlecase"),An(4,N4,3,3,"span",4),Ye()()),2&e){const t=En(2);He(2),Qr("",Io(3,2,t.item.mammalType)," "),He(2),mt("ngIf",t.item.mammalSubType)}}function B4(e,n){if(1&e&&(tt(0,"span")(1,"span",15),Rt(2),Ye()()),2&e){const t=En(2);He(2),ra(t.item.name)}}function V4(e,n){if(1&e&&(tt(0,"div",16),sn(1,"img",3),Ye()),2&e){const t=En(2);He(1),Va("src","assets/tmp/",t.item.image,"",za)}}function U4(e,n){if(1&e&&(vd(0),tt(1,"dt",17),Rt(2),no(3,"propcase"),Ye(),tt(4,"dd",17),sn(5,"span",18),Ye(),bd()),2&e){const t=En().$implicit,i=En(2);He(2),ra(Io(3,2,t.key)),He(3),mt("innerHTML",i.display(t.key,t.value),Yx)}}const j4=function(){return["country","name","uid","image","shipType","icon","mammalType","mammalSubType","icon"]};function $4(e,n){if(1&e&&(vd(0),An(1,U4,6,4,"ng-container",4),bd()),2&e){const t=n.$implicit;He(1),mt("ngIf",!es(1,j4).includes(t.key))}}function H4(e,n){if(1&e){const t=o_();tt(0,"mat-slider",19)(1,"input",20),yi("ngModelChange",function(r){return Wo(t),vl(En(2).timeline.qStart=r)})("ngModelChange",function(r){return Wo(t),vl(En(2).timelineFilter(r))}),Ye(),tt(2,"input",21),yi("ngModelChange",function(r){return Wo(t),vl(En(2).timeline.qEnd=r)})("ngModelChange",function(r){return Wo(t),vl(En(2).timelineFilter(r))}),Ye()()}if(2&e){const t=En(2);mt("min",t.timeline.start)("max",t.timeline.end)("step",72e5)("displayWith",t.displayDate),He(1),mt("ngModel",t.timeline.qStart),He(1),mt("ngModel",t.timeline.qEnd)}}function G4(e,n){if(1&e&&(tt(0,"mgl-marker",32,33)(2,"div",34),sn(3,"img",35),Ye()()),2&e){const t=n.$implicit;mt("feature",t),He(3),Va("src","assets/icons/",(null==t.properties?null:t.properties.iconType)||"",".svg",za)}}const q4=function(){return[4]},Z4=function(e){return[e]},W4=function(){return[8]},X4=function(){return{source:"bathymetry",exaggeration:1.5}},AT=function(){return{"line-join":"round","line-cap":"round"}},K4=function(){return{"line-color":"#000","line-width":4}},Y4=function(){return{"line-color":"#f8bc09","line-width":4}};function J4(e,n){if(1&e&&(tt(0,"div",22)(1,"mgl-map",23),sn(2,"mgl-control",24)(3,"mgl-raster-dem-source",25),An(4,G4,4,2,"mgl-marker",26),tt(5,"mgl-geojson-source",27),sn(6,"mgl-feature",28),Ye(),sn(7,"mgl-layer",29),tt(8,"mgl-geojson-source",30),sn(9,"mgl-feature",28),Ye(),sn(10,"mgl-layer",31),Ye()()),2&e){const t=En(2);He(1),ia(t.CONFIG.style+t.CONFIG.key),mt("zoom",es(18,q4))("center",t.center)("maxPitch",85)("bearing",Yh(19,Z4,-2))("pitch",es(21,W4))("terrain",es(22,X4)),He(1),mt("visualizePitch",!0)("showCompass",!0),He(1),mt("url",t.CONFIG.raster+t.CONFIG.key),He(1),mt("ngForOf",t.markers),He(2),mt("geometry",t.official),He(1),mt("layout",es(23,AT))("paint",es(24,K4)),He(2),mt("geometry",t.tracked),He(1),mt("layout",es(25,AT))("paint",es(26,Y4))}}function Q4(e,n){if(1&e&&(tt(0,"div")(1,"figure")(2,"figcaption",36),Rt(3),no(4,"date"),Ye(),sn(5,"audio",37),Ye()()),2&e){const t=n.$implicit;He(3),ra(uE(4,2,t.timestamp,"dd/MM/yyyy hh:mm")),He(2),Va("src","assets/wavs/",t.wav,"",za)}}function e5(e,n){if(1&e&&(tt(0,"div",1)(1,"h1",2)(2,"span"),sn(3,"img",3),Ye(),Rt(4," \xa0 "),An(5,L4,5,4,"span",4),An(6,z4,5,4,"span",4),An(7,B4,3,1,"span",4),Ye(),tt(8,"div",5)(9,"div",6)(10,"h2",7),Rt(11,"Information"),Ye(),An(12,V4,2,1,"div",8),tt(13,"dl",9),An(14,$4,2,2,"ng-container",10),no(15,"keyvalue"),Ye()(),tt(16,"div",11)(17,"h2",7),Rt(18,"Tracking"),Ye(),An(19,H4,3,6,"mat-slider",12),An(20,J4,11,27,"div",13),Ye(),tt(21,"div",14)(22,"h2",7),Rt(23,"Recordings"),Ye(),An(24,Q4,6,5,"div",10),Ye()()()),2&e){const t=En();He(3),Va("src","assets/icons/",t.item.icon,".svg",za),He(2),mt("ngIf","ship"===t.item.type),He(1),mt("ngIf","mammal"===t.item.type),He(1),mt("ngIf","tracker"===t.item.type),He(5),mt("ngIf",!!t.item.image),He(2),mt("ngForOf",Io(15,9,t.item)),He(5),mt("ngIf",t.timeline.start&&t.timeline.end),He(1),mt("ngIf",!!t.item),He(4),mt("ngForOf",t.recordings)}}const t5=[{path:"assets",component:C4},{path:"dashboard",component:O4},{path:"details/:id",component:(()=>{class e{constructor(t,i,r,c){this.route=t,this.router=i,this.dataService=r,this.geoService=c,this.CONFIG=MT,this.official={type:"LineString",coordinates:[]},this.tracked={type:"LineString",coordinates:[]},this.qOfficial={type:"LineString",coordinates:[]},this.qTracked={type:"LineString",coordinates:[]},this.markers=[],this.timeline={start:void 0,end:void 0,qStart:void 0,qEnd:void 0},this.recordings=[],this.center=[78.8718,21.7679]}ngOnInit(){this.route.params.subscribe(t=>{this.id=t.id,this.dataService.get(this.id).then(i=>{this.item=i,this.item&&("tracker"!==this.item.type?(this.dataService.getPaths(this.id).then(r=>{this.timeline.end=r.end.getTime(),this.timeline.start=r.start.getTime(),this.timeline.qEnd=r.end.getTime(),this.timeline.qStart=r.start.getTime(),this.setup(r)}),this.center=this.item.position):(this.center=this.item.position,this.markers.push({type:"Feature",geometry:{type:"Point",coordinates:this.item.position},properties:{iconType:this.item.icon}}),this.recordings=[...Array(10)].map((r,c)=>({timestamp:this.dataService.generateRandomDate(),wav:c%4+1+".wav"})),this.recordings.sort((r,c)=>r.timestamp<c.timestamp?1:-1)))})})}setup(t){this.official.coordinates=t.official,this.tracked.coordinates=t.actual,this.markers=[],this.markers.push({type:"Feature",geometry:{type:"Point",coordinates:t.actual[0]},properties:{iconType:"start"}}),this.markers.push({type:"Feature",geometry:{type:"Point",coordinates:t.actual[t.actual.length-1]},properties:{iconType:this.item.icon}}),this.recordings=[...Array(t.actual.length)].map((i,r)=>({timestamp:this.dataService.generateRandomDate(t.start,t.end),wav:r%4+1+".wav"})),this.recordings.sort((i,r)=>i.timestamp<r.timestamp?1:-1)}displayDate(t){const i=new Date(t);return`${i.toLocaleDateString()} ${i.toLocaleTimeString()}`}display(t,i){return Array.isArray(i)?i.map(r=>this.sDisplay(r)).join("<br>"):this.sDisplay(i)}sDisplay(t){return"string"==typeof t&&t.startsWith("http")?`<a href="${t}" target="_blank" class="px-1"> <i class="fas fa-external-link-alt"></i></a>`:t}timelineFilter(t){this.dataService.getPaths(this.id,new Date(this.timeline.qStart),new Date(this.timeline.qEnd)).then(i=>{this.setup(i)})}static#e=this.\u0275fac=function(i){return new(i||e)(xe(Nd),xe(To),xe(Ox),xe(Rx))};static#t=this.\u0275cmp=Nn({type:e,selectors:[["app-details"]],decls:1,vars:1,consts:[["class","container mt-5",4,"ngIf"],[1,"container","mt-5"],[1,"text-center"],[1,"img-fluid",3,"src"],[4,"ngIf"],[1,"row","mt-4"],[1,"col-3","pe-1"],[1,"h4"],["class","w-100 mb-2",4,"ngIf"],[1,"row"],[4,"ngFor","ngForOf"],[1,"col-7"],["class","w-100","showTickMarks","","discrete","",3,"min","max","step","displayWith",4,"ngIf"],["class","w-100 vh-50",4,"ngIf"],[1,"col-2"],[1,""],[1,"w-100","mb-2"],[1,"col-sm-6"],[3,"innerHTML"],["showTickMarks","","discrete","",1,"w-100",3,"min","max","step","displayWith"],["matSliderStartThumb","",3,"ngModel","ngModelChange"],["matSliderEndThumb","",3,"ngModel","ngModelChange"],[1,"w-100","vh-50"],[1,"vh-50","w-100",3,"zoom","center","maxPitch","bearing","pitch","terrain"],["mglNavigation","","position","top-left",3,"visualizePitch","showCompass"],["id","bathymetry",3,"url"],[3,"feature",4,"ngFor","ngForOf"],["id","official-path"],[3,"geometry"],["id","route","type","line","source","official-path",3,"layout","paint"],["id","tracked-path"],["id","tracked","type","line","source","tracked-path",3,"layout","paint"],[3,"feature"],["marker",""],[1,"marker"],[3,"src"],[1,"ps-1","pb-1"],["controls","",3,"src"]],template:function(i,r){1&i&&An(0,e5,25,11,"div",0),2&i&&mt("ngIf",!!r.item)},dependencies:[ip,Id,om,j0,J0,wI,az,xI,EI,oz,CI,O0,bI,uV,rM,rp,g0,UD,F4],styles:["[_nghost-%COMP%]     .mat-mdc-slider .mdc-slider__track .mdc-slider__track--inactive{background-color:#fad051!important}[_nghost-%COMP%]     .mat-mdc-slider .mdc-slider__track .mdc-slider__track--active .mdc-slider__track--active_fill{border-color:#f8bc09}[_nghost-%COMP%]     .mat-mdc-slider .mdc-slider__thumb-knob{background-color:#f8bc09!important;border-color:#f8bc09}[_nghost-%COMP%]     .mat-mdc-slider .mdc-slider__thumb--focused .mdc-slider__thumb-knob{border-color:#f8bc09}"]})}return e})()},{path:"",redirectTo:"/assets",pathMatch:"full"}];let n5=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=Ni({type:e});static#n=this.\u0275inj=Fi({imports:[ET.forRoot(t5),ET]})}return e})();const i5=function(){return["/assets"]},r5=function(){return["/dashboard"]};let s5=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275cmp=Nn({type:e,selectors:[["app-header"]],decls:17,vars:4,consts:[[1,"app-header","sticky-top"],[1,"container"],[1,"d-flex","justify-content-between","align-items-center"],[1,"app-logos"],["href","https://datavid.com/","target","_blank"],["src","assets/datavid-favicon.webp","width","70",1,"img-fluid"],["href","https://www.aikairos.com/","target","_blank"],["src","assets/aikairos-logo.png","width","100",1,"img-fluid"],[1,"app-menu"],[1,"navbar"],[1,"list-unstyled","list-inline","mb-0"],[1,"list-inline-item"],[1,"nav-link",3,"routerLink"]],template:function(i,r){1&i&&(tt(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"a",4),sn(5,"img",5),Ye(),tt(6,"a",6),sn(7,"img",7),Ye()(),tt(8,"div",8)(9,"nav",9)(10,"ul",10)(11,"li",11)(12,"a",12),Rt(13," Assets "),Ye()(),tt(14,"li",11)(15,"a",12),Rt(16," Dashboard "),Ye()()()()()()()()),2&i&&(He(12),mt("routerLink",es(2,i5)),He(3),mt("routerLink",es(3,r5)))},dependencies:[bp],styles:[".app-header[_ngcontent-%COMP%]{background-color:#000;border-bottom:5px solid #f8bc09;color:#fff}"]})}return e})(),o5=(()=>{class e{constructor(){this.title="WAV Rover"}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275cmp=Nn({type:e,selectors:[["app-root"]],decls:3,vars:0,consts:[[1,"min-vh-65"]],template:function(i,r){1&i&&(sn(0,"app-header"),tt(1,"main",0),sn(2,"router-outlet"),Ye())},dependencies:[Ex,s5],encapsulation:2})}return e})(),a5=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=Ni({type:e,bootstrap:[o5]});static#n=this.\u0275inj=Fi({providers:[rp,g0],imports:[RN,n5,zV,YB,JB,cz,fV]})}return e})();kN().bootstrapModule(a5).catch(e=>console.error(e))},624:function(xp){xp.exports=function(){"use strict";var vc,bc,Jt;function Iu(g,mn){if(vc)if(bc){var be="var sharedChunk = {}; ("+vc+")(sharedChunk); ("+bc+")(sharedChunk);",Ar={};vc(Ar),Jt=mn(Ar),typeof window<"u"&&(Jt.workerUrl=window.URL.createObjectURL(new Blob([be],{type:"text/javascript"})))}else bc=mn;else vc=mn}return Iu(0,function(g){function mn(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var be=Ar;function Ar(a,s){this.x=a,this.y=s}Ar.prototype={clone:function(){return new Ar(this.x,this.y)},add:function(a){return this.clone()._add(a)},sub:function(a){return this.clone()._sub(a)},multByPoint:function(a){return this.clone()._multByPoint(a)},divByPoint:function(a){return this.clone()._divByPoint(a)},mult:function(a){return this.clone()._mult(a)},div:function(a){return this.clone()._div(a)},rotate:function(a){return this.clone()._rotate(a)},rotateAround:function(a,s){return this.clone()._rotateAround(a,s)},matMult:function(a){return this.clone()._matMult(a)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(a){return this.x===a.x&&this.y===a.y},dist:function(a){return Math.sqrt(this.distSqr(a))},distSqr:function(a){var s=a.x-this.x,l=a.y-this.y;return s*s+l*l},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(a){return Math.atan2(this.y-a.y,this.x-a.x)},angleWith:function(a){return this.angleWithSep(a.x,a.y)},angleWithSep:function(a,s){return Math.atan2(this.x*s-this.y*a,this.x*a+this.y*s)},_matMult:function(a){var s=a[2]*this.x+a[3]*this.y;return this.x=a[0]*this.x+a[1]*this.y,this.y=s,this},_add:function(a){return this.x+=a.x,this.y+=a.y,this},_sub:function(a){return this.x-=a.x,this.y-=a.y,this},_mult:function(a){return this.x*=a,this.y*=a,this},_div:function(a){return this.x/=a,this.y/=a,this},_multByPoint:function(a){return this.x*=a.x,this.y*=a.y,this},_divByPoint:function(a){return this.x/=a.x,this.y/=a.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var a=this.y;return this.y=this.x,this.x=-a,this},_rotate:function(a){var s=Math.cos(a),l=Math.sin(a),d=l*this.x+s*this.y;return this.x=s*this.x-l*this.y,this.y=d,this},_rotateAround:function(a,s){var l=Math.cos(a),d=Math.sin(a),f=s.y+d*(this.x-s.x)+l*(this.y-s.y);return this.x=s.x+l*(this.x-s.x)-d*(this.y-s.y),this.y=f,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Ar.convert=function(a){return a instanceof Ar?a:Array.isArray(a)?new Ar(a[0],a[1]):a};var yt=mn(be),kr=Os;function Os(a,s,l,d){this.cx=3*a,this.bx=3*(l-a)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*s,this.by=3*(d-s)-this.cy,this.ay=1-this.cy-this.by,this.p1x=a,this.p1y=s,this.p2x=l,this.p2y=d}Os.prototype={sampleCurveX:function(a){return((this.ax*a+this.bx)*a+this.cx)*a},sampleCurveY:function(a){return((this.ay*a+this.by)*a+this.cy)*a},sampleCurveDerivativeX:function(a){return(3*this.ax*a+2*this.bx)*a+this.cx},solveCurveX:function(a,s){if(void 0===s&&(s=1e-6),a<0)return 0;if(a>1)return 1;for(var l=a,d=0;d<8;d++){var f=this.sampleCurveX(l)-a;if(Math.abs(f)<s)return l;var v=this.sampleCurveDerivativeX(l);if(Math.abs(v)<1e-6)break;l-=f/v}var x=0,C=1;for(l=a,d=0;d<20&&(f=this.sampleCurveX(l),!(Math.abs(f-a)<s));d++)a>f?x=l:C=l,l=.5*(C-x)+x;return l},solve:function(a,s){return this.sampleCurveY(this.solveCurveX(a,s))}};var Xa=mn(kr);function Ao(a,s,l,d){const f=new Xa(a,s,l,d);return function(v){return f.solve(v)}}const Ur=Ao(.25,.1,.25,1);function Kn(a,s,l){return Math.min(l,Math.max(s,a))}function xc(a,s,l){const d=l-s,f=((a-s)%d+d)%d+s;return f===s?l:f}function qi(a,...s){for(const l of s)for(const d in l)a[d]=l[d];return a}let Fs=1;function gs(a,s,l){const d={};for(const f in a)d[f]=s.call(l||this,a[f],f,a);return d}function Rl(a,s,l){const d={};for(const f in a)s.call(l||this,a[f],f,a)&&(d[f]=a[f]);return d}function Pr(a){return Array.isArray(a)?a.map(Pr):"object"==typeof a&&a?gs(a,Pr):a}const Ls={};function Zi(a){Ls[a]||(typeof console<"u"&&console.warn(a),Ls[a]=!0)}function gn(a,s,l){return(l.y-a.y)*(s.x-a.x)>(s.y-a.y)*(l.x-a.x)}function oo(a){let s=0;for(let l,d,f=0,v=a.length,x=v-1;f<v;x=f++)l=a[f],d=a[x],s+=(d.x-l.x)*(l.y+d.y);return s}function mr(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}let ao=null;function ko(a){if(null==ao){const s=a.navigator?a.navigator.userAgent:null;ao=!!a.safari||!(!s||!(/\b(iPad|iPhone|iPod)\b/.test(s)||s.match("Safari")&&!s.match("Chrome")))}return ao}function Po(a){return typeof ImageBitmap<"u"&&a instanceof ImageBitmap}const ts="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let jr,la;const ca={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(a){const s=requestAnimationFrame(a);return{cancel:()=>cancelAnimationFrame(s)}},getImageData(a,s=0){return this.getImageCanvasContext(a).getImageData(-s,-s,a.width+2*s,a.height+2*s)},getImageCanvasContext(a){const s=window.document.createElement("canvas"),l=s.getContext("2d",{willReadFrequently:!0});if(!l)throw new Error("failed to create canvas 2d context");return s.width=a.width,s.height=a.height,l.drawImage(a,0,0,a.width,a.height),l},resolveURL:a=>(jr||(jr=document.createElement("a")),jr.href=a,jr.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(null==la&&(la=matchMedia("(prefers-reduced-motion: reduce)")),la.matches)}},Ln={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};class Ro extends Error{constructor(s,l,d,f){super(`AJAXError: ${l} (${s}): ${d}`),this.status=s,this.statusText=l,this.url=d,this.body=f}}const Ns=mr()?()=>self.worker&&self.worker.referrer:()=>("blob:"===window.location.protocol?window.parent:window).location.href,ns=a=>Ln.REGISTERED_PROTOCOLS[a.substring(0,a.indexOf("://"))];function Yn(a,s){const l=new AbortController,d=new Request(a.url,{method:a.method||"GET",body:a.body,credentials:a.credentials,headers:a.headers,cache:a.cache,referrer:Ns(),signal:l.signal});let f=!1,v=!1;return"json"===a.type&&d.headers.set("Accept","application/json"),v||fetch(d).then(x=>{return x.ok?(C=x,void("arrayBuffer"===a.type||"image"===a.type?C.arrayBuffer():"json"===a.type?C.json():C.text()).then(S=>{v||(f=!0,s(null,S,C.headers.get("Cache-Control"),C.headers.get("Expires")))}).catch(S=>{v||s(new Error(S.message))})):x.blob().then(C=>s(new Ro(x.status,x.statusText,a.url,C)));var C}).catch(x=>{20!==x.code&&s(new Error(x.message))}),{cancel:()=>{v=!0,f||l.abort()}}}const ci=function(a,s){if(/:\/\//.test(a.url)&&!/^https?:|^file:/.test(a.url)){if(mr()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",a,s);if(!mr())return(ns(a.url)||Yn)(a,s)}if(!(/^file:/.test(l=a.url)||/^file:/.test(Ns())&&!/^\w+:/.test(l))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return Yn(a,s);if(mr()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",a,s,void 0,!0)}var l;return function(d,f){const v=new XMLHttpRequest;v.open(d.method||"GET",d.url,!0),"arrayBuffer"!==d.type&&"image"!==d.type||(v.responseType="arraybuffer");for(const x in d.headers)v.setRequestHeader(x,d.headers[x]);return"json"===d.type&&(v.responseType="text",v.setRequestHeader("Accept","application/json")),v.withCredentials="include"===d.credentials,v.onerror=()=>{f(new Error(v.statusText))},v.onload=()=>{if((v.status>=200&&v.status<300||0===v.status)&&null!==v.response){let x=v.response;if("json"===d.type)try{x=JSON.parse(v.response)}catch(C){return f(C)}f(null,x,v.getResponseHeader("Cache-Control"),v.getResponseHeader("Expires"))}else{const x=new Blob([v.response],{type:v.getResponseHeader("Content-Type")});f(new Ro(v.status,v.statusText,d.url,x))}},v.send(d.body),{cancel:()=>v.abort()}}(a,s)},Ka=function(a,s){return ci(qi(a,{type:"arrayBuffer"}),s)};function Oo(a){if(!a||a.indexOf("://")<=0||0===a.indexOf("data:image/")||0===a.indexOf("blob:"))return!0;const s=new URL(a),l=window.location;return s.protocol===l.protocol&&s.host===l.host}function Vn(a,s,l){l[a]&&-1!==l[a].indexOf(s)||(l[a]=l[a]||[],l[a].push(s))}function _n(a,s,l){if(l&&l[a]){const d=l[a].indexOf(s);-1!==d&&l[a].splice(d,1)}}class is{constructor(s,l={}){qi(this,l),this.type=s}}class Ft extends is{constructor(s,l={}){super("error",qi({error:s},l))}}class zs{on(s,l){return this._listeners=this._listeners||{},Vn(s,l,this._listeners),this}off(s,l){return _n(s,l,this._listeners),_n(s,l,this._oneTimeListeners),this}once(s,l){return l?(this._oneTimeListeners=this._oneTimeListeners||{},Vn(s,l,this._oneTimeListeners),this):new Promise(d=>this.once(s,d))}fire(s,l){"string"==typeof s&&(s=new is(s,l||{}));const d=s.type;if(this.listens(d)){s.target=this;const f=this._listeners&&this._listeners[d]?this._listeners[d].slice():[];for(const C of f)C.call(this,s);const v=this._oneTimeListeners&&this._oneTimeListeners[d]?this._oneTimeListeners[d].slice():[];for(const C of v)_n(d,C,this._oneTimeListeners),C.call(this,s);const x=this._eventedParent;x&&(qi(s,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),x.fire(s))}else s instanceof Ft&&console.error(s.error);return this}listens(s){return this._listeners&&this._listeners[s]&&this._listeners[s].length>0||this._oneTimeListeners&&this._oneTimeListeners[s]&&this._oneTimeListeners[s].length>0||this._eventedParent&&this._eventedParent.listens(s)}setEventedParent(s,l){return this._eventedParent=s,this._eventedParentData=l,this}}var we={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const _s=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Ya(a,s){const l={};for(const d in a)"ref"!==d&&(l[d]=a[d]);return _s.forEach(d=>{d in s&&(l[d]=s[d])}),l}function yn(a,s){if(Array.isArray(a)){if(!Array.isArray(s)||a.length!==s.length)return!1;for(let l=0;l<a.length;l++)if(!yn(a[l],s[l]))return!1;return!0}if("object"==typeof a&&null!==a&&null!==s){if("object"!=typeof s||Object.keys(a).length!==Object.keys(s).length)return!1;for(const l in a)if(!yn(a[l],s[l]))return!1;return!0}return a===s}const on={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function Ja(a,s,l){l.push({command:on.addSource,args:[a,s[a]]})}function Qa(a,s,l){s.push({command:on.removeSource,args:[a]}),l[a]=!0}function Su(a,s,l,d){Qa(a,l,d),Ja(a,s,l)}function Mu(a,s,l){let d;for(d in a[l])if(Object.prototype.hasOwnProperty.call(a[l],d)&&"data"!==d&&!yn(a[l][d],s[l][d]))return!1;for(d in s[l])if(Object.prototype.hasOwnProperty.call(s[l],d)&&"data"!==d&&!yn(a[l][d],s[l][d]))return!1;return!0}function Jn(a,s,l,d,f,v){let x;for(x in s=s||{},a=a||{})Object.prototype.hasOwnProperty.call(a,x)&&(yn(a[x],s[x])||l.push({command:v,args:[d,x,s[x],f]}));for(x in s)Object.prototype.hasOwnProperty.call(s,x)&&!Object.prototype.hasOwnProperty.call(a,x)&&(yn(a[x],s[x])||l.push({command:v,args:[d,x,s[x],f]}))}function el(a){return a.id}function tl(a,s){return a[s.id]=s,a}class Be{constructor(s,l,d,f){this.message=(s?`${s}: `:"")+d,f&&(this.identifier=f),null!=l&&l.__line__&&(this.line=l.__line__)}}function gr(a,...s){for(const l of s)for(const d in l)a[d]=l[d];return a}class sr extends Error{constructor(s,l){super(l),this.message=l,this.key=s}}class Bs{constructor(s,l=[]){this.parent=s,this.bindings={};for(const[d,f]of l)this.bindings[d]=f}concat(s){return new Bs(this,s)}get(s){if(this.bindings[s])return this.bindings[s];if(this.parent)return this.parent.get(s);throw new Error(`${s} not found in scope.`)}has(s){return!!this.bindings[s]||!!this.parent&&this.parent.has(s)}}const Fo={kind:"null"},$e={kind:"number"},Pt={kind:"string"},Ct={kind:"boolean"},Wi={kind:"color"},lo={kind:"object"},bt={kind:"value"},Vs={kind:"collator"},Us={kind:"formatted"},Lo={kind:"padding"},rs={kind:"resolvedImage"},No={kind:"variableAnchorOffsetCollection"};function Xi(a,s){return{kind:"array",itemType:a,N:s}}function kn(a){if("array"===a.kind){const s=kn(a.itemType);return"number"==typeof a.N?`array<${s}, ${a.N}>`:"value"===a.itemType.kind?"array":`array<${s}>`}return a.kind}const Ol=[Fo,$e,Pt,Ct,Wi,Us,lo,Xi(bt),Lo,rs,No];function js(a,s){if("error"===s.kind)return null;if("array"===a.kind){if("array"===s.kind&&(0===s.N&&"value"===s.itemType.kind||!js(a.itemType,s.itemType))&&("number"!=typeof a.N||a.N===s.N))return null}else{if(a.kind===s.kind)return null;if("value"===a.kind)for(const l of Ol)if(!js(l,s))return null}return`Expected ${kn(a)} but found ${kn(s)} instead.`}function Y(a,s){return s.some(l=>l.kind===a.kind)}function N(a,s){return s.some(l=>"null"===l?null===a:"array"===l?Array.isArray(a):"object"===l?a&&!Array.isArray(a)&&"object"==typeof a:l===typeof a)}function V(a,s){return"array"===a.kind&&"array"===s.kind?a.itemType.kind===s.itemType.kind&&"number"==typeof a.N:a.kind===s.kind}const H=.96422,ie=4/29,ue=6/29,ae=3*ue*ue,se=ue*ue*ue,he=Math.PI/180,Te=180/Math.PI;function Ae(a){return(a%=360)<0&&(a+=360),a}function Ee([a,s,l,d]){let f,v;const x=St((.2225045*(a=_t(a))+.7168786*(s=_t(s))+.0606169*(l=_t(l)))/1);a===s&&s===l?f=v=x:(f=St((.4360747*a+.3850649*s+.1430804*l)/H),v=St((.0139322*a+.0971045*s+.7141733*l)/.82521));const C=116*x-16;return[C<0?0:C,500*(f-x),200*(x-v),d]}function _t(a){return a<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}function St(a){return a>se?Math.pow(a,1/3):a/ae+ie}function ot([a,s,l,d]){let f=(a+16)/116,v=isNaN(s)?f:f+s/500,x=isNaN(l)?f:f-l/200;return f=1*Dt(f),v=H*Dt(v),x=.82521*Dt(x),[pt(3.1338561*v-1.6168667*f-.4906146*x),pt(-.9787684*v+1.9161415*f+.033454*x),pt(.0719453*v-.2289914*f+1.4052427*x),d]}function pt(a){return(a=a<=.00304?12.92*a:1.055*Math.pow(a,1/2.4)-.055)<0?0:a>1?1:a}function Dt(a){return a>ue?a*a*a:ae*(a-ie)}function Wt(a){return parseInt(a.padEnd(2,a),16)/255}function vn(a,s){return At(s?a/100:a,0,1)}function At(a,s,l){return Math.min(Math.max(s,a),l)}function qt(a){return!a.some(Number.isNaN)}const ln={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class gt{constructor(s,l,d,f=1,v=!0){this.r=s,this.g=l,this.b=d,this.a=f,v||(this.r*=f,this.g*=f,this.b*=f,f||this.overwriteGetter("rgb",[s,l,d,f]))}static parse(s){if(s instanceof gt)return s;if("string"!=typeof s)return;const l=function(d){if("transparent"===(d=d.toLowerCase().trim()))return[0,0,0,0];const f=ln[d];if(f){const[x,C,S]=f;return[x/255,C/255,S/255,1]}if(d.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(d)){const x=d.length<6?1:2;let C=1;return[Wt(d.slice(C,C+=x)),Wt(d.slice(C,C+=x)),Wt(d.slice(C,C+=x)),Wt(d.slice(C,C+x)||"ff")]}if(d.startsWith("rgb")){const x=d.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(x){const[C,S,T,O,L,B,j,$,K,Q,ne,de]=x,oe=[O||" ",j||" ",Q].join("");if("  "===oe||"  /"===oe||",,"===oe||",,,"===oe){const pe=[T,B,K].join(""),_e="%%%"===pe?100:""===pe?255:0;if(_e){const Me=[At(+S/_e,0,1),At(+L/_e,0,1),At(+$/_e,0,1),ne?vn(+ne,de):1];if(qt(Me))return Me}}return}}const v=d.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(v){const[x,C,S,T,O,L,B,j,$]=v,K=[S||" ",O||" ",B].join("");if("  "===K||"  /"===K||",,"===K||",,,"===K){const Q=[+C,At(+T,0,100),At(+L,0,100),j?vn(+j,$):1];if(qt(Q))return function([ne,de,oe,pe]){function _e(Me){const Ze=(Me+ne/30)%12,it=de*Math.min(oe,1-oe);return oe-it*Math.max(-1,Math.min(Ze-3,9-Ze,1))}return ne=Ae(ne),de/=100,oe/=100,[_e(0),_e(8),_e(4),pe]}(Q)}}}(s);return l?new gt(...l,!1):void 0}get rgb(){const{r:s,g:l,b:d,a:f}=this,v=f||1/0;return this.overwriteGetter("rgb",[s/v,l/v,d/v,f])}get hcl(){return this.overwriteGetter("hcl",function(s){const[l,d,f,v]=Ee(s),x=Math.sqrt(d*d+f*f);return[Math.round(1e4*x)?Ae(Math.atan2(f,d)*Te):NaN,x,l,v]}(this.rgb))}get lab(){return this.overwriteGetter("lab",Ee(this.rgb))}overwriteGetter(s,l){return Object.defineProperty(this,s,{value:l}),l}toString(){const[s,l,d,f]=this.rgb;return`rgba(${[s,l,d].map(v=>Math.round(255*v)).join(",")},${f})`}}gt.black=new gt(0,0,0,1),gt.white=new gt(1,1,1,1),gt.transparent=new gt(0,0,0,0),gt.red=new gt(1,0,0,1);class bn{constructor(s,l,d){this.sensitivity=s?l?"variant":"case":l?"accent":"base",this.locale=d,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(s,l){return this.collator.compare(s,l)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class or{constructor(s,l,d,f,v){this.text=s,this.image=l,this.scale=d,this.fontStack=f,this.textColor=v}}class ui{constructor(s){this.sections=s}static fromString(s){return new ui([new or(s,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some(s=>0!==s.text.length||s.image&&0!==s.image.name.length)}static factory(s){return s instanceof ui?s:ui.fromString(s)}toString(){return 0===this.sections.length?"":this.sections.map(s=>s.text).join("")}}class $r{constructor(s){this.values=s.slice()}static parse(s){if(s instanceof $r)return s;if("number"==typeof s)return new $r([s,s,s,s]);if(Array.isArray(s)&&!(s.length<1||s.length>4)){for(const l of s)if("number"!=typeof l)return;switch(s.length){case 1:s=[s[0],s[0],s[0],s[0]];break;case 2:s=[s[0],s[1],s[0],s[1]];break;case 3:s=[s[0],s[1],s[2],s[1]]}return new $r(s)}}toString(){return JSON.stringify(this.values)}}const Tu=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class Ki{constructor(s){this.values=s.slice()}static parse(s){if(s instanceof Ki)return s;if(Array.isArray(s)&&!(s.length<1)&&s.length%2==0){for(let l=0;l<s.length;l+=2){const d=s[l],f=s[l+1];if("string"!=typeof d||!Tu.has(d)||!Array.isArray(f)||2!==f.length||"number"!=typeof f[0]||"number"!=typeof f[1])return}return new Ki(s)}}toString(){return JSON.stringify(this.values)}}class ar{constructor(s){this.name=s.name,this.available=s.available}toString(){return this.name}static fromString(s){return s?new ar({name:s,available:!1}):null}}function Bd(a,s,l,d){return"number"==typeof a&&a>=0&&a<=255&&"number"==typeof s&&s>=0&&s<=255&&"number"==typeof l&&l>=0&&l<=255?void 0===d||"number"==typeof d&&d>=0&&d<=1?null:`Invalid rgba value [${[a,s,l,d].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof d?[a,s,l,d]:[a,s,l]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Fl(a){if(null===a||"string"==typeof a||"boolean"==typeof a||"number"==typeof a||a instanceof gt||a instanceof bn||a instanceof ui||a instanceof $r||a instanceof Ki||a instanceof ar)return!0;if(Array.isArray(a)){for(const s of a)if(!Fl(s))return!1;return!0}if("object"==typeof a){for(const s in a)if(!Fl(a[s]))return!1;return!0}return!1}function ii(a){if(null===a)return Fo;if("string"==typeof a)return Pt;if("boolean"==typeof a)return Ct;if("number"==typeof a)return $e;if(a instanceof gt)return Wi;if(a instanceof bn)return Vs;if(a instanceof ui)return Us;if(a instanceof $r)return Lo;if(a instanceof Ki)return No;if(a instanceof ar)return rs;if(Array.isArray(a)){const s=a.length;let l;for(const d of a){const f=ii(d);if(l){if(l===f)continue;l=bt;break}l=f}return Xi(l||bt,s)}return lo}function zo(a){const s=typeof a;return null===a?"":"string"===s||"number"===s||"boolean"===s?String(a):a instanceof gt||a instanceof ui||a instanceof $r||a instanceof Ki||a instanceof ar?a.toString():JSON.stringify(a)}class ua{constructor(s,l){this.type=s,this.value=l}static parse(s,l){if(2!==s.length)return l.error(`'literal' expression requires exactly one argument, but found ${s.length-1} instead.`);if(!Fl(s[1]))return l.error("invalid value");const d=s[1];let f=ii(d);const v=l.expectedType;return"array"!==f.kind||0!==f.N||!v||"array"!==v.kind||"number"==typeof v.N&&0!==v.N||(f=v),new ua(f,d)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class di{constructor(s){this.name="ExpressionEvaluationError",this.message=s}toJSON(){return this.message}}const wc={string:Pt,number:$e,boolean:Ct,object:lo};class Yi{constructor(s,l){this.type=s,this.args=l}static parse(s,l){if(s.length<2)return l.error("Expected at least one argument.");let d,f=1;const v=s[0];if("array"===v){let C,S;if(s.length>2){const T=s[1];if("string"!=typeof T||!(T in wc)||"object"===T)return l.error('The item type argument of "array" must be one of string, number, boolean',1);C=wc[T],f++}else C=bt;if(s.length>3){if(null!==s[2]&&("number"!=typeof s[2]||s[2]<0||s[2]!==Math.floor(s[2])))return l.error('The length argument to "array" must be a positive integer literal',2);S=s[2],f++}d=Xi(C,S)}else{if(!wc[v])throw new Error(`Types doesn't contain name = ${v}`);d=wc[v]}const x=[];for(;f<s.length;f++){const C=l.parse(s[f],f,bt);if(!C)return null;x.push(C)}return new Yi(d,x)}evaluate(s){for(let l=0;l<this.args.length;l++){const d=this.args[l].evaluate(s);if(!js(this.type,ii(d)))return d;if(l===this.args.length-1)throw new di(`Expected value to be of type ${kn(this.type)}, but found ${kn(ii(d))} instead.`)}throw new Error}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every(s=>s.outputDefined())}}const Cc={"to-boolean":Ct,"to-color":Wi,"to-number":$e,"to-string":Pt};class $s{constructor(s,l){this.type=s,this.args=l}static parse(s,l){if(s.length<2)return l.error("Expected at least one argument.");const d=s[0];if(!Cc[d])throw new Error(`Can't parse ${d} as it is not part of the known types`);if(("to-boolean"===d||"to-string"===d)&&2!==s.length)return l.error("Expected one argument.");const f=Cc[d],v=[];for(let x=1;x<s.length;x++){const C=l.parse(s[x],x,bt);if(!C)return null;v.push(C)}return new $s(f,v)}evaluate(s){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(s);case"color":{let l,d;for(const f of this.args){if(l=f.evaluate(s),d=null,l instanceof gt)return l;if("string"==typeof l){const v=s.parseColor(l);if(v)return v}else if(Array.isArray(l)&&(d=l.length<3||l.length>4?`Invalid rbga value ${JSON.stringify(l)}: expected an array containing either three or four numeric values.`:Bd(l[0],l[1],l[2],l[3]),!d))return new gt(l[0]/255,l[1]/255,l[2]/255,l[3])}throw new di(d||`Could not parse color from value '${"string"==typeof l?l:JSON.stringify(l)}'`)}case"padding":{let l;for(const d of this.args){l=d.evaluate(s);const f=$r.parse(l);if(f)return f}throw new di(`Could not parse padding from value '${"string"==typeof l?l:JSON.stringify(l)}'`)}case"variableAnchorOffsetCollection":{let l;for(const d of this.args){l=d.evaluate(s);const f=Ki.parse(l);if(f)return f}throw new di(`Could not parse variableAnchorOffsetCollection from value '${"string"==typeof l?l:JSON.stringify(l)}'`)}case"number":{let l=null;for(const d of this.args){if(l=d.evaluate(s),null===l)return 0;const f=Number(l);if(!isNaN(f))return f}throw new di(`Could not convert ${JSON.stringify(l)} to number.`)}case"formatted":return ui.fromString(zo(this.args[0].evaluate(s)));case"resolvedImage":return ar.fromString(zo(this.args[0].evaluate(s)));default:return zo(this.args[0].evaluate(s))}}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every(s=>s.outputDefined())}}const Qn=["Unknown","Point","LineString","Polygon"];class hn{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?Qn[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(s){let l=this._parseColorCache[s];return l||(l=this._parseColorCache[s]=gt.parse(s)),l}}class _r{constructor(s,l,d=[],f,v=new Bs,x=[]){this.registry=s,this.path=d,this.key=d.map(C=>`[${C}]`).join(""),this.scope=v,this.errors=x,this.expectedType=f,this._isConstant=l}parse(s,l,d,f,v={}){return l?this.concat(l,d,f)._parse(s,v):this._parse(s,v)}_parse(s,l){function d(f,v,x){return"assert"===x?new Yi(v,[f]):"coerce"===x?new $s(v,[f]):f}if(null!==s&&"string"!=typeof s&&"boolean"!=typeof s&&"number"!=typeof s||(s=["literal",s]),Array.isArray(s)){if(0===s.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const f=s[0];if("string"!=typeof f)return this.error(`Expression name must be a string, but found ${typeof f} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const v=this.registry[f];if(v){let x=v.parse(s,this);if(!x)return null;if(this.expectedType){const C=this.expectedType,S=x.type;if("string"!==C.kind&&"number"!==C.kind&&"boolean"!==C.kind&&"object"!==C.kind&&"array"!==C.kind||"value"!==S.kind)if("color"!==C.kind&&"formatted"!==C.kind&&"resolvedImage"!==C.kind||"value"!==S.kind&&"string"!==S.kind)if("padding"!==C.kind||"value"!==S.kind&&"number"!==S.kind&&"array"!==S.kind)if("variableAnchorOffsetCollection"!==C.kind||"value"!==S.kind&&"array"!==S.kind){if(this.checkSubtype(C,S))return null}else x=d(x,C,l.typeAnnotation||"coerce");else x=d(x,C,l.typeAnnotation||"coerce");else x=d(x,C,l.typeAnnotation||"coerce");else x=d(x,C,l.typeAnnotation||"assert")}if(!(x instanceof ua)&&"resolvedImage"!==x.type.kind&&this._isConstant(x)){const C=new hn;try{x=new ua(x.type,x.evaluate(C))}catch(S){return this.error(S.message),null}}return x}return this.error(`Unknown expression "${f}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(void 0===s?"'undefined' value invalid. Use null instead.":"object"==typeof s?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof s} instead.`)}concat(s,l,d){const f="number"==typeof s?this.path.concat(s):this.path,v=d?this.scope.concat(d):this.scope;return new _r(this.registry,this._isConstant,f,l||null,v,this.errors)}error(s,...l){const d=`${this.key}${l.map(f=>`[${f}]`).join("")}`;this.errors.push(new sr(d,s))}checkSubtype(s,l){const d=js(s,l);return d&&this.error(d),d}}class Et{constructor(s,l,d){this.type=Vs,this.locale=d,this.caseSensitive=s,this.diacriticSensitive=l}static parse(s,l){if(2!==s.length)return l.error("Expected one argument.");const d=s[1];if("object"!=typeof d||Array.isArray(d))return l.error("Collator options argument must be an object.");const f=l.parse(void 0!==d["case-sensitive"]&&d["case-sensitive"],1,Ct);if(!f)return null;const v=l.parse(void 0!==d["diacritic-sensitive"]&&d["diacritic-sensitive"],1,Ct);if(!v)return null;let x=null;return d.locale&&(x=l.parse(d.locale,1,Pt),!x)?null:new Et(f,v,x)}evaluate(s){return new bn(this.caseSensitive.evaluate(s),this.diacriticSensitive.evaluate(s),this.locale?this.locale.evaluate(s):null)}eachChild(s){s(this.caseSensitive),s(this.diacriticSensitive),this.locale&&s(this.locale)}outputDefined(){return!1}}const co=8192;function nl(a,s){a[0]=Math.min(a[0],s[0]),a[1]=Math.min(a[1],s[1]),a[2]=Math.max(a[2],s[0]),a[3]=Math.max(a[3],s[1])}function lr(a,s){return!(a[0]<=s[0]||a[2]>=s[2]||a[1]<=s[1]||a[3]>=s[3])}function Cp(a,s){const l=(180+a[0])/360,d=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a[1]*Math.PI/360)))/360,f=Math.pow(2,s.z);return[Math.round(l*f*co),Math.round(d*f*co)]}function Vd(a,s,l){const d=a[0]-s[0],f=a[1]-s[1],v=a[0]-l[0],x=a[1]-l[1];return d*x-v*f==0&&d*v<=0&&f*x<=0}function an(a,s){let l=!1;for(let x=0,C=s.length;x<C;x++){const S=s[x];for(let T=0,O=S.length;T<O-1;T++){if(Vd(a,S[T],S[T+1]))return!1;(f=S[T])[1]>(d=a)[1]!=(v=S[T+1])[1]>d[1]&&d[0]<(v[0]-f[0])*(d[1]-f[1])/(v[1]-f[1])+f[0]&&(l=!l)}}var d,f,v;return l}function Ec(a,s){for(let l=0;l<s.length;l++)if(an(a,s[l]))return!0;return!1}function vi(a,s,l,d){const f=d[0]-l[0],v=d[1]-l[1],x=(a[0]-l[0])*v-f*(a[1]-l[1]),C=(s[0]-l[0])*v-f*(s[1]-l[1]);return x>0&&C<0||x<0&&C>0}function Au(a,s,l){for(const T of l)for(let O=0;O<T.length-1;++O)if((C=[(x=T[O+1])[0]-(v=T[O])[0],x[1]-v[1]])[0]*(S=[(f=s)[0]-(d=a)[0],f[1]-d[1]])[1]-C[1]*S[0]!=0&&vi(d,f,v,x)&&vi(v,x,d,f))return!0;var d,f,v,x,C,S;return!1}function Ud(a,s){for(let l=0;l<a.length;++l)if(!an(a[l],s))return!1;for(let l=0;l<a.length-1;++l)if(Au(a[l],a[l+1],s))return!1;return!0}function pn(a,s){for(let l=0;l<s.length;l++)if(Ud(a,s[l]))return!0;return!1}function It(a,s,l){const d=[];for(let f=0;f<a.length;f++){const v=[];for(let x=0;x<a[f].length;x++){const C=Cp(a[f][x],l);nl(s,C),v.push(C)}d.push(v)}return d}function Dc(a,s,l){const d=[];for(let f=0;f<a.length;f++){const v=It(a[f],s,l);d.push(v)}return d}function Ic(a,s,l,d){if(a[0]<l[0]||a[0]>l[2]){const f=.5*d;let v=a[0]-l[0]>f?-d:l[0]-a[0]>f?d:0;0===v&&(v=a[0]-l[2]>f?-d:l[2]-a[0]>f?d:0),a[0]+=v}nl(s,a)}function ku(a,s,l,d){const f=Math.pow(2,d.z)*co,v=[d.x*co,d.y*co],x=[];for(const C of a)for(const S of C){const T=[S.x+v[0],S.y+v[1]];Ic(T,s,l,f),x.push(T)}return x}function Pu(a,s,l,d){const f=Math.pow(2,d.z)*co,v=[d.x*co,d.y*co],x=[];for(const S of a){const T=[];for(const O of S){const L=[O.x+v[0],O.y+v[1]];nl(s,L),T.push(L)}x.push(T)}if(s[2]-s[0]<=f/2){(C=s)[0]=C[1]=1/0,C[2]=C[3]=-1/0;for(const S of x)for(const T of S)Ic(T,s,l,f)}var C;return x}class Pe{constructor(s,l){this.type=Ct,this.geojson=s,this.geometries=l}static parse(s,l){if(2!==s.length)return l.error(`'within' expression requires exactly one argument, but found ${s.length-1} instead.`);if(Fl(s[1])){const d=s[1];if("FeatureCollection"===d.type)for(let f=0;f<d.features.length;++f){const v=d.features[f].geometry.type;if("Polygon"===v||"MultiPolygon"===v)return new Pe(d,d.features[f].geometry)}else if("Feature"===d.type){const f=d.geometry.type;if("Polygon"===f||"MultiPolygon"===f)return new Pe(d,d.geometry)}else if("Polygon"===d.type||"MultiPolygon"===d.type)return new Pe(d,d)}return l.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(s){if(null!=s.geometry()&&null!=s.canonicalID()){if("Point"===s.geometryType())return function(l,d){const f=[1/0,1/0,-1/0,-1/0],v=[1/0,1/0,-1/0,-1/0],x=l.canonicalID();if("Polygon"===d.type){const C=It(d.coordinates,v,x),S=ku(l.geometry(),f,v,x);if(!lr(f,v))return!1;for(const T of S)if(!an(T,C))return!1}if("MultiPolygon"===d.type){const C=Dc(d.coordinates,v,x),S=ku(l.geometry(),f,v,x);if(!lr(f,v))return!1;for(const T of S)if(!Ec(T,C))return!1}return!0}(s,this.geometries);if("LineString"===s.geometryType())return function(l,d){const f=[1/0,1/0,-1/0,-1/0],v=[1/0,1/0,-1/0,-1/0],x=l.canonicalID();if("Polygon"===d.type){const C=It(d.coordinates,v,x),S=Pu(l.geometry(),f,v,x);if(!lr(f,v))return!1;for(const T of S)if(!Ud(T,C))return!1}if("MultiPolygon"===d.type){const C=Dc(d.coordinates,v,x),S=Pu(l.geometry(),f,v,x);if(!lr(f,v))return!1;for(const T of S)if(!pn(T,C))return!1}return!0}(s,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}class da{constructor(s,l){this.type=l.type,this.name=s,this.boundExpression=l}static parse(s,l){if(2!==s.length||"string"!=typeof s[1])return l.error("'var' expression requires exactly one string literal argument.");const d=s[1];return l.scope.has(d)?new da(d,l.scope.get(d)):l.error(`Unknown variable "${d}". Make sure "${d}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(s){return this.boundExpression.evaluate(s)}eachChild(){}outputDefined(){return!1}}class vt{constructor(s,l,d,f){this.name=s,this.type=l,this._evaluate=d,this.args=f}evaluate(s){return this._evaluate(s,this.args)}eachChild(s){this.args.forEach(s)}outputDefined(){return!1}static parse(s,l){const d=s[0],f=vt.definitions[d];if(!f)return l.error(`Unknown expression "${d}". If you wanted a literal array, use ["literal", [...]].`,0);const v=Array.isArray(f)?f[0]:f.type,x=Array.isArray(f)?[[f[1],f[2]]]:f.overloads,C=x.filter(([T])=>!Array.isArray(T)||T.length===s.length-1);let S=null;for(const[T,O]of C){S=new _r(l.registry,Qt,l.path,null,l.scope);const L=[];let B=!1;for(let j=1;j<s.length;j++){const $=s[j],K=Array.isArray(T)?T[j-1]:T.type,Q=S.parse($,1+L.length,K);if(!Q){B=!0;break}L.push(Q)}if(!B)if(Array.isArray(T)&&T.length!==L.length)S.error(`Expected ${T.length} arguments, but found ${L.length} instead.`);else{for(let j=0;j<L.length;j++){const $=Array.isArray(T)?T[j]:T.type,K=L[j];S.concat(j+1).checkSubtype($,K.type)}if(0===S.errors.length)return new vt(d,v,O,L)}}if(1===C.length)l.errors.push(...S.errors);else{const T=(C.length?C:x).map(([L])=>{return B=L,Array.isArray(B)?`(${B.map(kn).join(", ")})`:`(${kn(B.type)}...)`;var B}).join(" | "),O=[];for(let L=1;L<s.length;L++){const B=l.parse(s[L],1+O.length);if(!B)return null;O.push(kn(B.type))}l.error(`Expected arguments of type ${T}, but found (${O.join(", ")}) instead.`)}return null}static register(s,l){vt.definitions=l;for(const d in l)s[d]=vt}}function Qt(a){if(a instanceof da)return Qt(a.boundExpression);if(a instanceof vt&&"error"===a.name||a instanceof Et||a instanceof Pe)return!1;const s=a instanceof $s||a instanceof Yi;let l=!0;return a.eachChild(d=>{l=s?l&&Qt(d):l&&d instanceof ua}),!!l&&Sc(a)&&Ll(a,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function Sc(a){if(a instanceof vt&&("get"===a.name&&1===a.args.length||"feature-state"===a.name||"has"===a.name&&1===a.args.length||"properties"===a.name||"geometry-type"===a.name||"id"===a.name||/^filter-/.test(a.name))||a instanceof Pe)return!1;let s=!0;return a.eachChild(l=>{s&&!Sc(l)&&(s=!1)}),s}function Mc(a){if(a instanceof vt&&"feature-state"===a.name)return!1;let s=!0;return a.eachChild(l=>{s&&!Mc(l)&&(s=!1)}),s}function Ll(a,s){if(a instanceof vt&&s.indexOf(a.name)>=0)return!1;let l=!0;return a.eachChild(d=>{l&&!Ll(d,s)&&(l=!1)}),l}function ha(a,s){const l=a.length-1;let d,f,v=0,x=l,C=0;for(;v<=x;)if(C=Math.floor((v+x)/2),d=a[C],f=a[C+1],d<=s){if(C===l||s<f)return C;v=C+1}else{if(!(d>s))throw new di("Input is not a number.");x=C-1}return 0}class Ji{constructor(s,l,d){this.type=s,this.input=l,this.labels=[],this.outputs=[];for(const[f,v]of d)this.labels.push(f),this.outputs.push(v)}static parse(s,l){if(s.length-1<4)return l.error(`Expected at least 4 arguments, but found only ${s.length-1}.`);if((s.length-1)%2!=0)return l.error("Expected an even number of arguments.");const d=l.parse(s[1],1,$e);if(!d)return null;const f=[];let v=null;l.expectedType&&"value"!==l.expectedType.kind&&(v=l.expectedType);for(let x=1;x<s.length;x+=2){const C=1===x?-1/0:s[x],S=s[x+1],T=x,O=x+1;if("number"!=typeof C)return l.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',T);if(f.length&&f[f.length-1][0]>=C)return l.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',T);const L=l.parse(S,O,v);if(!L)return null;v=v||L.type,f.push([C,L])}return new Ji(v,d,f)}evaluate(s){const l=this.labels,d=this.outputs;if(1===l.length)return d[0].evaluate(s);const f=this.input.evaluate(s);if(f<=l[0])return d[0].evaluate(s);const v=l.length;return f>=l[v-1]?d[v-1].evaluate(s):d[ha(l,f)].evaluate(s)}eachChild(s){s(this.input);for(const l of this.outputs)s(l)}outputDefined(){return this.outputs.every(s=>s.outputDefined())}}function il(a,s,l){return a+l*(s-a)}function Tc(a,s,l){return a.map((d,f)=>il(d,s[f],l))}const ss={number:il,color:function(a,s,l,d="rgb"){switch(d){case"rgb":{const[f,v,x,C]=Tc(a.rgb,s.rgb,l);return new gt(f,v,x,C,!1)}case"hcl":{const[f,v,x,C]=a.hcl,[S,T,O,L]=s.hcl;let B,j;if(isNaN(f)||isNaN(S))isNaN(f)?isNaN(S)?B=NaN:(B=S,1!==x&&0!==x||(j=T)):(B=f,1!==O&&0!==O||(j=v));else{let de=S-f;S>f&&de>180?de-=360:S<f&&f-S>180&&(de+=360),B=f+l*de}const[$,K,Q,ne]=function([de,oe,pe,_e]){return de=isNaN(de)?0:de*he,ot([pe,Math.cos(de)*oe,Math.sin(de)*oe,_e])}([B,j??il(v,T,l),il(x,O,l),il(C,L,l)]);return new gt($,K,Q,ne,!1)}case"lab":{const[f,v,x,C]=ot(Tc(a.lab,s.lab,l));return new gt(f,v,x,C,!1)}}},array:Tc,padding:function(a,s,l){return new $r(Tc(a.values,s.values,l))},variableAnchorOffsetCollection:function(a,s,l){const d=a.values,f=s.values;if(d.length!==f.length)throw new di(`Cannot interpolate values of different length. from: ${a.toString()}, to: ${s.toString()}`);const v=[];for(let x=0;x<d.length;x+=2){if(d[x]!==f[x])throw new di(`Cannot interpolate values containing mismatched anchors. from[${x}]: ${d[x]}, to[${x}]: ${f[x]}`);v.push(d[x]);const[C,S]=d[x+1],[T,O]=f[x+1];v.push([il(C,T,l),il(S,O,l)])}return new Ki(v)}};class Si{constructor(s,l,d,f,v){this.type=s,this.operator=l,this.interpolation=d,this.input=f,this.labels=[],this.outputs=[];for(const[x,C]of v)this.labels.push(x),this.outputs.push(C)}static interpolationFactor(s,l,d,f){let v=0;if("exponential"===s.name)v=jd(l,s.base,d,f);else if("linear"===s.name)v=jd(l,1,d,f);else if("cubic-bezier"===s.name){const x=s.controlPoints;v=new Xa(x[0],x[1],x[2],x[3]).solve(jd(l,1,d,f))}return v}static parse(s,l){let[d,f,v,...x]=s;if(!Array.isArray(f)||0===f.length)return l.error("Expected an interpolation type expression.",1);if("linear"===f[0])f={name:"linear"};else if("exponential"===f[0]){const T=f[1];if("number"!=typeof T)return l.error("Exponential interpolation requires a numeric base.",1,1);f={name:"exponential",base:T}}else{if("cubic-bezier"!==f[0])return l.error(`Unknown interpolation type ${String(f[0])}`,1,0);{const T=f.slice(1);if(4!==T.length||T.some(O=>"number"!=typeof O||O<0||O>1))return l.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);f={name:"cubic-bezier",controlPoints:T}}}if(s.length-1<4)return l.error(`Expected at least 4 arguments, but found only ${s.length-1}.`);if((s.length-1)%2!=0)return l.error("Expected an even number of arguments.");if(v=l.parse(v,2,$e),!v)return null;const C=[];let S=null;"interpolate-hcl"===d||"interpolate-lab"===d?S=Wi:l.expectedType&&"value"!==l.expectedType.kind&&(S=l.expectedType);for(let T=0;T<x.length;T+=2){const O=x[T],L=x[T+1],B=T+3,j=T+4;if("number"!=typeof O)return l.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',B);if(C.length&&C[C.length-1][0]>=O)return l.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',B);const $=l.parse(L,j,S);if(!$)return null;S=S||$.type,C.push([O,$])}return V(S,$e)||V(S,Wi)||V(S,Lo)||V(S,No)||V(S,Xi($e))?new Si(S,d,f,v,C):l.error(`Type ${kn(S)} is not interpolatable.`)}evaluate(s){const l=this.labels,d=this.outputs;if(1===l.length)return d[0].evaluate(s);const f=this.input.evaluate(s);if(f<=l[0])return d[0].evaluate(s);const v=l.length;if(f>=l[v-1])return d[v-1].evaluate(s);const x=ha(l,f),C=Si.interpolationFactor(this.interpolation,f,l[x],l[x+1]),S=d[x].evaluate(s),T=d[x+1].evaluate(s);switch(this.operator){case"interpolate":return ss[this.type.kind](S,T,C);case"interpolate-hcl":return ss.color(S,T,C,"hcl");case"interpolate-lab":return ss.color(S,T,C,"lab")}}eachChild(s){s(this.input);for(const l of this.outputs)s(l)}outputDefined(){return this.outputs.every(s=>s.outputDefined())}}function jd(a,s,l,d){const f=d-l,v=a-l;return 0===f?0:1===s?v/f:(Math.pow(s,v)-1)/(Math.pow(s,f)-1)}class Ru{constructor(s,l){this.type=s,this.args=l}static parse(s,l){if(s.length<2)return l.error("Expectected at least one argument.");let d=null;const f=l.expectedType;f&&"value"!==f.kind&&(d=f);const v=[];for(const C of s.slice(1)){const S=l.parse(C,1+v.length,d,void 0,{typeAnnotation:"omit"});if(!S)return null;d=d||S.type,v.push(S)}if(!d)throw new Error("No output type");const x=f&&v.some(C=>js(f,C.type));return new Ru(x?bt:d,v)}evaluate(s){let l,d=null,f=0;for(const v of this.args)if(f++,d=v.evaluate(s),d&&d instanceof ar&&!d.available&&(l||(l=d.name),d=null,f===this.args.length&&(d=l)),null!==d)break;return d}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every(s=>s.outputDefined())}}class Nl{constructor(s,l){this.type=l.type,this.bindings=[].concat(s),this.result=l}evaluate(s){return this.result.evaluate(s)}eachChild(s){for(const l of this.bindings)s(l[1]);s(this.result)}static parse(s,l){if(s.length<4)return l.error(`Expected at least 3 arguments, but found ${s.length-1} instead.`);const d=[];for(let v=1;v<s.length-1;v+=2){const x=s[v];if("string"!=typeof x)return l.error(`Expected string, but found ${typeof x} instead.`,v);if(/[^a-zA-Z0-9_]/.test(x))return l.error("Variable names must contain only alphanumeric characters or '_'.",v);const C=l.parse(s[v+1],v+1);if(!C)return null;d.push([x,C])}const f=l.parse(s[s.length-1],s.length-1,l.expectedType,d);return f?new Nl(d,f):null}outputDefined(){return this.result.outputDefined()}}class zl{constructor(s,l,d){this.type=s,this.index=l,this.input=d}static parse(s,l){if(3!==s.length)return l.error(`Expected 2 arguments, but found ${s.length-1} instead.`);const d=l.parse(s[1],1,$e),f=l.parse(s[2],2,Xi(l.expectedType||bt));return d&&f?new zl(f.type.itemType,d,f):null}evaluate(s){const l=this.index.evaluate(s),d=this.input.evaluate(s);if(l<0)throw new di(`Array index out of bounds: ${l} < 0.`);if(l>=d.length)throw new di(`Array index out of bounds: ${l} > ${d.length-1}.`);if(l!==Math.floor(l))throw new di(`Array index must be an integer, but found ${l} instead.`);return d[l]}eachChild(s){s(this.index),s(this.input)}outputDefined(){return!1}}class en{constructor(s,l){this.type=Ct,this.needle=s,this.haystack=l}static parse(s,l){if(3!==s.length)return l.error(`Expected 2 arguments, but found ${s.length-1} instead.`);const d=l.parse(s[1],1,bt),f=l.parse(s[2],2,bt);return d&&f?Y(d.type,[Ct,Pt,$e,Fo,bt])?new en(d,f):l.error(`Expected first argument to be of type boolean, string, number or null, but found ${kn(d.type)} instead`):null}evaluate(s){const l=this.needle.evaluate(s),d=this.haystack.evaluate(s);if(!d)return!1;if(!N(l,["boolean","string","number","null"]))throw new di(`Expected first argument to be of type boolean, string, number or null, but found ${kn(ii(l))} instead.`);if(!N(d,["string","array"]))throw new di(`Expected second argument to be of type array or string, but found ${kn(ii(d))} instead.`);return d.indexOf(l)>=0}eachChild(s){s(this.needle),s(this.haystack)}outputDefined(){return!0}}class Ou{constructor(s,l,d){this.type=$e,this.needle=s,this.haystack=l,this.fromIndex=d}static parse(s,l){if(s.length<=2||s.length>=5)return l.error(`Expected 3 or 4 arguments, but found ${s.length-1} instead.`);const d=l.parse(s[1],1,bt),f=l.parse(s[2],2,bt);if(!d||!f)return null;if(!Y(d.type,[Ct,Pt,$e,Fo,bt]))return l.error(`Expected first argument to be of type boolean, string, number or null, but found ${kn(d.type)} instead`);if(4===s.length){const v=l.parse(s[3],3,$e);return v?new Ou(d,f,v):null}return new Ou(d,f)}evaluate(s){const l=this.needle.evaluate(s),d=this.haystack.evaluate(s);if(!N(l,["boolean","string","number","null"]))throw new di(`Expected first argument to be of type boolean, string, number or null, but found ${kn(ii(l))} instead.`);if(!N(d,["string","array"]))throw new di(`Expected second argument to be of type array or string, but found ${kn(ii(d))} instead.`);if(this.fromIndex){const f=this.fromIndex.evaluate(s);return d.indexOf(l,f)}return d.indexOf(l)}eachChild(s){s(this.needle),s(this.haystack),this.fromIndex&&s(this.fromIndex)}outputDefined(){return!1}}class Fu{constructor(s,l,d,f,v,x){this.inputType=s,this.type=l,this.input=d,this.cases=f,this.outputs=v,this.otherwise=x}static parse(s,l){if(s.length<5)return l.error(`Expected at least 4 arguments, but found only ${s.length-1}.`);if(s.length%2!=1)return l.error("Expected an even number of arguments.");let d,f;l.expectedType&&"value"!==l.expectedType.kind&&(f=l.expectedType);const v={},x=[];for(let T=2;T<s.length-1;T+=2){let O=s[T];const L=s[T+1];Array.isArray(O)||(O=[O]);const B=l.concat(T);if(0===O.length)return B.error("Expected at least one branch label.");for(const $ of O){if("number"!=typeof $&&"string"!=typeof $)return B.error("Branch labels must be numbers or strings.");if("number"==typeof $&&Math.abs($)>Number.MAX_SAFE_INTEGER)return B.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof $&&Math.floor($)!==$)return B.error("Numeric branch labels must be integer values.");if(d){if(B.checkSubtype(d,ii($)))return null}else d=ii($);if(void 0!==v[String($)])return B.error("Branch labels must be unique.");v[String($)]=x.length}const j=l.parse(L,T,f);if(!j)return null;f=f||j.type,x.push(j)}const C=l.parse(s[1],1,bt);if(!C)return null;const S=l.parse(s[s.length-1],s.length-1,f);return S?"value"!==C.type.kind&&l.concat(1).checkSubtype(d,C.type)?null:new Fu(d,f,C,v,x,S):null}evaluate(s){const l=this.input.evaluate(s);return(ii(l)===this.inputType&&this.outputs[this.cases[l]]||this.otherwise).evaluate(s)}eachChild(s){s(this.input),this.outputs.forEach(s),s(this.otherwise)}outputDefined(){return this.outputs.every(s=>s.outputDefined())&&this.otherwise.outputDefined()}}class $d{constructor(s,l,d){this.type=s,this.branches=l,this.otherwise=d}static parse(s,l){if(s.length<4)return l.error(`Expected at least 3 arguments, but found only ${s.length-1}.`);if(s.length%2!=0)return l.error("Expected an odd number of arguments.");let d;l.expectedType&&"value"!==l.expectedType.kind&&(d=l.expectedType);const f=[];for(let x=1;x<s.length-1;x+=2){const C=l.parse(s[x],x,Ct);if(!C)return null;const S=l.parse(s[x+1],x+1,d);if(!S)return null;f.push([C,S]),d=d||S.type}const v=l.parse(s[s.length-1],s.length-1,d);if(!v)return null;if(!d)throw new Error("Can't infer output type");return new $d(d,f,v)}evaluate(s){for(const[l,d]of this.branches)if(l.evaluate(s))return d.evaluate(s);return this.otherwise.evaluate(s)}eachChild(s){for(const[l,d]of this.branches)s(l),s(d);s(this.otherwise)}outputDefined(){return this.branches.every(([s,l])=>l.outputDefined())&&this.otherwise.outputDefined()}}class yr{constructor(s,l,d,f){this.type=s,this.input=l,this.beginIndex=d,this.endIndex=f}static parse(s,l){if(s.length<=2||s.length>=5)return l.error(`Expected 3 or 4 arguments, but found ${s.length-1} instead.`);const d=l.parse(s[1],1,bt),f=l.parse(s[2],2,$e);if(!d||!f)return null;if(!Y(d.type,[Xi(bt),Pt,bt]))return l.error(`Expected first argument to be of type array or string, but found ${kn(d.type)} instead`);if(4===s.length){const v=l.parse(s[3],3,$e);return v?new yr(d.type,d,f,v):null}return new yr(d.type,d,f)}evaluate(s){const l=this.input.evaluate(s),d=this.beginIndex.evaluate(s);if(!N(l,["string","array"]))throw new di(`Expected first argument to be of type array or string, but found ${kn(ii(l))} instead.`);if(this.endIndex){const f=this.endIndex.evaluate(s);return l.slice(d,f)}return l.slice(d)}eachChild(s){s(this.input),s(this.beginIndex),this.endIndex&&s(this.endIndex)}outputDefined(){return!1}}function Mt(a,s){return"=="===a||"!="===a?"boolean"===s.kind||"string"===s.kind||"number"===s.kind||"null"===s.kind||"value"===s.kind:"string"===s.kind||"number"===s.kind||"value"===s.kind}function Ep(a,s,l,d){return 0===d.compare(s,l)}function Bl(a,s,l){const d="=="!==a&&"!="!==a;return class kT{constructor(v,x,C){this.type=Ct,this.lhs=v,this.rhs=x,this.collator=C,this.hasUntypedArgument="value"===v.type.kind||"value"===x.type.kind}static parse(v,x){if(3!==v.length&&4!==v.length)return x.error("Expected two or three arguments.");const C=v[0];let S=x.parse(v[1],1,bt);if(!S)return null;if(!Mt(C,S.type))return x.concat(1).error(`"${C}" comparisons are not supported for type '${kn(S.type)}'.`);let T=x.parse(v[2],2,bt);if(!T)return null;if(!Mt(C,T.type))return x.concat(2).error(`"${C}" comparisons are not supported for type '${kn(T.type)}'.`);if(S.type.kind!==T.type.kind&&"value"!==S.type.kind&&"value"!==T.type.kind)return x.error(`Cannot compare types '${kn(S.type)}' and '${kn(T.type)}'.`);d&&("value"===S.type.kind&&"value"!==T.type.kind?S=new Yi(T.type,[S]):"value"!==S.type.kind&&"value"===T.type.kind&&(T=new Yi(S.type,[T])));let O=null;if(4===v.length){if("string"!==S.type.kind&&"string"!==T.type.kind&&"value"!==S.type.kind&&"value"!==T.type.kind)return x.error("Cannot use collator to compare non-string types.");if(O=x.parse(v[3],3,Vs),!O)return null}return new kT(S,T,O)}evaluate(v){const x=this.lhs.evaluate(v),C=this.rhs.evaluate(v);if(d&&this.hasUntypedArgument){const S=ii(x),T=ii(C);if(S.kind!==T.kind||"string"!==S.kind&&"number"!==S.kind)throw new di(`Expected arguments for "${a}" to be (string, string) or (number, number), but found (${S.kind}, ${T.kind}) instead.`)}if(this.collator&&!d&&this.hasUntypedArgument){const S=ii(x),T=ii(C);if("string"!==S.kind||"string"!==T.kind)return s(v,x,C)}return this.collator?l(v,x,C,this.collator.evaluate(v)):s(v,x,C)}eachChild(v){v(this.lhs),v(this.rhs),this.collator&&v(this.collator)}outputDefined(){return!0}}}const Rm=Bl("==",function(a,s,l){return s===l},Ep),ct=Bl("!=",function(a,s,l){return s!==l},function(a,s,l,d){return!Ep(0,s,l,d)}),Om=Bl("<",function(a,s,l){return s<l},function(a,s,l,d){return d.compare(s,l)<0}),Fi=Bl(">",function(a,s,l){return s>l},function(a,s,l,d){return d.compare(s,l)>0}),Ac=Bl("<=",function(a,s,l){return s<=l},function(a,s,l,d){return d.compare(s,l)<=0}),Dp=Bl(">=",function(a,s,l){return s>=l},function(a,s,l,d){return d.compare(s,l)>=0});class kc{constructor(s,l,d,f,v){this.type=Pt,this.number=s,this.locale=l,this.currency=d,this.minFractionDigits=f,this.maxFractionDigits=v}static parse(s,l){if(3!==s.length)return l.error("Expected two arguments.");const d=l.parse(s[1],1,$e);if(!d)return null;const f=s[2];if("object"!=typeof f||Array.isArray(f))return l.error("NumberFormat options argument must be an object.");let v=null;if(f.locale&&(v=l.parse(f.locale,1,Pt),!v))return null;let x=null;if(f.currency&&(x=l.parse(f.currency,1,Pt),!x))return null;let C=null;if(f["min-fraction-digits"]&&(C=l.parse(f["min-fraction-digits"],1,$e),!C))return null;let S=null;return f["max-fraction-digits"]&&(S=l.parse(f["max-fraction-digits"],1,$e),!S)?null:new kc(d,v,x,C,S)}evaluate(s){return new Intl.NumberFormat(this.locale?this.locale.evaluate(s):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(s):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(s):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(s):void 0}).format(this.number.evaluate(s))}eachChild(s){s(this.number),this.locale&&s(this.locale),this.currency&&s(this.currency),this.minFractionDigits&&s(this.minFractionDigits),this.maxFractionDigits&&s(this.maxFractionDigits)}outputDefined(){return!1}}class Pc{constructor(s){this.type=Us,this.sections=s}static parse(s,l){if(s.length<2)return l.error("Expected at least one argument.");const d=s[1];if(!Array.isArray(d)&&"object"==typeof d)return l.error("First argument must be an image or text section.");const f=[];let v=!1;for(let x=1;x<=s.length-1;++x){const C=s[x];if(v&&"object"==typeof C&&!Array.isArray(C)){v=!1;let S=null;if(C["font-scale"]&&(S=l.parse(C["font-scale"],1,$e),!S))return null;let T=null;if(C["text-font"]&&(T=l.parse(C["text-font"],1,Xi(Pt)),!T))return null;let O=null;if(C["text-color"]&&(O=l.parse(C["text-color"],1,Wi),!O))return null;const L=f[f.length-1];L.scale=S,L.font=T,L.textColor=O}else{const S=l.parse(s[x],1,bt);if(!S)return null;const T=S.type.kind;if("string"!==T&&"value"!==T&&"null"!==T&&"resolvedImage"!==T)return l.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");v=!0,f.push({content:S,scale:null,font:null,textColor:null})}}return new Pc(f)}evaluate(s){return new ui(this.sections.map(l=>{const d=l.content.evaluate(s);return ii(d)===rs?new or("",d,null,null,null):new or(zo(d),null,l.scale?l.scale.evaluate(s):null,l.font?l.font.evaluate(s).join(","):null,l.textColor?l.textColor.evaluate(s):null)}))}eachChild(s){for(const l of this.sections)s(l.content),l.scale&&s(l.scale),l.font&&s(l.font),l.textColor&&s(l.textColor)}outputDefined(){return!1}}class rl{constructor(s){this.type=rs,this.input=s}static parse(s,l){if(2!==s.length)return l.error("Expected two arguments.");const d=l.parse(s[1],1,Pt);return d?new rl(d):l.error("No image name provided.")}evaluate(s){const l=this.input.evaluate(s),d=ar.fromString(l);return d&&s.availableImages&&(d.available=s.availableImages.indexOf(l)>-1),d}eachChild(s){s(this.input)}outputDefined(){return!1}}class sl{constructor(s){this.type=$e,this.input=s}static parse(s,l){if(2!==s.length)return l.error(`Expected 1 argument, but found ${s.length-1} instead.`);const d=l.parse(s[1],1);return d?"array"!==d.type.kind&&"string"!==d.type.kind&&"value"!==d.type.kind?l.error(`Expected argument of type string or array, but found ${kn(d.type)} instead.`):new sl(d):null}evaluate(s){const l=this.input.evaluate(s);if("string"==typeof l||Array.isArray(l))return l.length;throw new di(`Expected value to be of type string or array, but found ${kn(ii(l))} instead.`)}eachChild(s){s(this.input)}outputDefined(){return!1}}const Bo={"==":Rm,"!=":ct,">":Fi,"<":Om,">=":Dp,"<=":Ac,array:Yi,at:zl,boolean:Yi,case:$d,coalesce:Ru,collator:Et,format:Pc,image:rl,in:en,"index-of":Ou,interpolate:Si,"interpolate-hcl":Si,"interpolate-lab":Si,length:sl,let:Nl,literal:ua,match:Fu,number:Yi,"number-format":kc,object:Yi,slice:yr,step:Ji,string:Yi,"to-boolean":$s,"to-color":$s,"to-number":$s,"to-string":$s,var:da,within:Pe};function Lu(a,[s,l,d,f]){s=s.evaluate(a),l=l.evaluate(a),d=d.evaluate(a);const v=f?f.evaluate(a):1,x=Bd(s,l,d,v);if(x)throw new di(x);return new gt(s/255,l/255,d/255,v,!1)}function Hd(a,s){return a in s}function Ut(a,s){const l=s[a];return void 0===l?null:l}function uo(a){return{type:a}}function Nu(a){return{result:"success",value:a}}function Mi(a){return{result:"error",value:a}}function pa(a){return"data-driven"===a["property-type"]||"cross-faded-data-driven"===a["property-type"]}function Ip(a){return!!a.expression&&a.expression.parameters.indexOf("zoom")>-1}function Dn(a){return!!a.expression&&a.expression.interpolated}function cn(a){return a instanceof Number?"number":a instanceof String?"string":a instanceof Boolean?"boolean":Array.isArray(a)?"array":null===a?"null":typeof a}function zu(a){return"object"==typeof a&&null!==a&&!Array.isArray(a)}function Bu(a){return a}function Rc(a,s){const l="color"===s.type,d=a.stops&&"object"==typeof a.stops[0][0],f=d||!(d||void 0!==a.property),v=a.type||(Dn(s)?"exponential":"interval");if(l||"padding"===s.type){const O=l?gt.parse:$r.parse;(a=gr({},a)).stops&&(a.stops=a.stops.map(L=>[L[0],O(L[1])])),a.default=O(a.default?a.default:s.default)}if(a.colorSpace&&"rgb"!==(x=a.colorSpace)&&"hcl"!==x&&"lab"!==x)throw new Error(`Unknown color space: "${a.colorSpace}"`);var x;let C,S,T;if("exponential"===v)C=Oc;else if("interval"===v)C=Sp;else if("categorical"===v){C=Vu,S=Object.create(null);for(const O of a.stops)S[O[0]]=O[1];T=typeof a.stops[0][0]}else{if("identity"!==v)throw new Error(`Unknown function type "${v}"`);C=Fm}if(d){const O={},L=[];for(let $=0;$<a.stops.length;$++){const K=a.stops[$],Q=K[0].zoom;void 0===O[Q]&&(O[Q]={zoom:Q,type:a.type,property:a.property,default:a.default,stops:[]},L.push(Q)),O[Q].stops.push([K[0].value,K[1]])}const B=[];for(const $ of L)B.push([O[$].zoom,Rc(O[$],s)]);const j={name:"linear"};return{kind:"composite",interpolationType:j,interpolationFactor:Si.interpolationFactor.bind(void 0,j),zoomStops:B.map($=>$[0]),evaluate:({zoom:$},K)=>Oc({stops:B,base:a.base},s,$).evaluate($,K)}}if(f){const O="exponential"===v?{name:"exponential",base:void 0!==a.base?a.base:1}:null;return{kind:"camera",interpolationType:O,interpolationFactor:Si.interpolationFactor.bind(void 0,O),zoomStops:a.stops.map(L=>L[0]),evaluate:({zoom:L})=>C(a,s,L,S,T)}}return{kind:"source",evaluate(O,L){const B=L&&L.properties?L.properties[a.property]:void 0;return void 0===B?Vo(a.default,s.default):C(a,s,B,S,T)}}}function Vo(a,s,l){return void 0!==a?a:void 0!==s?s:void 0!==l?l:void 0}function Vu(a,s,l,d,f){return Vo(typeof l===f?d[l]:void 0,a.default,s.default)}function Sp(a,s,l){if("number"!==cn(l))return Vo(a.default,s.default);const d=a.stops.length;if(1===d||l<=a.stops[0][0])return a.stops[0][1];if(l>=a.stops[d-1][0])return a.stops[d-1][1];const f=ha(a.stops.map(v=>v[0]),l);return a.stops[f][1]}function Oc(a,s,l){const d=void 0!==a.base?a.base:1;if("number"!==cn(l))return Vo(a.default,s.default);const f=a.stops.length;if(1===f||l<=a.stops[0][0])return a.stops[0][1];if(l>=a.stops[f-1][0])return a.stops[f-1][1];const v=ha(a.stops.map(O=>O[0]),l),x=function(O,L,B,j){const $=j-B,K=O-B;return 0===$?0:1===L?K/$:(Math.pow(L,K)-1)/(Math.pow(L,$)-1)}(l,d,a.stops[v][0],a.stops[v+1][0]),C=a.stops[v][1],S=a.stops[v+1][1],T=ss[s.type]||Bu;return"function"==typeof C.evaluate?{evaluate(...O){const L=C.evaluate.apply(void 0,O),B=S.evaluate.apply(void 0,O);if(void 0!==L&&void 0!==B)return T(L,B,x,a.colorSpace)}}:T(C,S,x,a.colorSpace)}function Fm(a,s,l){switch(s.type){case"color":l=gt.parse(l);break;case"formatted":l=ui.fromString(l.toString());break;case"resolvedImage":l=ar.fromString(l.toString());break;case"padding":l=$r.parse(l);break;default:cn(l)===s.type||"enum"===s.type&&s.values[l]||(l=void 0)}return Vo(l,a.default,s.default)}vt.register(Bo,{error:[{kind:"error"},[Pt],(a,[s])=>{throw new di(s.evaluate(a))}],typeof:[Pt,[bt],(a,[s])=>kn(ii(s.evaluate(a)))],"to-rgba":[Xi($e,4),[Wi],(a,[s])=>{const[l,d,f,v]=s.evaluate(a).rgb;return[255*l,255*d,255*f,v]}],rgb:[Wi,[$e,$e,$e],Lu],rgba:[Wi,[$e,$e,$e,$e],Lu],has:{type:Ct,overloads:[[[Pt],(a,[s])=>Hd(s.evaluate(a),a.properties())],[[Pt,lo],(a,[s,l])=>Hd(s.evaluate(a),l.evaluate(a))]]},get:{type:bt,overloads:[[[Pt],(a,[s])=>Ut(s.evaluate(a),a.properties())],[[Pt,lo],(a,[s,l])=>Ut(s.evaluate(a),l.evaluate(a))]]},"feature-state":[bt,[Pt],(a,[s])=>Ut(s.evaluate(a),a.featureState||{})],properties:[lo,[],a=>a.properties()],"geometry-type":[Pt,[],a=>a.geometryType()],id:[bt,[],a=>a.id()],zoom:[$e,[],a=>a.globals.zoom],"heatmap-density":[$e,[],a=>a.globals.heatmapDensity||0],"line-progress":[$e,[],a=>a.globals.lineProgress||0],accumulated:[bt,[],a=>void 0===a.globals.accumulated?null:a.globals.accumulated],"+":[$e,uo($e),(a,s)=>{let l=0;for(const d of s)l+=d.evaluate(a);return l}],"*":[$e,uo($e),(a,s)=>{let l=1;for(const d of s)l*=d.evaluate(a);return l}],"-":{type:$e,overloads:[[[$e,$e],(a,[s,l])=>s.evaluate(a)-l.evaluate(a)],[[$e],(a,[s])=>-s.evaluate(a)]]},"/":[$e,[$e,$e],(a,[s,l])=>s.evaluate(a)/l.evaluate(a)],"%":[$e,[$e,$e],(a,[s,l])=>s.evaluate(a)%l.evaluate(a)],ln2:[$e,[],()=>Math.LN2],pi:[$e,[],()=>Math.PI],e:[$e,[],()=>Math.E],"^":[$e,[$e,$e],(a,[s,l])=>Math.pow(s.evaluate(a),l.evaluate(a))],sqrt:[$e,[$e],(a,[s])=>Math.sqrt(s.evaluate(a))],log10:[$e,[$e],(a,[s])=>Math.log(s.evaluate(a))/Math.LN10],ln:[$e,[$e],(a,[s])=>Math.log(s.evaluate(a))],log2:[$e,[$e],(a,[s])=>Math.log(s.evaluate(a))/Math.LN2],sin:[$e,[$e],(a,[s])=>Math.sin(s.evaluate(a))],cos:[$e,[$e],(a,[s])=>Math.cos(s.evaluate(a))],tan:[$e,[$e],(a,[s])=>Math.tan(s.evaluate(a))],asin:[$e,[$e],(a,[s])=>Math.asin(s.evaluate(a))],acos:[$e,[$e],(a,[s])=>Math.acos(s.evaluate(a))],atan:[$e,[$e],(a,[s])=>Math.atan(s.evaluate(a))],min:[$e,uo($e),(a,s)=>Math.min(...s.map(l=>l.evaluate(a)))],max:[$e,uo($e),(a,s)=>Math.max(...s.map(l=>l.evaluate(a)))],abs:[$e,[$e],(a,[s])=>Math.abs(s.evaluate(a))],round:[$e,[$e],(a,[s])=>{const l=s.evaluate(a);return l<0?-Math.round(-l):Math.round(l)}],floor:[$e,[$e],(a,[s])=>Math.floor(s.evaluate(a))],ceil:[$e,[$e],(a,[s])=>Math.ceil(s.evaluate(a))],"filter-==":[Ct,[Pt,bt],(a,[s,l])=>a.properties()[s.value]===l.value],"filter-id-==":[Ct,[bt],(a,[s])=>a.id()===s.value],"filter-type-==":[Ct,[Pt],(a,[s])=>a.geometryType()===s.value],"filter-<":[Ct,[Pt,bt],(a,[s,l])=>{const d=a.properties()[s.value],f=l.value;return typeof d==typeof f&&d<f}],"filter-id-<":[Ct,[bt],(a,[s])=>{const l=a.id(),d=s.value;return typeof l==typeof d&&l<d}],"filter->":[Ct,[Pt,bt],(a,[s,l])=>{const d=a.properties()[s.value],f=l.value;return typeof d==typeof f&&d>f}],"filter-id->":[Ct,[bt],(a,[s])=>{const l=a.id(),d=s.value;return typeof l==typeof d&&l>d}],"filter-<=":[Ct,[Pt,bt],(a,[s,l])=>{const d=a.properties()[s.value],f=l.value;return typeof d==typeof f&&d<=f}],"filter-id-<=":[Ct,[bt],(a,[s])=>{const l=a.id(),d=s.value;return typeof l==typeof d&&l<=d}],"filter->=":[Ct,[Pt,bt],(a,[s,l])=>{const d=a.properties()[s.value],f=l.value;return typeof d==typeof f&&d>=f}],"filter-id->=":[Ct,[bt],(a,[s])=>{const l=a.id(),d=s.value;return typeof l==typeof d&&l>=d}],"filter-has":[Ct,[bt],(a,[s])=>s.value in a.properties()],"filter-has-id":[Ct,[],a=>null!==a.id()&&void 0!==a.id()],"filter-type-in":[Ct,[Xi(Pt)],(a,[s])=>s.value.indexOf(a.geometryType())>=0],"filter-id-in":[Ct,[Xi(bt)],(a,[s])=>s.value.indexOf(a.id())>=0],"filter-in-small":[Ct,[Pt,Xi(bt)],(a,[s,l])=>l.value.indexOf(a.properties()[s.value])>=0],"filter-in-large":[Ct,[Pt,Xi(bt)],(a,[s,l])=>function(d,f,v,x){for(;v<=x;){const C=v+x>>1;if(f[C]===d)return!0;f[C]>d?x=C-1:v=C+1}return!1}(a.properties()[s.value],l.value,0,l.value.length-1)],all:{type:Ct,overloads:[[[Ct,Ct],(a,[s,l])=>s.evaluate(a)&&l.evaluate(a)],[uo(Ct),(a,s)=>{for(const l of s)if(!l.evaluate(a))return!1;return!0}]]},any:{type:Ct,overloads:[[[Ct,Ct],(a,[s,l])=>s.evaluate(a)||l.evaluate(a)],[uo(Ct),(a,s)=>{for(const l of s)if(l.evaluate(a))return!0;return!1}]]},"!":[Ct,[Ct],(a,[s])=>!s.evaluate(a)],"is-supported-script":[Ct,[Pt],(a,[s])=>{const l=a.globals&&a.globals.isSupportedScript;return!l||l(s.evaluate(a))}],upcase:[Pt,[Pt],(a,[s])=>s.evaluate(a).toUpperCase()],downcase:[Pt,[Pt],(a,[s])=>s.evaluate(a).toLowerCase()],concat:[Pt,uo(bt),(a,s)=>s.map(l=>zo(l.evaluate(a))).join("")],"resolved-locale":[Pt,[Vs],(a,[s])=>s.evaluate(a).resolvedLocale()]});class ri{constructor(s,l){var d;this.expression=s,this._warningHistory={},this._evaluator=new hn,this._defaultValue=l?"color"===(d=l).type&&zu(d.default)?new gt(0,0,0,0):"color"===d.type?gt.parse(d.default)||null:"padding"===d.type?$r.parse(d.default)||null:"variableAnchorOffsetCollection"===d.type?Ki.parse(d.default)||null:void 0===d.default?null:d.default:null,this._enumValues=l&&"enum"===l.type?l.values:null}evaluateWithoutErrorHandling(s,l,d,f,v,x){return this._evaluator.globals=s,this._evaluator.feature=l,this._evaluator.featureState=d,this._evaluator.canonical=f,this._evaluator.availableImages=v||null,this._evaluator.formattedSection=x,this.expression.evaluate(this._evaluator)}evaluate(s,l,d,f,v,x){this._evaluator.globals=s,this._evaluator.feature=l||null,this._evaluator.featureState=d||null,this._evaluator.canonical=f,this._evaluator.availableImages=v||null,this._evaluator.formattedSection=x||null;try{const C=this.expression.evaluate(this._evaluator);if(null==C||"number"==typeof C&&C!=C)return this._defaultValue;if(this._enumValues&&!(C in this._enumValues))throw new di(`Expected value to be one of ${Object.keys(this._enumValues).map(S=>JSON.stringify(S)).join(", ")}, but found ${JSON.stringify(C)} instead.`);return C}catch(C){return this._warningHistory[C.message]||(this._warningHistory[C.message]=!0,typeof console<"u"&&console.warn(C.message)),this._defaultValue}}}function Uu(a){return Array.isArray(a)&&a.length>0&&"string"==typeof a[0]&&a[0]in Bo}function jt(a,s){const l=new _r(Bo,Qt,[],s?function(f){const v={color:Wi,string:Pt,number:$e,enum:Pt,boolean:Ct,formatted:Us,padding:Lo,resolvedImage:rs,variableAnchorOffsetCollection:No};return"array"===f.type?Xi(v[f.value]||bt,f.length):v[f.type]}(s):void 0),d=l.parse(a,void 0,void 0,void 0,s&&"string"===s.type?{typeAnnotation:"coerce"}:void 0);return d?Nu(new ri(d,s)):Mi(l.errors)}class Fc{constructor(s,l){this.kind=s,this._styleExpression=l,this.isStateDependent="constant"!==s&&!Mc(l.expression)}evaluateWithoutErrorHandling(s,l,d,f,v,x){return this._styleExpression.evaluateWithoutErrorHandling(s,l,d,f,v,x)}evaluate(s,l,d,f,v,x){return this._styleExpression.evaluate(s,l,d,f,v,x)}}class fn{constructor(s,l,d,f){this.kind=s,this.zoomStops=d,this._styleExpression=l,this.isStateDependent="camera"!==s&&!Mc(l.expression),this.interpolationType=f}evaluateWithoutErrorHandling(s,l,d,f,v,x){return this._styleExpression.evaluateWithoutErrorHandling(s,l,d,f,v,x)}evaluate(s,l,d,f,v,x){return this._styleExpression.evaluate(s,l,d,f,v,x)}interpolationFactor(s,l,d){return this.interpolationType?Si.interpolationFactor(this.interpolationType,s,l,d):0}}function In(a,s){const l=jt(a,s);if("error"===l.result)return l;const d=l.value.expression,f=Sc(d);if(!f&&!pa(s))return Mi([new sr("","data expressions not supported")]);const v=Ll(d,["zoom"]);if(!v&&!Ip(s))return Mi([new sr("","zoom expressions not supported")]);const x=Vl(d);return x||v?x instanceof sr?Mi([x]):x instanceof Si&&!Dn(s)?Mi([new sr("",'"interpolate" expressions cannot be used with this property')]):Nu(x?new fn(f?"camera":"composite",l.value,x.labels,x instanceof Si?x.interpolation:void 0):new Fc(f?"constant":"source",l.value)):Mi([new sr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Hs{constructor(s,l){this._parameters=s,this._specification=l,gr(this,Rc(this._parameters,this._specification))}static deserialize(s){return new Hs(s._parameters,s._specification)}static serialize(s){return{_parameters:s._parameters,_specification:s._specification}}}function Vl(a){let s=null;if(a instanceof Nl)s=Vl(a.result);else if(a instanceof Ru){for(const l of a.args)if(s=Vl(l),s)break}else(a instanceof Ji||a instanceof Si)&&a.input instanceof vt&&"zoom"===a.input.name&&(s=a);return s instanceof sr||a.eachChild(l=>{const d=Vl(l);d instanceof sr?s=d:!s&&d?s=new sr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):s&&d&&s!==d&&(s=new sr("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),s}function ju(a){if(!0===a||!1===a)return!0;if(!Array.isArray(a)||0===a.length)return!1;switch(a[0]){case"has":return a.length>=2&&"$id"!==a[1]&&"$type"!==a[1];case"in":return a.length>=3&&("string"!=typeof a[1]||Array.isArray(a[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==a.length||Array.isArray(a[1])||Array.isArray(a[2]);case"any":case"all":for(const s of a.slice(1))if(!ju(s)&&"boolean"!=typeof s)return!1;return!0;default:return!0}}const Mp={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Lc(a){if(null==a)return{filter:()=>!0,needGeometry:!1};ju(a)||(a=os(a));const s=jt(a,Mp);if("error"===s.result)throw new Error(s.value.map(l=>`${l.key}: ${l.message}`).join(", "));return{filter:(l,d,f)=>s.value.evaluate(l,d,{},f),needGeometry:$u(a)}}function ol(a,s){return a<s?-1:a>s?1:0}function $u(a){if(!Array.isArray(a))return!1;if("within"===a[0])return!0;for(let s=1;s<a.length;s++)if($u(a[s]))return!0;return!1}function os(a){if(!a)return!0;const s=a[0];return a.length<=1?"any"!==s:"=="===s?Nc(a[1],a[2],"=="):"!="===s?Ke(Nc(a[1],a[2],"==")):"<"===s||">"===s||"<="===s||">="===s?Nc(a[1],a[2],s):"any"===s?(l=a.slice(1),["any"].concat(l.map(os))):"all"===s?["all"].concat(a.slice(1).map(os)):"none"===s?["all"].concat(a.slice(1).map(os).map(Ke)):"in"===s?nt(a[1],a.slice(2)):"!in"===s?Ke(nt(a[1],a.slice(2))):"has"===s?Ul(a[1]):"!has"===s?Ke(Ul(a[1])):"within"!==s||a;var l}function Nc(a,s,l){switch(a){case"$type":return[`filter-type-${l}`,s];case"$id":return[`filter-id-${l}`,s];default:return[`filter-${l}`,a,s]}}function nt(a,s){if(0===s.length)return!1;switch(a){case"$type":return["filter-type-in",["literal",s]];case"$id":return["filter-id-in",["literal",s]];default:return s.length>200&&!s.some(l=>typeof l!=typeof s[0])?["filter-in-large",a,["literal",s.sort(ol)]]:["filter-in-small",a,["literal",s]]}}function Ul(a){switch(a){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",a]}}function Ke(a){return["!",a]}function al(a){const s=typeof a;if("number"===s||"boolean"===s||"string"===s||null==a)return JSON.stringify(a);if(Array.isArray(a)){let f="[";for(const v of a)f+=`${al(v)},`;return`${f}]`}const l=Object.keys(a).sort();let d="{";for(let f=0;f<l.length;f++)d+=`${JSON.stringify(l[f])}:${al(a[l[f]])},`;return`${d}}`}function Hu(a){let s="";for(const l of _s)s+=`/${al(a[l])}`;return s}function ll(a){const s=a.value;return s?[new Be(a.key,s,"constants have been deprecated as of v8")]:[]}function hi(a){return a instanceof Number||a instanceof String||a instanceof Boolean?a.valueOf():a}function fa(a){if(Array.isArray(a))return a.map(fa);if(a instanceof Object&&!(a instanceof Number||a instanceof String||a instanceof Boolean)){const s={};for(const l in a)s[l]=fa(a[l]);return s}return hi(a)}function as(a){const s=a.key,l=a.value,d=a.valueSpec||{},f=a.objectElementValidators||{},v=a.style,x=a.styleSpec,C=a.validateSpec;let S=[];const T=cn(l);if("object"!==T)return[new Be(s,l,`object expected, ${T} found`)];for(const O in l){const L=O.split(".")[0],B=d[L]||d["*"];let j;if(f[L])j=f[L];else if(d[L])j=C;else if(f["*"])j=f["*"];else{if(!d["*"]){S.push(new Be(s,l[O],`unknown property "${O}"`));continue}j=C}S=S.concat(j({key:(s&&`${s}.`)+O,value:l[O],valueSpec:B,style:v,styleSpec:x,object:l,objectKey:O,validateSpec:C},l))}for(const O in d)f[O]||d[O].required&&void 0===d[O].default&&void 0===l[O]&&S.push(new Be(s,l,`missing required property "${O}"`));return S}function ys(a){const s=a.value,l=a.valueSpec,d=a.style,f=a.styleSpec,v=a.key,x=a.arrayElementValidator||a.validateSpec;if("array"!==cn(s))return[new Be(v,s,`array expected, ${cn(s)} found`)];if(l.length&&s.length!==l.length)return[new Be(v,s,`array length ${l.length} expected, length ${s.length} found`)];if(l["min-length"]&&s.length<l["min-length"])return[new Be(v,s,`array length at least ${l["min-length"]} expected, length ${s.length} found`)];let C={type:l.value,values:l.values};f.$version<7&&(C.function=l.function),"object"===cn(l.value)&&(C=l.value);let S=[];for(let T=0;T<s.length;T++)S=S.concat(x({array:s,arrayIndex:T,value:s[T],valueSpec:C,validateSpec:a.validateSpec,style:d,styleSpec:f,key:`${v}[${T}]`}));return S}function ma(a){const s=a.key,l=a.value,d=a.valueSpec;let f=cn(l);return"number"===f&&l!=l&&(f="NaN"),"number"!==f?[new Be(s,l,`number expected, ${f} found`)]:"minimum"in d&&l<d.minimum?[new Be(s,l,`${l} is less than the minimum value ${d.minimum}`)]:"maximum"in d&&l>d.maximum?[new Be(s,l,`${l} is greater than the maximum value ${d.maximum}`)]:[]}function Hr(a){const s=a.valueSpec,l=hi(a.value.type);let d,f,v,x={};const C="categorical"!==l&&void 0===a.value.property,S=!C,T="array"===cn(a.value.stops)&&"array"===cn(a.value.stops[0])&&"object"===cn(a.value.stops[0][0]),O=as({key:a.key,value:a.value,valueSpec:a.styleSpec.function,validateSpec:a.validateSpec,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{stops:function(j){if("identity"===l)return[new Be(j.key,j.value,'identity function may not have a "stops" property')];let $=[];const K=j.value;return $=$.concat(ys({key:j.key,value:K,valueSpec:j.valueSpec,validateSpec:j.validateSpec,style:j.style,styleSpec:j.styleSpec,arrayElementValidator:L})),"array"===cn(K)&&0===K.length&&$.push(new Be(j.key,K,"array must have at least one stop")),$},default:function(j){return j.validateSpec({key:j.key,value:j.value,valueSpec:s,validateSpec:j.validateSpec,style:j.style,styleSpec:j.styleSpec})}}});return"identity"===l&&C&&O.push(new Be(a.key,a.value,'missing required property "property"')),"identity"===l||a.value.stops||O.push(new Be(a.key,a.value,'missing required property "stops"')),"exponential"===l&&a.valueSpec.expression&&!Dn(a.valueSpec)&&O.push(new Be(a.key,a.value,"exponential functions not supported")),a.styleSpec.$version>=8&&(S&&!pa(a.valueSpec)?O.push(new Be(a.key,a.value,"property functions not supported")):C&&!Ip(a.valueSpec)&&O.push(new Be(a.key,a.value,"zoom functions not supported"))),"categorical"!==l&&!T||void 0!==a.value.property||O.push(new Be(a.key,a.value,'"property" property is required')),O;function L(j){let $=[];const K=j.value,Q=j.key;if("array"!==cn(K))return[new Be(Q,K,`array expected, ${cn(K)} found`)];if(2!==K.length)return[new Be(Q,K,`array length 2 expected, length ${K.length} found`)];if(T){if("object"!==cn(K[0]))return[new Be(Q,K,`object expected, ${cn(K[0])} found`)];if(void 0===K[0].zoom)return[new Be(Q,K,"object stop key must have zoom")];if(void 0===K[0].value)return[new Be(Q,K,"object stop key must have value")];if(v&&v>hi(K[0].zoom))return[new Be(Q,K[0].zoom,"stop zoom values must appear in ascending order")];hi(K[0].zoom)!==v&&(v=hi(K[0].zoom),f=void 0,x={}),$=$.concat(as({key:`${Q}[0]`,value:K[0],valueSpec:{zoom:{}},validateSpec:j.validateSpec,style:j.style,styleSpec:j.styleSpec,objectElementValidators:{zoom:ma,value:B}}))}else $=$.concat(B({key:`${Q}[0]`,value:K[0],valueSpec:{},validateSpec:j.validateSpec,style:j.style,styleSpec:j.styleSpec},K));return Uu(fa(K[1]))?$.concat([new Be(`${Q}[1]`,K[1],"expressions are not allowed in function stops.")]):$.concat(j.validateSpec({key:`${Q}[1]`,value:K[1],valueSpec:s,validateSpec:j.validateSpec,style:j.style,styleSpec:j.styleSpec}))}function B(j,$){const K=cn(j.value),Q=hi(j.value),ne=null!==j.value?j.value:$;if(d){if(K!==d)return[new Be(j.key,ne,`${K} stop domain type must match previous stop domain type ${d}`)]}else d=K;if("number"!==K&&"string"!==K&&"boolean"!==K)return[new Be(j.key,ne,"stop domain value must be a number, string, or boolean")];if("number"!==K&&"categorical"!==l){let de=`number expected, ${K} found`;return pa(s)&&void 0===l&&(de+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Be(j.key,ne,de)]}return"categorical"!==l||"number"!==K||isFinite(Q)&&Math.floor(Q)===Q?"categorical"!==l&&"number"===K&&void 0!==f&&Q<f?[new Be(j.key,ne,"stop domain values must appear in ascending order")]:(f=Q,"categorical"===l&&Q in x?[new Be(j.key,ne,"stop domain values must be unique")]:(x[Q]=!0,[])):[new Be(j.key,ne,`integer expected, found ${Q}`)]}}function Li(a){const s=("property"===a.expressionContext?In:jt)(fa(a.value),a.valueSpec);if("error"===s.result)return s.value.map(d=>new Be(`${a.key}${d.key}`,a.value,d.message));const l=s.value.expression||s.value._styleExpression.expression;if("property"===a.expressionContext&&"text-font"===a.propertyKey&&!l.outputDefined())return[new Be(a.key,a.value,`Invalid data expression for "${a.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===a.expressionContext&&"layout"===a.propertyType&&!Mc(l))return[new Be(a.key,a.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===a.expressionContext&&!Mc(l))return[new Be(a.key,a.value,'"feature-state" data expressions are not supported with filters.')];if(a.expressionContext&&0===a.expressionContext.indexOf("cluster")){if(!Ll(l,["zoom","feature-state"]))return[new Be(a.key,a.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===a.expressionContext&&!Sc(l))return[new Be(a.key,a.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Zt(a){const s=a.key,l=a.value,d=a.valueSpec,f=[];return Array.isArray(d.values)?-1===d.values.indexOf(hi(l))&&f.push(new Be(s,l,`expected one of [${d.values.join(", ")}], ${JSON.stringify(l)} found`)):-1===Object.keys(d.values).indexOf(hi(l))&&f.push(new Be(s,l,`expected one of [${Object.keys(d.values).join(", ")}], ${JSON.stringify(l)} found`)),f}function ga(a){return ju(fa(a.value))?Li(gr({},a,{expressionContext:"filter",valueSpec:{value:"boolean"}})):zc(a)}function zc(a){const s=a.value,l=a.key;if("array"!==cn(s))return[new Be(l,s,`array expected, ${cn(s)} found`)];const d=a.styleSpec;let f,v=[];if(s.length<1)return[new Be(l,s,"filter array must have at least 1 element")];switch(v=v.concat(Zt({key:`${l}[0]`,value:s[0],valueSpec:d.filter_operator,style:a.style,styleSpec:a.styleSpec})),hi(s[0])){case"<":case"<=":case">":case">=":s.length>=2&&"$type"===hi(s[1])&&v.push(new Be(l,s,`"$type" cannot be use with operator "${s[0]}"`));case"==":case"!=":3!==s.length&&v.push(new Be(l,s,`filter array for operator "${s[0]}" must have 3 elements`));case"in":case"!in":s.length>=2&&(f=cn(s[1]),"string"!==f&&v.push(new Be(`${l}[1]`,s[1],`string expected, ${f} found`)));for(let x=2;x<s.length;x++)f=cn(s[x]),"$type"===hi(s[1])?v=v.concat(Zt({key:`${l}[${x}]`,value:s[x],valueSpec:d.geometry_type,style:a.style,styleSpec:a.styleSpec})):"string"!==f&&"number"!==f&&"boolean"!==f&&v.push(new Be(`${l}[${x}]`,s[x],`string, number, or boolean expected, ${f} found`));break;case"any":case"all":case"none":for(let x=1;x<s.length;x++)v=v.concat(zc({key:`${l}[${x}]`,value:s[x],style:a.style,styleSpec:a.styleSpec}));break;case"has":case"!has":f=cn(s[1]),2!==s.length?v.push(new Be(l,s,`filter array for "${s[0]}" operator must have 2 elements`)):"string"!==f&&v.push(new Be(`${l}[1]`,s[1],`string expected, ${f} found`));break;case"within":f=cn(s[1]),2!==s.length?v.push(new Be(l,s,`filter array for "${s[0]}" operator must have 2 elements`)):"object"!==f&&v.push(new Be(`${l}[1]`,s[1],`object expected, ${f} found`))}return v}function cl(a,s){const l=a.key,d=a.validateSpec,f=a.style,v=a.styleSpec,x=a.value,C=a.objectKey,S=v[`${s}_${a.layerType}`];if(!S)return[];const T=C.match(/^(.*)-transition$/);if("paint"===s&&T&&S[T[1]]&&S[T[1]].transition)return d({key:l,value:x,valueSpec:v.transition,style:f,styleSpec:v});const O=a.valueSpec||S[C];if(!O)return[new Be(l,x,`unknown property "${C}"`)];let L;if("string"===cn(x)&&pa(O)&&!O.tokens&&(L=/^{([^}]+)}$/.exec(x)))return[new Be(l,x,`"${C}" does not support interpolation syntax\nUse an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(L[1])} }\`.`)];const B=[];return"symbol"===a.layerType&&("text-field"===C&&f&&!f.glyphs&&B.push(new Be(l,x,'use of "text-field" requires a style "glyphs" property')),"text-font"===C&&zu(fa(x))&&"identity"===hi(x.type)&&B.push(new Be(l,x,'"text-font" does not support identity functions'))),B.concat(d({key:a.key,value:x,valueSpec:O,style:f,styleSpec:v,expressionContext:"property",propertyType:s,propertyKey:C}))}function ul(a){return cl(a,"paint")}function ls(a){return cl(a,"layout")}function Uo(a){let s=[];const l=a.value,d=a.key,f=a.style,v=a.styleSpec;l.type||l.ref||s.push(new Be(d,l,'either "type" or "ref" is required'));let x=hi(l.type);const C=hi(l.ref);if(l.id){const S=hi(l.id);for(let T=0;T<a.arrayIndex;T++){const O=f.layers[T];hi(O.id)===S&&s.push(new Be(d,l.id,`duplicate layer id "${l.id}", previously used at line ${O.id.__line__}`))}}if("ref"in l){let S;["type","source","source-layer","filter","layout"].forEach(T=>{T in l&&s.push(new Be(d,l[T],`"${T}" is prohibited for ref layers`))}),f.layers.forEach(T=>{hi(T.id)===C&&(S=T)}),S?S.ref?s.push(new Be(d,l.ref,"ref cannot reference another ref layer")):x=hi(S.type):s.push(new Be(d,l.ref,`ref layer "${C}" not found`))}else if("background"!==x)if(l.source){const S=f.sources&&f.sources[l.source],T=S&&hi(S.type);S?"vector"===T&&"raster"===x?s.push(new Be(d,l.source,`layer "${l.id}" requires a raster source`)):"raster"===T&&"raster"!==x?s.push(new Be(d,l.source,`layer "${l.id}" requires a vector source`)):"vector"!==T||l["source-layer"]?"raster-dem"===T&&"hillshade"!==x?s.push(new Be(d,l.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==x||!l.paint||!l.paint["line-gradient"]||"geojson"===T&&S.lineMetrics||s.push(new Be(d,l,`layer "${l.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):s.push(new Be(d,l,`layer "${l.id}" must specify a "source-layer"`)):s.push(new Be(d,l.source,`source "${l.source}" not found`))}else s.push(new Be(d,l,'missing required property "source"'));return s=s.concat(as({key:d,value:l,valueSpec:v.layer,style:a.style,styleSpec:a.styleSpec,validateSpec:a.validateSpec,objectElementValidators:{"*":()=>[],type:()=>a.validateSpec({key:`${d}.type`,value:l.type,valueSpec:v.layer.type,style:a.style,styleSpec:a.styleSpec,validateSpec:a.validateSpec,object:l,objectKey:"type"}),filter:ga,layout:S=>as({layer:l,key:S.key,value:S.value,style:S.style,styleSpec:S.styleSpec,validateSpec:S.validateSpec,objectElementValidators:{"*":T=>ls(gr({layerType:x},T))}}),paint:S=>as({layer:l,key:S.key,value:S.value,style:S.style,styleSpec:S.styleSpec,validateSpec:S.validateSpec,objectElementValidators:{"*":T=>ul(gr({layerType:x},T))}})}})),s}function ho(a){const s=a.value,l=a.key,d=cn(s);return"string"!==d?[new Be(l,s,`string expected, ${d} found`)]:[]}const Gu={promoteId:function({key:a,value:s}){if("string"===cn(s))return ho({key:a,value:s});{const l=[];for(const d in s)l.push(...ho({key:`${a}.${d}`,value:s[d]}));return l}}};function _a(a){const s=a.value,l=a.key,d=a.styleSpec,f=a.style,v=a.validateSpec;if(!s.type)return[new Be(l,s,'"type" is required')];const x=hi(s.type);let C;switch(x){case"vector":case"raster":case"raster-dem":return C=as({key:l,value:s,valueSpec:d[`source_${x.replace("-","_")}`],style:a.style,styleSpec:d,objectElementValidators:Gu,validateSpec:v}),C;case"geojson":if(C=as({key:l,value:s,valueSpec:d.source_geojson,style:f,styleSpec:d,validateSpec:v,objectElementValidators:Gu}),s.cluster)for(const S in s.clusterProperties){const[T,O]=s.clusterProperties[S],L="string"==typeof T?[T,["accumulated"],["get",S]]:T;C.push(...Li({key:`${l}.${S}.map`,value:O,validateSpec:v,expressionContext:"cluster-map"})),C.push(...Li({key:`${l}.${S}.reduce`,value:L,validateSpec:v,expressionContext:"cluster-reduce"}))}return C;case"video":return as({key:l,value:s,valueSpec:d.source_video,style:f,validateSpec:v,styleSpec:d});case"image":return as({key:l,value:s,valueSpec:d.source_image,style:f,validateSpec:v,styleSpec:d});case"canvas":return[new Be(l,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Zt({key:`${l}.type`,value:s.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:f,validateSpec:v,styleSpec:d})}}function qu(a){const s=a.value,l=a.styleSpec,d=l.light,f=a.style;let v=[];const x=cn(s);if(void 0===s)return v;if("object"!==x)return v=v.concat([new Be("light",s,`object expected, ${x} found`)]),v;for(const C in s){const S=C.match(/^(.*)-transition$/);v=v.concat(S&&d[S[1]]&&d[S[1]].transition?a.validateSpec({key:C,value:s[C],valueSpec:l.transition,validateSpec:a.validateSpec,style:f,styleSpec:l}):d[C]?a.validateSpec({key:C,value:s[C],valueSpec:d[C],validateSpec:a.validateSpec,style:f,styleSpec:l}):[new Be(C,s[C],`unknown property "${C}"`)])}return v}function Zu(a){const s=a.value,l=a.styleSpec,d=l.terrain,f=a.style;let v=[];const x=cn(s);if(void 0===s)return v;if("object"!==x)return v=v.concat([new Be("terrain",s,`object expected, ${x} found`)]),v;for(const C in s)v=v.concat(d[C]?a.validateSpec({key:C,value:s[C],valueSpec:d[C],validateSpec:a.validateSpec,style:f,styleSpec:l}):[new Be(C,s[C],`unknown property "${C}"`)]);return v}function dl(a){let s=[];const l=a.value,d=a.key;if(Array.isArray(l)){const f=[],v=[];for(const x in l)l[x].id&&f.includes(l[x].id)&&s.push(new Be(d,l,`all the sprites' ids must be unique, but ${l[x].id} is duplicated`)),f.push(l[x].id),l[x].url&&v.includes(l[x].url)&&s.push(new Be(d,l,`all the sprites' URLs must be unique, but ${l[x].url} is duplicated`)),v.push(l[x].url),s=s.concat(as({key:`${d}[${x}]`,value:l[x],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:a.validateSpec}));return s}return ho({key:d,value:l})}const Wu={"*":()=>[],array:ys,boolean:function(a){const s=a.value,l=a.key,d=cn(s);return"boolean"!==d?[new Be(l,s,`boolean expected, ${d} found`)]:[]},number:ma,color:function(a){const s=a.key,l=a.value,d=cn(l);return"string"!==d?[new Be(s,l,`color expected, ${d} found`)]:gt.parse(String(l))?[]:[new Be(s,l,`color expected, "${l}" found`)]},constants:ll,enum:Zt,filter:ga,function:Hr,layer:Uo,object:as,source:_a,light:qu,terrain:Zu,string:ho,formatted:function(a){return 0===ho(a).length?[]:Li(a)},resolvedImage:function(a){return 0===ho(a).length?[]:Li(a)},padding:function(a){const s=a.key,l=a.value;if("array"===cn(l)){if(l.length<1||l.length>4)return[new Be(s,l,`padding requires 1 to 4 values; ${l.length} values found`)];const d={type:"number"};let f=[];for(let v=0;v<l.length;v++)f=f.concat(a.validateSpec({key:`${s}[${v}]`,value:l[v],validateSpec:a.validateSpec,valueSpec:d}));return f}return ma({key:s,value:l,valueSpec:{}})},variableAnchorOffsetCollection:function(a){const s=a.key,l=a.value,d=cn(l),f=a.styleSpec;if("array"!==d||l.length<1||l.length%2!=0)return[new Be(s,l,"variableAnchorOffsetCollection requires a non-empty array of even length")];let v=[];for(let x=0;x<l.length;x+=2)v=v.concat(Zt({key:`${s}[${x}]`,value:l[x],valueSpec:f.layout_symbol["text-anchor"]})),v=v.concat(ys({key:`${s}[${x+1}]`,value:l[x+1],valueSpec:{length:2,value:"number"},validateSpec:a.validateSpec,style:a.style,styleSpec:f}));return v},sprite:dl};function hl(a){const s=a.value,l=a.valueSpec,d=a.styleSpec;return a.validateSpec=hl,l.expression&&zu(hi(s))?Hr(a):l.expression&&Uu(fa(s))?Li(a):l.type&&Wu[l.type]?Wu[l.type](a):as(gr({},a,{valueSpec:l.type?d[l.type]:l}))}function jl(a){const s=a.value,l=a.key,d=ho(a);return d.length||(-1===s.indexOf("{fontstack}")&&d.push(new Be(l,s,'"glyphs" url must include a "{fontstack}" token')),-1===s.indexOf("{range}")&&d.push(new Be(l,s,'"glyphs" url must include a "{range}" token'))),d}function Rr(a,s=we){let l=[];return l=l.concat(hl({key:"",value:a,valueSpec:s.$root,styleSpec:s,style:a,validateSpec:hl,objectElementValidators:{glyphs:jl,"*":()=>[]}})),a.constants&&(l=l.concat(ll({key:"constants",value:a.constants,style:a,styleSpec:s,validateSpec:hl}))),$l(l)}function bi(a){return function(s){return a({...s,validateSpec:hl})}}function $l(a){return[].concat(a).sort((s,l)=>s.line-l.line)}function Ti(a){return function(...s){return $l(a.apply(this,s))}}Rr.source=Ti(bi(_a)),Rr.sprite=Ti(bi(dl)),Rr.glyphs=Ti(bi(jl)),Rr.light=Ti(bi(qu)),Rr.terrain=Ti(bi(Zu)),Rr.layer=Ti(bi(Uo)),Rr.filter=Ti(bi(ga)),Rr.paintProperty=Ti(bi(ul)),Rr.layoutProperty=Ti(bi(ls));const Hl=Rr,Gd=Hl.light,Gl=Hl.paintProperty,Tp=Hl.layoutProperty;function Bc(a,s){let l=!1;if(s&&s.length)for(const d of s)a.fire(new Ft(new Error(d.message))),l=!0;return l}class ql{constructor(s,l,d){const f=this.cells=[];if(s instanceof ArrayBuffer){this.arrayBuffer=s;const x=new Int32Array(this.arrayBuffer);s=x[0],this.d=(l=x[1])+2*(d=x[2]);for(let S=0;S<this.d*this.d;S++){const T=x[3+S],O=x[3+S+1];f.push(T===O?null:x.subarray(T,O))}const C=x[3+f.length+1];this.keys=x.subarray(x[3+f.length],C),this.bboxes=x.subarray(C),this.insert=this._insertReadonly}else{this.d=l+2*d;for(let x=0;x<this.d*this.d;x++)f.push([]);this.keys=[],this.bboxes=[]}this.n=l,this.extent=s,this.padding=d,this.scale=l/s,this.uid=0;const v=d/l*s;this.min=-v,this.max=s+v}insert(s,l,d,f,v){this._forEachCell(l,d,f,v,this._insertCell,this.uid++,void 0,void 0),this.keys.push(s),this.bboxes.push(l),this.bboxes.push(d),this.bboxes.push(f),this.bboxes.push(v)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(s,l,d,f,v,x){this.cells[v].push(x)}query(s,l,d,f,v){const x=this.min,C=this.max;if(s<=x&&l<=x&&C<=d&&C<=f&&!v)return Array.prototype.slice.call(this.keys);{const S=[];return this._forEachCell(s,l,d,f,this._queryCell,S,{},v),S}}_queryCell(s,l,d,f,v,x,C,S){const T=this.cells[v];if(null!==T){const O=this.keys,L=this.bboxes;for(let B=0;B<T.length;B++){const j=T[B];if(void 0===C[j]){const $=4*j;(S?S(L[$+0],L[$+1],L[$+2],L[$+3]):s<=L[$+2]&&l<=L[$+3]&&d>=L[$+0]&&f>=L[$+1])?(C[j]=!0,x.push(O[j])):C[j]=!1}}}}_forEachCell(s,l,d,f,v,x,C,S){const T=this._convertToCellCoord(s),O=this._convertToCellCoord(l),L=this._convertToCellCoord(d),B=this._convertToCellCoord(f);for(let j=T;j<=L;j++)for(let $=O;$<=B;$++){const K=this.d*$+j;if((!S||S(this._convertFromCellCoord(j),this._convertFromCellCoord($),this._convertFromCellCoord(j+1),this._convertFromCellCoord($+1)))&&v.call(this,s,l,d,f,K,x,C,S))return}}_convertFromCellCoord(s){return(s-this.padding)/this.scale}_convertToCellCoord(s){return Math.max(0,Math.min(this.d-1,Math.floor(s*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const s=this.cells,l=3+this.cells.length+1+1;let d=0;for(let x=0;x<this.cells.length;x++)d+=this.cells[x].length;const f=new Int32Array(l+d+this.keys.length+this.bboxes.length);f[0]=this.extent,f[1]=this.n,f[2]=this.padding;let v=l;for(let x=0;x<s.length;x++){const C=s[x];f[3+x]=v,f.set(C,v),v+=C.length}return f[3+s.length]=v,f.set(this.keys,v),v+=this.keys.length,f[3+s.length+1]=v,f.set(this.bboxes,v),v+=this.bboxes.length,f.buffer}static serialize(s,l){const d=s.toArrayBuffer();return l&&l.push(d),{buffer:d}}static deserialize(s){return new ql(s.buffer)}}const vs={};function Je(a,s,l={}){if(vs[a])throw new Error(`${a} is already registered.`);Object.defineProperty(s,"_classRegistryKey",{value:a,writeable:!1}),vs[a]={klass:s,omit:l.omit||[],shallow:l.shallow||[]}}Je("Object",Object),Je("TransferableGridIndex",ql),Je("Color",gt),Je("Error",Error),Je("AJAXError",Ro),Je("ResolvedImage",ar),Je("StylePropertyFunction",Hs),Je("StyleExpression",ri,{omit:["_evaluator"]}),Je("ZoomDependentExpression",fn),Je("ZoomConstantExpression",Fc),Je("CompoundExpression",vt,{omit:["_evaluate"]});for(const a in Bo)Bo[a]._classRegistryKey||Je(`Expression_${a}`,Bo[a]);function pl(a){return a&&typeof ArrayBuffer<"u"&&(a instanceof ArrayBuffer||a.constructor&&"ArrayBuffer"===a.constructor.name)}function Zl(a,s){if(null==a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp||a instanceof Blob)return a;if(pl(a)||Po(a))return s&&s.push(a),a;if(ArrayBuffer.isView(a)){const l=a;return s&&s.push(l.buffer),l}if(a instanceof ImageData)return s&&s.push(a.data.buffer),a;if(Array.isArray(a)){const l=[];for(const d of a)l.push(Zl(d,s));return l}if("object"==typeof a){const l=a.constructor,d=l._classRegistryKey;if(!d)throw new Error("can't serialize object of unregistered class");if(!vs[d])throw new Error(`${d} is not registered.`);const f=l.serialize?l.serialize(a,s):{};if(l.serialize){if(s&&f===s[s.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const v in a){if(!a.hasOwnProperty(v)||vs[d].omit.indexOf(v)>=0)continue;const x=a[v];f[v]=vs[d].shallow.indexOf(v)>=0?x:Zl(x,s)}a instanceof Error&&(f.message=a.message)}if(f.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==d&&(f.$name=d),f}throw new Error("can't serialize object of type "+typeof a)}function Nn(a){if(null==a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp||a instanceof Blob||pl(a)||Po(a)||ArrayBuffer.isView(a)||a instanceof ImageData)return a;if(Array.isArray(a))return a.map(Nn);if("object"==typeof a){const s=a.$name||"Object";if(!vs[s])throw new Error(`can't deserialize unregistered class ${s}`);const{klass:l}=vs[s];if(!l)throw new Error(`can't deserialize unregistered class ${s}`);if(l.deserialize)return l.deserialize(a);const d=Object.create(l.prototype);for(const f of Object.keys(a)){if("$name"===f)continue;const v=a[f];d[f]=vs[s].shallow.indexOf(f)>=0?v:Nn(v)}return d}throw new Error("can't deserialize object of type "+typeof a)}class Xu{constructor(){this.first=!0}update(s,l){const d=Math.floor(s);return this.first?(this.first=!1,this.lastIntegerZoom=d,this.lastIntegerZoomTime=0,this.lastZoom=s,this.lastFloorZoom=d,!0):(this.lastFloorZoom>d?(this.lastIntegerZoom=d+1,this.lastIntegerZoomTime=l):this.lastFloorZoom<d&&(this.lastIntegerZoom=d,this.lastIntegerZoomTime=l),s!==this.lastZoom&&(this.lastZoom=s,this.lastFloorZoom=d,!0))}}const Ge={"Latin-1 Supplement":a=>a>=128&&a<=255,Arabic:a=>a>=1536&&a<=1791,"Arabic Supplement":a=>a>=1872&&a<=1919,"Arabic Extended-A":a=>a>=2208&&a<=2303,"Hangul Jamo":a=>a>=4352&&a<=4607,"Unified Canadian Aboriginal Syllabics":a=>a>=5120&&a<=5759,Khmer:a=>a>=6016&&a<=6143,"Unified Canadian Aboriginal Syllabics Extended":a=>a>=6320&&a<=6399,"General Punctuation":a=>a>=8192&&a<=8303,"Letterlike Symbols":a=>a>=8448&&a<=8527,"Number Forms":a=>a>=8528&&a<=8591,"Miscellaneous Technical":a=>a>=8960&&a<=9215,"Control Pictures":a=>a>=9216&&a<=9279,"Optical Character Recognition":a=>a>=9280&&a<=9311,"Enclosed Alphanumerics":a=>a>=9312&&a<=9471,"Geometric Shapes":a=>a>=9632&&a<=9727,"Miscellaneous Symbols":a=>a>=9728&&a<=9983,"Miscellaneous Symbols and Arrows":a=>a>=11008&&a<=11263,"CJK Radicals Supplement":a=>a>=11904&&a<=12031,"Kangxi Radicals":a=>a>=12032&&a<=12255,"Ideographic Description Characters":a=>a>=12272&&a<=12287,"CJK Symbols and Punctuation":a=>a>=12288&&a<=12351,Hiragana:a=>a>=12352&&a<=12447,Katakana:a=>a>=12448&&a<=12543,Bopomofo:a=>a>=12544&&a<=12591,"Hangul Compatibility Jamo":a=>a>=12592&&a<=12687,Kanbun:a=>a>=12688&&a<=12703,"Bopomofo Extended":a=>a>=12704&&a<=12735,"CJK Strokes":a=>a>=12736&&a<=12783,"Katakana Phonetic Extensions":a=>a>=12784&&a<=12799,"Enclosed CJK Letters and Months":a=>a>=12800&&a<=13055,"CJK Compatibility":a=>a>=13056&&a<=13311,"CJK Unified Ideographs Extension A":a=>a>=13312&&a<=19903,"Yijing Hexagram Symbols":a=>a>=19904&&a<=19967,"CJK Unified Ideographs":a=>a>=19968&&a<=40959,"Yi Syllables":a=>a>=40960&&a<=42127,"Yi Radicals":a=>a>=42128&&a<=42191,"Hangul Jamo Extended-A":a=>a>=43360&&a<=43391,"Hangul Syllables":a=>a>=44032&&a<=55215,"Hangul Jamo Extended-B":a=>a>=55216&&a<=55295,"Private Use Area":a=>a>=57344&&a<=63743,"CJK Compatibility Ideographs":a=>a>=63744&&a<=64255,"Arabic Presentation Forms-A":a=>a>=64336&&a<=65023,"Vertical Forms":a=>a>=65040&&a<=65055,"CJK Compatibility Forms":a=>a>=65072&&a<=65103,"Small Form Variants":a=>a>=65104&&a<=65135,"Arabic Presentation Forms-B":a=>a>=65136&&a<=65279,"Halfwidth and Fullwidth Forms":a=>a>=65280&&a<=65519};function Vc(a){for(const s of a)if(fl(s.charCodeAt(0)))return!0;return!1}function Ni(a){for(const s of a)if(!Ap(s.charCodeAt(0)))return!1;return!0}function Ap(a){return!(Ge.Arabic(a)||Ge["Arabic Supplement"](a)||Ge["Arabic Extended-A"](a)||Ge["Arabic Presentation Forms-A"](a)||Ge["Arabic Presentation Forms-B"](a))}function fl(a){return!(746!==a&&747!==a&&(a<4352||!(Ge["Bopomofo Extended"](a)||Ge.Bopomofo(a)||Ge["CJK Compatibility Forms"](a)&&!(a>=65097&&a<=65103)||Ge["CJK Compatibility Ideographs"](a)||Ge["CJK Compatibility"](a)||Ge["CJK Radicals Supplement"](a)||Ge["CJK Strokes"](a)||!(!Ge["CJK Symbols and Punctuation"](a)||a>=12296&&a<=12305||a>=12308&&a<=12319||12336===a)||Ge["CJK Unified Ideographs Extension A"](a)||Ge["CJK Unified Ideographs"](a)||Ge["Enclosed CJK Letters and Months"](a)||Ge["Hangul Compatibility Jamo"](a)||Ge["Hangul Jamo Extended-A"](a)||Ge["Hangul Jamo Extended-B"](a)||Ge["Hangul Jamo"](a)||Ge["Hangul Syllables"](a)||Ge.Hiragana(a)||Ge["Ideographic Description Characters"](a)||Ge.Kanbun(a)||Ge["Kangxi Radicals"](a)||Ge["Katakana Phonetic Extensions"](a)||Ge.Katakana(a)&&12540!==a||!(!Ge["Halfwidth and Fullwidth Forms"](a)||65288===a||65289===a||65293===a||a>=65306&&a<=65310||65339===a||65341===a||65343===a||a>=65371&&a<=65503||65507===a||a>=65512&&a<=65519)||!(!Ge["Small Form Variants"](a)||a>=65112&&a<=65118||a>=65123&&a<=65126)||Ge["Unified Canadian Aboriginal Syllabics"](a)||Ge["Unified Canadian Aboriginal Syllabics Extended"](a)||Ge["Vertical Forms"](a)||Ge["Yijing Hexagram Symbols"](a)||Ge["Yi Syllables"](a)||Ge["Yi Radicals"](a))))}function xt(a){return!(fl(a)||(s=a,Ge["Latin-1 Supplement"](s)&&(167===s||169===s||174===s||177===s||188===s||189===s||190===s||215===s||247===s)||Ge["General Punctuation"](s)&&(8214===s||8224===s||8225===s||8240===s||8241===s||8251===s||8252===s||8258===s||8263===s||8264===s||8265===s||8273===s)||Ge["Letterlike Symbols"](s)||Ge["Number Forms"](s)||Ge["Miscellaneous Technical"](s)&&(s>=8960&&s<=8967||s>=8972&&s<=8991||s>=8996&&s<=9e3||9003===s||s>=9085&&s<=9114||s>=9150&&s<=9165||9167===s||s>=9169&&s<=9179||s>=9186&&s<=9215)||Ge["Control Pictures"](s)&&9251!==s||Ge["Optical Character Recognition"](s)||Ge["Enclosed Alphanumerics"](s)||Ge["Geometric Shapes"](s)||Ge["Miscellaneous Symbols"](s)&&!(s>=9754&&s<=9759)||Ge["Miscellaneous Symbols and Arrows"](s)&&(s>=11026&&s<=11055||s>=11088&&s<=11097||s>=11192&&s<=11243)||Ge["CJK Symbols and Punctuation"](s)||Ge.Katakana(s)||Ge["Private Use Area"](s)||Ge["CJK Compatibility Forms"](s)||Ge["Small Form Variants"](s)||Ge["Halfwidth and Fullwidth Forms"](s)||8734===s||8756===s||8757===s||s>=9984&&s<=10087||s>=10102&&s<=10131||65532===s||65533===s));var s}function Qi(a){return a>=1424&&a<=2303||Ge["Arabic Presentation Forms-A"](a)||Ge["Arabic Presentation Forms-B"](a)}function tn(a,s){return!(!s&&Qi(a)||a>=2304&&a<=3583||a>=3840&&a<=4255||Ge.Khmer(a))}function zi(a){for(const s of a)if(Qi(s.charCodeAt(0)))return!0;return!1}const er="deferred",Gs="loading",vr="loaded";let Uc=null,br="unavailable",bs=null;const Ku=function(a){a&&"string"==typeof a&&a.indexOf("NetworkError")>-1&&(br="error"),Uc&&Uc(a)};function Yu(){Gn.fire(new is("pluginStateChange",{pluginStatus:br,pluginURL:bs}))}const Gn=new zs,Qe=function(){return br},Ot=function(){if(br!==er||!bs)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");br=Gs,Yu(),bs&&Ka({url:bs},a=>{a?Ku(a):(br=vr,Yu())})},Xt={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>br===vr||null!=Xt.applyArabicShaping,isLoading:()=>br===Gs,setState(a){if(!mr())throw new Error("Cannot set the state of the rtl-text-plugin when not in the web-worker context");br=a.pluginStatus,bs=a.pluginURL},isParsed(){if(!mr())throw new Error("rtl-text-plugin is only parsed on the worker-threads");return null!=Xt.applyArabicShaping&&null!=Xt.processBidirectionalText&&null!=Xt.processStyledBidirectionalText},getPluginURL(){if(!mr())throw new Error("rtl-text-plugin url can only be queried from the worker threads");return bs}};class Kt{constructor(s,l){this.zoom=s,l?(this.now=l.now,this.fadeDuration=l.fadeDuration,this.zoomHistory=l.zoomHistory,this.transition=l.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Xu,this.transition={})}isSupportedScript(s){return function(l,d){for(const f of l)if(!tn(f.charCodeAt(0),d))return!1;return!0}(s,Xt.isLoaded())}crossFadingFactor(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const s=this.zoom,l=s-Math.floor(s),d=this.crossFadingFactor();return s>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:l+(1-l)*d}:{fromScale:.5,toScale:1,t:1-(1-d)*l}}}class jo{constructor(s,l){this.property=s,this.value=l,this.expression=function(d,f){if(zu(d))return new Hs(d,f);if(Uu(d)){const v=In(d,f);if("error"===v.result)throw new Error(v.value.map(x=>`${x.key}: ${x.message}`).join(", "));return v.value}{let v=d;return"color"===f.type&&"string"==typeof d?v=gt.parse(d):"padding"!==f.type||"number"!=typeof d&&!Array.isArray(d)?"variableAnchorOffsetCollection"===f.type&&Array.isArray(d)&&(v=Ki.parse(d)):v=$r.parse(d),{kind:"constant",evaluate:()=>v}}}(void 0===l?s.specification.default:l,s.specification)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(s,l,d){return this.property.possiblyEvaluate(this,s,l,d)}}class pi{constructor(s){this.property=s,this.value=new jo(s,void 0)}transitioned(s,l){return new qn(this.property,this.value,l,qi({},s.transition,this.transition),s.now)}untransitioned(){return new qn(this.property,this.value,null,{},0)}}class ya{constructor(s){this._properties=s,this._values=Object.create(s.defaultTransitionablePropertyValues)}getValue(s){return Pr(this._values[s].value.value)}setValue(s,l){Object.prototype.hasOwnProperty.call(this._values,s)||(this._values[s]=new pi(this._values[s].property)),this._values[s].value=new jo(this._values[s].property,null===l?void 0:Pr(l))}getTransition(s){return Pr(this._values[s].transition)}setTransition(s,l){Object.prototype.hasOwnProperty.call(this._values,s)||(this._values[s]=new pi(this._values[s].property)),this._values[s].transition=Pr(l)||void 0}serialize(){const s={};for(const l of Object.keys(this._values)){const d=this.getValue(l);void 0!==d&&(s[l]=d);const f=this.getTransition(l);void 0!==f&&(s[`${l}-transition`]=f)}return s}transitioned(s,l){const d=new po(this._properties);for(const f of Object.keys(this._values))d._values[f]=this._values[f].transitioned(s,l._values[f]);return d}untransitioned(){const s=new po(this._properties);for(const l of Object.keys(this._values))s._values[l]=this._values[l].untransitioned();return s}}class qn{constructor(s,l,d,f,v){this.property=s,this.value=l,this.begin=v+f.delay||0,this.end=this.begin+f.duration||0,s.specification.transition&&(f.delay||f.duration)&&(this.prior=d)}possiblyEvaluate(s,l,d){const f=s.now||0,v=this.value.possiblyEvaluate(s,l,d),x=this.prior;if(x){if(f>this.end)return this.prior=null,v;if(this.value.isDataDriven())return this.prior=null,v;if(f<this.begin)return x.possiblyEvaluate(s,l,d);{const C=(f-this.begin)/(this.end-this.begin);return this.property.interpolate(x.possiblyEvaluate(s,l,d),v,function(S){if(S<=0)return 0;if(S>=1)return 1;const T=S*S,O=T*S;return 4*(S<.5?O:3*(S-T)+O-.75)}(C))}}return v}}class po{constructor(s){this._properties=s,this._values=Object.create(s.defaultTransitioningPropertyValues)}possiblyEvaluate(s,l,d){const f=new fo(this._properties);for(const v of Object.keys(this._values))f._values[v]=this._values[v].possiblyEvaluate(s,l,d);return f}hasTransition(){for(const s of Object.keys(this._values))if(this._values[s].prior)return!0;return!1}}class ml{constructor(s){this._properties=s,this._values=Object.create(s.defaultPropertyValues)}hasValue(s){return void 0!==this._values[s].value}getValue(s){return Pr(this._values[s].value)}setValue(s,l){this._values[s]=new jo(this._values[s].property,null===l?void 0:Pr(l))}serialize(){const s={};for(const l of Object.keys(this._values)){const d=this.getValue(l);void 0!==d&&(s[l]=d)}return s}possiblyEvaluate(s,l,d){const f=new fo(this._properties);for(const v of Object.keys(this._values))f._values[v]=this._values[v].possiblyEvaluate(s,l,d);return f}}class wt{constructor(s,l,d){this.property=s,this.value=l,this.parameters=d}isConstant(){return"constant"===this.value.kind}constantOr(s){return"constant"===this.value.kind?this.value.value:s}evaluate(s,l,d,f){return this.property.evaluate(this.value,this.parameters,s,l,d,f)}}class fo{constructor(s){this._properties=s,this._values=Object.create(s.defaultPossiblyEvaluatedValues)}get(s){return this._values[s]}}class lt{constructor(s){this.specification=s}possiblyEvaluate(s,l){if(s.isDataDriven())throw new Error("Value should not be data driven");return s.expression.evaluate(l)}interpolate(s,l,d){const f=ss[this.specification.type];return f?f(s,l,d):s}}class ft{constructor(s,l){this.specification=s,this.overrides=l}possiblyEvaluate(s,l,d,f){return new wt(this,"constant"===s.expression.kind||"camera"===s.expression.kind?{kind:"constant",value:s.expression.evaluate(l,null,{},d,f)}:s.expression,l)}interpolate(s,l,d){if("constant"!==s.value.kind||"constant"!==l.value.kind)return s;if(void 0===s.value.value||void 0===l.value.value)return new wt(this,{kind:"constant",value:void 0},s.parameters);const f=ss[this.specification.type];if(f){const v=f(s.value.value,l.value.value,d);return new wt(this,{kind:"constant",value:v},s.parameters)}return s}evaluate(s,l,d,f,v,x){return"constant"===s.kind?s.value:s.evaluate(l,d,f,v,x)}}class Zn extends ft{possiblyEvaluate(s,l,d,f){if(void 0===s.value)return new wt(this,{kind:"constant",value:void 0},l);if("constant"===s.expression.kind){const v=s.expression.evaluate(l,null,{},d,f),x="resolvedImage"===s.property.specification.type&&"string"!=typeof v?v.name:v,C=this._calculate(x,x,x,l);return new wt(this,{kind:"constant",value:C},l)}if("camera"===s.expression.kind){const v=this._calculate(s.expression.evaluate({zoom:l.zoom-1}),s.expression.evaluate({zoom:l.zoom}),s.expression.evaluate({zoom:l.zoom+1}),l);return new wt(this,{kind:"constant",value:v},l)}return new wt(this,s.expression,l)}evaluate(s,l,d,f,v,x){if("source"===s.kind){const C=s.evaluate(l,d,f,v,x);return this._calculate(C,C,C,l)}return"composite"===s.kind?this._calculate(s.evaluate({zoom:Math.floor(l.zoom)-1},d,f),s.evaluate({zoom:Math.floor(l.zoom)},d,f),s.evaluate({zoom:Math.floor(l.zoom)+1},d,f),l):s.value}_calculate(s,l,d,f){return f.zoom>f.zoomHistory.lastIntegerZoom?{from:s,to:l}:{from:d,to:l}}interpolate(s){return s}}class va{constructor(s){this.specification=s}possiblyEvaluate(s,l,d,f){if(void 0!==s.value){if("constant"===s.expression.kind){const v=s.expression.evaluate(l,null,{},d,f);return this._calculate(v,v,v,l)}return this._calculate(s.expression.evaluate(new Kt(Math.floor(l.zoom-1),l)),s.expression.evaluate(new Kt(Math.floor(l.zoom),l)),s.expression.evaluate(new Kt(Math.floor(l.zoom+1),l)),l)}}_calculate(s,l,d,f){return f.zoom>f.zoomHistory.lastIntegerZoom?{from:s,to:l}:{from:d,to:l}}interpolate(s){return s}}class $o{constructor(s){this.specification=s}possiblyEvaluate(s,l,d,f){return!!s.expression.evaluate(l,null,{},d,f)}interpolate(){return!1}}class ei{constructor(s){this.properties=s,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const l in s){const d=s[l];d.specification.overridable&&this.overridableProperties.push(l);const f=this.defaultPropertyValues[l]=new jo(d,void 0),v=this.defaultTransitionablePropertyValues[l]=new pi(d);this.defaultTransitioningPropertyValues[l]=v.untransitioned(),this.defaultPossiblyEvaluatedValues[l]=f.possiblyEvaluate({})}}}Je("DataDrivenProperty",ft),Je("DataConstantProperty",lt),Je("CrossFadedDataDrivenProperty",Zn),Je("CrossFadedProperty",va),Je("ColorRampProperty",$o);const xs="-transition";class ws extends zs{constructor(s,l){if(super(),this.id=s.id,this.type=s.type,this._featureFilter={filter:()=>!0,needGeometry:!1},"custom"!==s.type&&(this.metadata=s.metadata,this.minzoom=s.minzoom,this.maxzoom=s.maxzoom,"background"!==s.type&&(this.source=s.source,this.sourceLayer=s["source-layer"],this.filter=s.filter),l.layout&&(this._unevaluatedLayout=new ml(l.layout)),l.paint)){this._transitionablePaint=new ya(l.paint);for(const d in s.paint)this.setPaintProperty(d,s.paint[d],{validate:!1});for(const d in s.layout)this.setLayoutProperty(d,s.layout[d],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new fo(l.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(s){return"visibility"===s?this.visibility:this._unevaluatedLayout.getValue(s)}setLayoutProperty(s,l,d={}){null!=l&&this._validate(Tp,`layers.${this.id}.layout.${s}`,s,l,d)||("visibility"!==s?this._unevaluatedLayout.setValue(s,l):this.visibility=l)}getPaintProperty(s){return s.endsWith(xs)?this._transitionablePaint.getTransition(s.slice(0,-11)):this._transitionablePaint.getValue(s)}setPaintProperty(s,l,d={}){if(null!=l&&this._validate(Gl,`layers.${this.id}.paint.${s}`,s,l,d))return!1;if(s.endsWith(xs))return this._transitionablePaint.setTransition(s.slice(0,-11),l||void 0),!1;{const f=this._transitionablePaint._values[s],v="cross-faded-data-driven"===f.property.specification["property-type"],x=f.value.isDataDriven(),C=f.value;this._transitionablePaint.setValue(s,l),this._handleSpecialPaintPropertyUpdate(s);const S=this._transitionablePaint._values[s].value;return S.isDataDriven()||x||v||this._handleOverridablePaintPropertyUpdate(s,C,S)}}_handleSpecialPaintPropertyUpdate(s){}_handleOverridablePaintPropertyUpdate(s,l,d){return!1}isHidden(s){return!!(this.minzoom&&s<this.minzoom)||!!(this.maxzoom&&s>=this.maxzoom)||"none"===this.visibility}updateTransitions(s){this._transitioningPaint=this._transitionablePaint.transitioned(s,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(s,l){s.getCrossfadeParameters&&(this._crossfadeParameters=s.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(s,void 0,l)),this.paint=this._transitioningPaint.possiblyEvaluate(s,void 0,l)}serialize(){const s={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(s.layout=s.layout||{},s.layout.visibility=this.visibility),Rl(s,(l,d)=>!(void 0===l||"layout"===d&&!Object.keys(l).length||"paint"===d&&!Object.keys(l).length))}_validate(s,l,d,f,v={}){return(!v||!1!==v.validate)&&Bc(this,s.call(Hl,{key:l,layerType:this.type,objectKey:d,value:f,styleSpec:we,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const s in this.paint._values){const l=this.paint.get(s);if(l instanceof wt&&pa(l.property.specification)&&("source"===l.value.kind||"composite"===l.value.kind)&&l.value.isStateDependent)return!0}return!1}}const Ho={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Gr{constructor(s,l){this._structArray=s,this._pos1=l*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Sn{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(s,l){return s._trim(),l&&(s.isTransferred=!0,l.push(s.arrayBuffer)),{length:s.length,arrayBuffer:s.arrayBuffer}}static deserialize(s){const l=Object.create(this.prototype);return l.arrayBuffer=s.arrayBuffer,l.length=s.length,l.capacity=s.arrayBuffer.byteLength/l.bytesPerElement,l._refreshViews(),l}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(s){this.reserve(s),this.length=s}reserve(s){if(s>this.capacity){this.capacity=Math.max(s,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const l=this.uint8;this._refreshViews(),l&&this.uint8.set(l)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Un(a,s=1){let l=0,d=0;return{members:a.map(f=>{const v=Ho[f.type].BYTES_PER_ELEMENT,x=l=Ht(l,Math.max(s,v)),C=f.components||1;return d=Math.max(d,v),l+=v*C,{name:f.name,type:f.type,components:C,offset:x}}),size:Ht(l,Math.max(d,s)),alignment:s}}function Ht(a,s){return Math.ceil(a/s)*s}class Cs extends Sn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,l){const d=this.length;return this.resize(d+1),this.emplace(d,s,l)}emplace(s,l,d){const f=2*s;return this.int16[f+0]=l,this.int16[f+1]=d,s}}Cs.prototype.bytesPerElement=4,Je("StructArrayLayout2i4",Cs);class ba extends Sn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,l,d){const f=this.length;return this.resize(f+1),this.emplace(f,s,l,d)}emplace(s,l,d,f){const v=3*s;return this.int16[v+0]=l,this.int16[v+1]=d,this.int16[v+2]=f,s}}ba.prototype.bytesPerElement=6,Je("StructArrayLayout3i6",ba);class gl extends Sn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,l,d,f){const v=this.length;return this.resize(v+1),this.emplace(v,s,l,d,f)}emplace(s,l,d,f,v){const x=4*s;return this.int16[x+0]=l,this.int16[x+1]=d,this.int16[x+2]=f,this.int16[x+3]=v,s}}gl.prototype.bytesPerElement=8,Je("StructArrayLayout4i8",gl);class qr extends Sn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,l,d,f,v,x){const C=this.length;return this.resize(C+1),this.emplace(C,s,l,d,f,v,x)}emplace(s,l,d,f,v,x,C){const S=6*s;return this.int16[S+0]=l,this.int16[S+1]=d,this.int16[S+2]=f,this.int16[S+3]=v,this.int16[S+4]=x,this.int16[S+5]=C,s}}qr.prototype.bytesPerElement=12,Je("StructArrayLayout2i4i12",qr);class Go extends Sn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,l,d,f,v,x){const C=this.length;return this.resize(C+1),this.emplace(C,s,l,d,f,v,x)}emplace(s,l,d,f,v,x,C){const S=4*s,T=8*s;return this.int16[S+0]=l,this.int16[S+1]=d,this.uint8[T+4]=f,this.uint8[T+5]=v,this.uint8[T+6]=x,this.uint8[T+7]=C,s}}Go.prototype.bytesPerElement=8,Je("StructArrayLayout2i4ub8",Go);class qs extends Sn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,l){const d=this.length;return this.resize(d+1),this.emplace(d,s,l)}emplace(s,l,d){const f=2*s;return this.float32[f+0]=l,this.float32[f+1]=d,s}}qs.prototype.bytesPerElement=8,Je("StructArrayLayout2f8",qs);class Zs extends Sn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,l,d,f,v,x,C,S,T,O){const L=this.length;return this.resize(L+1),this.emplace(L,s,l,d,f,v,x,C,S,T,O)}emplace(s,l,d,f,v,x,C,S,T,O,L){const B=10*s;return this.uint16[B+0]=l,this.uint16[B+1]=d,this.uint16[B+2]=f,this.uint16[B+3]=v,this.uint16[B+4]=x,this.uint16[B+5]=C,this.uint16[B+6]=S,this.uint16[B+7]=T,this.uint16[B+8]=O,this.uint16[B+9]=L,s}}Zs.prototype.bytesPerElement=20,Je("StructArrayLayout10ui20",Zs);class ti extends Sn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,l,d,f,v,x,C,S,T,O,L,B){const j=this.length;return this.resize(j+1),this.emplace(j,s,l,d,f,v,x,C,S,T,O,L,B)}emplace(s,l,d,f,v,x,C,S,T,O,L,B,j){const $=12*s;return this.int16[$+0]=l,this.int16[$+1]=d,this.int16[$+2]=f,this.int16[$+3]=v,this.uint16[$+4]=x,this.uint16[$+5]=C,this.uint16[$+6]=S,this.uint16[$+7]=T,this.int16[$+8]=O,this.int16[$+9]=L,this.int16[$+10]=B,this.int16[$+11]=j,s}}ti.prototype.bytesPerElement=24,Je("StructArrayLayout4i4ui4i24",ti);class qd extends Sn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,l,d){const f=this.length;return this.resize(f+1),this.emplace(f,s,l,d)}emplace(s,l,d,f){const v=3*s;return this.float32[v+0]=l,this.float32[v+1]=d,this.float32[v+2]=f,s}}qd.prototype.bytesPerElement=12,Je("StructArrayLayout3f12",qd);class tr extends Sn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(s){const l=this.length;return this.resize(l+1),this.emplace(l,s)}emplace(s,l){return this.uint32[1*s+0]=l,s}}tr.prototype.bytesPerElement=4,Je("StructArrayLayout1ul4",tr);class fi extends Sn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,l,d,f,v,x,C,S,T){const O=this.length;return this.resize(O+1),this.emplace(O,s,l,d,f,v,x,C,S,T)}emplace(s,l,d,f,v,x,C,S,T,O){const L=10*s,B=5*s;return this.int16[L+0]=l,this.int16[L+1]=d,this.int16[L+2]=f,this.int16[L+3]=v,this.int16[L+4]=x,this.int16[L+5]=C,this.uint32[B+3]=S,this.uint16[L+8]=T,this.uint16[L+9]=O,s}}fi.prototype.bytesPerElement=20,Je("StructArrayLayout6i1ul2ui20",fi);class Wl extends Sn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,l,d,f,v,x){const C=this.length;return this.resize(C+1),this.emplace(C,s,l,d,f,v,x)}emplace(s,l,d,f,v,x,C){const S=6*s;return this.int16[S+0]=l,this.int16[S+1]=d,this.int16[S+2]=f,this.int16[S+3]=v,this.int16[S+4]=x,this.int16[S+5]=C,s}}Wl.prototype.bytesPerElement=12,Je("StructArrayLayout2i2i2i12",Wl);class mo extends Sn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,l,d,f,v){const x=this.length;return this.resize(x+1),this.emplace(x,s,l,d,f,v)}emplace(s,l,d,f,v,x){const C=4*s,S=8*s;return this.float32[C+0]=l,this.float32[C+1]=d,this.float32[C+2]=f,this.int16[S+6]=v,this.int16[S+7]=x,s}}mo.prototype.bytesPerElement=16,Je("StructArrayLayout2f1f2i16",mo);class xa extends Sn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,l,d,f){const v=this.length;return this.resize(v+1),this.emplace(v,s,l,d,f)}emplace(s,l,d,f,v){const x=12*s,C=3*s;return this.uint8[x+0]=l,this.uint8[x+1]=d,this.float32[C+1]=f,this.float32[C+2]=v,s}}xa.prototype.bytesPerElement=12,Je("StructArrayLayout2ub2f12",xa);class Or extends Sn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,l,d){const f=this.length;return this.resize(f+1),this.emplace(f,s,l,d)}emplace(s,l,d,f){const v=3*s;return this.uint16[v+0]=l,this.uint16[v+1]=d,this.uint16[v+2]=f,s}}Or.prototype.bytesPerElement=6,Je("StructArrayLayout3ui6",Or);class Xl extends Sn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,l,d,f,v,x,C,S,T,O,L,B,j,$,K,Q,ne){const de=this.length;return this.resize(de+1),this.emplace(de,s,l,d,f,v,x,C,S,T,O,L,B,j,$,K,Q,ne)}emplace(s,l,d,f,v,x,C,S,T,O,L,B,j,$,K,Q,ne,de){const oe=24*s,pe=12*s,_e=48*s;return this.int16[oe+0]=l,this.int16[oe+1]=d,this.uint16[oe+2]=f,this.uint16[oe+3]=v,this.uint32[pe+2]=x,this.uint32[pe+3]=C,this.uint32[pe+4]=S,this.uint16[oe+10]=T,this.uint16[oe+11]=O,this.uint16[oe+12]=L,this.float32[pe+7]=B,this.float32[pe+8]=j,this.uint8[_e+36]=$,this.uint8[_e+37]=K,this.uint8[_e+38]=Q,this.uint32[pe+10]=ne,this.int16[oe+22]=de,s}}Xl.prototype.bytesPerElement=48,Je("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Xl);class rn extends Sn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,l,d,f,v,x,C,S,T,O,L,B,j,$,K,Q,ne,de,oe,pe,_e,Me,Ze,it,qe,je,Ne,et){const ze=this.length;return this.resize(ze+1),this.emplace(ze,s,l,d,f,v,x,C,S,T,O,L,B,j,$,K,Q,ne,de,oe,pe,_e,Me,Ze,it,qe,je,Ne,et)}emplace(s,l,d,f,v,x,C,S,T,O,L,B,j,$,K,Q,ne,de,oe,pe,_e,Me,Ze,it,qe,je,Ne,et,ze){const Oe=32*s,ut=16*s;return this.int16[Oe+0]=l,this.int16[Oe+1]=d,this.int16[Oe+2]=f,this.int16[Oe+3]=v,this.int16[Oe+4]=x,this.int16[Oe+5]=C,this.int16[Oe+6]=S,this.int16[Oe+7]=T,this.uint16[Oe+8]=O,this.uint16[Oe+9]=L,this.uint16[Oe+10]=B,this.uint16[Oe+11]=j,this.uint16[Oe+12]=$,this.uint16[Oe+13]=K,this.uint16[Oe+14]=Q,this.uint16[Oe+15]=ne,this.uint16[Oe+16]=de,this.uint16[Oe+17]=oe,this.uint16[Oe+18]=pe,this.uint16[Oe+19]=_e,this.uint16[Oe+20]=Me,this.uint16[Oe+21]=Ze,this.uint16[Oe+22]=it,this.uint32[ut+12]=qe,this.float32[ut+13]=je,this.float32[ut+14]=Ne,this.uint16[Oe+30]=et,this.uint16[Oe+31]=ze,s}}rn.prototype.bytesPerElement=64,Je("StructArrayLayout8i15ui1ul2f2ui64",rn);class _ extends Sn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s){const l=this.length;return this.resize(l+1),this.emplace(l,s)}emplace(s,l){return this.float32[1*s+0]=l,s}}_.prototype.bytesPerElement=4,Je("StructArrayLayout1f4",_);class o extends Sn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,l,d){const f=this.length;return this.resize(f+1),this.emplace(f,s,l,d)}emplace(s,l,d,f){const v=3*s;return this.uint16[6*s+0]=l,this.float32[v+1]=d,this.float32[v+2]=f,s}}o.prototype.bytesPerElement=12,Je("StructArrayLayout1ui2f12",o);class u extends Sn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,l,d){const f=this.length;return this.resize(f+1),this.emplace(f,s,l,d)}emplace(s,l,d,f){const v=4*s;return this.uint32[2*s+0]=l,this.uint16[v+2]=d,this.uint16[v+3]=f,s}}u.prototype.bytesPerElement=8,Je("StructArrayLayout1ul2ui8",u);class p extends Sn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,l){const d=this.length;return this.resize(d+1),this.emplace(d,s,l)}emplace(s,l,d){const f=2*s;return this.uint16[f+0]=l,this.uint16[f+1]=d,s}}p.prototype.bytesPerElement=4,Je("StructArrayLayout2ui4",p);class m extends Sn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s){const l=this.length;return this.resize(l+1),this.emplace(l,s)}emplace(s,l){return this.uint16[1*s+0]=l,s}}m.prototype.bytesPerElement=2,Je("StructArrayLayout1ui2",m);class b extends Sn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,l,d,f){const v=this.length;return this.resize(v+1),this.emplace(v,s,l,d,f)}emplace(s,l,d,f,v){const x=4*s;return this.float32[x+0]=l,this.float32[x+1]=d,this.float32[x+2]=f,this.float32[x+3]=v,s}}b.prototype.bytesPerElement=16,Je("StructArrayLayout4f16",b);class E extends Gr{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new yt(this.anchorPointX,this.anchorPointY)}}E.prototype.size=20;class D extends fi{get(s){return new E(this,s)}}Je("CollisionBoxArray",D);class M extends Gr{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(s){this._structArray.uint8[this._pos1+37]=s}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(s){this._structArray.uint8[this._pos1+38]=s}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(s){this._structArray.uint32[this._pos4+10]=s}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}M.prototype.size=48;class k extends Xl{get(s){return new M(this,s)}}Je("PlacedSymbolArray",k);class R extends Gr{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(s){this._structArray.uint32[this._pos4+12]=s}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}R.prototype.size=64;class F extends rn{get(s){return new R(this,s)}}Je("SymbolInstanceArray",F);class U extends _{getoffsetX(s){return this.float32[1*s+0]}}Je("GlyphOffsetArray",U);class X extends ba{getx(s){return this.int16[3*s+0]}gety(s){return this.int16[3*s+1]}gettileUnitDistanceFromAnchor(s){return this.int16[3*s+2]}}Je("SymbolLineVertexArray",X);class W extends Gr{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}W.prototype.size=12;class J extends o{get(s){return new W(this,s)}}Je("TextAnchorOffsetArray",J);class q extends Gr{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}q.prototype.size=8;class le extends u{get(s){return new q(this,s)}}Je("FeatureIndexArray",le);class me extends Cs{}class te extends Cs{}class ce extends Cs{}class ye extends qr{}class ve extends Go{}class Se extends qs{}class ke extends Zs{}class De extends ti{}class Le extends qd{}class We extends tr{}class zt extends Wl{}class Ue extends xa{}class dt extends Or{}class rt extends p{}const Pn=Un([{name:"a_pos",components:2,type:"Int16"}],4),{members:Bt}=Pn;class ht{constructor(s=[]){this.segments=s}prepareSegment(s,l,d,f){let v=this.segments[this.segments.length-1];return s>ht.MAX_VERTEX_ARRAY_LENGTH&&Zi(`Max vertices per segment is ${ht.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${s}`),(!v||v.vertexLength+s>ht.MAX_VERTEX_ARRAY_LENGTH||v.sortKey!==f)&&(v={vertexOffset:l.length,primitiveOffset:d.length,vertexLength:0,primitiveLength:0},void 0!==f&&(v.sortKey=f),this.segments.push(v)),v}get(){return this.segments}destroy(){for(const s of this.segments)for(const l in s.vaos)s.vaos[l].destroy()}static simpleSegment(s,l,d,f){return new ht([{vertexOffset:s,primitiveOffset:l,vertexLength:d,primitiveLength:f,vaos:{},sortKey:0}])}}function Lt(a,s){return 256*(a=Kn(Math.floor(a),0,255))+Kn(Math.floor(s),0,255)}ht.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Je("SegmentVector",ht);const jn=Un([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var un={exports:{}},Ai=function(a,s){var l,d,f,v,x,C,S,T;for(d=a.length-(l=3&a.length),f=s,x=3432918353,C=461845907,T=0;T<d;)S=255&a.charCodeAt(T)|(255&a.charCodeAt(++T))<<8|(255&a.charCodeAt(++T))<<16|(255&a.charCodeAt(++T))<<24,++T,f=27492+(65535&(v=5*(65535&(f=(f^=S=(65535&(S=(S=(65535&S)*x+(((S>>>16)*x&65535)<<16)&4294967295)<<15|S>>>17))*C+(((S>>>16)*C&65535)<<16)&4294967295)<<13|f>>>19))+((5*(f>>>16)&65535)<<16)&4294967295))+((58964+(v>>>16)&65535)<<16);switch(S=0,l){case 3:S^=(255&a.charCodeAt(T+2))<<16;case 2:S^=(255&a.charCodeAt(T+1))<<8;case 1:f^=S=(65535&(S=(S=(65535&(S^=255&a.charCodeAt(T)))*x+(((S>>>16)*x&65535)<<16)&4294967295)<<15|S>>>17))*C+(((S>>>16)*C&65535)<<16)&4294967295}return f^=a.length,f=2246822507*(65535&(f^=f>>>16))+((2246822507*(f>>>16)&65535)<<16)&4294967295,f=3266489909*(65535&(f^=f>>>13))+((3266489909*(f>>>16)&65535)<<16)&4294967295,(f^=f>>>16)>>>0},Es=function(a,s){for(var l,d=a.length,f=s^d,v=0;d>=4;)l=1540483477*(65535&(l=255&a.charCodeAt(v)|(255&a.charCodeAt(++v))<<8|(255&a.charCodeAt(++v))<<16|(255&a.charCodeAt(++v))<<24))+((1540483477*(l>>>16)&65535)<<16),f=1540483477*(65535&f)+((1540483477*(f>>>16)&65535)<<16)^(l=1540483477*(65535&(l^=l>>>24))+((1540483477*(l>>>16)&65535)<<16)),d-=4,++v;switch(d){case 3:f^=(255&a.charCodeAt(v+2))<<16;case 2:f^=(255&a.charCodeAt(v+1))<<8;case 1:f=1540483477*(65535&(f^=255&a.charCodeAt(v)))+((1540483477*(f>>>16)&65535)<<16)}return f=1540483477*(65535&(f^=f>>>13))+((1540483477*(f>>>16)&65535)<<16),(f^=f>>>15)>>>0};un.exports=Ai,un.exports.murmur3=Ai,un.exports.murmur2=Es;var Ws=mn(un.exports);class go{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(s,l,d,f){this.ids.push(Kl(s)),this.positions.push(l,d,f)}getPositions(s){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const l=Kl(s);let d=0,f=this.ids.length-1;for(;d<f;){const x=d+f>>1;this.ids[x]>=l?f=x:d=x+1}const v=[];for(;this.ids[d]===l;)v.push({index:this.positions[3*d],start:this.positions[3*d+1],end:this.positions[3*d+2]}),d++;return v}static serialize(s,l){const d=new Float64Array(s.ids),f=new Uint32Array(s.positions);return qo(d,f,0,d.length-1),l&&l.push(d.buffer,f.buffer),{ids:d,positions:f}}static deserialize(s){const l=new go;return l.ids=s.ids,l.positions=s.positions,l.indexed=!0,l}}function Kl(a){const s=+a;return!isNaN(s)&&s<=Number.MAX_SAFE_INTEGER?s:Ws(String(a))}function qo(a,s,l,d){for(;l<d;){const f=a[l+d>>1];let v=l-1,x=d+1;for(;;){do{v++}while(a[v]<f);do{x--}while(a[x]>f);if(v>=x)break;_o(a,v,x),_o(s,3*v,3*x),_o(s,3*v+1,3*x+1),_o(s,3*v+2,3*x+2)}x-l<d-x?(qo(a,s,l,x),l=x+1):(qo(a,s,x+1,d),d=x)}}function _o(a,s,l){const d=a[s];a[s]=a[l],a[l]=d}Je("FeaturePositionMap",go);class wi{constructor(s,l){this.gl=s.gl,this.location=l}}class Ci extends wi{constructor(s,l){super(s,l),this.current=0}set(s){this.current!==s&&(this.current=s,this.gl.uniform1f(this.location,s))}}class Bi extends wi{constructor(s,l){super(s,l),this.current=[0,0,0,0]}set(s){s[0]===this.current[0]&&s[1]===this.current[1]&&s[2]===this.current[2]&&s[3]===this.current[3]||(this.current=s,this.gl.uniform4f(this.location,s[0],s[1],s[2],s[3]))}}class _l extends wi{constructor(s,l){super(s,l),this.current=gt.transparent}set(s){s.r===this.current.r&&s.g===this.current.g&&s.b===this.current.b&&s.a===this.current.a||(this.current=s,this.gl.uniform4f(this.location,s.r,s.g,s.b,s.a))}}const mi=new Float32Array(16);function ki(a){return[Lt(255*a.r,255*a.g),Lt(255*a.b,255*a.a)]}class xr{constructor(s,l,d){this.value=s,this.uniformNames=l.map(f=>`u_${f}`),this.type=d}setUniform(s,l,d){s.set(d.constantOr(this.value))}getBinding(s,l,d){return"color"===this.type?new _l(s,l):new Ci(s,l)}}class Wn{constructor(s,l){this.uniformNames=l.map(d=>`u_${d}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(s,l){this.pixelRatioFrom=l.pixelRatio,this.pixelRatioTo=s.pixelRatio,this.patternFrom=l.tlbr,this.patternTo=s.tlbr}setUniform(s,l,d,f){const v="u_pattern_to"===f?this.patternTo:"u_pattern_from"===f?this.patternFrom:"u_pixel_ratio_to"===f?this.pixelRatioTo:"u_pixel_ratio_from"===f?this.pixelRatioFrom:null;v&&s.set(v)}getBinding(s,l,d){return"u_pattern"===d.substr(0,9)?new Bi(s,l):new Ci(s,l)}}class Xs{constructor(s,l,d,f){this.expression=s,this.type=d,this.maxValue=0,this.paintVertexAttributes=l.map(v=>({name:`a_${v}`,type:"Float32",components:"color"===d?2:1,offset:0})),this.paintVertexArray=new f}populatePaintArray(s,l,d,f,v){const x=this.paintVertexArray.length,C=this.expression.evaluate(new Kt(0),l,{},f,[],v);this.paintVertexArray.resize(s),this._setPaintValue(x,s,C)}updatePaintArray(s,l,d,f){const v=this.expression.evaluate({zoom:0},d,f);this._setPaintValue(s,l,v)}_setPaintValue(s,l,d){if("color"===this.type){const f=ki(d);for(let v=s;v<l;v++)this.paintVertexArray.emplace(v,f[0],f[1])}else{for(let f=s;f<l;f++)this.paintVertexArray.emplace(f,d);this.maxValue=Math.max(this.maxValue,Math.abs(d))}}upload(s){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=s.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class cs{constructor(s,l,d,f,v,x){this.expression=s,this.uniformNames=l.map(C=>`u_${C}_t`),this.type=d,this.useIntegerZoom=f,this.zoom=v,this.maxValue=0,this.paintVertexAttributes=l.map(C=>({name:`a_${C}`,type:"Float32",components:"color"===d?4:2,offset:0})),this.paintVertexArray=new x}populatePaintArray(s,l,d,f,v){const x=this.expression.evaluate(new Kt(this.zoom),l,{},f,[],v),C=this.expression.evaluate(new Kt(this.zoom+1),l,{},f,[],v),S=this.paintVertexArray.length;this.paintVertexArray.resize(s),this._setPaintValue(S,s,x,C)}updatePaintArray(s,l,d,f){const v=this.expression.evaluate({zoom:this.zoom},d,f),x=this.expression.evaluate({zoom:this.zoom+1},d,f);this._setPaintValue(s,l,v,x)}_setPaintValue(s,l,d,f){if("color"===this.type){const v=ki(d),x=ki(f);for(let C=s;C<l;C++)this.paintVertexArray.emplace(C,v[0],v[1],x[0],x[1])}else{for(let v=s;v<l;v++)this.paintVertexArray.emplace(v,d,f);this.maxValue=Math.max(this.maxValue,Math.abs(d),Math.abs(f))}}upload(s){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=s.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(s,l){const d=this.useIntegerZoom?Math.floor(l.zoom):l.zoom,f=Kn(this.expression.interpolationFactor(d,this.zoom,this.zoom+1),0,1);s.set(f)}getBinding(s,l,d){return new Ci(s,l)}}class Zo{constructor(s,l,d,f,v,x){this.expression=s,this.type=l,this.useIntegerZoom=d,this.zoom=f,this.layerId=x,this.zoomInPaintVertexArray=new v,this.zoomOutPaintVertexArray=new v}populatePaintArray(s,l,d){const f=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(s),this.zoomOutPaintVertexArray.resize(s),this._setPaintValues(f,s,l.patterns&&l.patterns[this.layerId],d)}updatePaintArray(s,l,d,f,v){this._setPaintValues(s,l,d.patterns&&d.patterns[this.layerId],v)}_setPaintValues(s,l,d,f){if(!f||!d)return;const{min:v,mid:x,max:C}=d,S=f[v],T=f[x],O=f[C];if(S&&T&&O)for(let L=s;L<l;L++)this.zoomInPaintVertexArray.emplace(L,T.tl[0],T.tl[1],T.br[0],T.br[1],S.tl[0],S.tl[1],S.br[0],S.br[1],T.pixelRatio,S.pixelRatio),this.zoomOutPaintVertexArray.emplace(L,T.tl[0],T.tl[1],T.br[0],T.br[1],O.tl[0],O.tl[1],O.br[0],O.br[1],T.pixelRatio,O.pixelRatio)}upload(s){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=s.createVertexBuffer(this.zoomInPaintVertexArray,jn.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=s.createVertexBuffer(this.zoomOutPaintVertexArray,jn.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Zd{constructor(s,l,d){this.binders={},this._buffers=[];const f=[];for(const v in s.paint._values){if(!d(v))continue;const x=s.paint.get(v);if(!(x instanceof wt&&pa(x.property.specification)))continue;const C=Wd(v,s.type),S=x.value,T=x.property.specification.type,O=x.property.useIntegerZoom,L=x.property.specification["property-type"],B="cross-faded"===L||"cross-faded-data-driven"===L;if("constant"===S.kind)this.binders[v]=B?new Wn(S.value,C):new xr(S.value,C,T),f.push(`/u_${v}`);else if("source"===S.kind||B){const j=Ca(v,T,"source");this.binders[v]=B?new Zo(S,T,O,l,j,s.id):new Xs(S,C,T,j),f.push(`/a_${v}`)}else{const j=Ca(v,T,"composite");this.binders[v]=new cs(S,C,T,O,l,j),f.push(`/z_${v}`)}}this.cacheKey=f.sort().join("")}getMaxValue(s){const l=this.binders[s];return l instanceof Xs||l instanceof cs?l.maxValue:0}populatePaintArrays(s,l,d,f,v){for(const x in this.binders){const C=this.binders[x];(C instanceof Xs||C instanceof cs||C instanceof Zo)&&C.populatePaintArray(s,l,d,f,v)}}setConstantPatternPositions(s,l){for(const d in this.binders){const f=this.binders[d];f instanceof Wn&&f.setConstantPatternPositions(s,l)}}updatePaintArrays(s,l,d,f,v){let x=!1;for(const C in s){const S=l.getPositions(C);for(const T of S){const O=d.feature(T.index);for(const L in this.binders){const B=this.binders[L];if((B instanceof Xs||B instanceof cs||B instanceof Zo)&&!0===B.expression.isStateDependent){const j=f.paint.get(L);B.expression=j.value,B.updatePaintArray(T.start,T.end,O,s[C],v),x=!0}}}}return x}defines(){const s=[];for(const l in this.binders){const d=this.binders[l];(d instanceof xr||d instanceof Wn)&&s.push(...d.uniformNames.map(f=>`#define HAS_UNIFORM_${f}`))}return s}getBinderAttributes(){const s=[];for(const l in this.binders){const d=this.binders[l];if(d instanceof Xs||d instanceof cs)for(let f=0;f<d.paintVertexAttributes.length;f++)s.push(d.paintVertexAttributes[f].name);else if(d instanceof Zo)for(let f=0;f<jn.members.length;f++)s.push(jn.members[f].name)}return s}getBinderUniforms(){const s=[];for(const l in this.binders){const d=this.binders[l];if(d instanceof xr||d instanceof Wn||d instanceof cs)for(const f of d.uniformNames)s.push(f)}return s}getPaintVertexBuffers(){return this._buffers}getUniforms(s,l){const d=[];for(const f in this.binders){const v=this.binders[f];if(v instanceof xr||v instanceof Wn||v instanceof cs)for(const x of v.uniformNames)if(l[x]){const C=v.getBinding(s,l[x],x);d.push({name:x,property:f,binding:C})}}return d}setUniforms(s,l,d,f){for(const{name:v,property:x,binding:C}of l)this.binders[x].setUniform(C,f,d.get(x),v)}updatePaintBuffers(s){this._buffers=[];for(const l in this.binders){const d=this.binders[l];if(s&&d instanceof Zo){const f=2===s.fromScale?d.zoomInPaintVertexBuffer:d.zoomOutPaintVertexBuffer;f&&this._buffers.push(f)}else(d instanceof Xs||d instanceof cs)&&d.paintVertexBuffer&&this._buffers.push(d.paintVertexBuffer)}}upload(s){for(const l in this.binders){const d=this.binders[l];(d instanceof Xs||d instanceof cs||d instanceof Zo)&&d.upload(s)}this.updatePaintBuffers()}destroy(){for(const s in this.binders){const l=this.binders[s];(l instanceof Xs||l instanceof cs||l instanceof Zo)&&l.destroy()}}}class wa{constructor(s,l,d=(()=>!0)){this.programConfigurations={};for(const f of s)this.programConfigurations[f.id]=new Zd(f,l,d);this.needsUpload=!1,this._featureMap=new go,this._bufferOffset=0}populatePaintArrays(s,l,d,f,v,x){for(const C in this.programConfigurations)this.programConfigurations[C].populatePaintArrays(s,l,f,v,x);void 0!==l.id&&this._featureMap.add(l.id,d,this._bufferOffset,s),this._bufferOffset=s,this.needsUpload=!0}updatePaintArrays(s,l,d,f){for(const v of d)this.needsUpload=this.programConfigurations[v.id].updatePaintArrays(s,this._featureMap,l,v,f)||this.needsUpload}get(s){return this.programConfigurations[s]}upload(s){if(this.needsUpload){for(const l in this.programConfigurations)this.programConfigurations[l].upload(s);this.needsUpload=!1}}destroy(){for(const s in this.programConfigurations)this.programConfigurations[s].destroy()}}function Wd(a,s){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[a]||[a.replace(`${s}-`,"").replace(/-/g,"_")]}function Ca(a,s,l){const f={"line-pattern":{source:ke,composite:ke},"fill-pattern":{source:ke,composite:ke},"fill-extrusion-pattern":{source:ke,composite:ke}}[a];return f&&f[l]||{color:{source:qs,composite:b},number:{source:_,composite:qs}}[s][l]}Je("ConstantBinder",xr),Je("CrossFadedConstantBinder",Wn),Je("SourceExpressionBinder",Xs),Je("CrossFadedCompositeBinder",Zo),Je("CompositeExpressionBinder",cs),Je("ProgramConfiguration",Zd,{omit:["_buffers"]}),Je("ProgramConfigurationSet",wa);const Xn=8192,jc=Math.pow(2,14)-1,Xd=-jc-1;function yo(a){const s=Xn/a.extent,l=a.loadGeometry();for(let d=0;d<l.length;d++){const f=l[d];for(let v=0;v<f.length;v++){const x=f[v],C=Math.round(x.x*s),S=Math.round(x.y*s);x.x=Kn(C,Xd,jc),x.y=Kn(S,Xd,jc),(C<x.x||C>x.x+1||S<x.y||S>x.y+1)&&Zi("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return l}function Bn(a,s){return{type:a.type,id:a.id,properties:a.properties,geometry:s?yo(a):[]}}function Ea(a,s,l,d,f){a.emplaceBack(2*s+(d+1)/2,2*l+(f+1)/2)}class kp{constructor(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(l=>l.id),this.index=s.index,this.hasPattern=!1,this.layoutVertexArray=new te,this.indexArray=new dt,this.segments=new ht,this.programConfigurations=new wa(s.layers,s.zoom),this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id)}populate(s,l,d){const f=this.layers[0],v=[];let x=null,C=!1;"circle"===f.type&&(x=f.layout.get("circle-sort-key"),C=!x.isConstant());for(const{feature:S,id:T,index:O,sourceLayerIndex:L}of s){const B=this.layers[0]._featureFilter.needGeometry,j=Bn(S,B);if(!this.layers[0]._featureFilter.filter(new Kt(this.zoom),j,d))continue;const $=C?x.evaluate(j,{},d):void 0,K={id:T,properties:S.properties,type:S.type,sourceLayerIndex:L,index:O,geometry:B?j.geometry:yo(S),patterns:{},sortKey:$};v.push(K)}C&&v.sort((S,T)=>S.sortKey-T.sortKey);for(const S of v){const{geometry:T,index:O,sourceLayerIndex:L}=S,B=s[O].feature;this.addFeature(S,T,O,d),l.featureIndex.insert(B,T,O,L,this.index)}}update(s,l,d){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,l,this.stateDependentLayers,d)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,Bt),this.indexBuffer=s.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(s,l,d,f){for(const v of l)for(const x of v){const C=x.x,S=x.y;if(C<0||C>=Xn||S<0||S>=Xn)continue;const T=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,s.sortKey),O=T.vertexLength;Ea(this.layoutVertexArray,C,S,-1,-1),Ea(this.layoutVertexArray,C,S,1,-1),Ea(this.layoutVertexArray,C,S,1,1),Ea(this.layoutVertexArray,C,S,-1,1),this.indexArray.emplaceBack(O,O+1,O+2),this.indexArray.emplaceBack(O,O+3,O+2),T.vertexLength+=4,T.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,d,{},f)}}function Lm(a,s){for(let l=0;l<a.length;l++)if(xn(s,a[l]))return!0;for(let l=0;l<s.length;l++)if(xn(a,s[l]))return!0;return!!Ju(a,s)}function Nm(a,s,l){return!!xn(a,s)||!!Ks(s,a,l)}function Pp(a,s){if(1===a.length)return Op(s,a[0]);for(let l=0;l<s.length;l++){const d=s[l];for(let f=0;f<d.length;f++)if(xn(a,d[f]))return!0}for(let l=0;l<a.length;l++)if(Op(s,a[l]))return!0;for(let l=0;l<s.length;l++)if(Ju(a,s[l]))return!0;return!1}function Dy(a,s,l){if(a.length>1){if(Ju(a,s))return!0;for(let d=0;d<s.length;d++)if(Ks(s[d],a,l))return!0}for(let d=0;d<a.length;d++)if(Ks(a[d],s,l))return!0;return!1}function Ju(a,s){if(0===a.length||0===s.length)return!1;for(let l=0;l<a.length-1;l++){const d=a[l],f=a[l+1];for(let v=0;v<s.length-1;v++)if(Iy(d,f,s[v],s[v+1]))return!0}return!1}function Iy(a,s,l,d){return gn(a,l,d)!==gn(s,l,d)&&gn(a,s,l)!==gn(a,s,d)}function Ks(a,s,l){const d=l*l;if(1===s.length)return a.distSqr(s[0])<d;for(let f=1;f<s.length;f++)if(Rp(a,s[f-1],s[f])<d)return!0;return!1}function Rp(a,s,l){const d=s.distSqr(l);if(0===d)return a.distSqr(s);const f=((a.x-s.x)*(l.x-s.x)+(a.y-s.y)*(l.y-s.y))/d;return a.distSqr(f<0?s:f>1?l:l.sub(s)._mult(f)._add(s))}function Op(a,s){let l,d,f,v=!1;for(let x=0;x<a.length;x++){l=a[x];for(let C=0,S=l.length-1;C<l.length;S=C++)d=l[C],f=l[S],d.y>s.y!=f.y>s.y&&s.x<(f.x-d.x)*(s.y-d.y)/(f.y-d.y)+d.x&&(v=!v)}return v}function xn(a,s){let l=!1;for(let d=0,f=a.length-1;d<a.length;f=d++){const v=a[d],x=a[f];v.y>s.y!=x.y>s.y&&s.x<(x.x-v.x)*(s.y-v.y)/(x.y-v.y)+v.x&&(l=!l)}return l}function Fp(a,s,l){const d=l[0],f=l[2];if(a.x<d.x&&s.x<d.x||a.x>f.x&&s.x>f.x||a.y<d.y&&s.y<d.y||a.y>f.y&&s.y>f.y)return!1;const v=gn(a,s,l[0]);return v!==gn(a,s,l[1])||v!==gn(a,s,l[2])||v!==gn(a,s,l[3])}function yl(a,s,l){const d=s.paint.get(a).value;return"constant"===d.kind?d.value:l.programConfigurations.get(s.id).getMaxValue(a)}function wr(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1])}function Kd(a,s,l,d,f){if(!s[0]&&!s[1])return a;const v=yt.convert(s)._mult(f);"viewport"===l&&v._rotate(-d);const x=[];for(let C=0;C<a.length;C++)x.push(a[C].sub(v));return x}let Lp,Yl;Je("CircleBucket",kp,{omit:["layers"]});var Ds={get paint(){return Yl=Yl||new ei({"circle-radius":new ft(we.paint_circle["circle-radius"]),"circle-color":new ft(we.paint_circle["circle-color"]),"circle-blur":new ft(we.paint_circle["circle-blur"]),"circle-opacity":new ft(we.paint_circle["circle-opacity"]),"circle-translate":new lt(we.paint_circle["circle-translate"]),"circle-translate-anchor":new lt(we.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new lt(we.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new lt(we.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new ft(we.paint_circle["circle-stroke-width"]),"circle-stroke-color":new ft(we.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new ft(we.paint_circle["circle-stroke-opacity"])})},get layout(){return Lp=Lp||new ei({"circle-sort-key":new ft(we.layout_circle["circle-sort-key"])})}},Lr=1e-6,$c=typeof Float32Array<"u"?Float32Array:Array;function Np(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function Da(a,s,l){var d=s[0],f=s[1],v=s[2],x=s[3],C=s[4],S=s[5],T=s[6],O=s[7],L=s[8],B=s[9],j=s[10],$=s[11],K=s[12],Q=s[13],ne=s[14],de=s[15],oe=l[0],pe=l[1],_e=l[2],Me=l[3];return a[0]=oe*d+pe*C+_e*L+Me*K,a[1]=oe*f+pe*S+_e*B+Me*Q,a[2]=oe*v+pe*T+_e*j+Me*ne,a[3]=oe*x+pe*O+_e*$+Me*de,a[4]=(oe=l[4])*d+(pe=l[5])*C+(_e=l[6])*L+(Me=l[7])*K,a[5]=oe*f+pe*S+_e*B+Me*Q,a[6]=oe*v+pe*T+_e*j+Me*ne,a[7]=oe*x+pe*O+_e*$+Me*de,a[8]=(oe=l[8])*d+(pe=l[9])*C+(_e=l[10])*L+(Me=l[11])*K,a[9]=oe*f+pe*S+_e*B+Me*Q,a[10]=oe*v+pe*T+_e*j+Me*ne,a[11]=oe*x+pe*O+_e*$+Me*de,a[12]=(oe=l[12])*d+(pe=l[13])*C+(_e=l[14])*L+(Me=l[15])*K,a[13]=oe*f+pe*S+_e*B+Me*Q,a[14]=oe*v+pe*T+_e*j+Me*ne,a[15]=oe*x+pe*O+_e*$+Me*de,a}Math.hypot||(Math.hypot=function(){for(var a=0,s=arguments.length;s--;)a+=arguments[s]*arguments[s];return Math.sqrt(a)});var Hc,Sy=Da;function Qu(a,s,l){var d=s[0],f=s[1],v=s[2],x=s[3];return a[0]=l[0]*d+l[4]*f+l[8]*v+l[12]*x,a[1]=l[1]*d+l[5]*f+l[9]*v+l[13]*x,a[2]=l[2]*d+l[6]*f+l[10]*v+l[14]*x,a[3]=l[3]*d+l[7]*f+l[11]*v+l[15]*x,a}Hc=new $c(4),$c!=Float32Array&&(Hc[0]=0,Hc[1]=0,Hc[2]=0,Hc[3]=0);class zm extends ws{constructor(s){super(s,Ds)}createBucket(s){return new kp(s)}queryRadius(s){const l=s;return yl("circle-radius",this,l)+yl("circle-stroke-width",this,l)+wr(this.paint.get("circle-translate"))}queryIntersectsFeature(s,l,d,f,v,x,C,S){const T=Kd(s,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),x.angle,C),O=this.paint.get("circle-radius").evaluate(l,d)+this.paint.get("circle-stroke-width").evaluate(l,d),L="map"===this.paint.get("circle-pitch-alignment"),B=L?T:(K=S,T.map(Q=>zp(Q,K))),j=L?O*C:O;var K;for(const $ of f)for(const K of $){const Q=L?K:zp(K,S);let ne=j;const de=Qu([],[K.x,K.y,0,1],S);if("viewport"===this.paint.get("circle-pitch-scale")&&"map"===this.paint.get("circle-pitch-alignment")?ne*=de[3]/x.cameraToCenterDistance:"map"===this.paint.get("circle-pitch-scale")&&"viewport"===this.paint.get("circle-pitch-alignment")&&(ne*=x.cameraToCenterDistance/de[3]),Nm(B,Q,ne))return!0}return!1}}function zp(a,s){const l=Qu([],[a.x,a.y,0,1],s);return new yt(l[0]/l[3],l[1]/l[3])}class Bm extends kp{}let kt;Je("HeatmapBucket",Bm,{omit:["layers"]});var Vm={get paint(){return kt=kt||new ei({"heatmap-radius":new ft(we.paint_heatmap["heatmap-radius"]),"heatmap-weight":new ft(we.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new lt(we.paint_heatmap["heatmap-intensity"]),"heatmap-color":new $o(we.paint_heatmap["heatmap-color"]),"heatmap-opacity":new lt(we.paint_heatmap["heatmap-opacity"])})}};function Um(a,{width:s,height:l},d,f){if(f){if(f instanceof Uint8ClampedArray)f=new Uint8Array(f.buffer);else if(f.length!==s*l*d)throw new RangeError(`mismatched image size. expected: ${f.length} but got: ${s*l*d}`)}else f=new Uint8Array(s*l*d);return a.width=s,a.height=l,a.data=f,a}function jm(a,{width:s,height:l},d){if(s===a.width&&l===a.height)return;const f=Um({},{width:s,height:l},d);Bp(a,f,{x:0,y:0},{x:0,y:0},{width:Math.min(a.width,s),height:Math.min(a.height,l)},d),a.width=s,a.height=l,a.data=f.data}function Bp(a,s,l,d,f,v){if(0===f.width||0===f.height)return s;if(f.width>a.width||f.height>a.height||l.x>a.width-f.width||l.y>a.height-f.height)throw new RangeError("out of range source coordinates for image copy");if(f.width>s.width||f.height>s.height||d.x>s.width-f.width||d.y>s.height-f.height)throw new RangeError("out of range destination coordinates for image copy");const x=a.data,C=s.data;if(x===C)throw new Error("srcData equals dstData, so image is already copied");for(let S=0;S<f.height;S++){const T=((l.y+S)*a.width+l.x)*v,O=((d.y+S)*s.width+d.x)*v;for(let L=0;L<f.width*v;L++)C[O+L]=x[T+L]}return s}class ed{constructor(s,l){Um(this,s,1,l)}resize(s){jm(this,s,1)}clone(){return new ed({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(s,l,d,f,v){Bp(s,l,d,f,v,1)}}class us{constructor(s,l){Um(this,s,4,l)}resize(s){jm(this,s,4)}replace(s,l){l?this.data.set(s):this.data=s instanceof Uint8ClampedArray?new Uint8Array(s.buffer):s}clone(){return new us({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(s,l,d,f,v){Bp(s,l,d,f,v,4)}}function Jl(a){const s={},l=a.resolution||256,d=a.clips?a.clips.length:1,f=a.image||new us({width:l,height:d});if(Math.log(l)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${l}`);const v=(x,C,S)=>{s[a.evaluationKey]=S;const T=a.expression.evaluate(s);f.data[x+C+0]=Math.floor(255*T.r/T.a),f.data[x+C+1]=Math.floor(255*T.g/T.a),f.data[x+C+2]=Math.floor(255*T.b/T.a),f.data[x+C+3]=Math.floor(255*T.a)};if(a.clips)for(let x=0,C=0;x<d;++x,C+=4*l)for(let S=0,T=0;S<l;S++,T+=4){const O=S/(l-1),{start:L,end:B}=a.clips[x];v(C,T,L*(1-O)+B*O)}else for(let x=0,C=0;x<l;x++,C+=4)v(0,C,x/(l-1));return f}Je("AlphaImage",ed),Je("RGBAImage",us);class My extends ws{createBucket(s){return new Bm(s)}constructor(s){super(s,Vm),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(s){"heatmap-color"===s&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Jl({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}}let $m;var Ty={get paint(){return $m=$m||new ei({"hillshade-illumination-direction":new lt(we.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new lt(we.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new lt(we.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new lt(we.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new lt(we.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new lt(we.paint_hillshade["hillshade-accent-color"])})}};class Ay extends ws{constructor(s){super(s,Ty)}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}}const ky=Un([{name:"a_pos",components:2,type:"Int16"}],4),{members:Re}=ky;var nn={exports:{}};function Wo(a,s,l){l=l||2;var d,f,v,x,C,S,T,O=s&&s.length,L=O?s[0]*l:a.length,B=vl(a,0,L,l,!0),j=[];if(!B||B.next===B.prev)return j;if(O&&(B=function(K,Q,ne,de){var oe,pe,_e,Me=[];for(oe=0,pe=Q.length;oe<pe;oe++)(_e=vl(K,Q[oe]*de,oe<pe-1?Q[oe+1]*de:K.length,de,!1))===_e.next&&(_e.steiner=!0),Me.push(Ia(_e));for(Me.sort(Py),oe=0;oe<Me.length;oe++)ne=Nx(Me[oe],ne);return ne}(a,s,B,l)),a.length>80*l){d=v=a[0],f=x=a[1];for(var $=l;$<L;$+=l)(C=a[$])<d&&(d=C),(S=a[$+1])<f&&(f=S),C>v&&(v=C),S>x&&(x=S);T=0!==(T=Math.max(v-d,x-f))?32767/T:0}return Gc(B,j,l,d,f,T,0),j}function vl(a,s,l,d,f){var v,x;if(f===th(a,s,l,d)>0)for(v=s;v<l;v+=d)x=$p(v,a[v],a[v+1],x);else for(v=l-d;v>=s;v-=d)x=$p(v,a[v],a[v+1],x);return x&&Yd(x,x.next)&&(tc(x),x=x.next),x}function gi(a,s){if(!a)return a;s||(s=a);var l,d=a;do{if(l=!1,d.steiner||!Yd(d,d.next)&&0!==wn(d.prev,d,d.next))d=d.next;else{if(tc(d),(d=s=d.prev)===d.next)break;l=!0}}while(l||d!==s);return s}function Gc(a,s,l,d,f,v,x){if(a){!x&&v&&function(O,L,B,j){var $=O;do{0===$.z&&($.z=Cr($.x,$.y,L,B,j)),$.prevZ=$.prev,$.nextZ=$.next,$=$.next}while($!==O);$.prevZ.nextZ=null,$.prevZ=null,function(K){var Q,ne,de,oe,pe,_e,Me,Ze,it=1;do{for(ne=K,K=null,pe=null,_e=0;ne;){for(_e++,de=ne,Me=0,Q=0;Q<it&&(Me++,de=de.nextZ);Q++);for(Ze=it;Me>0||Ze>0&&de;)0!==Me&&(0===Ze||!de||ne.z<=de.z)?(oe=ne,ne=ne.nextZ,Me--):(oe=de,de=de.nextZ,Ze--),pe?pe.nextZ=oe:K=oe,oe.prevZ=pe,pe=oe;ne=de}pe.nextZ=null,it*=2}while(_e>1)}($)}(a,d,f,v);for(var C,S,T=a;a.prev!==a.next;)if(C=a.prev,S=a.next,v?Xo(a,d,f,v):td(a))s.push(C.i/l|0),s.push(a.i/l|0),s.push(S.i/l|0),tc(a),a=S.next,T=S.next;else if((a=S)===T){x?1===x?Gc(a=Vp(gi(a),s,l),s,l,d,f,v,2):2===x&&Up(a,s,l,d,f,v):Gc(gi(a),s,l,d,f,v,1);break}}}function td(a){var s=a.prev,l=a,d=a.next;if(wn(s,l,d)>=0)return!1;for(var f=s.x,v=l.x,x=d.x,C=s.y,S=l.y,T=d.y,O=f<v?f<x?f:x:v<x?v:x,L=C<S?C<T?C:T:S<T?S:T,B=f>v?f>x?f:x:v>x?v:x,j=C>S?C>T?C:T:S>T?S:T,$=d.next;$!==s;){if($.x>=O&&$.x<=B&&$.y>=L&&$.y<=j&&Ql(f,C,v,S,x,T,$.x,$.y)&&wn($.prev,$,$.next)>=0)return!1;$=$.next}return!0}function Xo(a,s,l,d){var f=a.prev,v=a,x=a.next;if(wn(f,v,x)>=0)return!1;for(var C=f.x,S=v.x,T=x.x,O=f.y,L=v.y,B=x.y,j=C<S?C<T?C:T:S<T?S:T,$=O<L?O<B?O:B:L<B?L:B,K=C>S?C>T?C:T:S>T?S:T,Q=O>L?O>B?O:B:L>B?L:B,ne=Cr(j,$,s,l,d),de=Cr(K,Q,s,l,d),oe=a.prevZ,pe=a.nextZ;oe&&oe.z>=ne&&pe&&pe.z<=de;){if(oe.x>=j&&oe.x<=K&&oe.y>=$&&oe.y<=Q&&oe!==f&&oe!==x&&Ql(C,O,S,L,T,B,oe.x,oe.y)&&wn(oe.prev,oe,oe.next)>=0||(oe=oe.prevZ,pe.x>=j&&pe.x<=K&&pe.y>=$&&pe.y<=Q&&pe!==f&&pe!==x&&Ql(C,O,S,L,T,B,pe.x,pe.y)&&wn(pe.prev,pe,pe.next)>=0))return!1;pe=pe.nextZ}for(;oe&&oe.z>=ne;){if(oe.x>=j&&oe.x<=K&&oe.y>=$&&oe.y<=Q&&oe!==f&&oe!==x&&Ql(C,O,S,L,T,B,oe.x,oe.y)&&wn(oe.prev,oe,oe.next)>=0)return!1;oe=oe.prevZ}for(;pe&&pe.z<=de;){if(pe.x>=j&&pe.x<=K&&pe.y>=$&&pe.y<=Q&&pe!==f&&pe!==x&&Ql(C,O,S,L,T,B,pe.x,pe.y)&&wn(pe.prev,pe,pe.next)>=0)return!1;pe=pe.nextZ}return!0}function Vp(a,s,l){var d=a;do{var f=d.prev,v=d.next.next;!Yd(f,v)&&jp(f,d,d.next,v)&&ec(f,v)&&ec(v,f)&&(s.push(f.i/l|0),s.push(d.i/l|0),s.push(v.i/l|0),tc(d),tc(d.next),d=a=v),d=d.next}while(d!==a);return gi(d)}function Up(a,s,l,d,f,v){var x=a;do{for(var C=x.next.next;C!==x.prev;){if(x.i!==C.i&&qc(x,C)){var S=eh(x,C);return x=gi(x,x.next),S=gi(S,S.next),Gc(x,s,l,d,f,v,0),void Gc(S,s,l,d,f,v,0)}C=C.next}x=x.next}while(x!==a)}function Py(a,s){return a.x-s.x}function Nx(a,s){var l=function(f,v){var x,C=v,S=f.x,T=f.y,O=-1/0;do{if(T<=C.y&&T>=C.next.y&&C.next.y!==C.y){var L=C.x+(T-C.y)*(C.next.x-C.x)/(C.next.y-C.y);if(L<=S&&L>O&&(O=L,x=C.x<C.next.x?C:C.next,L===S))return x}C=C.next}while(C!==v);if(!x)return null;var B,j=x,$=x.x,K=x.y,Q=1/0;C=x;do{S>=C.x&&C.x>=$&&S!==C.x&&Ql(T<K?S:O,T,$,K,T<K?O:S,T,C.x,C.y)&&(B=Math.abs(T-C.y)/(S-C.x),ec(C,f)&&(B<Q||B===Q&&(C.x>x.x||C.x===x.x&&Hm(x,C)))&&(x=C,Q=B)),C=C.next}while(C!==j);return x}(a,s);if(!l)return s;var d=eh(l,a);return gi(d,d.next),gi(l,l.next)}function Hm(a,s){return wn(a.prev,a,s.prev)<0&&wn(s.next,a,a.next)<0}function Cr(a,s,l,d,f){return(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=(a-l)*f|0)|a<<8))|a<<4))|a<<2))|a<<1))|(s=1431655765&((s=858993459&((s=252645135&((s=16711935&((s=(s-d)*f|0)|s<<8))|s<<4))|s<<2))|s<<1))<<1}function Ia(a){var s=a,l=a;do{(s.x<l.x||s.x===l.x&&s.y<l.y)&&(l=s),s=s.next}while(s!==a);return l}function Ql(a,s,l,d,f,v,x,C){return(f-x)*(s-C)>=(a-x)*(v-C)&&(a-x)*(d-C)>=(l-x)*(s-C)&&(l-x)*(v-C)>=(f-x)*(d-C)}function qc(a,s){return a.next.i!==s.i&&a.prev.i!==s.i&&!function(l,d){var f=l;do{if(f.i!==l.i&&f.next.i!==l.i&&f.i!==d.i&&f.next.i!==d.i&&jp(f,f.next,l,d))return!0;f=f.next}while(f!==l);return!1}(a,s)&&(ec(a,s)&&ec(s,a)&&function(l,d){var f=l,v=!1,x=(l.x+d.x)/2,C=(l.y+d.y)/2;do{f.y>C!=f.next.y>C&&f.next.y!==f.y&&x<(f.next.x-f.x)*(C-f.y)/(f.next.y-f.y)+f.x&&(v=!v),f=f.next}while(f!==l);return v}(a,s)&&(wn(a.prev,a,s.prev)||wn(a,s.prev,s))||Yd(a,s)&&wn(a.prev,a,a.next)>0&&wn(s.prev,s,s.next)>0)}function wn(a,s,l){return(s.y-a.y)*(l.x-s.x)-(s.x-a.x)*(l.y-s.y)}function Yd(a,s){return a.x===s.x&&a.y===s.y}function jp(a,s,l,d){var f=Qd(wn(a,s,l)),v=Qd(wn(a,s,d)),x=Qd(wn(l,d,a)),C=Qd(wn(l,d,s));return f!==v&&x!==C||!(0!==f||!Jd(a,l,s))||!(0!==v||!Jd(a,d,s))||!(0!==x||!Jd(l,a,d))||!(0!==C||!Jd(l,s,d))}function Jd(a,s,l){return s.x<=Math.max(a.x,l.x)&&s.x>=Math.min(a.x,l.x)&&s.y<=Math.max(a.y,l.y)&&s.y>=Math.min(a.y,l.y)}function Qd(a){return a>0?1:a<0?-1:0}function ec(a,s){return wn(a.prev,a,a.next)<0?wn(a,s,a.next)>=0&&wn(a,a.prev,s)>=0:wn(a,s,a.prev)<0||wn(a,a.next,s)<0}function eh(a,s){var l=new Hp(a.i,a.x,a.y),d=new Hp(s.i,s.x,s.y),f=a.next,v=s.prev;return a.next=s,s.prev=a,l.next=f,f.prev=l,d.next=l,l.prev=d,v.next=d,d.prev=v,d}function $p(a,s,l,d){var f=new Hp(a,s,l);return d?(f.next=d.next,f.prev=d,d.next.prev=f,d.next=f):(f.prev=f,f.next=f),f}function tc(a){a.next.prev=a.prev,a.prev.next=a.next,a.prevZ&&(a.prevZ.nextZ=a.nextZ),a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function Hp(a,s,l){this.i=a,this.x=s,this.y=l,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function th(a,s,l,d){for(var f=0,v=s,x=l-d;v<l;v+=d)f+=(a[x]-a[v])*(a[v+1]+a[x+1]),x=v;return f}nn.exports=Wo,nn.exports.default=Wo,Wo.deviation=function(a,s,l,d){var f=s&&s.length,v=Math.abs(th(a,0,f?s[0]*l:a.length,l));if(f)for(var x=0,C=s.length;x<C;x++)v-=Math.abs(th(a,s[x]*l,x<C-1?s[x+1]*l:a.length,l));var S=0;for(x=0;x<d.length;x+=3){var T=d[x]*l,O=d[x+1]*l,L=d[x+2]*l;S+=Math.abs((a[T]-a[L])*(a[O+1]-a[T+1])-(a[T]-a[O])*(a[L+1]-a[T+1]))}return 0===v&&0===S?0:Math.abs((S-v)/v)},Wo.flatten=function(a){for(var s=a[0][0].length,l={vertices:[],holes:[],dimensions:s},d=0,f=0;f<a.length;f++){for(var v=0;v<a[f].length;v++)for(var x=0;x<s;x++)l.vertices.push(a[f][v][x]);f>0&&l.holes.push(d+=a[f-1].length)}return l};var nh=mn(nn.exports);function Gm(a,s,l,d,f){Gp(a,s,l||0,d||a.length-1,f||qm)}function Gp(a,s,l,d,f){for(;d>l;){if(d-l>600){var v=d-l+1,x=s-l+1,C=Math.log(v),S=.5*Math.exp(2*C/3),T=.5*Math.sqrt(C*S*(v-S)/v)*(x-v/2<0?-1:1);Gp(a,s,Math.max(l,Math.floor(s-x*S/v+T)),Math.min(d,Math.floor(s+(v-x)*S/v+T)),f)}var O=a[s],L=l,B=d;for(Zc(a,l,s),f(a[d],O)>0&&Zc(a,l,d);L<B;){for(Zc(a,L,B),L++,B--;f(a[L],O)<0;)L++;for(;f(a[B],O)>0;)B--}0===f(a[l],O)?Zc(a,l,B):Zc(a,++B,d),B<=s&&(l=B+1),s<=B&&(d=B-1)}}function Zc(a,s,l){var d=a[s];a[s]=a[l],a[l]=d}function qm(a,s){return a<s?-1:a>s?1:0}function nd(a,s){const l=a.length;if(l<=1)return[a];const d=[];let f,v;for(let x=0;x<l;x++){const C=oo(a[x]);0!==C&&(a[x].area=Math.abs(C),void 0===v&&(v=C<0),v===C<0?(f&&d.push(f),f=[a[x]]):f.push(a[x]))}if(f&&d.push(f),s>1)for(let x=0;x<d.length;x++)d[x].length<=s||(Gm(d[x],s,1,d[x].length-1,Ry),d[x]=d[x].slice(0,s));return d}function Ry(a,s){return s.area-a.area}function qp(a,s,l){const d=l.patternDependencies;let f=!1;for(const v of s){const x=v.paint.get(`${a}-pattern`);x.isConstant()||(f=!0);const C=x.constantOr(null);C&&(f=!0,d[C.to]=!0,d[C.from]=!0)}return f}function Er(a,s,l,d,f){const v=f.patternDependencies;for(const x of s){const C=x.paint.get(`${a}-pattern`).value;if("constant"!==C.kind){let S=C.evaluate({zoom:d-1},l,{},f.availableImages),T=C.evaluate({zoom:d},l,{},f.availableImages),O=C.evaluate({zoom:d+1},l,{},f.availableImages);S=S&&S.name?S.name:S,T=T&&T.name?T.name:T,O=O&&O.name?O.name:O,v[S]=!0,v[T]=!0,v[O]=!0,l.patterns[x.id]={min:S,mid:T,max:O}}}return l}class Sa{constructor(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(l=>l.id),this.index=s.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new ce,this.indexArray=new dt,this.indexArray2=new rt,this.programConfigurations=new wa(s.layers,s.zoom),this.segments=new ht,this.segments2=new ht,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id)}populate(s,l,d){this.hasPattern=qp("fill",this.layers,l);const f=this.layers[0].layout.get("fill-sort-key"),v=!f.isConstant(),x=[];for(const{feature:C,id:S,index:T,sourceLayerIndex:O}of s){const L=this.layers[0]._featureFilter.needGeometry,B=Bn(C,L);if(!this.layers[0]._featureFilter.filter(new Kt(this.zoom),B,d))continue;const j=v?f.evaluate(B,{},d,l.availableImages):void 0,$={id:S,properties:C.properties,type:C.type,sourceLayerIndex:O,index:T,geometry:L?B.geometry:yo(C),patterns:{},sortKey:j};x.push($)}v&&x.sort((C,S)=>C.sortKey-S.sortKey);for(const C of x){const{geometry:S,index:T,sourceLayerIndex:O}=C;if(this.hasPattern){const L=Er("fill",this.layers,C,this.zoom,l);this.patternFeatures.push(L)}else this.addFeature(C,S,T,d,{});l.featureIndex.insert(s[T].feature,S,T,O,this.index)}}update(s,l,d){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,l,this.stateDependentLayers,d)}addFeatures(s,l,d){for(const f of this.patternFeatures)this.addFeature(f,f.geometry,f.index,l,d)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,Re),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.indexBuffer2=s.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(s,l,d,f,v){for(const x of nd(l,500)){let C=0;for(const j of x)C+=j.length;const S=this.segments.prepareSegment(C,this.layoutVertexArray,this.indexArray),T=S.vertexLength,O=[],L=[];for(const j of x){if(0===j.length)continue;j!==x[0]&&L.push(O.length/2);const $=this.segments2.prepareSegment(j.length,this.layoutVertexArray,this.indexArray2),K=$.vertexLength;this.layoutVertexArray.emplaceBack(j[0].x,j[0].y),this.indexArray2.emplaceBack(K+j.length-1,K),O.push(j[0].x),O.push(j[0].y);for(let Q=1;Q<j.length;Q++)this.layoutVertexArray.emplaceBack(j[Q].x,j[Q].y),this.indexArray2.emplaceBack(K+Q-1,K+Q),O.push(j[Q].x),O.push(j[Q].y);$.vertexLength+=j.length,$.primitiveLength+=j.length}const B=nh(O,L);for(let j=0;j<B.length;j+=3)this.indexArray.emplaceBack(T+B[j],T+B[j+1],T+B[j+2]);S.vertexLength+=C,S.primitiveLength+=B.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,d,v,f)}}let si,Zm;Je("FillBucket",Sa,{omit:["layers","patternFeatures"]});var Oy={get paint(){return Zm=Zm||new ei({"fill-antialias":new lt(we.paint_fill["fill-antialias"]),"fill-opacity":new ft(we.paint_fill["fill-opacity"]),"fill-color":new ft(we.paint_fill["fill-color"]),"fill-outline-color":new ft(we.paint_fill["fill-outline-color"]),"fill-translate":new lt(we.paint_fill["fill-translate"]),"fill-translate-anchor":new lt(we.paint_fill["fill-translate-anchor"]),"fill-pattern":new Zn(we.paint_fill["fill-pattern"])})},get layout(){return si=si||new ei({"fill-sort-key":new ft(we.layout_fill["fill-sort-key"])})}};class Fy extends ws{constructor(s){super(s,Oy)}recalculate(s,l){super.recalculate(s,l);const d=this.paint._values["fill-outline-color"];"constant"===d.value.kind&&void 0===d.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(s){return new Sa(s)}queryRadius(){return wr(this.paint.get("fill-translate"))}queryIntersectsFeature(s,l,d,f,v,x,C){return Pp(Kd(s,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),x.angle,C),f)}isTileClipped(){return!0}}const Ly=Un([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),Wm=Un([{name:"a_centroid",components:2,type:"Int16"}],4),{members:Xm}=Ly;var vo={},bl=be,Km=Ma;function Ma(a,s,l,d,f){this.properties={},this.extent=l,this.type=0,this._pbf=a,this._geometry=-1,this._keys=d,this._values=f,a.readFields(ih,this,s)}function ih(a,s,l){1==a?s.id=l.readVarint():2==a?function(d,f){for(var v=d.readVarint()+d.pos;d.pos<v;){var x=f._keys[d.readVarint()],C=f._values[d.readVarint()];f.properties[x]=C}}(l,s):3==a?s.type=l.readVarint():4==a&&(s._geometry=l.pos)}function rh(a){for(var s,l,d=0,f=0,v=a.length,x=v-1;f<v;x=f++)d+=((l=a[x]).x-(s=a[f]).x)*(s.y+l.y);return d}Ma.types=["Unknown","Point","LineString","Polygon"],Ma.prototype.loadGeometry=function(){var a=this._pbf;a.pos=this._geometry;for(var s,l=a.readVarint()+a.pos,d=1,f=0,v=0,x=0,C=[];a.pos<l;){if(f<=0){var S=a.readVarint();d=7&S,f=S>>3}if(f--,1===d||2===d)v+=a.readSVarint(),x+=a.readSVarint(),1===d&&(s&&C.push(s),s=[]),s.push(new bl(v,x));else{if(7!==d)throw new Error("unknown command "+d);s&&s.push(s[0].clone())}}return s&&C.push(s),C},Ma.prototype.bbox=function(){var a=this._pbf;a.pos=this._geometry;for(var s=a.readVarint()+a.pos,l=1,d=0,f=0,v=0,x=1/0,C=-1/0,S=1/0,T=-1/0;a.pos<s;){if(d<=0){var O=a.readVarint();l=7&O,d=O>>3}if(d--,1===l||2===l)(f+=a.readSVarint())<x&&(x=f),f>C&&(C=f),(v+=a.readSVarint())<S&&(S=v),v>T&&(T=v);else if(7!==l)throw new Error("unknown command "+l)}return[x,S,C,T]},Ma.prototype.toGeoJSON=function(a,s,l){var d,f,v=this.extent*Math.pow(2,l),x=this.extent*a,C=this.extent*s,S=this.loadGeometry(),T=Ma.types[this.type];function O(j){for(var $=0;$<j.length;$++){var K=j[$];j[$]=[360*(K.x+x)/v-180,360/Math.PI*Math.atan(Math.exp((180-360*(K.y+C)/v)*Math.PI/180))-90]}}switch(this.type){case 1:var L=[];for(d=0;d<S.length;d++)L[d]=S[d][0];O(S=L);break;case 2:for(d=0;d<S.length;d++)O(S[d]);break;case 3:for(S=function(j){var $=j.length;if($<=1)return[j];for(var K,Q,ne=[],de=0;de<$;de++){var oe=rh(j[de]);0!==oe&&(void 0===Q&&(Q=oe<0),Q===oe<0?(K&&ne.push(K),K=[j[de]]):K.push(j[de]))}return K&&ne.push(K),ne}(S),d=0;d<S.length;d++)for(f=0;f<S[d].length;f++)O(S[d][f])}1===S.length?S=S[0]:T="Multi"+T;var B={type:"Feature",geometry:{type:T,coordinates:S},properties:this.properties};return"id"in this&&(B.id=this.id),B};var Zp=Km,Wp=Xp;function Xp(a,s){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=a,this._keys=[],this._values=[],this._features=[],a.readFields(Ny,this,s),this.length=this._features.length}function Ny(a,s,l){15===a?s.version=l.readVarint():1===a?s.name=l.readString():5===a?s.extent=l.readVarint():2===a?s._features.push(l.pos):3===a?s._keys.push(l.readString()):4===a&&s._values.push(function(d){for(var f=null,v=d.readVarint()+d.pos;d.pos<v;){var x=d.readVarint()>>3;f=1===x?d.readString():2===x?d.readFloat():3===x?d.readDouble():4===x?d.readVarint64():5===x?d.readVarint():6===x?d.readSVarint():7===x?d.readBoolean():null}return f}(l))}Xp.prototype.feature=function(a){if(a<0||a>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[a];var s=this._pbf.readVarint()+this._pbf.pos;return new Zp(this._pbf,s,this.extent,this._keys,this._values)};var Wc=Wp;function id(a,s,l){if(3===a){var d=new Wc(l,l.readVarint()+l.pos);d.length&&(s[d.name]=d)}}vo.VectorTile=function(a,s){this.layers=a.readFields(id,{},s)},vo.VectorTileFeature=Km,vo.VectorTileLayer=Wp;const zy=vo.VectorTileFeature.types,Ym=Math.pow(2,13);function nc(a,s,l,d,f,v,x,C){a.emplaceBack(s,l,2*Math.floor(d*Ym)+x,f*Ym*2,v*Ym*2,Math.round(C))}class Jm{constructor(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(l=>l.id),this.index=s.index,this.hasPattern=!1,this.layoutVertexArray=new ye,this.centroidVertexArray=new me,this.indexArray=new dt,this.programConfigurations=new wa(s.layers,s.zoom),this.segments=new ht,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id)}populate(s,l,d){this.features=[],this.hasPattern=qp("fill-extrusion",this.layers,l);for(const{feature:f,id:v,index:x,sourceLayerIndex:C}of s){const S=this.layers[0]._featureFilter.needGeometry,T=Bn(f,S);if(!this.layers[0]._featureFilter.filter(new Kt(this.zoom),T,d))continue;const O={id:v,sourceLayerIndex:C,index:x,geometry:S?T.geometry:yo(f),properties:f.properties,type:f.type,patterns:{}};this.hasPattern?this.features.push(Er("fill-extrusion",this.layers,O,this.zoom,l)):this.addFeature(O,O.geometry,x,d,{}),l.featureIndex.insert(f,O.geometry,x,C,this.index,!0)}}addFeatures(s,l,d){for(const f of this.features){const{geometry:v}=f;this.addFeature(f,v,f.index,l,d)}}update(s,l,d){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,l,this.stateDependentLayers,d)}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.centroidVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,Xm),this.centroidVertexBuffer=s.createVertexBuffer(this.centroidVertexArray,Wm.members,!0),this.indexBuffer=s.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(s,l,d,f,v){const x={x:0,y:0,vertexCount:0};for(const C of nd(l,500)){let S=0;for(const $ of C)S+=$.length;let T=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const $ of C){if(0===$.length||((a=$).every(s=>s.x<0)||a.every(s=>s.x>Xn)||a.every(s=>s.y<0)||a.every(s=>s.y>Xn)))continue;let K=0;for(let Q=0;Q<$.length;Q++){const ne=$[Q];if(Q>=1){const de=$[Q-1];if(!By(ne,de)){T.vertexLength+4>ht.MAX_VERTEX_ARRAY_LENGTH&&(T=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const oe=ne.sub(de)._perp()._unit(),pe=de.dist(ne);K+pe>32768&&(K=0),nc(this.layoutVertexArray,ne.x,ne.y,oe.x,oe.y,0,0,K),nc(this.layoutVertexArray,ne.x,ne.y,oe.x,oe.y,0,1,K),x.x+=2*ne.x,x.y+=2*ne.y,x.vertexCount+=2,K+=pe,nc(this.layoutVertexArray,de.x,de.y,oe.x,oe.y,0,0,K),nc(this.layoutVertexArray,de.x,de.y,oe.x,oe.y,0,1,K),x.x+=2*de.x,x.y+=2*de.y,x.vertexCount+=2;const _e=T.vertexLength;this.indexArray.emplaceBack(_e,_e+2,_e+1),this.indexArray.emplaceBack(_e+1,_e+2,_e+3),T.vertexLength+=4,T.primitiveLength+=2}}}}if(T.vertexLength+S>ht.MAX_VERTEX_ARRAY_LENGTH&&(T=this.segments.prepareSegment(S,this.layoutVertexArray,this.indexArray)),"Polygon"!==zy[s.type])continue;const O=[],L=[],B=T.vertexLength;for(const $ of C)if(0!==$.length){$!==C[0]&&L.push(O.length/2);for(let K=0;K<$.length;K++){const Q=$[K];nc(this.layoutVertexArray,Q.x,Q.y,0,0,1,1,0),x.x+=Q.x,x.y+=Q.y,x.vertexCount+=1,O.push(Q.x),O.push(Q.y)}}const j=nh(O,L);for(let $=0;$<j.length;$+=3)this.indexArray.emplaceBack(B+j[$],B+j[$+2],B+j[$+1]);T.primitiveLength+=j.length/3,T.vertexLength+=S}var a;for(let C=0;C<x.vertexCount;C++)this.centroidVertexArray.emplaceBack(Math.floor(x.x/x.vertexCount),Math.floor(x.y/x.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,d,v,f)}}function By(a,s){return a.x===s.x&&(a.x<0||a.x>Xn)||a.y===s.y&&(a.y<0||a.y>Xn)}let Uy;Je("FillExtrusionBucket",Jm,{omit:["layers","features"]});var zx={get paint(){return Uy=Uy||new ei({"fill-extrusion-opacity":new lt(we["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new ft(we["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new lt(we["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new lt(we["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Zn(we["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new ft(we["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new ft(we["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new lt(we["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class Kp extends ws{constructor(s){super(s,zx)}createBucket(s){return new Jm(s)}queryRadius(){return wr(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(s,l,d,f,v,x,C,S){const T=Kd(s,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),x.angle,C),O=this.paint.get("fill-extrusion-height").evaluate(l,d),L=this.paint.get("fill-extrusion-base").evaluate(l,d),B=function($,K,Q,ne){const de=[];for(const oe of $){const pe=[oe.x,oe.y,0,1];Qu(pe,pe,K),de.push(new yt(pe[0]/pe[3],pe[1]/pe[3]))}return de}(T,S),j=function($,K,Q,ne){const de=[],oe=[],pe=ne[8]*K,_e=ne[9]*K,Me=ne[10]*K,Ze=ne[11]*K,it=ne[8]*Q,qe=ne[9]*Q,je=ne[10]*Q,Ne=ne[11]*Q;for(const et of $){const ze=[],Oe=[];for(const ut of et){const st=ut.x,Nt=ut.y,Mn=ne[0]*st+ne[4]*Nt+ne[12],Tn=ne[1]*st+ne[5]*Nt+ne[13],Ei=ne[2]*st+ne[6]*Nt+ne[14],Nr=ne[3]*st+ne[7]*Nt+ne[15],ji=Ei+Me,Di=Nr+Ze,Ri=Mn+it,ur=Tn+qe,Xr=Ei+je,zr=Nr+Ne,_i=new yt((Mn+pe)/Di,(Tn+_e)/Di);_i.z=ji/Di,ze.push(_i);const Ii=new yt(Ri/zr,ur/zr);Ii.z=Xr/zr,Oe.push(Ii)}de.push(ze),oe.push(Oe)}return[de,oe]}(f,L,O,S);return function($,K,Q){let ne=1/0;Pp(Q,K)&&(ne=Qm(Q,K[0]));for(let de=0;de<K.length;de++){const oe=K[de],pe=$[de];for(let _e=0;_e<oe.length-1;_e++){const Me=oe[_e],Ze=[Me,oe[_e+1],pe[_e+1],pe[_e],Me];Lm(Q,Ze)&&(ne=Math.min(ne,Qm(Q,Ze)))}}return ne!==1/0&&ne}(j[0],j[1],B)}}function Ta(a,s){return a.x*s.x+a.y*s.y}function Qm(a,s){if(1===a.length){let l=0;const d=s[l++];let f;for(;!f||d.equals(f);)if(f=s[l++],!f)return 1/0;for(;l<s.length;l++){const v=s[l],x=a[0],C=f.sub(d),S=v.sub(d),T=x.sub(d),O=Ta(C,C),L=Ta(C,S),B=Ta(S,S),j=Ta(T,C),$=Ta(T,S),K=O*B-L*L,Q=(B*j-L*$)/K,ne=(O*$-L*j)/K,de=d.z*(1-Q-ne)+f.z*Q+v.z*ne;if(isFinite(de))return de}return 1/0}{let l=1/0;for(const d of s)l=Math.min(l,d.z);return l}}const rd=Un([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Yp}=rd,sh=Un([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Bx}=sh,eg=vo.VectorTileFeature.types,tg=Math.cos(Math.PI/180*37.5),ng=Math.pow(2,14)/.5;class Ys{constructor(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(l=>l.id),this.index=s.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(l=>{this.gradients[l.id]={}}),this.layoutVertexArray=new ve,this.layoutVertexArray2=new Se,this.indexArray=new dt,this.programConfigurations=new wa(s.layers,s.zoom),this.segments=new ht,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id)}populate(s,l,d){this.hasPattern=qp("line",this.layers,l);const f=this.layers[0].layout.get("line-sort-key"),v=!f.isConstant(),x=[];for(const{feature:C,id:S,index:T,sourceLayerIndex:O}of s){const L=this.layers[0]._featureFilter.needGeometry,B=Bn(C,L);if(!this.layers[0]._featureFilter.filter(new Kt(this.zoom),B,d))continue;const j=v?f.evaluate(B,{},d):void 0,$={id:S,properties:C.properties,type:C.type,sourceLayerIndex:O,index:T,geometry:L?B.geometry:yo(C),patterns:{},sortKey:j};x.push($)}v&&x.sort((C,S)=>C.sortKey-S.sortKey);for(const C of x){const{geometry:S,index:T,sourceLayerIndex:O}=C;if(this.hasPattern){const L=Er("line",this.layers,C,this.zoom,l);this.patternFeatures.push(L)}else this.addFeature(C,S,T,d,{});l.featureIndex.insert(s[T].feature,S,T,O,this.index)}}update(s,l,d){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,l,this.stateDependentLayers,d)}addFeatures(s,l,d){for(const f of this.patternFeatures)this.addFeature(f,f.geometry,f.index,l,d)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=s.createVertexBuffer(this.layoutVertexArray2,Bx)),this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,Yp),this.indexBuffer=s.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(s){if(s.properties&&Object.prototype.hasOwnProperty.call(s.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(s.properties,"mapbox_clip_end"))return{start:+s.properties.mapbox_clip_start,end:+s.properties.mapbox_clip_end}}addFeature(s,l,d,f,v){const x=this.layers[0].layout,C=x.get("line-join").evaluate(s,{}),S=x.get("line-cap"),T=x.get("line-miter-limit"),O=x.get("line-round-limit");this.lineClips=this.lineFeatureClips(s);for(const L of l)this.addLine(L,s,C,S,T,O);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,d,v,f)}addLine(s,l,d,f,v,x){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ne=0;ne<s.length-1;ne++)this.totalDistance+=s[ne].dist(s[ne+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const C="Polygon"===eg[l.type];let S=s.length;for(;S>=2&&s[S-1].equals(s[S-2]);)S--;let T=0;for(;T<S-1&&s[T].equals(s[T+1]);)T++;if(S<(C?3:2))return;"bevel"===d&&(v=1.05);const O=this.overscaling<=16?15*Xn/(512*this.overscaling):0,L=this.segments.prepareSegment(10*S,this.layoutVertexArray,this.indexArray);let B,j,$,K,Q;this.e1=this.e2=-1,C&&(B=s[S-2],Q=s[T].sub(B)._unit()._perp());for(let ne=T;ne<S;ne++){if($=ne===S-1?C?s[T+1]:void 0:s[ne+1],$&&s[ne].equals($))continue;Q&&(K=Q),B&&(j=B),B=s[ne],Q=$?$.sub(B)._unit()._perp():K,K=K||Q;let de=K.add(Q);0===de.x&&0===de.y||de._unit();const oe=K.x*Q.x+K.y*Q.y,pe=de.x*Q.x+de.y*Q.y,_e=0!==pe?1/pe:1/0,Me=2*Math.sqrt(2-2*pe),Ze=pe<tg&&j&&$,it=K.x*Q.y-K.y*Q.x>0;if(Ze&&ne>T){const Ne=B.dist(j);if(Ne>2*O){const et=B.sub(B.sub(j)._mult(O/Ne)._round());this.updateDistance(j,et),this.addCurrentVertex(et,K,0,0,L),j=et}}const qe=j&&$;let je=qe?d:C?"butt":f;if(qe&&"round"===je&&(_e<x?je="miter":_e<=2&&(je="fakeround")),"miter"===je&&_e>v&&(je="bevel"),"bevel"===je&&(_e>2&&(je="flipbevel"),_e<v&&(je="miter")),j&&this.updateDistance(j,B),"miter"===je)de._mult(_e),this.addCurrentVertex(B,de,0,0,L);else if("flipbevel"===je){if(_e>100)de=Q.mult(-1);else{const Ne=_e*K.add(Q).mag()/K.sub(Q).mag();de._perp()._mult(Ne*(it?-1:1))}this.addCurrentVertex(B,de,0,0,L),this.addCurrentVertex(B,de.mult(-1),0,0,L)}else if("bevel"===je||"fakeround"===je){const Ne=-Math.sqrt(_e*_e-1),et=it?Ne:0,ze=it?0:Ne;if(j&&this.addCurrentVertex(B,K,et,ze,L),"fakeround"===je){const Oe=Math.round(180*Me/Math.PI/20);for(let ut=1;ut<Oe;ut++){let st=ut/Oe;if(.5!==st){const Mn=st-.5;st+=st*Mn*(st-1)*((1.0904+oe*(oe*(3.55645-1.43519*oe)-3.2452))*Mn*Mn+(.848013+oe*(.215638*oe-1.06021)))}const Nt=Q.sub(K)._mult(st)._add(K)._unit()._mult(it?-1:1);this.addHalfVertex(B,Nt.x,Nt.y,!1,it,0,L)}}$&&this.addCurrentVertex(B,Q,-et,-ze,L)}else if("butt"===je)this.addCurrentVertex(B,de,0,0,L);else if("square"===je){const Ne=j?1:-1;this.addCurrentVertex(B,de,Ne,Ne,L)}else"round"===je&&(j&&(this.addCurrentVertex(B,K,0,0,L),this.addCurrentVertex(B,K,1,1,L,!0)),$&&(this.addCurrentVertex(B,Q,-1,-1,L,!0),this.addCurrentVertex(B,Q,0,0,L)));if(Ze&&ne<S-1){const Ne=B.dist($);if(Ne>2*O){const et=B.add($.sub(B)._mult(O/Ne)._round());this.updateDistance(B,et),this.addCurrentVertex(et,Q,0,0,L),B=et}}}}addCurrentVertex(s,l,d,f,v,x=!1){const C=l.y*f-l.x,S=-l.y-l.x*f;this.addHalfVertex(s,l.x+l.y*d,l.y-l.x*d,x,!1,d,v),this.addHalfVertex(s,C,S,x,!0,-f,v),this.distance>ng/2&&0===this.totalDistance&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(s,l,d,f,v,x))}addHalfVertex({x:s,y:l},d,f,v,x,C,S){const T=.5*(this.lineClips?this.scaledDistance*(ng-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((s<<1)+(v?1:0),(l<<1)+(x?1:0),Math.round(63*d)+128,Math.round(63*f)+128,1+(0===C?0:C<0?-1:1)|(63&T)<<2,T>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const O=S.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,O),S.primitiveLength++),x?this.e2=O:this.e1=O}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(s,l){this.distance+=s.dist(l),this.updateScaledDistance()}}let ig,sd;Je("LineBucket",Ys,{omit:["layers","patternFeatures"]});var oh={get paint(){return sd=sd||new ei({"line-opacity":new ft(we.paint_line["line-opacity"]),"line-color":new ft(we.paint_line["line-color"]),"line-translate":new lt(we.paint_line["line-translate"]),"line-translate-anchor":new lt(we.paint_line["line-translate-anchor"]),"line-width":new ft(we.paint_line["line-width"]),"line-gap-width":new ft(we.paint_line["line-gap-width"]),"line-offset":new ft(we.paint_line["line-offset"]),"line-blur":new ft(we.paint_line["line-blur"]),"line-dasharray":new va(we.paint_line["line-dasharray"]),"line-pattern":new Zn(we.paint_line["line-pattern"]),"line-gradient":new $o(we.paint_line["line-gradient"])})},get layout(){return ig=ig||new ei({"line-cap":new lt(we.layout_line["line-cap"]),"line-join":new ft(we.layout_line["line-join"]),"line-miter-limit":new lt(we.layout_line["line-miter-limit"]),"line-round-limit":new lt(we.layout_line["line-round-limit"]),"line-sort-key":new ft(we.layout_line["line-sort-key"])})}};class rg extends ft{possiblyEvaluate(s,l){return l=new Kt(Math.floor(l.zoom),{now:l.now,fadeDuration:l.fadeDuration,zoomHistory:l.zoomHistory,transition:l.transition}),super.possiblyEvaluate(s,l)}evaluate(s,l,d,f){return l=qi({},l,{zoom:Math.floor(l.zoom)}),super.evaluate(s,l,d,f)}}let ic;class Jp extends ws{constructor(s){super(s,oh),this.gradientVersion=0,ic||(ic=new rg(oh.paint.properties["line-width"].specification),ic.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(s){"line-gradient"===s&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof Ji,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER)}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(s,l){super.recalculate(s,l),this.paint._values["line-floorwidth"]=ic.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,s)}createBucket(s){return new Ys(s)}queryRadius(s){const l=s,d=sg(yl("line-width",this,l),yl("line-gap-width",this,l)),f=yl("line-offset",this,l);return d/2+Math.abs(f)+wr(this.paint.get("line-translate"))}queryIntersectsFeature(s,l,d,f,v,x,C){const S=Kd(s,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),x.angle,C),T=C/2*sg(this.paint.get("line-width").evaluate(l,d),this.paint.get("line-gap-width").evaluate(l,d)),O=this.paint.get("line-offset").evaluate(l,d);return O&&(f=function(L,B){const j=[];for(let $=0;$<L.length;$++){const K=L[$],Q=[];for(let ne=0;ne<K.length;ne++){const de=K[ne-1],oe=K[ne],pe=K[ne+1],_e=0===ne?new yt(0,0):oe.sub(de)._unit()._perp(),Me=ne===K.length-1?new yt(0,0):pe.sub(oe)._unit()._perp(),Ze=_e._add(Me)._unit(),it=Ze.x*Me.x+Ze.y*Me.y;0!==it&&Ze._mult(1/it),Q.push(Ze._mult(B)._add(oe))}j.push(Q)}return j}(f,O*C)),function(L,B,j){for(let $=0;$<B.length;$++){const K=B[$];if(L.length>=3)for(let Q=0;Q<K.length;Q++)if(xn(L,K[Q]))return!0;if(Dy(L,K,j))return!0}return!1}(S,f,T)}isTileClipped(){return!0}}function sg(a,s){return s>0?s+2*a:a}const og=Un([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),ag=Un([{name:"a_projected_pos",components:3,type:"Float32"}],4);Un([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const lg=Un([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);Un([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Qp=Un([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),jy=Un([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function ah(a,s,l){return a.sections.forEach(d=>{d.text=function(f,v,x){const C=v.layout.get("text-transform").evaluate(x,{});return"uppercase"===C?f=f.toLocaleUpperCase():"lowercase"===C&&(f=f.toLocaleLowerCase()),Xt.applyArabicShaping&&(f=Xt.applyArabicShaping(f)),f}(d.text,s,l)}),a}Un([{name:"triangle",components:3,type:"Uint16"}]),Un([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Un([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),Un([{type:"Float32",name:"offsetX"}]),Un([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),Un([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const bo={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42"};var Pi=24,ef=Cn,tf=function(a,s,l,d,f){var v,x,C=8*f-d-1,S=(1<<C)-1,T=S>>1,O=-7,L=l?f-1:0,B=l?-1:1,j=a[s+L];for(L+=B,v=j&(1<<-O)-1,j>>=-O,O+=C;O>0;v=256*v+a[s+L],L+=B,O-=8);for(x=v&(1<<-O)-1,v>>=-O,O+=d;O>0;x=256*x+a[s+L],L+=B,O-=8);if(0===v)v=1-T;else{if(v===S)return x?NaN:1/0*(j?-1:1);x+=Math.pow(2,d),v-=T}return(j?-1:1)*x*Math.pow(2,v-d)},Xc=function(a,s,l,d,f,v){var x,C,S,T=8*v-f-1,O=(1<<T)-1,L=O>>1,B=23===f?Math.pow(2,-24)-Math.pow(2,-77):0,j=d?0:v-1,$=d?1:-1,K=s<0||0===s&&1/s<0?1:0;for(s=Math.abs(s),isNaN(s)||s===1/0?(C=isNaN(s)?1:0,x=O):(x=Math.floor(Math.log(s)/Math.LN2),s*(S=Math.pow(2,-x))<1&&(x--,S*=2),(s+=x+L>=1?B/S:B*Math.pow(2,1-L))*S>=2&&(x++,S/=2),x+L>=O?(C=0,x=O):x+L>=1?(C=(s*S-1)*Math.pow(2,f),x+=L):(C=s*Math.pow(2,L-1)*Math.pow(2,f),x=0));f>=8;a[l+j]=255&C,j+=$,C/=256,f-=8);for(x=x<<f|C,T+=f;T>0;a[l+j]=255&x,j+=$,x/=256,T-=8);a[l+j-$]|=128*K};function Cn(a){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(a)?a:new Uint8Array(a||0),this.pos=0,this.type=0,this.length=this.buf.length}Cn.Varint=0,Cn.Fixed64=1,Cn.Bytes=2,Cn.Fixed32=5;var Dr=4294967296,cg=1/Dr,cr=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function xo(a){return a.type===Cn.Bytes?a.readVarint()+a.pos:a.pos+1}function nf(a,s,l){var d=s<=16383?1:s<=2097151?2:s<=268435455?3:Math.floor(Math.log(s)/(7*Math.LN2));l.realloc(d);for(var f=l.pos-1;f>=a;f--)l.buf[f+d]=l.buf[f]}function lh(a,s){for(var l=0;l<a.length;l++)s.writeVarint(a[l])}function Yc(a,s){for(var l=0;l<a.length;l++)s.writeSVarint(a[l])}function Jc(a,s){for(var l=0;l<a.length;l++)s.writeFloat(a[l])}function Qc(a,s){for(var l=0;l<a.length;l++)s.writeDouble(a[l])}function ug(a,s){for(var l=0;l<a.length;l++)s.writeBoolean(a[l])}function rf(a,s){for(var l=0;l<a.length;l++)s.writeFixed32(a[l])}function eu(a,s){for(var l=0;l<a.length;l++)s.writeSFixed32(a[l])}function Vx(a,s){for(var l=0;l<a.length;l++)s.writeFixed64(a[l])}function $y(a,s){for(var l=0;l<a.length;l++)s.writeSFixed64(a[l])}function sf(a,s){return(a[s]|a[s+1]<<8|a[s+2]<<16)+16777216*a[s+3]}function od(a,s,l){a[l]=s,a[l+1]=s>>>8,a[l+2]=s>>>16,a[l+3]=s>>>24}function Hy(a,s){return(a[s]|a[s+1]<<8|a[s+2]<<16)+(a[s+3]<<24)}Cn.prototype={destroy:function(){this.buf=null},readFields:function(a,s,l){for(l=l||this.length;this.pos<l;){var d=this.readVarint(),f=d>>3,v=this.pos;this.type=7&d,a(f,s,this),this.pos===v&&this.skip(d)}return s},readMessage:function(a,s){return this.readFields(a,s,this.readVarint()+this.pos)},readFixed32:function(){var a=sf(this.buf,this.pos);return this.pos+=4,a},readSFixed32:function(){var a=Hy(this.buf,this.pos);return this.pos+=4,a},readFixed64:function(){var a=sf(this.buf,this.pos)+sf(this.buf,this.pos+4)*Dr;return this.pos+=8,a},readSFixed64:function(){var a=sf(this.buf,this.pos)+Hy(this.buf,this.pos+4)*Dr;return this.pos+=8,a},readFloat:function(){var a=tf(this.buf,this.pos,!0,23,4);return this.pos+=4,a},readDouble:function(){var a=tf(this.buf,this.pos,!0,52,8);return this.pos+=8,a},readVarint:function(a){var s,l,d=this.buf;return s=127&(l=d[this.pos++]),l<128?s:(s|=(127&(l=d[this.pos++]))<<7,l<128?s:(s|=(127&(l=d[this.pos++]))<<14,l<128?s:(s|=(127&(l=d[this.pos++]))<<21,l<128?s:function(f,v,x){var C,S,T=x.buf;if(C=(112&(S=T[x.pos++]))>>4,S<128||(C|=(127&(S=T[x.pos++]))<<3,S<128)||(C|=(127&(S=T[x.pos++]))<<10,S<128)||(C|=(127&(S=T[x.pos++]))<<17,S<128)||(C|=(127&(S=T[x.pos++]))<<24,S<128)||(C|=(1&(S=T[x.pos++]))<<31,S<128))return function Kc(a,s,l){return l?4294967296*s+(a>>>0):4294967296*(s>>>0)+(a>>>0)}(f,C,v);throw new Error("Expected varint not more than 10 bytes")}(s|=(15&(l=d[this.pos]))<<28,a,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var a=this.readVarint();return a%2==1?(a+1)/-2:a/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var a=this.readVarint()+this.pos,s=this.pos;return this.pos=a,a-s>=12&&cr?cr.decode(this.buf.subarray(s,a)):function(l,d,f){for(var v="",x=d;x<f;){var C,S,T,O=l[x],L=null,B=O>239?4:O>223?3:O>191?2:1;if(x+B>f)break;1===B?O<128&&(L=O):2===B?128==(192&(C=l[x+1]))&&(L=(31&O)<<6|63&C)<=127&&(L=null):3===B?(S=l[x+2],128==(192&(C=l[x+1]))&&128==(192&S)&&((L=(15&O)<<12|(63&C)<<6|63&S)<=2047||L>=55296&&L<=57343)&&(L=null)):4===B&&(S=l[x+2],T=l[x+3],128==(192&(C=l[x+1]))&&128==(192&S)&&128==(192&T)&&((L=(15&O)<<18|(63&C)<<12|(63&S)<<6|63&T)<=65535||L>=1114112)&&(L=null)),null===L?(L=65533,B=1):L>65535&&(L-=65536,v+=String.fromCharCode(L>>>10&1023|55296),L=56320|1023&L),v+=String.fromCharCode(L),x+=B}return v}(this.buf,s,a)},readBytes:function(){var a=this.readVarint()+this.pos,s=this.buf.subarray(this.pos,a);return this.pos=a,s},readPackedVarint:function(a,s){if(this.type!==Cn.Bytes)return a.push(this.readVarint(s));var l=xo(this);for(a=a||[];this.pos<l;)a.push(this.readVarint(s));return a},readPackedSVarint:function(a){if(this.type!==Cn.Bytes)return a.push(this.readSVarint());var s=xo(this);for(a=a||[];this.pos<s;)a.push(this.readSVarint());return a},readPackedBoolean:function(a){if(this.type!==Cn.Bytes)return a.push(this.readBoolean());var s=xo(this);for(a=a||[];this.pos<s;)a.push(this.readBoolean());return a},readPackedFloat:function(a){if(this.type!==Cn.Bytes)return a.push(this.readFloat());var s=xo(this);for(a=a||[];this.pos<s;)a.push(this.readFloat());return a},readPackedDouble:function(a){if(this.type!==Cn.Bytes)return a.push(this.readDouble());var s=xo(this);for(a=a||[];this.pos<s;)a.push(this.readDouble());return a},readPackedFixed32:function(a){if(this.type!==Cn.Bytes)return a.push(this.readFixed32());var s=xo(this);for(a=a||[];this.pos<s;)a.push(this.readFixed32());return a},readPackedSFixed32:function(a){if(this.type!==Cn.Bytes)return a.push(this.readSFixed32());var s=xo(this);for(a=a||[];this.pos<s;)a.push(this.readSFixed32());return a},readPackedFixed64:function(a){if(this.type!==Cn.Bytes)return a.push(this.readFixed64());var s=xo(this);for(a=a||[];this.pos<s;)a.push(this.readFixed64());return a},readPackedSFixed64:function(a){if(this.type!==Cn.Bytes)return a.push(this.readSFixed64());var s=xo(this);for(a=a||[];this.pos<s;)a.push(this.readSFixed64());return a},skip:function(a){var s=7&a;if(s===Cn.Varint)for(;this.buf[this.pos++]>127;);else if(s===Cn.Bytes)this.pos=this.readVarint()+this.pos;else if(s===Cn.Fixed32)this.pos+=4;else{if(s!==Cn.Fixed64)throw new Error("Unimplemented type: "+s);this.pos+=8}},writeTag:function(a,s){this.writeVarint(a<<3|s)},realloc:function(a){for(var s=this.length||16;s<this.pos+a;)s*=2;if(s!==this.length){var l=new Uint8Array(s);l.set(this.buf),this.buf=l,this.length=s}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(a){this.realloc(4),od(this.buf,a,this.pos),this.pos+=4},writeSFixed32:function(a){this.realloc(4),od(this.buf,a,this.pos),this.pos+=4},writeFixed64:function(a){this.realloc(8),od(this.buf,-1&a,this.pos),od(this.buf,Math.floor(a*cg),this.pos+4),this.pos+=8},writeSFixed64:function(a){this.realloc(8),od(this.buf,-1&a,this.pos),od(this.buf,Math.floor(a*cg),this.pos+4),this.pos+=8},writeVarint:function(a){(a=+a||0)>268435455||a<0?function(s,l){var d,f,v,C;if(s>=0?(d=s%4294967296|0,f=s/4294967296|0):(f=~(-s/4294967296),4294967295^(d=~(-s%4294967296))?d=d+1|0:(d=0,f=f+1|0)),s>=0x10000000000000000||s<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");l.realloc(10),v=d,(C=l).buf[C.pos++]=127&v|128,v>>>=7,C.buf[C.pos++]=127&v|128,v>>>=7,C.buf[C.pos++]=127&v|128,v>>>=7,C.buf[C.pos++]=127&v|128,C.buf[C.pos]=127&(v>>>=7),function(v,x){var C=(7&v)<<4;x.buf[x.pos++]|=C|((v>>>=3)?128:0),v&&(x.buf[x.pos++]=127&v|((v>>>=7)?128:0),v&&(x.buf[x.pos++]=127&v|((v>>>=7)?128:0),v&&(x.buf[x.pos++]=127&v|((v>>>=7)?128:0),v&&(x.buf[x.pos++]=127&v|((v>>>=7)?128:0),v&&(x.buf[x.pos++]=127&v)))))}(f,l)}(a,this):(this.realloc(4),this.buf[this.pos++]=127&a|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=a>>>7&127))))},writeSVarint:function(a){this.writeVarint(a<0?2*-a-1:2*a)},writeBoolean:function(a){this.writeVarint(!!a)},writeString:function(a){a=String(a),this.realloc(4*a.length),this.pos++;var s=this.pos;this.pos=function(d,f,v){for(var x,C,S=0;S<f.length;S++){if((x=f.charCodeAt(S))>55295&&x<57344){if(!C){x>56319||S+1===f.length?(d[v++]=239,d[v++]=191,d[v++]=189):C=x;continue}if(x<56320){d[v++]=239,d[v++]=191,d[v++]=189,C=x;continue}x=C-55296<<10|x-56320|65536,C=null}else C&&(d[v++]=239,d[v++]=191,d[v++]=189,C=null);x<128?d[v++]=x:(x<2048?d[v++]=x>>6|192:(x<65536?d[v++]=x>>12|224:(d[v++]=x>>18|240,d[v++]=x>>12&63|128),d[v++]=x>>6&63|128),d[v++]=63&x|128)}return v}(this.buf,a,this.pos);var l=this.pos-s;l>=128&&nf(s,l,this),this.pos=s-1,this.writeVarint(l),this.pos+=l},writeFloat:function(a){this.realloc(4),Xc(this.buf,a,this.pos,!0,23,4),this.pos+=4},writeDouble:function(a){this.realloc(8),Xc(this.buf,a,this.pos,!0,52,8),this.pos+=8},writeBytes:function(a){var s=a.length;this.writeVarint(s),this.realloc(s);for(var l=0;l<s;l++)this.buf[this.pos++]=a[l]},writeRawMessage:function(a,s){this.pos++;var l=this.pos;a(s,this);var d=this.pos-l;d>=128&&nf(l,d,this),this.pos=l-1,this.writeVarint(d),this.pos+=d},writeMessage:function(a,s,l){this.writeTag(a,Cn.Bytes),this.writeRawMessage(s,l)},writePackedVarint:function(a,s){s.length&&this.writeMessage(a,lh,s)},writePackedSVarint:function(a,s){s.length&&this.writeMessage(a,Yc,s)},writePackedBoolean:function(a,s){s.length&&this.writeMessage(a,ug,s)},writePackedFloat:function(a,s){s.length&&this.writeMessage(a,Jc,s)},writePackedDouble:function(a,s){s.length&&this.writeMessage(a,Qc,s)},writePackedFixed32:function(a,s){s.length&&this.writeMessage(a,rf,s)},writePackedSFixed32:function(a,s){s.length&&this.writeMessage(a,eu,s)},writePackedFixed64:function(a,s){s.length&&this.writeMessage(a,Vx,s)},writePackedSFixed64:function(a,s){s.length&&this.writeMessage(a,$y,s)},writeBytesField:function(a,s){this.writeTag(a,Cn.Bytes),this.writeBytes(s)},writeFixed32Field:function(a,s){this.writeTag(a,Cn.Fixed32),this.writeFixed32(s)},writeSFixed32Field:function(a,s){this.writeTag(a,Cn.Fixed32),this.writeSFixed32(s)},writeFixed64Field:function(a,s){this.writeTag(a,Cn.Fixed64),this.writeFixed64(s)},writeSFixed64Field:function(a,s){this.writeTag(a,Cn.Fixed64),this.writeSFixed64(s)},writeVarintField:function(a,s){this.writeTag(a,Cn.Varint),this.writeVarint(s)},writeSVarintField:function(a,s){this.writeTag(a,Cn.Varint),this.writeSVarint(s)},writeStringField:function(a,s){this.writeTag(a,Cn.Bytes),this.writeString(s)},writeFloatField:function(a,s){this.writeTag(a,Cn.Fixed32),this.writeFloat(s)},writeDoubleField:function(a,s){this.writeTag(a,Cn.Fixed64),this.writeDouble(s)},writeBooleanField:function(a,s){this.writeVarintField(a,!!s)}};var dg=mn(ef);const hg=3;function Ux(a,s,l){1===a&&l.readMessage(tu,s)}function tu(a,s,l){if(3===a){const{id:d,bitmap:f,width:v,height:x,left:C,top:S,advance:T}=l.readMessage(Gy,{});s.push({id:d,bitmap:new ed({width:v+2*hg,height:x+2*hg},f),metrics:{width:v,height:x,left:C,top:S,advance:T}})}}function Gy(a,s,l){1===a?s.id=l.readVarint():2===a?s.bitmap=l.readBytes():3===a?s.width=l.readVarint():4===a?s.height=l.readVarint():5===a?s.left=l.readSVarint():6===a?s.top=l.readSVarint():7===a&&(s.advance=l.readVarint())}const pg=hg;function Vi(a){let s=0,l=0;for(const x of a)s+=x.w*x.h,l=Math.max(l,x.w);a.sort((x,C)=>C.h-x.h);const d=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(s/.95)),l),h:1/0}];let f=0,v=0;for(const x of a)for(let C=d.length-1;C>=0;C--){const S=d[C];if(!(x.w>S.w||x.h>S.h)){if(x.x=S.x,x.y=S.y,v=Math.max(v,x.y+x.h),f=Math.max(f,x.x+x.w),x.w===S.w&&x.h===S.h){const T=d.pop();C<d.length&&(d[C]=T)}else x.h===S.h?(S.x+=x.w,S.w-=x.w):x.w===S.w?(S.y+=x.h,S.h-=x.h):(d.push({x:S.x+x.w,y:S.y,w:S.w-x.w,h:x.h}),S.y+=x.h,S.h-=x.h);break}}return{w:f,h:v,fill:s/(f*v)||0}}const Zr=1;class rc{constructor(s,{pixelRatio:l,version:d,stretchX:f,stretchY:v,content:x}){this.paddedRect=s,this.pixelRatio=l,this.stretchX=f,this.stretchY=v,this.content=x,this.version=d}get tl(){return[this.paddedRect.x+Zr,this.paddedRect.y+Zr]}get br(){return[this.paddedRect.x+this.paddedRect.w-Zr,this.paddedRect.y+this.paddedRect.h-Zr]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*Zr)/this.pixelRatio,(this.paddedRect.h-2*Zr)/this.pixelRatio]}}class fg{constructor(s,l){const d={},f={};this.haveRenderCallbacks=[];const v=[];this.addImages(s,d,v),this.addImages(l,f,v);const{w:x,h:C}=Vi(v),S=new us({width:x||1,height:C||1});for(const T in s){const O=s[T],L=d[T].paddedRect;us.copy(O.data,S,{x:0,y:0},{x:L.x+Zr,y:L.y+Zr},O.data)}for(const T in l){const O=l[T],L=f[T].paddedRect,B=L.x+Zr,j=L.y+Zr,$=O.data.width,K=O.data.height;us.copy(O.data,S,{x:0,y:0},{x:B,y:j},O.data),us.copy(O.data,S,{x:0,y:K-1},{x:B,y:j-1},{width:$,height:1}),us.copy(O.data,S,{x:0,y:0},{x:B,y:j+K},{width:$,height:1}),us.copy(O.data,S,{x:$-1,y:0},{x:B-1,y:j},{width:1,height:K}),us.copy(O.data,S,{x:0,y:0},{x:B+$,y:j},{width:1,height:K})}this.image=S,this.iconPositions=d,this.patternPositions=f}addImages(s,l,d){for(const f in s){const v=s[f],x={x:0,y:0,w:v.data.width+2*Zr,h:v.data.height+2*Zr};d.push(x),l[f]=new rc(x,v),v.hasRenderCallback&&this.haveRenderCallbacks.push(f)}}patchUpdatedImages(s,l){s.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const d in s.updatedImages)this.patchUpdatedImage(this.iconPositions[d],s.getImage(d),l),this.patchUpdatedImage(this.patternPositions[d],s.getImage(d),l)}patchUpdatedImage(s,l,d){if(!s||!l||s.version===l.version)return;s.version=l.version;const[f,v]=s.tl;d.update(l.data,void 0,{x:f,y:v})}}var nr;Je("ImagePosition",rc),Je("ImageAtlas",fg),g.WritingMode=void 0,(nr=g.WritingMode||(g.WritingMode={}))[nr.none=0]="none",nr[nr.horizontal=1]="horizontal",nr[nr.vertical=2]="vertical",nr[nr.horizontalOnly=3]="horizontalOnly";const Ko=-17;class nu{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(s,l){const d=new nu;return d.scale=s||1,d.fontStack=l,d}static forImage(s){const l=new nu;return l.imageName=s,l}}class Aa{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(s,l){const d=new Aa;for(let f=0;f<s.sections.length;f++){const v=s.sections[f];v.image?d.addImageSection(v):d.addTextSection(v,l)}return d}length(){return this.text.length}getSection(s){return this.sections[this.sectionIndex[s]]}getSectionIndex(s){return this.sectionIndex[s]}getCharCode(s){return this.text.charCodeAt(s)}verticalizePunctuation(){this.text=function(s){let l="";for(let d=0;d<s.length;d++){const f=s.charCodeAt(d+1)||null,v=s.charCodeAt(d-1)||null;l+=f&&xt(f)&&!bo[s[d+1]]||v&&xt(v)&&!bo[s[d-1]]||!bo[s[d]]?s[d]:bo[s[d]]}return l}(this.text)}trim(){let s=0;for(let d=0;d<this.text.length&&ch[this.text.charCodeAt(d)];d++)s++;let l=this.text.length;for(let d=this.text.length-1;d>=0&&d>=s&&ch[this.text.charCodeAt(d)];d--)l--;this.text=this.text.substring(s,l),this.sectionIndex=this.sectionIndex.slice(s,l)}substring(s,l){const d=new Aa;return d.text=this.text.substring(s,l),d.sectionIndex=this.sectionIndex.slice(s,l),d.sections=this.sections,d}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((s,l)=>Math.max(s,this.sections[l].scale),0)}addTextSection(s,l){this.text+=s.text,this.sections.push(nu.forText(s.scale,s.fontStack||l));const d=this.sections.length-1;for(let f=0;f<s.text.length;++f)this.sectionIndex.push(d)}addImageSection(s){const l=s.image?s.image.name:"";if(0===l.length)return void Zi("Can't add FormattedSection with an empty image.");const d=this.getNextImageSectionCharCode();d?(this.text+=String.fromCharCode(d),this.sections.push(nu.forImage(l)),this.sectionIndex.push(this.sections.length-1)):Zi("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function xl(a,s,l,d,f,v,x,C,S,T,O,L,B,j,$,K){const Q=Aa.fromFeature(a,f);let ne;L===g.WritingMode.vertical&&Q.verticalizePunctuation();const{processBidirectionalText:de,processStyledBidirectionalText:oe}=Xt;if(de&&1===Q.sections.length){ne=[];const Me=de(Q.toString(),gg(Q,T,v,s,d,j,$));for(const Ze of Me){const it=new Aa;it.text=Ze,it.sections=Q.sections;for(let qe=0;qe<Ze.length;qe++)it.sectionIndex.push(0);ne.push(it)}}else if(oe){ne=[];const Me=oe(Q.text,Q.sectionIndex,gg(Q,T,v,s,d,j,$));for(const Ze of Me){const it=new Aa;it.text=Ze[0],it.sectionIndex=Ze[1],it.sections=Q.sections,ne.push(it)}}else ne=function(Me,Ze){const it=[],qe=Me.text;let je=0;for(const Ne of Ze)it.push(Me.substring(je,Ne)),je=Ne;return je<qe.length&&it.push(Me.substring(je,qe.length)),it}(Q,gg(Q,T,v,s,d,j,$));const pe=[],_e={positionedLines:pe,text:Q.toString(),top:O[1],bottom:O[1],left:O[0],right:O[0],writingMode:L,iconsInText:!1,verticalizable:!1};return function(Me,Ze,it,qe,je,Ne,et,ze,Oe,ut,st,Nt){let Mn=0,Tn=Ko,Ei=0,Nr=0;const ji="right"===ze?1:"left"===ze?0:.5;let Di=0;for(const _i of je){_i.trim();const Ii=_i.getMaxScale(),$i=(Ii-1)*Pi,dr={positionedGlyphs:[],lineOffset:0};Me.positionedLines[Di]=dr;const Hi=dr.positionedGlyphs;let Kr=0;if(!_i.length()){Tn+=Ne,++Di;continue}for(let Sr=0;Sr<_i.length();Sr++){const $t=_i.getSection(Sr),Br=_i.getSectionIndex(Sr),hr=_i.getCharCode(Sr);let Oi=0,Yr=null,Ss=null,Js=null,Jo=Pi;const Ms=!(Oe===g.WritingMode.horizontal||!st&&!fl(hr)||st&&(ch[hr]||(Ri=hr,Ge.Arabic(Ri)||Ge["Arabic Supplement"](Ri)||Ge["Arabic Extended-A"](Ri)||Ge["Arabic Presentation Forms-A"](Ri)||Ge["Arabic Presentation Forms-B"](Ri))));if($t.imageName){const ds=qe[$t.imageName];if(!ds)continue;Js=$t.imageName,Me.iconsInText=Me.iconsInText||!0,Ss=ds.paddedRect;const Jr=ds.displaySize;$t.scale=$t.scale*Pi/Nt,Yr={width:Jr[0],height:Jr[1],left:Zr,top:-pg,advance:Ms?Jr[1]:Jr[0]},Oi=$i+(Pi-Jr[1]*$t.scale),Jo=Yr.advance;const La=Ms?Jr[0]*$t.scale-Pi*Ii:Jr[1]*$t.scale-Pi*Ii;La>0&&La>Kr&&(Kr=La)}else{const ds=it[$t.fontStack],Jr=ds&&ds[hr];if(Jr&&Jr.rect)Ss=Jr.rect,Yr=Jr.metrics;else{const La=Ze[$t.fontStack],fd=La&&La[hr];if(!fd)continue;Yr=fd.metrics}Oi=(Ii-$t.scale)*Pi}Ms?(Me.verticalizable=!0,Hi.push({glyph:hr,imageName:Js,x:Mn,y:Tn+Oi,vertical:Ms,scale:$t.scale,fontStack:$t.fontStack,sectionIndex:Br,metrics:Yr,rect:Ss}),Mn+=Jo*$t.scale+ut):(Hi.push({glyph:hr,imageName:Js,x:Mn,y:Tn+Oi,vertical:Ms,scale:$t.scale,fontStack:$t.fontStack,sectionIndex:Br,metrics:Yr,rect:Ss}),Mn+=Yr.advance*$t.scale+ut)}0!==Hi.length&&(Ei=Math.max(Mn-ut,Ei),Zy(Hi,0,Hi.length-1,ji,Kr)),Mn=0;const oi=Ne*Ii+Kr;dr.lineOffset=Math.max(Kr,$i),Tn+=oi,Nr=Math.max(oi,Nr),++Di}var Ri;const ur=Tn-Ko,{horizontalAlign:Xr,verticalAlign:zr}=dh(et);(function(_i,Ii,$i,dr,Hi,Kr,oi,Sr,$t){const Br=(Ii-$i)*Hi;let hr=0;hr=Kr!==oi?-Sr*dr-Ko:(-dr*$t+.5)*oi;for(const Oi of _i)for(const Yr of Oi.positionedGlyphs)Yr.x+=Br,Yr.y+=hr})(Me.positionedLines,ji,Xr,zr,Ei,Nr,Ne,ur,je.length),Me.top+=-zr*ur,Me.bottom=Me.top+ur,Me.left+=-Xr*Ei,Me.right=Me.left+Ei}(_e,s,l,d,ne,x,C,S,L,T,B,K),!function(Me){for(const Ze of Me)if(0!==Ze.positionedGlyphs.length)return!1;return!0}(pe)&&_e}const ch={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},jx={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function mg(a,s,l,d,f,v){if(s.imageName){const x=d[s.imageName];return x?x.displaySize[0]*s.scale*Pi/v+f:0}{const x=l[s.fontStack],C=x&&x[a];return C?C.metrics.advance*s.scale+f:0}}function qy(a,s,l,d){const f=Math.pow(a-s,2);return d?a<s?f/2:2*f:f+Math.abs(l)*l}function Is(a,s,l){let d=0;return 10===a&&(d-=1e4),l&&(d+=150),40!==a&&65288!==a||(d+=50),41!==s&&65289!==s||(d+=50),d}function uh(a,s,l,d,f,v){let x=null,C=qy(s,l,f,v);for(const S of d){const T=qy(s-S.x,l,f,v)+S.badness;T<=C&&(x=S,C=T)}return{index:a,x:s,priorBreak:x,badness:C}}function sc(a){return a?sc(a.priorBreak).concat(a.index):[]}function gg(a,s,l,d,f,v,x){if("point"!==v)return[];if(!a)return[];const C=[],S=function(B,j,$,K,Q,ne){let de=0;for(let oe=0;oe<B.length();oe++){const pe=B.getSection(oe);de+=mg(B.getCharCode(oe),pe,K,Q,j,ne)}return de/Math.max(1,Math.ceil(de/$))}(a,s,l,d,f,x),T=a.text.indexOf("\u200b")>=0;let O=0;for(let B=0;B<a.length();B++){const j=a.getSection(B),$=a.getCharCode(B);if(ch[$]||(O+=mg($,j,d,f,s,x)),B<a.length()-1){const K=!((L=$)<11904||!(Ge["Bopomofo Extended"](L)||Ge.Bopomofo(L)||Ge["CJK Compatibility Forms"](L)||Ge["CJK Compatibility Ideographs"](L)||Ge["CJK Compatibility"](L)||Ge["CJK Radicals Supplement"](L)||Ge["CJK Strokes"](L)||Ge["CJK Symbols and Punctuation"](L)||Ge["CJK Unified Ideographs Extension A"](L)||Ge["CJK Unified Ideographs"](L)||Ge["Enclosed CJK Letters and Months"](L)||Ge["Halfwidth and Fullwidth Forms"](L)||Ge.Hiragana(L)||Ge["Ideographic Description Characters"](L)||Ge["Kangxi Radicals"](L)||Ge["Katakana Phonetic Extensions"](L)||Ge.Katakana(L)||Ge["Vertical Forms"](L)||Ge["Yi Radicals"](L)||Ge["Yi Syllables"](L)));(jx[$]||K||j.imageName)&&C.push(uh(B+1,O,S,C,Is($,a.getCharCode(B+1),K&&T),!1))}}var L;return sc(uh(a.length(),O,S,C,0,!0))}function dh(a){let s=.5,l=.5;switch(a){case"right":case"top-right":case"bottom-right":s=1;break;case"left":case"top-left":case"bottom-left":s=0}switch(a){case"bottom":case"bottom-right":case"bottom-left":l=1;break;case"top":case"top-right":case"top-left":l=0}return{horizontalAlign:s,verticalAlign:l}}function Zy(a,s,l,d,f){if(!d&&!f)return;const v=a[l],x=(a[l].x+v.metrics.advance*v.scale)*d;for(let C=s;C<=l;C++)a[C].x-=x,a[C].y+=f}function Wy(a,s,l){const{horizontalAlign:d,verticalAlign:f}=dh(l),v=s[0]-a.displaySize[0]*d,x=s[1]-a.displaySize[1]*f;return{image:a,top:x,bottom:x+a.displaySize[1],left:v,right:v+a.displaySize[0]}}function _g(a,s,l,d,f,v){const x=a.image;let C;if(x.content){const Q=x.content,ne=x.pixelRatio||1;C=[Q[0]/ne,Q[1]/ne,x.displaySize[0]-Q[2]/ne,x.displaySize[1]-Q[3]/ne]}const S=s.left*v,T=s.right*v;let O,L,B,j;"width"===l||"both"===l?(j=f[0]+S-d[3],L=f[0]+T+d[1]):(j=f[0]+(S+T-x.displaySize[0])/2,L=j+x.displaySize[0]);const $=s.top*v,K=s.bottom*v;return"height"===l||"both"===l?(O=f[1]+$-d[0],B=f[1]+K+d[2]):(O=f[1]+($+K-x.displaySize[1])/2,B=O+x.displaySize[1]),{image:x,top:O,right:L,bottom:B,left:j,collisionPadding:C}}const ad=255,Yo=128,wl=ad*Yo;function hh(a,s){const{expression:l}=s;if("constant"===l.kind)return{kind:"constant",layoutSize:l.evaluate(new Kt(a+1))};if("source"===l.kind)return{kind:"source"};{const{zoomStops:d,interpolationType:f}=l;let v=0;for(;v<d.length&&d[v]<=a;)v++;v=Math.max(0,v-1);let x=v;for(;x<d.length&&d[x]<a+1;)x++;x=Math.min(d.length-1,x);const C=d[v],S=d[x];return"composite"===l.kind?{kind:"composite",minZoom:C,maxZoom:S,interpolationType:f}:{kind:"camera",minZoom:C,maxZoom:S,minSize:l.evaluate(new Kt(C)),maxSize:l.evaluate(new Kt(S)),interpolationType:f}}}function iu(a,s,l){let d="never";const f=a.get(s);return f?d=f:a.get(l)&&(d="always"),d}const Xy=vo.VectorTileFeature.types,ph=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function fh(a,s,l,d,f,v,x,C,S,T,O,L,B){const j=C?Math.min(wl,Math.round(C[0])):0,$=C?Math.min(wl,Math.round(C[1])):0;a.emplaceBack(s,l,Math.round(32*d),Math.round(32*f),v,x,(j<<1)+(S?1:0),$,16*T,16*O,256*L,256*B)}function ru(a,s,l){a.emplaceBack(s.x,s.y,l),a.emplaceBack(s.x,s.y,l),a.emplaceBack(s.x,s.y,l),a.emplaceBack(s.x,s.y,l)}function Ky(a){for(const s of a.sections)if(zi(s.text))return!0;return!1}class mh{constructor(s){this.layoutVertexArray=new De,this.indexArray=new dt,this.programConfigurations=s,this.segments=new ht,this.dynamicLayoutVertexArray=new Le,this.opacityVertexArray=new We,this.hasVisibleVertices=!1,this.placedSymbolArray=new k}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}upload(s,l,d,f){this.isEmpty()||(d&&(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,og.members),this.indexBuffer=s.createIndexBuffer(this.indexArray,l),this.dynamicLayoutVertexBuffer=s.createVertexBuffer(this.dynamicLayoutVertexArray,ag.members,!0),this.opacityVertexBuffer=s.createVertexBuffer(this.opacityVertexArray,ph,!0),this.opacityVertexBuffer.itemSize=1),(d||f)&&this.programConfigurations.upload(s))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Je("SymbolBuffers",mh);class ld{constructor(s,l,d){this.layoutVertexArray=new s,this.layoutAttributes=l,this.indexArray=new d,this.segments=new ht,this.collisionVertexArray=new Ue}upload(s){this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=s.createVertexBuffer(this.collisionVertexArray,lg.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Je("CollisionBuffers",ld);class ka{constructor(s){this.collisionBoxArray=s.collisionBoxArray,this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(x=>x.id),this.index=s.index,this.pixelRatio=s.pixelRatio,this.sourceLayerIndex=s.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Np([]),this.placementViewportMatrix=Np([]);const l=this.layers[0]._unevaluatedLayout._values;this.textSizeData=hh(this.zoom,l["text-size"]),this.iconSizeData=hh(this.zoom,l["icon-size"]);const d=this.layers[0].layout,f=d.get("symbol-sort-key"),v=d.get("symbol-z-order");this.canOverlap="never"!==iu(d,"text-overlap","text-allow-overlap")||"never"!==iu(d,"icon-overlap","icon-allow-overlap")||d.get("text-ignore-placement")||d.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==v&&!f.isConstant(),this.sortFeaturesByY=("viewport-y"===v||"auto"===v&&!this.sortFeaturesByKey)&&this.canOverlap,"point"===d.get("symbol-placement")&&(this.writingModes=d.get("text-writing-mode").map(x=>g.WritingMode[x])),this.stateDependentLayerIds=this.layers.filter(x=>x.isStateDependent()).map(x=>x.id),this.sourceID=s.sourceID}createArrays(){this.text=new mh(new wa(this.layers,this.zoom,s=>/^text/.test(s))),this.icon=new mh(new wa(this.layers,this.zoom,s=>/^icon/.test(s))),this.glyphOffsetArray=new U,this.lineVertexArray=new X,this.symbolInstances=new F,this.textAnchorOffsets=new J}calculateGlyphDependencies(s,l,d,f,v){for(let x=0;x<s.length;x++)if(l[s.charCodeAt(x)]=!0,(d||f)&&v){const C=bo[s.charAt(x)];C&&(l[C.charCodeAt(0)]=!0)}}populate(s,l,d){const f=this.layers[0],v=f.layout,x=v.get("text-font"),C=v.get("text-field"),S=v.get("icon-image"),T=("constant"!==C.value.kind||C.value.value instanceof ui&&!C.value.value.isEmpty()||C.value.value.toString().length>0)&&("constant"!==x.value.kind||x.value.value.length>0),O="constant"!==S.value.kind||!!S.value.value||Object.keys(S.parameters).length>0,L=v.get("symbol-sort-key");if(this.features=[],!T&&!O)return;const B=l.iconDependencies,j=l.glyphDependencies,$=l.availableImages,K=new Kt(this.zoom);for(const{feature:Q,id:ne,index:de,sourceLayerIndex:oe}of s){const pe=f._featureFilter.needGeometry,_e=Bn(Q,pe);if(!f._featureFilter.filter(K,_e,d))continue;let Me,Ze;if(pe||(_e.geometry=yo(Q)),T){const qe=f.getValueAndResolveTokens("text-field",_e,d,$),je=ui.factory(qe);Ky(je)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===Qe()||this.hasRTLText&&Xt.isParsed())&&(Me=ah(je,f,_e))}if(O){const qe=f.getValueAndResolveTokens("icon-image",_e,d,$);Ze=qe instanceof ar?qe:ar.fromString(qe)}if(!Me&&!Ze)continue;const it=this.sortFeaturesByKey?L.evaluate(_e,{},d):void 0;if(this.features.push({id:ne,text:Me,icon:Ze,index:de,sourceLayerIndex:oe,geometry:_e.geometry,properties:Q.properties,type:Xy[Q.type],sortKey:it}),Ze&&(B[Ze.name]=!0),Me){const qe=x.evaluate(_e,{},d).join(","),je="viewport"!==v.get("text-rotation-alignment")&&"point"!==v.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(g.WritingMode.vertical)>=0;for(const Ne of Me.sections)if(Ne.image)B[Ne.image.name]=!0;else{const et=Vc(Me.toString()),ze=Ne.fontStack||qe,Oe=j[ze]=j[ze]||{};this.calculateGlyphDependencies(Ne.text,Oe,je,this.allowVerticalPlacement,et)}}}"line"===v.get("symbol-placement")&&(this.features=function(Q){const ne={},de={},oe=[];let pe=0;function _e(qe){oe.push(Q[qe]),pe++}function Me(qe,je,Ne){const et=de[qe];return delete de[qe],de[je]=et,oe[et].geometry[0].pop(),oe[et].geometry[0]=oe[et].geometry[0].concat(Ne[0]),et}function Ze(qe,je,Ne){const et=ne[je];return delete ne[je],ne[qe]=et,oe[et].geometry[0].shift(),oe[et].geometry[0]=Ne[0].concat(oe[et].geometry[0]),et}function it(qe,je,Ne){const et=Ne?je[0][je[0].length-1]:je[0][0];return`${qe}:${et.x}:${et.y}`}for(let qe=0;qe<Q.length;qe++){const je=Q[qe],Ne=je.geometry,et=je.text?je.text.toString():null;if(!et){_e(qe);continue}const ze=it(et,Ne),Oe=it(et,Ne,!0);if(ze in de&&Oe in ne&&de[ze]!==ne[Oe]){const ut=Ze(ze,Oe,Ne),st=Me(ze,Oe,oe[ut].geometry);delete ne[ze],delete de[Oe],de[it(et,oe[st].geometry,!0)]=st,oe[ut].geometry=null}else ze in de?Me(ze,Oe,Ne):Oe in ne?Ze(ze,Oe,Ne):(_e(qe),ne[ze]=pe-1,de[Oe]=pe-1)}return oe.filter(qe=>qe.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((Q,ne)=>Q.sortKey-ne.sortKey)}update(s,l,d){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(s,l,this.layers,d),this.icon.programConfigurations.updatePaintArrays(s,l,this.layers,d))}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(s){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(s),this.iconCollisionBox.upload(s)),this.text.upload(s,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(s,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(s,l){const d=this.lineVertexArray.length;if(void 0!==s.segment){let f=s.dist(l[s.segment+1]),v=s.dist(l[s.segment]);const x={};for(let C=s.segment+1;C<l.length;C++)x[C]={x:l[C].x,y:l[C].y,tileUnitDistanceFromAnchor:f},C<l.length-1&&(f+=l[C+1].dist(l[C]));for(let C=s.segment||0;C>=0;C--)x[C]={x:l[C].x,y:l[C].y,tileUnitDistanceFromAnchor:v},C>0&&(v+=l[C-1].dist(l[C]));for(let C=0;C<l.length;C++){const S=x[C];this.lineVertexArray.emplaceBack(S.x,S.y,S.tileUnitDistanceFromAnchor)}}return{lineStartIndex:d,lineLength:this.lineVertexArray.length-d}}addSymbols(s,l,d,f,v,x,C,S,T,O,L,B){const j=s.indexArray,$=s.layoutVertexArray,K=s.segments.prepareSegment(4*l.length,$,j,this.canOverlap?x.sortKey:void 0),Q=this.glyphOffsetArray.length,ne=K.vertexLength,de=this.allowVerticalPlacement&&C===g.WritingMode.vertical?Math.PI/2:0,oe=x.text&&x.text.sections;for(let pe=0;pe<l.length;pe++){const{tl:_e,tr:Me,bl:Ze,br:it,tex:qe,pixelOffsetTL:je,pixelOffsetBR:Ne,minFontScaleX:et,minFontScaleY:ze,glyphOffset:Oe,isSDF:ut,sectionIndex:st}=l[pe],Nt=K.vertexLength,Mn=Oe[1];fh($,S.x,S.y,_e.x,Mn+_e.y,qe.x,qe.y,d,ut,je.x,je.y,et,ze),fh($,S.x,S.y,Me.x,Mn+Me.y,qe.x+qe.w,qe.y,d,ut,Ne.x,je.y,et,ze),fh($,S.x,S.y,Ze.x,Mn+Ze.y,qe.x,qe.y+qe.h,d,ut,je.x,Ne.y,et,ze),fh($,S.x,S.y,it.x,Mn+it.y,qe.x+qe.w,qe.y+qe.h,d,ut,Ne.x,Ne.y,et,ze),ru(s.dynamicLayoutVertexArray,S,de),j.emplaceBack(Nt,Nt+1,Nt+2),j.emplaceBack(Nt+1,Nt+2,Nt+3),K.vertexLength+=4,K.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Oe[0]),pe!==l.length-1&&st===l[pe+1].sectionIndex||s.programConfigurations.populatePaintArrays($.length,x,x.index,{},B,oe&&oe[st])}s.placedSymbolArray.emplaceBack(S.x,S.y,Q,this.glyphOffsetArray.length-Q,ne,T,O,S.segment,d?d[0]:0,d?d[1]:0,f[0],f[1],C,0,!1,0,L)}_addCollisionDebugVertex(s,l,d,f,v,x){return l.emplaceBack(0,0),s.emplaceBack(d.x,d.y,f,v,Math.round(x.x),Math.round(x.y))}addCollisionDebugVertices(s,l,d,f,v,x,C){const S=v.segments.prepareSegment(4,v.layoutVertexArray,v.indexArray),T=S.vertexLength,O=v.layoutVertexArray,L=v.collisionVertexArray,B=C.anchorX,j=C.anchorY;this._addCollisionDebugVertex(O,L,x,B,j,new yt(s,l)),this._addCollisionDebugVertex(O,L,x,B,j,new yt(d,l)),this._addCollisionDebugVertex(O,L,x,B,j,new yt(d,f)),this._addCollisionDebugVertex(O,L,x,B,j,new yt(s,f)),S.vertexLength+=4;const $=v.indexArray;$.emplaceBack(T,T+1),$.emplaceBack(T+1,T+2),$.emplaceBack(T+2,T+3),$.emplaceBack(T+3,T),S.primitiveLength+=4}addDebugCollisionBoxes(s,l,d,f){for(let v=s;v<l;v++){const x=this.collisionBoxArray.get(v);this.addCollisionDebugVertices(x.x1,x.y1,x.x2,x.y2,f?this.textCollisionBox:this.iconCollisionBox,x.anchorPoint,d)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new ld(zt,Qp.members,rt),this.iconCollisionBox=new ld(zt,Qp.members,rt);for(let s=0;s<this.symbolInstances.length;s++){const l=this.symbolInstances.get(s);this.addDebugCollisionBoxes(l.textBoxStartIndex,l.textBoxEndIndex,l,!0),this.addDebugCollisionBoxes(l.verticalTextBoxStartIndex,l.verticalTextBoxEndIndex,l,!0),this.addDebugCollisionBoxes(l.iconBoxStartIndex,l.iconBoxEndIndex,l,!1),this.addDebugCollisionBoxes(l.verticalIconBoxStartIndex,l.verticalIconBoxEndIndex,l,!1)}}_deserializeCollisionBoxesForSymbol(s,l,d,f,v,x,C,S,T){const O={};for(let L=l;L<d;L++){const B=s.get(L);O.textBox={x1:B.x1,y1:B.y1,x2:B.x2,y2:B.y2,anchorPointX:B.anchorPointX,anchorPointY:B.anchorPointY},O.textFeatureIndex=B.featureIndex;break}for(let L=f;L<v;L++){const B=s.get(L);O.verticalTextBox={x1:B.x1,y1:B.y1,x2:B.x2,y2:B.y2,anchorPointX:B.anchorPointX,anchorPointY:B.anchorPointY},O.verticalTextFeatureIndex=B.featureIndex;break}for(let L=x;L<C;L++){const B=s.get(L);O.iconBox={x1:B.x1,y1:B.y1,x2:B.x2,y2:B.y2,anchorPointX:B.anchorPointX,anchorPointY:B.anchorPointY},O.iconFeatureIndex=B.featureIndex;break}for(let L=S;L<T;L++){const B=s.get(L);O.verticalIconBox={x1:B.x1,y1:B.y1,x2:B.x2,y2:B.y2,anchorPointX:B.anchorPointX,anchorPointY:B.anchorPointY},O.verticalIconFeatureIndex=B.featureIndex;break}return O}deserializeCollisionBoxes(s){this.collisionArrays=[];for(let l=0;l<this.symbolInstances.length;l++){const d=this.symbolInstances.get(l);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(s,d.textBoxStartIndex,d.textBoxEndIndex,d.verticalTextBoxStartIndex,d.verticalTextBoxEndIndex,d.iconBoxStartIndex,d.iconBoxEndIndex,d.verticalIconBoxStartIndex,d.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(s,l){const d=s.placedSymbolArray.get(l),f=d.vertexStartIndex+4*d.numGlyphs;for(let v=d.vertexStartIndex;v<f;v+=4)s.indexArray.emplaceBack(v,v+1,v+2),s.indexArray.emplaceBack(v+1,v+2,v+3)}getSortedSymbolIndexes(s){if(this.sortedAngle===s&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const l=Math.sin(s),d=Math.cos(s),f=[],v=[],x=[];for(let C=0;C<this.symbolInstances.length;++C){x.push(C);const S=this.symbolInstances.get(C);f.push(0|Math.round(l*S.anchorX+d*S.anchorY)),v.push(S.featureIndex)}return x.sort((C,S)=>f[C]-f[S]||v[S]-v[C]),x}addToSortKeyRanges(s,l){const d=this.sortKeyRanges[this.sortKeyRanges.length-1];d&&d.sortKey===l?d.symbolInstanceEnd=s+1:this.sortKeyRanges.push({sortKey:l,symbolInstanceStart:s,symbolInstanceEnd:s+1})}sortFeatures(s){if(this.sortFeaturesByY&&this.sortedAngle!==s&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(s),this.sortedAngle=s,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const l of this.symbolInstanceIndexes){const d=this.symbolInstances.get(l);this.featureSortOrder.push(d.featureIndex),[d.rightJustifiedTextSymbolIndex,d.centerJustifiedTextSymbolIndex,d.leftJustifiedTextSymbolIndex].forEach((f,v,x)=>{f>=0&&x.indexOf(f)===v&&this.addIndicesForPlacedSymbol(this.text,f)}),d.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,d.verticalPlacedTextSymbolIndex),d.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,d.placedIconSymbolIndex),d.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,d.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let af,yg;Je("SymbolBucket",ka,{omit:["layers","collisionBoxArray","features","compareText"]}),ka.MAX_GLYPHS=65535,ka.addDynamicAttributes=ru;var lf={get paint(){return yg=yg||new ei({"icon-opacity":new ft(we.paint_symbol["icon-opacity"]),"icon-color":new ft(we.paint_symbol["icon-color"]),"icon-halo-color":new ft(we.paint_symbol["icon-halo-color"]),"icon-halo-width":new ft(we.paint_symbol["icon-halo-width"]),"icon-halo-blur":new ft(we.paint_symbol["icon-halo-blur"]),"icon-translate":new lt(we.paint_symbol["icon-translate"]),"icon-translate-anchor":new lt(we.paint_symbol["icon-translate-anchor"]),"text-opacity":new ft(we.paint_symbol["text-opacity"]),"text-color":new ft(we.paint_symbol["text-color"],{runtimeType:Wi,getOverride:a=>a.textColor,hasOverride:a=>!!a.textColor}),"text-halo-color":new ft(we.paint_symbol["text-halo-color"]),"text-halo-width":new ft(we.paint_symbol["text-halo-width"]),"text-halo-blur":new ft(we.paint_symbol["text-halo-blur"]),"text-translate":new lt(we.paint_symbol["text-translate"]),"text-translate-anchor":new lt(we.paint_symbol["text-translate-anchor"])})},get layout(){return af=af||new ei({"symbol-placement":new lt(we.layout_symbol["symbol-placement"]),"symbol-spacing":new lt(we.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new lt(we.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new ft(we.layout_symbol["symbol-sort-key"]),"symbol-z-order":new lt(we.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new lt(we.layout_symbol["icon-allow-overlap"]),"icon-overlap":new lt(we.layout_symbol["icon-overlap"]),"icon-ignore-placement":new lt(we.layout_symbol["icon-ignore-placement"]),"icon-optional":new lt(we.layout_symbol["icon-optional"]),"icon-rotation-alignment":new lt(we.layout_symbol["icon-rotation-alignment"]),"icon-size":new ft(we.layout_symbol["icon-size"]),"icon-text-fit":new lt(we.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new lt(we.layout_symbol["icon-text-fit-padding"]),"icon-image":new ft(we.layout_symbol["icon-image"]),"icon-rotate":new ft(we.layout_symbol["icon-rotate"]),"icon-padding":new ft(we.layout_symbol["icon-padding"]),"icon-keep-upright":new lt(we.layout_symbol["icon-keep-upright"]),"icon-offset":new ft(we.layout_symbol["icon-offset"]),"icon-anchor":new ft(we.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new lt(we.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new lt(we.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new lt(we.layout_symbol["text-rotation-alignment"]),"text-field":new ft(we.layout_symbol["text-field"]),"text-font":new ft(we.layout_symbol["text-font"]),"text-size":new ft(we.layout_symbol["text-size"]),"text-max-width":new ft(we.layout_symbol["text-max-width"]),"text-line-height":new lt(we.layout_symbol["text-line-height"]),"text-letter-spacing":new ft(we.layout_symbol["text-letter-spacing"]),"text-justify":new ft(we.layout_symbol["text-justify"]),"text-radial-offset":new ft(we.layout_symbol["text-radial-offset"]),"text-variable-anchor":new lt(we.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new ft(we.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new ft(we.layout_symbol["text-anchor"]),"text-max-angle":new lt(we.layout_symbol["text-max-angle"]),"text-writing-mode":new lt(we.layout_symbol["text-writing-mode"]),"text-rotate":new ft(we.layout_symbol["text-rotate"]),"text-padding":new lt(we.layout_symbol["text-padding"]),"text-keep-upright":new lt(we.layout_symbol["text-keep-upright"]),"text-transform":new ft(we.layout_symbol["text-transform"]),"text-offset":new ft(we.layout_symbol["text-offset"]),"text-allow-overlap":new lt(we.layout_symbol["text-allow-overlap"]),"text-overlap":new lt(we.layout_symbol["text-overlap"]),"text-ignore-placement":new lt(we.layout_symbol["text-ignore-placement"]),"text-optional":new lt(we.layout_symbol["text-optional"])})}};class oc{constructor(s){if(void 0===s.property.overrides)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=s.property.overrides?s.property.overrides.runtimeType:Fo,this.defaultValue=s}evaluate(s){if(s.formattedSection){const l=this.defaultValue.property.overrides;if(l&&l.hasOverride(s.formattedSection))return l.getOverride(s.formattedSection)}return s.feature&&s.featureState?this.defaultValue.evaluate(s.feature,s.featureState):this.defaultValue.property.specification.default}eachChild(s){this.defaultValue.isConstant()||s(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Je("FormatSectionOverride",oc,{omit:["defaultValue"]});class Cl extends ws{constructor(s){super(s,lf)}recalculate(s,l){if(super.recalculate(s,l),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]="map"===this.layout.get("text-rotation-alignment")?"map":"viewport"),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),"point"===this.layout.get("symbol-placement")){const d=this.layout.get("text-writing-mode");if(d){const f=[];for(const v of d)f.indexOf(v)<0&&f.push(v);this.layout._values["text-writing-mode"]=f}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(s,l,d,f){const v=this.layout.get(s).evaluate(l,{},d,f),x=this._unevaluatedLayout._values[s];return x.isDataDriven()||Uu(x.value)||!v?v:(C=l.properties,v.replace(/{([^{}]+)}/g,(T,O)=>O in C?String(C[O]):""));var C}createBucket(s){return new ka(s)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const s of lf.paint.overridableProperties){if(!Cl.hasPaintOverride(this.layout,s))continue;const l=this.paint.get(s),d=new oc(l),f=new ri(d,l.property.specification);let v=null;v="constant"===l.value.kind||"source"===l.value.kind?new Fc("source",f):new fn("composite",f,l.value.zoomStops),this.paint._values[s]=new wt(l.property,v,l.parameters)}}_handleOverridablePaintPropertyUpdate(s,l,d){return!(!this.layout||l.isDataDriven()||d.isDataDriven())&&Cl.hasPaintOverride(this.layout,s)}static hasPaintOverride(s,l){const d=s.get("text-field"),f=lf.paint.properties[l];let v=!1;const x=C=>{for(const S of C)if(f.overrides&&f.overrides.hasOverride(S))return void(v=!0)};if("constant"===d.value.kind&&d.value.value instanceof ui)x(d.value.value.sections);else if("source"===d.value.kind){const C=T=>{v||(T instanceof ua&&ii(T.value)===Us?x(T.value.sections):T instanceof Pc?x(T.sections):T.eachChild(C))},S=d.value;S._styleExpression&&C(S._styleExpression.expression)}return v}}let vg;var $x={get paint(){return vg=vg||new ei({"background-color":new lt(we.paint_background["background-color"]),"background-pattern":new va(we.paint_background["background-pattern"]),"background-opacity":new lt(we.paint_background["background-opacity"])})}};class bg extends ws{constructor(s){super(s,$x)}}let xg;var Hx={get paint(){return xg=xg||new ei({"raster-opacity":new lt(we.paint_raster["raster-opacity"]),"raster-hue-rotate":new lt(we.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new lt(we.paint_raster["raster-brightness-min"]),"raster-brightness-max":new lt(we.paint_raster["raster-brightness-max"]),"raster-saturation":new lt(we.paint_raster["raster-saturation"]),"raster-contrast":new lt(we.paint_raster["raster-contrast"]),"raster-resampling":new lt(we.paint_raster["raster-resampling"]),"raster-fade-duration":new lt(we.paint_raster["raster-fade-duration"])})}};class Yy extends ws{constructor(s){super(s,Hx)}}class Jy extends ws{constructor(s){super(s,{}),this.onAdd=l=>{this.implementation.onAdd&&this.implementation.onAdd(l,l.painter.context.gl)},this.onRemove=l=>{this.implementation.onRemove&&this.implementation.onRemove(l,l.painter.context.gl)},this.implementation=s}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class Qy{constructor(s){this._callback=s,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){delete this._channel,this._callback=()=>{}}}const su=6371008.8;class Pa{constructor(s,l){if(isNaN(s)||isNaN(l))throw new Error(`Invalid LngLat object: (${s}, ${l})`);if(this.lng=+s,this.lat=+l,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Pa(xc(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(s){const l=Math.PI/180,d=this.lat*l,f=s.lat*l,v=Math.sin(d)*Math.sin(f)+Math.cos(d)*Math.cos(f)*Math.cos((s.lng-this.lng)*l);return su*Math.acos(Math.min(v,1))}static convert(s){if(s instanceof Pa)return s;if(Array.isArray(s)&&(2===s.length||3===s.length))return new Pa(Number(s[0]),Number(s[1]));if(!Array.isArray(s)&&"object"==typeof s&&null!==s)return new Pa(Number("lng"in s?s.lng:s.lon),Number(s.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const wg=2*Math.PI*su;function cf(a){return wg*Math.cos(a*Math.PI/180)}function ev(a){return(180+a)/360}function uf(a){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a*Math.PI/360)))/360}function tv(a,s){return a/cf(s)}function df(a){return 360/Math.PI*Math.atan(Math.exp((180-360*a)*Math.PI/180))-90}class gh{constructor(s,l,d=0){this.x=+s,this.y=+l,this.z=+d}static fromLngLat(s,l=0){const d=Pa.convert(s);return new gh(ev(d.lng),uf(d.lat),tv(l,d.lat))}toLngLat(){return new Pa(360*this.x-180,df(this.y))}toAltitude(){return this.z*cf(df(this.y))}meterInMercatorCoordinateUnits(){return 1/wg*(s=df(this.y),1/Math.cos(s*Math.PI/180));var s}}function _h(a,s,l){var d=2*Math.PI*6378137/256/Math.pow(2,l);return[a*d-2*Math.PI*6378137/2,s*d-2*Math.PI*6378137/2]}class Cg{constructor(s,l,d){if(s<0||s>25||d<0||d>=Math.pow(2,s)||l<0||l>=Math.pow(2,s))throw new Error(`x=${l}, y=${d}, z=${s} outside of bounds. 0<=x<${Math.pow(2,s)}, 0<=y<${Math.pow(2,s)} 0<=z<=25 `);this.z=s,this.x=l,this.y=d,this.key=yh(0,s,s,l,d)}equals(s){return this.z===s.z&&this.x===s.x&&this.y===s.y}url(s,l,d){const f=(x=this.y,C=this.z,S=_h(256*(v=this.x),256*(x=Math.pow(2,C)-x-1),C),T=_h(256*(v+1),256*(x+1),C),S[0]+","+S[1]+","+T[0]+","+T[1]);var v,x,C,S,T;const O=function(L,B,j){let $,K="";for(let Q=L;Q>0;Q--)$=1<<Q-1,K+=(B&$?1:0)+(j&$?2:0);return K}(this.z,this.x,this.y);return s[(this.x+this.y)%s.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String("tms"===d?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,l>1?"@2x":"").replace(/{quadkey}/g,O).replace(/{bbox-epsg-3857}/g,f)}isChildOf(s){const l=this.z-s.z;return l>0&&s.x===this.x>>l&&s.y===this.y>>l}getTilePoint(s){const l=Math.pow(2,this.z);return new yt((s.x*l-this.x)*Xn,(s.y*l-this.y)*Xn)}toString(){return`${this.z}/${this.x}/${this.y}`}}class nv{constructor(s,l){this.wrap=s,this.canonical=l,this.key=yh(s,l.z,l.z,l.x,l.y)}}class Wr{constructor(s,l,d,f,v){if(s<d)throw new Error(`overscaledZ should be >= z; overscaledZ = ${s}; z = ${d}`);this.overscaledZ=s,this.wrap=l,this.canonical=new Cg(d,+f,+v),this.key=yh(l,s,d,f,v)}clone(){return new Wr(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(s){return this.overscaledZ===s.overscaledZ&&this.wrap===s.wrap&&this.canonical.equals(s.canonical)}scaledTo(s){if(s>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${s}; overscaledZ = ${this.overscaledZ}`);const l=this.canonical.z-s;return s>this.canonical.z?new Wr(s,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Wr(s,this.wrap,s,this.canonical.x>>l,this.canonical.y>>l)}calculateScaledKey(s,l){if(s>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${s}; overscaledZ = ${this.overscaledZ}`);const d=this.canonical.z-s;return s>this.canonical.z?yh(this.wrap*+l,s,this.canonical.z,this.canonical.x,this.canonical.y):yh(this.wrap*+l,s,s,this.canonical.x>>d,this.canonical.y>>d)}isChildOf(s){if(s.wrap!==this.wrap)return!1;const l=this.canonical.z-s.canonical.z;return 0===s.overscaledZ||s.overscaledZ<this.overscaledZ&&s.canonical.x===this.canonical.x>>l&&s.canonical.y===this.canonical.y>>l}children(s){if(this.overscaledZ>=s)return[new Wr(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const l=this.canonical.z+1,d=2*this.canonical.x,f=2*this.canonical.y;return[new Wr(l,this.wrap,l,d,f),new Wr(l,this.wrap,l,d+1,f),new Wr(l,this.wrap,l,d,f+1),new Wr(l,this.wrap,l,d+1,f+1)]}isLessThan(s){return this.wrap<s.wrap||!(this.wrap>s.wrap)&&(this.overscaledZ<s.overscaledZ||!(this.overscaledZ>s.overscaledZ)&&(this.canonical.x<s.canonical.x||!(this.canonical.x>s.canonical.x)&&this.canonical.y<s.canonical.y))}wrapped(){return new Wr(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(s){return new Wr(this.overscaledZ,s,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new nv(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(s){return this.canonical.getTilePoint(new gh(s.x-this.wrap,s.y))}}function yh(a,s,l,d,f){(a*=2)<0&&(a=-1*a-1);const v=1<<l;return(v*v*a+v*f+d).toString(36)+l.toString(36)+s.toString(36)}Je("CanonicalTileID",Cg),Je("OverscaledTileID",Wr,{omit:["posMatrix"]});class iv{constructor(s,l,d){if(this.uid=s,l.height!==l.width)throw new RangeError("DEM tiles must be square");if(d&&"mapbox"!==d&&"terrarium"!==d)return void Zi(`"${d}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=l.height;const f=this.dim=l.height-2;this.data=new Uint32Array(l.data.buffer),this.encoding=d||"mapbox";for(let v=0;v<f;v++)this.data[this._idx(-1,v)]=this.data[this._idx(0,v)],this.data[this._idx(f,v)]=this.data[this._idx(f-1,v)],this.data[this._idx(v,-1)]=this.data[this._idx(v,0)],this.data[this._idx(v,f)]=this.data[this._idx(v,f-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(f,-1)]=this.data[this._idx(f-1,0)],this.data[this._idx(-1,f)]=this.data[this._idx(0,f-1)],this.data[this._idx(f,f)]=this.data[this._idx(f-1,f-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let v=0;v<f;v++)for(let x=0;x<f;x++){const C=this.get(v,x);C>this.max&&(this.max=C),C<this.min&&(this.min=C)}}get(s,l){const d=new Uint8Array(this.data.buffer),f=4*this._idx(s,l);return("terrarium"===this.encoding?this._unpackTerrarium:this._unpackMapbox)(d[f],d[f+1],d[f+2])}getUnpackVector(){return"terrarium"===this.encoding?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]}_idx(s,l){if(s<-1||s>=this.dim+1||l<-1||l>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(l+1)*this.stride+(s+1)}_unpackMapbox(s,l,d){return(256*s*256+256*l+d)/10-1e4}_unpackTerrarium(s,l,d){return 256*s+l+d/256-32768}getPixels(){return new us({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(s,l,d){if(this.dim!==s.dim)throw new Error("dem dimension mismatch");let f=l*this.dim,v=l*this.dim+this.dim,x=d*this.dim,C=d*this.dim+this.dim;switch(l){case-1:f=v-1;break;case 1:v=f+1}switch(d){case-1:x=C-1;break;case 1:C=x+1}const S=-l*this.dim,T=-d*this.dim;for(let O=x;O<C;O++)for(let L=f;L<v;L++)this.data[this._idx(L,O)]=s.data[this._idx(L+S,O+T)]}}Je("DEMData",iv);class rv{constructor(s){this._stringToNumber={},this._numberToString=[];for(let l=0;l<s.length;l++){const d=s[l];this._stringToNumber[d]=l,this._numberToString[l]=d}}encode(s){return this._stringToNumber[s]}decode(s){if(s>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${s} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[s]}}class sv{constructor(s,l,d,f,v){this.type="Feature",this._vectorTileFeature=s,s._z=l,s._x=d,s._y=f,this.properties=s.properties,this.id=v}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(s){this._geometry=s}toJSON(){const s={geometry:this.geometry};for(const l in this)"_geometry"!==l&&"_vectorTileFeature"!==l&&(s[l]=this[l]);return s}}class ov{constructor(s,l){this.tileID=s,this.x=s.canonical.x,this.y=s.canonical.y,this.z=s.canonical.z,this.grid=new ql(Xn,16,0),this.grid3D=new ql(Xn,16,0),this.featureIndexArray=new le,this.promoteId=l}insert(s,l,d,f,v,x){const C=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(d,f,v);const S=x?this.grid3D:this.grid;for(let T=0;T<l.length;T++){const O=l[T],L=[1/0,1/0,-1/0,-1/0];for(let B=0;B<O.length;B++){const j=O[B];L[0]=Math.min(L[0],j.x),L[1]=Math.min(L[1],j.y),L[2]=Math.max(L[2],j.x),L[3]=Math.max(L[3],j.y)}L[0]<Xn&&L[1]<Xn&&L[2]>=0&&L[3]>=0&&S.insert(C,L[0],L[1],L[2],L[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new vo.VectorTile(new dg(this.rawTileData)).layers,this.sourceLayerCoder=new rv(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(s,l,d,f){this.loadVTLayers();const v=s.params||{},x=Xn/s.tileSize/s.scale,C=Lc(v.filter),S=s.queryGeometry,T=s.queryPadding*x,O=cd(S),L=this.grid.query(O.minX-T,O.minY-T,O.maxX+T,O.maxY+T),B=cd(s.cameraQueryGeometry),j=this.grid3D.query(B.minX-T,B.minY-T,B.maxX+T,B.maxY+T,(Q,ne,de,oe)=>function(pe,_e,Me,Ze,it){for(const je of pe)if(_e<=je.x&&Me<=je.y&&Ze>=je.x&&it>=je.y)return!0;const qe=[new yt(_e,Me),new yt(_e,it),new yt(Ze,it),new yt(Ze,Me)];if(pe.length>2)for(const je of qe)if(xn(pe,je))return!0;for(let je=0;je<pe.length-1;je++)if(Fp(pe[je],pe[je+1],qe))return!0;return!1}(s.cameraQueryGeometry,Q-T,ne-T,de+T,oe+T));for(const Q of j)L.push(Q);L.sort(vh);const $={};let K;for(let Q=0;Q<L.length;Q++){const ne=L[Q];if(ne===K)continue;K=ne;const de=this.featureIndexArray.get(ne);let oe=null;this.loadMatchingFeature($,de.bucketIndex,de.sourceLayerIndex,de.featureIndex,C,v.layers,v.availableImages,l,d,f,(pe,_e,Me)=>(oe||(oe=yo(pe)),_e.queryIntersectsFeature(S,pe,Me,oe,this.z,s.transform,x,s.pixelPosMatrix)))}return $}loadMatchingFeature(s,l,d,f,v,x,C,S,T,O,L){const B=this.bucketLayerIDs[l];if(x&&!function(Q,ne){for(let de=0;de<Q.length;de++)if(ne.indexOf(Q[de])>=0)return!0;return!1}(x,B))return;const j=this.sourceLayerCoder.decode(d),$=this.vtLayers[j].feature(f);if(v.needGeometry){const Q=Bn($,!0);if(!v.filter(new Kt(this.tileID.overscaledZ),Q,this.tileID.canonical))return}else if(!v.filter(new Kt(this.tileID.overscaledZ),$))return;const K=this.getId($,j);for(let Q=0;Q<B.length;Q++){const ne=B[Q];if(x&&x.indexOf(ne)<0)continue;const de=S[ne];if(!de)continue;let oe={};K&&O&&(oe=O.getState(de.sourceLayer||"_geojsonTileLayer",K));const pe=qi({},T[ne]);pe.paint=Eg(pe.paint,de.paint,$,oe,C),pe.layout=Eg(pe.layout,de.layout,$,oe,C);const _e=!L||L($,de,oe);if(!_e)continue;const Me=new sv($,this.z,this.x,this.y,K);Me.layer=pe;let Ze=s[ne];void 0===Ze&&(Ze=s[ne]=[]),Ze.push({featureIndex:f,feature:Me,intersectionZ:_e})}}lookupSymbolFeatures(s,l,d,f,v,x,C,S){const T={};this.loadVTLayers();const O=Lc(v);for(const L of s)this.loadMatchingFeature(T,d,f,L,O,x,C,S,l);return T}hasLayer(s){for(const l of this.bucketLayerIDs)for(const d of l)if(s===d)return!0;return!1}getId(s,l){let d=s.id;return this.promoteId&&(d=s.properties["string"==typeof this.promoteId?this.promoteId:this.promoteId[l]],"boolean"==typeof d&&(d=Number(d))),d}}function Eg(a,s,l,d,f){return gs(a,(v,x)=>{const C=s instanceof fo?s.get(x):null;return C&&C.evaluate?C.evaluate(l,d,f):C})}function cd(a){let s=1/0,l=1/0,d=-1/0,f=-1/0;for(const v of a)s=Math.min(s,v.x),l=Math.min(l,v.y),d=Math.max(d,v.x),f=Math.max(f,v.y);return{minX:s,minY:l,maxX:d,maxY:f}}function vh(a,s){return s-a}function hf(a,s,l,d,f){const v=[];for(let x=0;x<a.length;x++){const C=a[x];let S;for(let T=0;T<C.length-1;T++){let O=C[T],L=C[T+1];O.x<s&&L.x<s||(O.x<s?O=new yt(s,O.y+(s-O.x)/(L.x-O.x)*(L.y-O.y))._round():L.x<s&&(L=new yt(s,O.y+(s-O.x)/(L.x-O.x)*(L.y-O.y))._round()),O.y<l&&L.y<l||(O.y<l?O=new yt(O.x+(l-O.y)/(L.y-O.y)*(L.x-O.x),l)._round():L.y<l&&(L=new yt(O.x+(l-O.y)/(L.y-O.y)*(L.x-O.x),l)._round()),O.x>=d&&L.x>=d||(O.x>=d?O=new yt(d,O.y+(d-O.x)/(L.x-O.x)*(L.y-O.y))._round():L.x>=d&&(L=new yt(d,O.y+(d-O.x)/(L.x-O.x)*(L.y-O.y))._round()),O.y>=f&&L.y>=f||(O.y>=f?O=new yt(O.x+(f-O.y)/(L.y-O.y)*(L.x-O.x),f)._round():L.y>=f&&(L=new yt(O.x+(f-O.y)/(L.y-O.y)*(L.x-O.x),f)._round()),S&&O.equals(S[S.length-1])||(S=[O],v.push(S)),S.push(L)))))}}return v}Je("FeatureIndex",ov,{omit:["rawTileData","sourceLayerCoder"]});class Ra extends yt{constructor(s,l,d,f){super(s,l),this.angle=d,void 0!==f&&(this.segment=f)}clone(){return new Ra(this.x,this.y,this.angle,this.segment)}}function pf(a,s,l,d,f){if(void 0===s.segment||0===l)return!0;let v=s,x=s.segment+1,C=0;for(;C>-l/2;){if(x--,x<0)return!1;C-=a[x].dist(v),v=a[x]}C+=a[x].dist(a[x+1]),x++;const S=[];let T=0;for(;C<l/2;){const O=a[x],L=a[x+1];if(!L)return!1;let B=a[x-1].angleTo(O)-O.angleTo(L);for(B=Math.abs((B+3*Math.PI)%(2*Math.PI)-Math.PI),S.push({distance:C,angleDelta:B}),T+=B;C-S[0].distance>d;)T-=S.shift().angleDelta;if(T>f)return!1;x++,C+=O.dist(L)}return!0}function ac(a){let s=0;for(let l=0;l<a.length-1;l++)s+=a[l].dist(a[l+1]);return s}function ff(a,s,l){return a?.6*s*l:0}function mf(a,s){return Math.max(a?a.right-a.left:0,s?s.right-s.left:0)}function bh(a,s,l,d,f,v){const x=ff(l,f,v),C=mf(l,d)*v;let S=0;const T=ac(a)/2;for(let O=0;O<a.length-1;O++){const L=a[O],B=a[O+1],j=L.dist(B);if(S+j>T){const $=(T-S)/j,K=ss.number(L.x,B.x,$),Q=ss.number(L.y,B.y,$),ne=new Ra(K,Q,B.angleTo(L),O);return ne._round(),!x||pf(a,ne,C,x,s)?ne:void 0}S+=j}}function xh(a,s,l,d,f,v,x,C,S){const T=ff(d,v,x),O=mf(d,f),L=O*x,B=0===a[0].x||a[0].x===S||0===a[0].y||a[0].y===S;return s-L<s/4&&(s=L+s/4),Oa(a,B?s/2*C%s:(O/2+2*v)*x*C%s,s,T,l,L,B,!1,S)}function Oa(a,s,l,d,f,v,x,C,S){const T=v/2,O=ac(a);let L=0,B=s-l,j=[];for(let $=0;$<a.length-1;$++){const K=a[$],Q=a[$+1],ne=K.dist(Q),de=Q.angleTo(K);for(;B+l<L+ne;){B+=l;const oe=(B-L)/ne,pe=ss.number(K.x,Q.x,oe),_e=ss.number(K.y,Q.y,oe);if(pe>=0&&pe<S&&_e>=0&&_e<S&&B-T>=0&&B+T<=O){const Me=new Ra(pe,_e,de,$);Me._round(),d&&!pf(a,Me,v,d,f)||j.push(Me)}}L+=ne}return C||j.length||x||(j=Oa(a,L/2,l,d,f,v,x,!0,S)),j}Je("Anchor",Ra);const ou=Zr;function Dg(a,s,l,d){const f=[],v=a.image,x=v.pixelRatio,C=v.paddedRect.w-2*ou,S=v.paddedRect.h-2*ou,T=a.right-a.left,O=a.bottom-a.top,L=v.stretchX||[[0,C]],B=v.stretchY||[[0,S]],j=(Ne,et)=>Ne+et[1]-et[0],$=L.reduce(j,0),K=B.reduce(j,0),Q=C-$,ne=S-K;let de=0,oe=$,pe=0,_e=K,Me=0,Ze=Q,it=0,qe=ne;if(v.content&&d){const Ne=v.content;de=wh(L,0,Ne[0]),pe=wh(B,0,Ne[1]),oe=wh(L,Ne[0],Ne[2]),_e=wh(B,Ne[1],Ne[3]),Me=Ne[0]-de,it=Ne[1]-pe,Ze=Ne[2]-Ne[0]-oe,qe=Ne[3]-Ne[1]-_e}const je=(Ne,et,ze,Oe)=>{const ut=au(Ne.stretch-de,oe,T,a.left),st=Ch(Ne.fixed-Me,Ze,Ne.stretch,$),Nt=au(et.stretch-pe,_e,O,a.top),Mn=Ch(et.fixed-it,qe,et.stretch,K),Tn=au(ze.stretch-de,oe,T,a.left),Ei=Ch(ze.fixed-Me,Ze,ze.stretch,$),Nr=au(Oe.stretch-pe,_e,O,a.top),ji=Ch(Oe.fixed-it,qe,Oe.stretch,K),Di=new yt(ut,Nt),Ri=new yt(Tn,Nt),ur=new yt(Tn,Nr),Xr=new yt(ut,Nr),zr=new yt(st/x,Mn/x),_i=new yt(Ei/x,ji/x),Ii=s*Math.PI/180;if(Ii){const Hi=Math.sin(Ii),Kr=Math.cos(Ii),oi=[Kr,-Hi,Hi,Kr];Di._matMult(oi),Ri._matMult(oi),Xr._matMult(oi),ur._matMult(oi)}const $i=Ne.stretch+Ne.fixed,dr=et.stretch+et.fixed;return{tl:Di,tr:Ri,bl:Xr,br:ur,tex:{x:v.paddedRect.x+ou+$i,y:v.paddedRect.y+ou+dr,w:ze.stretch+ze.fixed-$i,h:Oe.stretch+Oe.fixed-dr},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:zr,pixelOffsetBR:_i,minFontScaleX:Ze/x/T,minFontScaleY:qe/x/O,isSDF:l}};if(d&&(v.stretchX||v.stretchY)){const Ne=gf(L,Q,$),et=gf(B,ne,K);for(let ze=0;ze<Ne.length-1;ze++){const Oe=Ne[ze],ut=Ne[ze+1];for(let st=0;st<et.length-1;st++)f.push(je(Oe,et[st],ut,et[st+1]))}}else f.push(je({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:C+1},{fixed:0,stretch:S+1}));return f}function wh(a,s,l){let d=0;for(const f of a)d+=Math.max(s,Math.min(l,f[1]))-Math.max(s,Math.min(l,f[0]));return d}function gf(a,s,l){const d=[{fixed:-ou,stretch:0}];for(const[f,v]of a){const x=d[d.length-1];d.push({fixed:f-x.stretch,stretch:x.stretch}),d.push({fixed:f-x.stretch,stretch:x.stretch+(v-f)})}return d.push({fixed:s+ou,stretch:l}),d}function au(a,s,l,d){return a/s*l+d}function Ch(a,s,l,d){return a-s*l/d}class Eh{constructor(s,l,d,f,v,x,C,S,T,O){if(this.boxStartIndex=s.length,T){let L=x.top,B=x.bottom;const j=x.collisionPadding;j&&(L-=j[1],B+=j[3]);let $=B-L;$>0&&($=Math.max(10,$),this.circleDiameter=$)}else{let L=x.top*C-S[0],B=x.bottom*C+S[2],j=x.left*C-S[3],$=x.right*C+S[1];const K=x.collisionPadding;if(K&&(j-=K[0]*C,L-=K[1]*C,$+=K[2]*C,B+=K[3]*C),O){const Q=new yt(j,L),ne=new yt($,L),de=new yt(j,B),oe=new yt($,B),pe=O*Math.PI/180;Q._rotate(pe),ne._rotate(pe),de._rotate(pe),oe._rotate(pe),j=Math.min(Q.x,ne.x,de.x,oe.x),$=Math.max(Q.x,ne.x,de.x,oe.x),L=Math.min(Q.y,ne.y,de.y,oe.y),B=Math.max(Q.y,ne.y,de.y,oe.y)}s.emplaceBack(l.x,l.y,j,L,$,B,d,f,v)}this.boxEndIndex=s.length}}class av{constructor(s=[],l=Ig){if(this.data=s,this.length=this.data.length,this.compare=l,this.length>0)for(let d=(this.length>>1)-1;d>=0;d--)this._down(d)}push(s){this.data.push(s),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const s=this.data[0],l=this.data.pop();return this.length--,this.length>0&&(this.data[0]=l,this._down(0)),s}peek(){return this.data[0]}_up(s){const{data:l,compare:d}=this,f=l[s];for(;s>0;){const v=s-1>>1,x=l[v];if(d(f,x)>=0)break;l[s]=x,s=v}l[s]=f}_down(s){const{data:l,compare:d}=this,f=this.length>>1,v=l[s];for(;s<f;){let x=1+(s<<1),C=l[x];const S=x+1;if(S<this.length&&d(l[S],C)<0&&(x=S,C=l[S]),d(C,v)>=0)break;l[s]=C,s=x}l[s]=v}}function Ig(a,s){return a<s?-1:a>s?1:0}function lv(a,s=1,l=!1){let d=1/0,f=1/0,v=-1/0,x=-1/0;const C=a[0];for(let j=0;j<C.length;j++){const $=C[j];(!j||$.x<d)&&(d=$.x),(!j||$.y<f)&&(f=$.y),(!j||$.x>v)&&(v=$.x),(!j||$.y>x)&&(x=$.y)}const S=Math.min(v-d,x-f);let T=S/2;const O=new av([],cv);if(0===S)return new yt(d,f);for(let j=d;j<v;j+=S)for(let $=f;$<x;$+=S)O.push(new ir(j+T,$+T,T,a));let L=function(j){let $=0,K=0,Q=0;const ne=j[0];for(let de=0,oe=ne.length,pe=oe-1;de<oe;pe=de++){const _e=ne[de],Me=ne[pe],Ze=_e.x*Me.y-Me.x*_e.y;K+=(_e.x+Me.x)*Ze,Q+=(_e.y+Me.y)*Ze,$+=3*Ze}return new ir(K/$,Q/$,0,j)}(a),B=O.length;for(;O.length;){const j=O.pop();(j.d>L.d||!L.d)&&(L=j,l&&console.log("found best %d after %d probes",Math.round(1e4*j.d)/1e4,B)),j.max-L.d<=s||(T=j.h/2,O.push(new ir(j.p.x-T,j.p.y-T,T,a)),O.push(new ir(j.p.x+T,j.p.y-T,T,a)),O.push(new ir(j.p.x-T,j.p.y+T,T,a)),O.push(new ir(j.p.x+T,j.p.y+T,T,a)),B+=4)}return l&&(console.log(`num probes: ${B}`),console.log(`best distance: ${L.d}`)),L.p}function cv(a,s){return s.max-a.max}function ir(a,s,l,d){this.p=new yt(a,s),this.h=l,this.d=function(f,v){let x=!1,C=1/0;for(let S=0;S<v.length;S++){const T=v[S];for(let O=0,L=T.length,B=L-1;O<L;B=O++){const j=T[O],$=T[B];j.y>f.y!=$.y>f.y&&f.x<($.x-j.x)*(f.y-j.y)/($.y-j.y)+j.x&&(x=!x),C=Math.min(C,Rp(f,j,$))}}return(x?1:-1)*Math.sqrt(C)}(this.p,d),this.max=this.d+this.h*Math.SQRT2}var Ui;g.TextAnchorEnum=void 0,(Ui=g.TextAnchorEnum||(g.TextAnchorEnum={}))[Ui.center=1]="center",Ui[Ui.left=2]="left",Ui[Ui.right=3]="right",Ui[Ui.top=4]="top",Ui[Ui.bottom=5]="bottom",Ui[Ui["top-left"]=6]="top-left",Ui[Ui["top-right"]=7]="top-right",Ui[Ui["bottom-left"]=8]="bottom-left",Ui[Ui["bottom-right"]=9]="bottom-right";const Fa=7,ud=Number.POSITIVE_INFINITY;function Ir(a,s){return s[1]!==ud?function(l,d,f){let v=0,x=0;switch(d=Math.abs(d),f=Math.abs(f),l){case"top-right":case"top-left":case"top":x=f-Fa;break;case"bottom-right":case"bottom-left":case"bottom":x=-f+Fa}switch(l){case"top-right":case"bottom-right":case"right":v=-d;break;case"top-left":case"bottom-left":case"left":v=d}return[v,x]}(a,s[0],s[1]):function(l,d){let f=0,v=0;d<0&&(d=0);const x=d/Math.SQRT2;switch(l){case"top-right":case"top-left":v=x-Fa;break;case"bottom-right":case"bottom-left":v=-x+Fa;break;case"bottom":v=-d+Fa;break;case"top":v=d-Fa}switch(l){case"top-right":case"bottom-right":f=-x;break;case"top-left":case"bottom-left":f=x;break;case"left":f=d;break;case"right":f=-d}return[f,v]}(a,s[0])}function lu(a,s,l){var d;const f=a.layout,v=null===(d=f.get("text-variable-anchor-offset"))||void 0===d?void 0:d.evaluate(s,{},l);if(v){const C=v.values,S=[];for(let T=0;T<C.length;T+=2){const O=S[T]=C[T],L=C[T+1].map(B=>B*Pi);O.startsWith("top")?L[1]-=Fa:O.startsWith("bottom")&&(L[1]+=Fa),S[T+1]=L}return new Ki(S)}const x=f.get("text-variable-anchor");if(x){let C;C=void 0!==a._unevaluatedLayout.getValue("text-radial-offset")?[f.get("text-radial-offset").evaluate(s,{},l)*Pi,ud]:f.get("text-offset").evaluate(s,{},l).map(T=>T*Pi);const S=[];for(const T of x)S.push(T,Ir(T,C));return new Ki(S)}return null}function Dh(a){switch(a){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Sg(a,s,l,d,f,v,x,C,S,T,O){let L=v.textMaxSize.evaluate(s,{});void 0===L&&(L=x);const B=a.layers[0].layout,j=B.get("icon-offset").evaluate(s,{},O),$=_f(l.horizontal),K=x/24,Q=a.tilePixelRatio*K,ne=a.tilePixelRatio*L/24,de=a.tilePixelRatio*C,oe=a.tilePixelRatio*B.get("symbol-spacing"),pe=B.get("text-padding")*a.tilePixelRatio,_e=function(Oe,ut,st,Nt=1){const Mn=Oe.get("icon-padding").evaluate(ut,{},st),Tn=Mn&&Mn.values;return[Tn[0]*Nt,Tn[1]*Nt,Tn[2]*Nt,Tn[3]*Nt]}(B,s,O,a.tilePixelRatio),Me=B.get("text-max-angle")/180*Math.PI,Ze="viewport"!==B.get("text-rotation-alignment")&&"point"!==B.get("symbol-placement"),it="map"===B.get("icon-rotation-alignment")&&"point"!==B.get("symbol-placement"),qe=B.get("symbol-placement"),je=oe/2,Ne=B.get("icon-text-fit");let et;d&&"none"!==Ne&&(a.allowVerticalPlacement&&l.vertical&&(et=_g(d,l.vertical,Ne,B.get("icon-text-fit-padding"),j,K)),$&&(d=_g(d,$,Ne,B.get("icon-text-fit-padding"),j,K)));const ze=(Oe,ut)=>{ut.x<0||ut.x>=Xn||ut.y<0||ut.y>=Xn||function(st,Nt,Mn,Tn,Ei,Nr,ji,Di,Ri,ur,Xr,zr,_i,Ii,$i,dr,Hi,Kr,oi,Sr,$t,Br,hr,Oi,Yr){const Ss=st.addToLineVertexArray(Nt,Mn);let Js,Jo,Ms,ds,Jr=0,La=0,fd=0,kg=0,wf=-1,Qo=-1;const Ts={};let Pg=Ws("");if(st.allowVerticalPlacement&&Tn.vertical){const pr=Di.layout.get("text-rotate").evaluate($t,{},Oi)+90;Ms=new Eh(Ri,Nt,ur,Xr,zr,Tn.vertical,_i,Ii,$i,pr),ji&&(ds=new Eh(Ri,Nt,ur,Xr,zr,ji,Hi,Kr,$i,pr))}if(Ei){const pr=Di.layout.get("icon-rotate").evaluate($t,{}),Qs="none"!==Di.layout.get("icon-text-fit"),uu=Dg(Ei,pr,hr,Qs),ta=ji?Dg(ji,pr,hr,Qs):void 0;Jo=new Eh(Ri,Nt,ur,Xr,zr,Ei,Hi,Kr,!1,pr),Jr=4*uu.length;const Na=st.iconSizeData;let eo=null;"source"===Na.kind?(eo=[Yo*Di.layout.get("icon-size").evaluate($t,{})],eo[0]>wl&&Zi(`${st.layerIds[0]}: Value for "icon-size" is >= ${ad}. Reduce your "icon-size".`)):"composite"===Na.kind&&(eo=[Yo*Br.compositeIconSizes[0].evaluate($t,{},Oi),Yo*Br.compositeIconSizes[1].evaluate($t,{},Oi)],(eo[0]>wl||eo[1]>wl)&&Zi(`${st.layerIds[0]}: Value for "icon-size" is >= ${ad}. Reduce your "icon-size".`)),st.addSymbols(st.icon,uu,eo,Sr,oi,$t,g.WritingMode.none,Nt,Ss.lineStartIndex,Ss.lineLength,-1,Oi),wf=st.icon.placedSymbolArray.length-1,ta&&(La=4*ta.length,st.addSymbols(st.icon,ta,eo,Sr,oi,$t,g.WritingMode.vertical,Nt,Ss.lineStartIndex,Ss.lineLength,-1,Oi),Qo=st.icon.placedSymbolArray.length-1)}const dv=Object.keys(Tn.horizontal);for(const pr of dv){const Qs=Tn.horizontal[pr];if(!Js){Pg=Ws(Qs.text);const ta=Di.layout.get("text-rotate").evaluate($t,{},Oi);Js=new Eh(Ri,Nt,ur,Xr,zr,Qs,_i,Ii,$i,ta)}const uu=1===Qs.positionedLines.length;if(fd+=Mg(st,Nt,Qs,Nr,Di,$i,$t,dr,Ss,Tn.vertical?g.WritingMode.horizontal:g.WritingMode.horizontalOnly,uu?dv:[pr],Ts,wf,Br,Oi),uu)break}Tn.vertical&&(kg+=Mg(st,Nt,Tn.vertical,Nr,Di,$i,$t,dr,Ss,g.WritingMode.vertical,["vertical"],Ts,Qo,Br,Oi));const Gx=Js?Js.boxStartIndex:st.collisionBoxArray.length,qx=Js?Js.boxEndIndex:st.collisionBoxArray.length,Zx=Ms?Ms.boxStartIndex:st.collisionBoxArray.length,Wx=Ms?Ms.boxEndIndex:st.collisionBoxArray.length,Rg=Jo?Jo.boxStartIndex:st.collisionBoxArray.length,hv=Jo?Jo.boxEndIndex:st.collisionBoxArray.length,pv=ds?ds.boxStartIndex:st.collisionBoxArray.length,fv=ds?ds.boxEndIndex:st.collisionBoxArray.length;let wo=-1;const cu=(pr,Qs)=>pr&&pr.circleDiameter?Math.max(pr.circleDiameter,Qs):Qs;wo=cu(Js,wo),wo=cu(Ms,wo),wo=cu(Jo,wo),wo=cu(ds,wo);const ea=wo>-1?1:0;ea&&(wo*=Yr/Pi),st.glyphOffsetArray.length>=ka.MAX_GLYPHS&&Zi("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==$t.sortKey&&st.addToSortKeyRanges(st.symbolInstances.length,$t.sortKey);const md=lu(Di,$t,Oi),[Og,Fg]=function(pr,Qs){const uu=pr.length,ta=Qs?.values;if(ta?.length>0)for(let Na=0;Na<ta.length;Na+=2){const eo=ta[Na+1];pr.emplaceBack(g.TextAnchorEnum[ta[Na]],eo[0],eo[1])}return[uu,pr.length]}(st.textAnchorOffsets,md);st.symbolInstances.emplaceBack(Nt.x,Nt.y,Ts.right>=0?Ts.right:-1,Ts.center>=0?Ts.center:-1,Ts.left>=0?Ts.left:-1,Ts.vertical||-1,wf,Qo,Pg,Gx,qx,Zx,Wx,Rg,hv,pv,fv,ur,fd,kg,Jr,La,ea,0,_i,wo,Og,Fg)}(a,ut,Oe,l,d,f,et,a.layers[0],a.collisionBoxArray,s.index,s.sourceLayerIndex,a.index,Q,[pe,pe,pe,pe],Ze,S,de,_e,it,j,s,v,T,O,x)};if("line"===qe)for(const Oe of hf(s.geometry,0,0,Xn,Xn)){const ut=xh(Oe,oe,Me,l.vertical||$,d,24,ne,a.overscaling,Xn);for(const st of ut)$&&uv(a,$.text,je,st)||ze(Oe,st)}else if("line-center"===qe){for(const Oe of s.geometry)if(Oe.length>1){const ut=bh(Oe,Me,l.vertical||$,d,24,ne);ut&&ze(Oe,ut)}}else if("Polygon"===s.type)for(const Oe of nd(s.geometry,0)){const ut=lv(Oe,16);ze(Oe[0],new Ra(ut.x,ut.y,0))}else if("LineString"===s.type)for(const Oe of s.geometry)ze(Oe,new Ra(Oe[0].x,Oe[0].y,0));else if("Point"===s.type)for(const Oe of s.geometry)for(const ut of Oe)ze([ut],new Ra(ut.x,ut.y,0))}function Mg(a,s,l,d,f,v,x,C,S,T,O,L,B,j,$){const K=function(de,oe,pe,_e,Me,Ze,it,qe){const je=_e.layout.get("text-rotate").evaluate(Ze,{})*Math.PI/180,Ne=[];for(const et of oe.positionedLines)for(const ze of et.positionedGlyphs){if(!ze.rect)continue;const Oe=ze.rect||{};let ut=pg+1,st=!0,Nt=1,Mn=0;const Tn=(Me||qe)&&ze.vertical,Ei=ze.metrics.advance*ze.scale/2;if(qe&&oe.verticalizable&&(Mn=et.lineOffset/2-(ze.imageName?-(Pi-ze.metrics.width*ze.scale)/2:(ze.scale-1)*Pi)),ze.imageName){const oi=it[ze.imageName];st=oi.sdf,Nt=oi.pixelRatio,ut=Zr/Nt}const Nr=Me?[ze.x+Ei,ze.y]:[0,0];let ji=Me?[0,0]:[ze.x+Ei+pe[0],ze.y+pe[1]-Mn],Di=[0,0];Tn&&(Di=ji,ji=[0,0]);const Ri=(ze.metrics.left-ut)*ze.scale-Ei+ji[0],ur=(-ze.metrics.top-ut)*ze.scale+ji[1],Xr=Ri+Oe.w*ze.scale/Nt,zr=ur+Oe.h*ze.scale/Nt,_i=new yt(Ri,ur),Ii=new yt(Xr,ur),$i=new yt(Ri,zr),dr=new yt(Xr,zr);if(Tn){const oi=new yt(-Ei,Ei-Ko),Sr=-Math.PI/2,$t=Pi/2-Ei,Br=new yt(5-Ko-$t,-(ze.imageName?$t:0)),hr=new yt(...Di);_i._rotateAround(Sr,oi)._add(Br)._add(hr),Ii._rotateAround(Sr,oi)._add(Br)._add(hr),$i._rotateAround(Sr,oi)._add(Br)._add(hr),dr._rotateAround(Sr,oi)._add(Br)._add(hr)}if(je){const oi=Math.sin(je),Sr=Math.cos(je),$t=[Sr,-oi,oi,Sr];_i._matMult($t),Ii._matMult($t),$i._matMult($t),dr._matMult($t)}const Hi=new yt(0,0),Kr=new yt(0,0);Ne.push({tl:_i,tr:Ii,bl:$i,br:dr,tex:Oe,writingMode:oe.writingMode,glyphOffset:Nr,sectionIndex:ze.sectionIndex,isSDF:st,pixelOffsetTL:Hi,pixelOffsetBR:Kr,minFontScaleX:0,minFontScaleY:0})}return Ne}(0,l,C,f,v,x,d,a.allowVerticalPlacement),Q=a.textSizeData;let ne=null;"source"===Q.kind?(ne=[Yo*f.layout.get("text-size").evaluate(x,{})],ne[0]>wl&&Zi(`${a.layerIds[0]}: Value for "text-size" is >= ${ad}. Reduce your "text-size".`)):"composite"===Q.kind&&(ne=[Yo*j.compositeTextSizes[0].evaluate(x,{},$),Yo*j.compositeTextSizes[1].evaluate(x,{},$)],(ne[0]>wl||ne[1]>wl)&&Zi(`${a.layerIds[0]}: Value for "text-size" is >= ${ad}. Reduce your "text-size".`)),a.addSymbols(a.text,K,ne,C,v,x,T,s,S.lineStartIndex,S.lineLength,B,$);for(const de of O)L[de]=a.text.placedSymbolArray.length-1;return 4*K.length}function _f(a){for(const s in a)return a[s];return null}function uv(a,s,l,d){const f=a.compareText;if(s in f){const v=f[s];for(let x=v.length-1;x>=0;x--)if(d.dist(v[x])<l)return!0}else f[s]=[];return f[s].push(d),!1}const yf=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class vf{static from(s){if(!(s instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[l,d]=new Uint8Array(s,0,2);if(219!==l)throw new Error("Data does not appear to be in a KDBush format.");const f=d>>4;if(1!==f)throw new Error(`Got v${f} data when expected v1.`);const v=yf[15&d];if(!v)throw new Error("Unrecognized array type.");const[x]=new Uint16Array(s,2,1),[C]=new Uint32Array(s,4,1);return new vf(C,x,v,s)}constructor(s,l=64,d=Float64Array,f){if(isNaN(s)||s<0)throw new Error(`Unpexpected numItems value: ${s}.`);this.numItems=+s,this.nodeSize=Math.min(Math.max(+l,2),65535),this.ArrayType=d,this.IndexArrayType=s<65536?Uint16Array:Uint32Array;const v=yf.indexOf(this.ArrayType),x=2*s*this.ArrayType.BYTES_PER_ELEMENT,C=s*this.IndexArrayType.BYTES_PER_ELEMENT,S=(8-C%8)%8;if(v<0)throw new Error(`Unexpected typed array class: ${d}.`);f&&f instanceof ArrayBuffer?(this.data=f,this.ids=new this.IndexArrayType(this.data,8,s),this.coords=new this.ArrayType(this.data,8+C+S,2*s),this._pos=2*s,this._finished=!0):(this.data=new ArrayBuffer(8+x+C+S),this.ids=new this.IndexArrayType(this.data,8,s),this.coords=new this.ArrayType(this.data,8+C+S,2*s),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+v]),new Uint16Array(this.data,2,1)[0]=l,new Uint32Array(this.data,4,1)[0]=s)}add(s,l){const d=this._pos>>1;return this.ids[d]=d,this.coords[this._pos++]=s,this.coords[this._pos++]=l,d}finish(){const s=this._pos>>1;if(s!==this.numItems)throw new Error(`Added ${s} items when expected ${this.numItems}.`);return Ih(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(s,l,d,f){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:v,coords:x,nodeSize:C}=this,S=[0,v.length-1,0],T=[];for(;S.length;){const O=S.pop()||0,L=S.pop()||0,B=S.pop()||0;if(L-B<=C){for(let Q=B;Q<=L;Q++){const ne=x[2*Q],de=x[2*Q+1];ne>=s&&ne<=d&&de>=l&&de<=f&&T.push(v[Q])}continue}const j=B+L>>1,$=x[2*j],K=x[2*j+1];$>=s&&$<=d&&K>=l&&K<=f&&T.push(v[j]),(0===O?s<=$:l<=K)&&(S.push(B),S.push(j-1),S.push(1-O)),(0===O?d>=$:f>=K)&&(S.push(j+1),S.push(L),S.push(1-O))}return T}within(s,l,d){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:f,coords:v,nodeSize:x}=this,C=[0,f.length-1,0],S=[],T=d*d;for(;C.length;){const O=C.pop()||0,L=C.pop()||0,B=C.pop()||0;if(L-B<=x){for(let Q=B;Q<=L;Q++)Sh(v[2*Q],v[2*Q+1],s,l)<=T&&S.push(f[Q]);continue}const j=B+L>>1,$=v[2*j],K=v[2*j+1];Sh($,K,s,l)<=T&&S.push(f[j]),(0===O?s-d<=$:l-d<=K)&&(C.push(B),C.push(j-1),C.push(1-O)),(0===O?s+d>=$:l+d>=K)&&(C.push(j+1),C.push(L),C.push(1-O))}return S}}function Ih(a,s,l,d,f,v){if(f-d<=l)return;const x=d+f>>1;Tg(a,s,x,d,f,v),Ih(a,s,l,d,x-1,1-v),Ih(a,s,l,x+1,f,1-v)}function Tg(a,s,l,d,f,v){for(;f>d;){if(f-d>600){const T=f-d+1,O=l-d+1,L=Math.log(T),B=.5*Math.exp(2*L/3),j=.5*Math.sqrt(L*B*(T-B)/T)*(O-T/2<0?-1:1);Tg(a,s,l,Math.max(d,Math.floor(l-O*B/T+j)),Math.min(f,Math.floor(l+(T-O)*B/T+j)),v)}const x=s[2*l+v];let C=d,S=f;for(dd(a,s,d,l),s[2*f+v]>x&&dd(a,s,d,f);C<S;){for(dd(a,s,C,S),C++,S--;s[2*C+v]<x;)C++;for(;s[2*S+v]>x;)S--}s[2*d+v]===x?dd(a,s,d,S):(S++,dd(a,s,S,f)),S<=l&&(d=S+1),l<=S&&(f=S-1)}}function dd(a,s,l,d){hd(a,l,d),hd(s,2*l,2*d),hd(s,2*l+1,2*d+1)}function hd(a,s,l){const d=a[s];a[s]=a[l],a[l]=d}function Sh(a,s,l,d){const f=a-l,v=s-d;return f*f+v*v}var bf;g.PerformanceMarkers=void 0,(bf=g.PerformanceMarkers||(g.PerformanceMarkers={})).create="create",bf.load="load",bf.fullLoad="fullLoad";let El=null,pd=[];const xf=1e3/60,Mh="loadTime",Th="fullLoadTime",Ag={mark(a){performance.mark(a)},frame(a){const s=a;null!=El&&pd.push(s-El),El=s},clearMetrics(){El=null,pd=[],performance.clearMeasures(Mh),performance.clearMeasures(Th);for(const a in g.PerformanceMarkers)performance.clearMarks(g.PerformanceMarkers[a])},getPerformanceMetrics(){performance.measure(Mh,g.PerformanceMarkers.create,g.PerformanceMarkers.load),performance.measure(Th,g.PerformanceMarkers.create,g.PerformanceMarkers.fullLoad);const a=performance.getEntriesByName(Mh)[0].duration,s=performance.getEntriesByName(Th)[0].duration,l=pd.length,d=1/(pd.reduce((v,x)=>v+x,0)/l/1e3),f=pd.filter(v=>v>xf).reduce((v,x)=>v+(x-xf)/xf,0);return{loadTime:a,fullLoadTime:s,fps:d,percentDroppedFrames:f/(l+f)*100,totalFrames:l}}};g.AJAXError=Ro,g.ARRAY_TYPE=$c,g.Actor=class{constructor(a,s,l){this.receive=d=>{const f=d.data,v=f.id;if(v&&(!f.targetMapId||this.mapId===f.targetMapId))if("<cancel>"===f.type){delete this.tasks[v];const x=this.cancelCallbacks[v];delete this.cancelCallbacks[v],x&&x()}else mr()||f.mustQueue?(this.tasks[v]=f,this.taskQueue.push(v),this.invoker.trigger()):this.processTask(v,f)},this.process=()=>{if(!this.taskQueue.length)return;const d=this.taskQueue.shift(),f=this.tasks[d];delete this.tasks[d],this.taskQueue.length&&this.invoker.trigger(),f&&this.processTask(d,f)},this.target=a,this.parent=s,this.mapId=l,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},this.invoker=new Qy(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=mr()?a:window}send(a,s,l,d,f=!1){const v=Math.round(1e18*Math.random()).toString(36).substring(0,10);l&&(this.callbacks[v]=l);const x=ko(this.globalScope)?void 0:[];return this.target.postMessage({id:v,type:a,hasCallback:!!l,targetMapId:d,mustQueue:f,sourceMapId:this.mapId,data:Zl(s,x)},x),{cancel:()=>{l&&delete this.callbacks[v],this.target.postMessage({id:v,type:"<cancel>",targetMapId:d,sourceMapId:this.mapId})}}}processTask(a,s){if("<response>"===s.type){const l=this.callbacks[a];delete this.callbacks[a],l&&(s.error?l(Nn(s.error)):l(null,Nn(s.data)))}else{let l=!1;const d=ko(this.globalScope)?void 0:[],f=s.hasCallback?(C,S)=>{l=!0,delete this.cancelCallbacks[a],this.target.postMessage({id:a,type:"<response>",sourceMapId:this.mapId,error:C?Zl(C):null,data:Zl(S,d)},d)}:C=>{l=!0};let v=null;const x=Nn(s.data);if(this.parent[s.type])v=this.parent[s.type](s.sourceMapId,x,f);else if(this.parent.getWorkerSource){const C=s.type.split(".");v=this.parent.getWorkerSource(s.sourceMapId,C[0],x.source)[C[1]](x,f)}else f(new Error(`Could not find function ${s.type}`));!l&&v&&v.cancel&&(this.cancelCallbacks[a]=v.cancel)}}remove(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)}},g.AlphaImage=ed,g.CanonicalTileID=Cg,g.CollisionBoxArray=D,g.CollisionCircleLayoutArray=class extends mo{},g.Color=gt,g.DEMData=iv,g.DataConstantProperty=lt,g.DictionaryCoder=rv,g.EXTENT=Xn,g.ErrorEvent=Ft,g.EvaluationParameters=Kt,g.Event=is,g.Evented=zs,g.FeatureIndex=ov,g.FillBucket=Sa,g.FillExtrusionBucket=Jm,g.GeoJSONFeature=sv,g.ImageAtlas=fg,g.ImagePosition=rc,g.KDBush=vf,g.LineBucket=Ys,g.LineStripIndexArray=class extends m{},g.LngLat=Pa,g.MercatorCoordinate=gh,g.ONE_EM=Pi,g.OverscaledTileID=Wr,g.PerformanceUtils=Ag,g.Point=yt,g.Pos3dArray=class extends ba{},g.PosArray=me,g.Properties=ei,g.Protobuf=dg,g.QuadTriangleArray=class extends Or{},g.RGBAImage=us,g.RasterBoundsArray=class extends gl{},g.RequestPerformance=class{constructor(a){this._marks={start:[a.url,"start"].join("#"),end:[a.url,"end"].join("#"),measure:a.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let a=performance.getEntriesByName(this._marks.measure);return 0===a.length&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),a=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),a}},g.SegmentVector=ht,g.SymbolBucket=ka,g.Transitionable=ya,g.TriangleIndexArray=dt,g.Uniform1f=Ci,g.Uniform1i=class extends wi{constructor(a,s){super(a,s),this.current=0}set(a){this.current!==a&&(this.current=a,this.gl.uniform1i(this.location,a))}},g.Uniform2f=class extends wi{constructor(a,s){super(a,s),this.current=[0,0]}set(a){a[0]===this.current[0]&&a[1]===this.current[1]||(this.current=a,this.gl.uniform2f(this.location,a[0],a[1]))}},g.Uniform3f=class extends wi{constructor(a,s){super(a,s),this.current=[0,0,0]}set(a){a[0]===this.current[0]&&a[1]===this.current[1]&&a[2]===this.current[2]||(this.current=a,this.gl.uniform3f(this.location,a[0],a[1],a[2]))}},g.Uniform4f=Bi,g.UniformColor=_l,g.UniformMatrix4f=class extends wi{constructor(a,s){super(a,s),this.current=mi}set(a){if(a[12]!==this.current[12]||a[0]!==this.current[0])return this.current=a,void this.gl.uniformMatrix4fv(this.location,!1,a);for(let s=1;s<16;s++)if(a[s]!==this.current[s]){this.current=a,this.gl.uniformMatrix4fv(this.location,!1,a);break}}},g.UnwrappedTileID=nv,g.ValidationError=Be,g.ZoomHistory=Xu,g.addDynamicAttributes=ru,g.arrayBufferToImage=function(a,s){const l=new Image;l.onload=()=>{s(null,l),URL.revokeObjectURL(l.src),l.onload=null,window.requestAnimationFrame(()=>{l.src=ts})},l.onerror=()=>s(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const d=new Blob([new Uint8Array(a)],{type:"image/png"});l.src=a.byteLength?URL.createObjectURL(d):ts},g.arrayBufferToImageBitmap=function(a,s){const l=new Blob([new Uint8Array(a)],{type:"image/png"});createImageBitmap(l).then(d=>{s(null,d)}).catch(d=>{s(new Error(`Could not load image because of ${d.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})},g.asyncAll=function(a,s,l){if(!a.length)return l(null,[]);let d=a.length;const f=new Array(a.length);let v=null;a.forEach((x,C)=>{s(x,(S,T)=>{S&&(v=S),f[C]=T,0==--d&&l(v,f)})})},g.bezier=Ao,g.browser=ca,g.clamp=Kn,g.clipLine=hf,g.clone=function(a){var s=new $c(16);return s[0]=a[0],s[1]=a[1],s[2]=a[2],s[3]=a[3],s[4]=a[4],s[5]=a[5],s[6]=a[6],s[7]=a[7],s[8]=a[8],s[9]=a[9],s[10]=a[10],s[11]=a[11],s[12]=a[12],s[13]=a[13],s[14]=a[14],s[15]=a[15],s},g.clone$1=Pr,g.collisionCircleLayout=jy,g.config=Ln,g.copy=function(a,s){return a[0]=s[0],a[1]=s[1],a[2]=s[2],a[3]=s[3],a[4]=s[4],a[5]=s[5],a[6]=s[6],a[7]=s[7],a[8]=s[8],a[9]=s[9],a[10]=s[10],a[11]=s[11],a[12]=s[12],a[13]=s[13],a[14]=s[14],a[15]=s[15],a},g.create=function(){var a=new $c(16);return $c!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=0,a[12]=0,a[13]=0,a[14]=0),a[0]=1,a[5]=1,a[10]=1,a[15]=1,a},g.createExpression=jt,g.createFilter=Lc,g.createLayout=Un,g.createStyleLayer=function(a){if("custom"===a.type)return new Jy(a);switch(a.type){case"background":return new bg(a);case"circle":return new zm(a);case"fill":return new Fy(a);case"fill-extrusion":return new Kp(a);case"heatmap":return new My(a);case"hillshade":return new Ay(a);case"line":return new Jp(a);case"raster":return new Yy(a);case"symbol":return new Cl(a)}},g.deepEqual=function a(s,l){if(Array.isArray(s)){if(!Array.isArray(l)||s.length!==l.length)return!1;for(let d=0;d<s.length;d++)if(!a(s[d],l[d]))return!1;return!0}if("object"==typeof s&&null!==s&&null!==l){if("object"!=typeof l||Object.keys(s).length!==Object.keys(l).length)return!1;for(const d in s)if(!a(s[d],l[d]))return!1;return!0}return s===l},g.defaultEasing=Ur,g.derefLayers=function(a){a=a.slice();const s=Object.create(null);for(let l=0;l<a.length;l++)s[a[l].id]=a[l];for(let l=0;l<a.length;l++)"ref"in a[l]&&(a[l]=Ya(a[l],s[a[l].ref]));return a},g.diffStyles=function(a,s){if(!a)return[{command:on.setStyle,args:[s]}];let l=[];try{if(!yn(a.version,s.version))return[{command:on.setStyle,args:[s]}];yn(a.center,s.center)||l.push({command:on.setCenter,args:[s.center]}),yn(a.zoom,s.zoom)||l.push({command:on.setZoom,args:[s.zoom]}),yn(a.bearing,s.bearing)||l.push({command:on.setBearing,args:[s.bearing]}),yn(a.pitch,s.pitch)||l.push({command:on.setPitch,args:[s.pitch]}),yn(a.sprite,s.sprite)||l.push({command:on.setSprite,args:[s.sprite]}),yn(a.glyphs,s.glyphs)||l.push({command:on.setGlyphs,args:[s.glyphs]}),yn(a.transition,s.transition)||l.push({command:on.setTransition,args:[s.transition]}),yn(a.light,s.light)||l.push({command:on.setLight,args:[s.light]});const d={},f=[];!function(x,C,S,T){let O;for(O in C=C||{},x=x||{})Object.prototype.hasOwnProperty.call(x,O)&&(Object.prototype.hasOwnProperty.call(C,O)||Qa(O,S,T));for(O in C)Object.prototype.hasOwnProperty.call(C,O)&&(Object.prototype.hasOwnProperty.call(x,O)?yn(x[O],C[O])||("geojson"===x[O].type&&"geojson"===C[O].type&&Mu(x,C,O)?S.push({command:on.setGeoJSONSourceData,args:[O,C[O].data]}):Su(O,C,S,T)):Ja(O,C,S))}(a.sources,s.sources,f,d);const v=[];a.layers&&a.layers.forEach(x=>{d[x.source]?l.push({command:on.removeLayer,args:[x.id]}):v.push(x)}),l=l.concat(f),function(x,C,S){C=C||[];const T=(x=x||[]).map(el),O=C.map(el),L=x.reduce(tl,{}),B=C.reduce(tl,{}),j=T.slice(),$=Object.create(null);let K,Q,ne,de,oe,pe,_e;for(K=0,Q=0;K<T.length;K++)ne=T[K],Object.prototype.hasOwnProperty.call(B,ne)?Q++:(S.push({command:on.removeLayer,args:[ne]}),j.splice(j.indexOf(ne,Q),1));for(K=0,Q=0;K<O.length;K++)ne=O[O.length-1-K],j[j.length-1-K]!==ne&&(Object.prototype.hasOwnProperty.call(L,ne)?(S.push({command:on.removeLayer,args:[ne]}),j.splice(j.lastIndexOf(ne,j.length-Q),1)):Q++,pe=j[j.length-K],S.push({command:on.addLayer,args:[B[ne],pe]}),j.splice(j.length-K,0,ne),$[ne]=!0);for(K=0;K<O.length;K++)if(ne=O[K],de=L[ne],oe=B[ne],!$[ne]&&!yn(de,oe))if(yn(de.source,oe.source)&&yn(de["source-layer"],oe["source-layer"])&&yn(de.type,oe.type)){for(_e in Jn(de.layout,oe.layout,S,ne,null,on.setLayoutProperty),Jn(de.paint,oe.paint,S,ne,null,on.setPaintProperty),yn(de.filter,oe.filter)||S.push({command:on.setFilter,args:[ne,oe.filter]}),yn(de.minzoom,oe.minzoom)&&yn(de.maxzoom,oe.maxzoom)||S.push({command:on.setLayerZoomRange,args:[ne,oe.minzoom,oe.maxzoom]}),de)Object.prototype.hasOwnProperty.call(de,_e)&&"layout"!==_e&&"paint"!==_e&&"filter"!==_e&&"metadata"!==_e&&"minzoom"!==_e&&"maxzoom"!==_e&&(0===_e.indexOf("paint.")?Jn(de[_e],oe[_e],S,ne,_e.slice(6),on.setPaintProperty):yn(de[_e],oe[_e])||S.push({command:on.setLayerProperty,args:[ne,_e,oe[_e]]}));for(_e in oe)Object.prototype.hasOwnProperty.call(oe,_e)&&!Object.prototype.hasOwnProperty.call(de,_e)&&"layout"!==_e&&"paint"!==_e&&"filter"!==_e&&"metadata"!==_e&&"minzoom"!==_e&&"maxzoom"!==_e&&(0===_e.indexOf("paint.")?Jn(de[_e],oe[_e],S,ne,_e.slice(6),on.setPaintProperty):yn(de[_e],oe[_e])||S.push({command:on.setLayerProperty,args:[ne,_e,oe[_e]]}))}else S.push({command:on.removeLayer,args:[ne]}),pe=j[j.lastIndexOf(ne)+1],S.push({command:on.addLayer,args:[oe,pe]})}(v,s.layers,l)}catch(d){console.warn("Unable to compute style diff:",d),l=[{command:on.setStyle,args:[s]}]}return l},g.dot=function(a,s){return a[0]*s[0]+a[1]*s[1]+a[2]*s[2]+a[3]*s[3]},g.earthRadius=su,g.emitValidationErrors=Bc,g.emptyStyle=function(){const a={},s=we.$version;for(const l in we.$root){const d=we.$root[l];if(d.required){let f=null;f="version"===l?s:"array"===d.type?[]:{},null!=f&&(a[l]=f)}}return a},g.equals=function(a,s){var l=a[0],d=a[1],f=a[2],v=a[3],x=a[4],C=a[5],S=a[6],T=a[7],O=a[8],L=a[9],B=a[10],j=a[11],$=a[12],K=a[13],Q=a[14],ne=a[15],de=s[0],oe=s[1],pe=s[2],_e=s[3],Me=s[4],Ze=s[5],it=s[6],qe=s[7],je=s[8],Ne=s[9],et=s[10],ze=s[11],Oe=s[12],ut=s[13],st=s[14],Nt=s[15];return Math.abs(l-de)<=Lr*Math.max(1,Math.abs(l),Math.abs(de))&&Math.abs(d-oe)<=Lr*Math.max(1,Math.abs(d),Math.abs(oe))&&Math.abs(f-pe)<=Lr*Math.max(1,Math.abs(f),Math.abs(pe))&&Math.abs(v-_e)<=Lr*Math.max(1,Math.abs(v),Math.abs(_e))&&Math.abs(x-Me)<=Lr*Math.max(1,Math.abs(x),Math.abs(Me))&&Math.abs(C-Ze)<=Lr*Math.max(1,Math.abs(C),Math.abs(Ze))&&Math.abs(S-it)<=Lr*Math.max(1,Math.abs(S),Math.abs(it))&&Math.abs(T-qe)<=Lr*Math.max(1,Math.abs(T),Math.abs(qe))&&Math.abs(O-je)<=Lr*Math.max(1,Math.abs(O),Math.abs(je))&&Math.abs(L-Ne)<=Lr*Math.max(1,Math.abs(L),Math.abs(Ne))&&Math.abs(B-et)<=Lr*Math.max(1,Math.abs(B),Math.abs(et))&&Math.abs(j-ze)<=Lr*Math.max(1,Math.abs(j),Math.abs(ze))&&Math.abs($-Oe)<=Lr*Math.max(1,Math.abs($),Math.abs(Oe))&&Math.abs(K-ut)<=Lr*Math.max(1,Math.abs(K),Math.abs(ut))&&Math.abs(Q-st)<=Lr*Math.max(1,Math.abs(Q),Math.abs(st))&&Math.abs(ne-Nt)<=Lr*Math.max(1,Math.abs(ne),Math.abs(Nt))},g.evaluateSizeForFeature=function(a,{uSize:s,uSizeT:l},{lowerSize:d,upperSize:f}){return"source"===a.kind?d/Yo:"composite"===a.kind?ss.number(d/Yo,f/Yo,l):s},g.evaluateSizeForZoom=function(a,s){let l=0,d=0;if("constant"===a.kind)d=a.layoutSize;else if("source"!==a.kind){const{interpolationType:f,minZoom:v,maxZoom:x}=a,C=f?Kn(Si.interpolationFactor(f,s,v,x),0,1):0;"camera"===a.kind?d=ss.number(a.minSize,a.maxSize,C):l=C}return{uSizeT:l,uSize:d}},g.evented=Gn,g.extend=qi,g.filterObject=Rl,g.findLineIntersection=function(a,s,l,d){const f=s.y-a.y,v=s.x-a.x,x=d.y-l.y,C=d.x-l.x,S=x*v-C*f;if(0===S)return null;const T=(C*(a.y-l.y)-x*(a.x-l.x))/S;return new yt(a.x+T*v,a.y+T*f)},g.fromScaling=function(a,s){return a[0]=s[0],a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=s[1],a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=s[2],a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},g.getAnchorAlignment=dh,g.getAnchorJustification=Dh,g.getArrayBuffer=Ka,g.getDefaultExportFromCjs=mn,g.getJSON=function(a,s){return ci(qi(a,{type:"json"}),s)},g.getOverlapMode=iu,g.getProtocolAction=ns,g.getRTLTextPluginStatus=Qe,g.getReferrer=Ns,g.getVideo=function(a,s){const l=window.document.createElement("video");l.muted=!0,l.onloadstart=function(){s(null,l)};for(let d=0;d<a.length;d++){const f=window.document.createElement("source");Oo(a[d])||(l.crossOrigin="Anonymous"),f.src=a[d],l.appendChild(f)}return{cancel:()=>{}}},g.groupByLayout=function(a,s){const l={};for(let f=0;f<a.length;f++){const v=s&&s[a[f].id]||Hu(a[f]);s&&(s[a[f].id]=v);let x=l[v];x||(x=l[v]=[]),x.push(a[f])}const d=[];for(const f in l)d.push(l[f]);return d},g.identity=Np,g.interpolate=ss,g.invert=function(a,s){var l=s[0],d=s[1],f=s[2],v=s[3],x=s[4],C=s[5],S=s[6],T=s[7],O=s[8],L=s[9],B=s[10],j=s[11],$=s[12],K=s[13],Q=s[14],ne=s[15],de=l*C-d*x,oe=l*S-f*x,pe=l*T-v*x,_e=d*S-f*C,Me=d*T-v*C,Ze=f*T-v*S,it=O*K-L*$,qe=O*Q-B*$,je=O*ne-j*$,Ne=L*Q-B*K,et=L*ne-j*K,ze=B*ne-j*Q,Oe=de*ze-oe*et+pe*Ne+_e*je-Me*qe+Ze*it;return Oe?(a[0]=(C*ze-S*et+T*Ne)*(Oe=1/Oe),a[1]=(f*et-d*ze-v*Ne)*Oe,a[2]=(K*Ze-Q*Me+ne*_e)*Oe,a[3]=(B*Me-L*Ze-j*_e)*Oe,a[4]=(S*je-x*ze-T*qe)*Oe,a[5]=(l*ze-f*je+v*qe)*Oe,a[6]=(Q*pe-$*Ze-ne*oe)*Oe,a[7]=(O*Ze-B*pe+j*oe)*Oe,a[8]=(x*et-C*je+T*it)*Oe,a[9]=(d*je-l*et-v*it)*Oe,a[10]=($*Me-K*pe+ne*de)*Oe,a[11]=(L*pe-O*Me-j*de)*Oe,a[12]=(C*qe-x*Ne-S*it)*Oe,a[13]=(l*Ne-d*qe+f*it)*Oe,a[14]=(K*oe-$*_e-Q*de)*Oe,a[15]=(O*_e-L*oe+B*de)*Oe,a):null},g.isImageBitmap=Po,g.isSafari=ko,g.isWorker=mr,g.keysDifference=function(a,s){const l=[];for(const d in a)d in s||l.push(d);return l},g.lazyLoadRTLTextPlugin=function(){Xt.isLoading()||Xt.isLoaded()||"deferred"!==Qe()||Ot()},g.makeRequest=ci,g.mapObject=gs,g.mercatorXfromLng=ev,g.mercatorYfromLat=uf,g.mercatorZfromAltitude=tv,g.mul=Sy,g.mul$1=function(a,s,l){return a[0]=s[0]*l[0],a[1]=s[1]*l[1],a[2]=s[2]*l[2],a[3]=s[3]*l[3],a},g.multiply=Da,g.nextPowerOfTwo=function(a){return a<=1?1:Math.pow(2,Math.ceil(Math.log(a)/Math.LN2))},g.operations=on,g.ortho=function(a,s,l,d,f,v,x){var C=1/(s-l),S=1/(d-f),T=1/(v-x);return a[0]=-2*C,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*S,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2*T,a[11]=0,a[12]=(s+l)*C,a[13]=(f+d)*S,a[14]=(x+v)*T,a[15]=1,a},g.parseCacheControl=function(a){const s={};if(a.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(l,d,f,v)=>{const x=f||v;return s[d]=!x||x.toLowerCase(),""}),s["max-age"]){const l=parseInt(s["max-age"],10);isNaN(l)?delete s["max-age"]:s["max-age"]=l}return s},g.parseGlyphPbf=function(a){return new dg(a).readFields(Ux,[])},g.pbf=ef,g.performSymbolLayout=function(a){a.bucket.createArrays(),a.bucket.tilePixelRatio=Xn/(512*a.bucket.overscaling),a.bucket.compareText={},a.bucket.iconsNeedLinear=!1;const s=a.bucket.layers[0],l=s.layout,d=s._unevaluatedLayout._values,f={layoutIconSize:d["icon-size"].possiblyEvaluate(new Kt(a.bucket.zoom+1),a.canonical),layoutTextSize:d["text-size"].possiblyEvaluate(new Kt(a.bucket.zoom+1),a.canonical),textMaxSize:d["text-size"].possiblyEvaluate(new Kt(18))};if("composite"===a.bucket.textSizeData.kind){const{minZoom:T,maxZoom:O}=a.bucket.textSizeData;f.compositeTextSizes=[d["text-size"].possiblyEvaluate(new Kt(T),a.canonical),d["text-size"].possiblyEvaluate(new Kt(O),a.canonical)]}if("composite"===a.bucket.iconSizeData.kind){const{minZoom:T,maxZoom:O}=a.bucket.iconSizeData;f.compositeIconSizes=[d["icon-size"].possiblyEvaluate(new Kt(T),a.canonical),d["icon-size"].possiblyEvaluate(new Kt(O),a.canonical)]}const v=l.get("text-line-height")*Pi,x="viewport"!==l.get("text-rotation-alignment")&&"point"!==l.get("symbol-placement"),C=l.get("text-keep-upright"),S=l.get("text-size");for(const T of a.bucket.features){const O=l.get("text-font").evaluate(T,{},a.canonical).join(","),L=S.evaluate(T,{},a.canonical),B=f.layoutTextSize.evaluate(T,{},a.canonical),j=f.layoutIconSize.evaluate(T,{},a.canonical),$={horizontal:{},vertical:void 0},K=T.text;let Q,ne=[0,0];if(K){const pe=K.toString(),_e=l.get("text-letter-spacing").evaluate(T,{},a.canonical)*Pi,Me=Ni(pe)?_e:0,Ze=l.get("text-anchor").evaluate(T,{},a.canonical),it=lu(s,T,a.canonical);if(!it){const ze=l.get("text-radial-offset").evaluate(T,{},a.canonical);ne=ze?Ir(Ze,[ze*Pi,ud]):l.get("text-offset").evaluate(T,{},a.canonical).map(Oe=>Oe*Pi)}let qe=x?"center":l.get("text-justify").evaluate(T,{},a.canonical);const je=l.get("symbol-placement"),Ne="point"===je?l.get("text-max-width").evaluate(T,{},a.canonical)*Pi:0,et=()=>{a.bucket.allowVerticalPlacement&&Vc(pe)&&($.vertical=xl(K,a.glyphMap,a.glyphPositions,a.imagePositions,O,Ne,v,Ze,"left",Me,ne,g.WritingMode.vertical,!0,je,B,L))};if(!x&&it){const ze=new Set;if("auto"===qe)for(let ut=0;ut<it.values.length;ut+=2)ze.add(Dh(it.values[ut]));else ze.add(qe);let Oe=!1;for(const ut of ze)if(!$.horizontal[ut])if(Oe)$.horizontal[ut]=$.horizontal[0];else{const st=xl(K,a.glyphMap,a.glyphPositions,a.imagePositions,O,Ne,v,"center",ut,Me,ne,g.WritingMode.horizontal,!1,je,B,L);st&&($.horizontal[ut]=st,Oe=1===st.positionedLines.length)}et()}else{"auto"===qe&&(qe=Dh(Ze));const ze=xl(K,a.glyphMap,a.glyphPositions,a.imagePositions,O,Ne,v,Ze,qe,Me,ne,g.WritingMode.horizontal,!1,je,B,L);ze&&($.horizontal[qe]=ze),et(),Vc(pe)&&x&&C&&($.vertical=xl(K,a.glyphMap,a.glyphPositions,a.imagePositions,O,Ne,v,Ze,qe,Me,ne,g.WritingMode.vertical,!1,je,B,L))}}let de=!1;if(T.icon&&T.icon.name){const pe=a.imageMap[T.icon.name];pe&&(Q=Wy(a.imagePositions[T.icon.name],l.get("icon-offset").evaluate(T,{},a.canonical),l.get("icon-anchor").evaluate(T,{},a.canonical)),de=!!pe.sdf,void 0===a.bucket.sdfIcons?a.bucket.sdfIcons=de:a.bucket.sdfIcons!==de&&Zi("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(pe.pixelRatio!==a.bucket.pixelRatio||0!==l.get("icon-rotate").constantOr(1))&&(a.bucket.iconsNeedLinear=!0))}const oe=_f($.horizontal)||$.vertical;a.bucket.iconsInText=!!oe&&oe.iconsInText,(oe||Q)&&Sg(a.bucket,T,$,Q,a.imageMap,f,B,j,ne,de,a.canonical)}a.showCollisionBoxes&&a.bucket.generateCollisionDebugBuffers()},g.perspective=function(a,s,l,d,f){var v,x=1/Math.tan(s/2);return a[0]=x/l,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=x,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=-1,a[12]=0,a[13]=0,a[15]=0,null!=f&&f!==1/0?(a[10]=(f+d)*(v=1/(d-f)),a[14]=2*f*d*v):(a[10]=-1,a[14]=-2*d),a},g.pick=function(a,s){const l={};for(let d=0;d<s.length;d++){const f=s[d];f in a&&(l[f]=a[f])}return l},g.plugin=Xt,g.pointGeometry=be,g.polygonIntersectsPolygon=Lm,g.potpack=Vi,g.register=Je,g.registerForPluginStateChange=function(a){return a({pluginStatus:br,pluginURL:bs}),Gn.on("pluginStateChange",a),a},g.renderColorRamp=Jl,g.rotateX=function(a,s,l){var d=Math.sin(l),f=Math.cos(l),v=s[4],x=s[5],C=s[6],S=s[7],T=s[8],O=s[9],L=s[10],B=s[11];return s!==a&&(a[0]=s[0],a[1]=s[1],a[2]=s[2],a[3]=s[3],a[12]=s[12],a[13]=s[13],a[14]=s[14],a[15]=s[15]),a[4]=v*f+T*d,a[5]=x*f+O*d,a[6]=C*f+L*d,a[7]=S*f+B*d,a[8]=T*f-v*d,a[9]=O*f-x*d,a[10]=L*f-C*d,a[11]=B*f-S*d,a},g.rotateZ=function(a,s,l){var d=Math.sin(l),f=Math.cos(l),v=s[0],x=s[1],C=s[2],S=s[3],T=s[4],O=s[5],L=s[6],B=s[7];return s!==a&&(a[8]=s[8],a[9]=s[9],a[10]=s[10],a[11]=s[11],a[12]=s[12],a[13]=s[13],a[14]=s[14],a[15]=s[15]),a[0]=v*f+T*d,a[1]=x*f+O*d,a[2]=C*f+L*d,a[3]=S*f+B*d,a[4]=T*f-v*d,a[5]=O*f-x*d,a[6]=L*f-C*d,a[7]=B*f-S*d,a},g.sameOrigin=Oo,g.scale=function(a,s,l){var d=l[0],f=l[1],v=l[2];return a[0]=s[0]*d,a[1]=s[1]*d,a[2]=s[2]*d,a[3]=s[3]*d,a[4]=s[4]*f,a[5]=s[5]*f,a[6]=s[6]*f,a[7]=s[7]*f,a[8]=s[8]*v,a[9]=s[9]*v,a[10]=s[10]*v,a[11]=s[11]*v,a[12]=s[12],a[13]=s[13],a[14]=s[14],a[15]=s[15],a},g.setRTLTextPlugin=function(a,s,l=!1){if(br===er||br===Gs||br===vr)throw new Error("setRTLTextPlugin cannot be called multiple times.");bs=ca.resolveURL(a),br=er,Uc=s,Yu(),l||Ot()},g.sphericalToCartesian=function([a,s,l]){return s+=90,s*=Math.PI/180,l*=Math.PI/180,{x:a*Math.cos(s)*Math.sin(l),y:a*Math.sin(s)*Math.sin(l),z:a*Math.cos(l)}},g.toEvaluationFeature=Bn,g.transformMat4=Qu,g.translate=function(a,s,l){var d,f,v,x,C,S,T,O,L,B,j,$,K=l[0],Q=l[1],ne=l[2];return s===a?(a[12]=s[0]*K+s[4]*Q+s[8]*ne+s[12],a[13]=s[1]*K+s[5]*Q+s[9]*ne+s[13],a[14]=s[2]*K+s[6]*Q+s[10]*ne+s[14],a[15]=s[3]*K+s[7]*Q+s[11]*ne+s[15]):(f=s[1],v=s[2],x=s[3],C=s[4],S=s[5],T=s[6],O=s[7],L=s[8],B=s[9],j=s[10],$=s[11],a[0]=d=s[0],a[1]=f,a[2]=v,a[3]=x,a[4]=C,a[5]=S,a[6]=T,a[7]=O,a[8]=L,a[9]=B,a[10]=j,a[11]=$,a[12]=d*K+C*Q+L*ne+s[12],a[13]=f*K+S*Q+B*ne+s[13],a[14]=v*K+T*Q+j*ne+s[14],a[15]=x*K+O*Q+$*ne+s[15]),a},g.triggerPluginCompletionEvent=Ku,g.unicodeBlockLookup=Ge,g.uniqueId=function(){return Fs++},g.v8Spec=we,g.validateCustomStyleLayer=function(a){const s=[],l=a.id;return void 0===l&&s.push({message:`layers.${l}: missing required property "id"`}),void 0===a.render&&s.push({message:`layers.${l}: missing required method "render"`}),a.renderingMode&&"2d"!==a.renderingMode&&"3d"!==a.renderingMode&&s.push({message:`layers.${l}: property "renderingMode" must be either "2d" or "3d"`}),s},g.validateLight=Gd,g.validateStyle=Hl,g.vectorTile=vo,g.warnOnce=Zi,g.wrap=xc}),Iu(0,function(g){class mn{constructor(N){this.keyCache={},N&&this.replace(N)}replace(N){this._layerConfigs={},this._layers={},this.update(N,[])}update(N,V){for(const ee of N){this._layerConfigs[ee.id]=ee;const ie=this._layers[ee.id]=g.createStyleLayer(ee);ie._featureFilter=g.createFilter(ie.filter),this.keyCache[ee.id]&&delete this.keyCache[ee.id]}for(const ee of V)delete this.keyCache[ee],delete this._layerConfigs[ee],delete this._layers[ee];this.familiesBySource={};const H=g.groupByLayout(Object.values(this._layerConfigs),this.keyCache);for(const ee of H){const ie=ee.map(Ae=>this._layers[Ae.id]),ue=ie[0];if("none"===ue.visibility)continue;const ae=ue.source||"";let se=this.familiesBySource[ae];se||(se=this.familiesBySource[ae]={});const he=ue.sourceLayer||"_geojsonTileLayer";let Te=se[he];Te||(Te=se[he]=[]),Te.push(ie)}}}class be{constructor(N){const V={},H=[];for(const ae in N){const se=N[ae],he=V[ae]={};for(const Te in se){const Ae=se[+Te];if(!Ae||0===Ae.bitmap.width||0===Ae.bitmap.height)continue;const Ee={x:0,y:0,w:Ae.bitmap.width+2,h:Ae.bitmap.height+2};H.push(Ee),he[Te]={rect:Ee,metrics:Ae.metrics}}}const{w:ee,h:ie}=g.potpack(H),ue=new g.AlphaImage({width:ee||1,height:ie||1});for(const ae in N){const se=N[ae];for(const he in se){const Te=se[+he];if(!Te||0===Te.bitmap.width||0===Te.bitmap.height)continue;const Ae=V[ae][he].rect;g.AlphaImage.copy(Te.bitmap,ue,{x:0,y:0},{x:Ae.x+1,y:Ae.y+1},Te.bitmap)}}this.image=ue,this.positions=V}}g.register("GlyphAtlas",be);class Ar{constructor(N){this.tileID=new g.OverscaledTileID(N.tileID.overscaledZ,N.tileID.wrap,N.tileID.canonical.z,N.tileID.canonical.x,N.tileID.canonical.y),this.uid=N.uid,this.zoom=N.zoom,this.pixelRatio=N.pixelRatio,this.tileSize=N.tileSize,this.source=N.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=N.showCollisionBoxes,this.collectResourceTiming=!!N.collectResourceTiming,this.returnDependencies=!!N.returnDependencies,this.promoteId=N.promoteId,this.inFlightDependencies=[],this.dependencySentinel=-1}parse(N,V,H,ee,ie){this.status="parsing",this.data=N,this.collisionBoxArray=new g.CollisionBoxArray;const ue=new g.DictionaryCoder(Object.keys(N.layers).sort()),ae=new g.FeatureIndex(this.tileID,this.promoteId);ae.bucketLayerIDs=[];const se={},he={featureIndex:ae,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:H},Te=V.familiesBySource[this.source];for(const At in Te){const qt=N.layers[At];if(!qt)continue;1===qt.version&&g.warnOnce(`Vector tile source "${this.source}" layer "${At}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const ln=ue.encode(At),gt=[];for(let bn=0;bn<qt.length;bn++){const or=qt.feature(bn),ui=ae.getId(or,At);gt.push({feature:or,id:ui,index:bn,sourceLayerIndex:ln})}for(const bn of Te[At]){const or=bn[0];or.source!==this.source&&g.warnOnce(`layer.source = ${or.source} does not equal this.source = ${this.source}`),or.minzoom&&this.zoom<Math.floor(or.minzoom)||or.maxzoom&&this.zoom>=or.maxzoom||"none"!==or.visibility&&(yt(bn,this.zoom,H),(se[or.id]=or.createBucket({index:ae.bucketLayerIDs.length,layers:bn,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:ln,sourceID:this.source})).populate(gt,he,this.tileID.canonical),ae.bucketLayerIDs.push(bn.map(ui=>ui.id)))}}let Ae,Ee,_t,St;const ot=g.mapObject(he.glyphDependencies,At=>Object.keys(At).map(Number));this.inFlightDependencies.forEach(At=>At?.cancel()),this.inFlightDependencies=[];const pt=++this.dependencySentinel;Object.keys(ot).length?this.inFlightDependencies.push(ee.send("getGlyphs",{uid:this.uid,stacks:ot,source:this.source,tileID:this.tileID,type:"glyphs"},(At,qt)=>{pt===this.dependencySentinel&&(Ae||(Ae=At,Ee=qt,vn.call(this)))})):Ee={};const Dt=Object.keys(he.iconDependencies);Dt.length?this.inFlightDependencies.push(ee.send("getImages",{icons:Dt,source:this.source,tileID:this.tileID,type:"icons"},(At,qt)=>{pt===this.dependencySentinel&&(Ae||(Ae=At,_t=qt,vn.call(this)))})):_t={};const Wt=Object.keys(he.patternDependencies);function vn(){if(Ae)return ie(Ae);if(Ee&&_t&&St){const At=new be(Ee),qt=new g.ImageAtlas(_t,St);for(const ln in se){const gt=se[ln];gt instanceof g.SymbolBucket?(yt(gt.layers,this.zoom,H),g.performSymbolLayout({bucket:gt,glyphMap:Ee,glyphPositions:At.positions,imageMap:_t,imagePositions:qt.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):gt.hasPattern&&(gt instanceof g.LineBucket||gt instanceof g.FillBucket||gt instanceof g.FillExtrusionBucket)&&(yt(gt.layers,this.zoom,H),gt.addFeatures(he,this.tileID.canonical,qt.patternPositions))}this.status="done",ie(null,{buckets:Object.values(se).filter(ln=>!ln.isEmpty()),featureIndex:ae,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:At.image,imageAtlas:qt,glyphMap:this.returnDependencies?Ee:null,iconMap:this.returnDependencies?_t:null,glyphPositions:this.returnDependencies?At.positions:null})}}Wt.length?this.inFlightDependencies.push(ee.send("getImages",{icons:Wt,source:this.source,tileID:this.tileID,type:"patterns"},(At,qt)=>{pt===this.dependencySentinel&&(Ae||(Ae=At,St=qt,vn.call(this)))})):St={},vn.call(this)}}function yt(Y,N,V){const H=new g.EvaluationParameters(N);for(const ee of Y)ee.recalculate(H,V)}function kr(Y,N){const V=g.getArrayBuffer(Y.request,(H,ee,ie,ue)=>{H?N(H):ee&&N(null,{vectorTile:new g.vectorTile.VectorTile(new g.Protobuf(ee)),rawData:ee,cacheControl:ie,expires:ue})});return()=>{V.cancel(),N()}}class Os{constructor(N,V,H,ee){this.actor=N,this.layerIndex=V,this.availableImages=H,this.loadVectorData=ee||kr,this.fetching={},this.loading={},this.loaded={}}loadTile(N,V){const H=N.uid;this.loading||(this.loading={});const ee=!!(N&&N.request&&N.request.collectResourceTiming)&&new g.RequestPerformance(N.request),ie=this.loading[H]=new Ar(N);ie.abort=this.loadVectorData(N,(ue,ae)=>{if(delete this.loading[H],ue||!ae)return ie.status="done",this.loaded[H]=ie,V(ue);const se=ae.rawData,he={};ae.expires&&(he.expires=ae.expires),ae.cacheControl&&(he.cacheControl=ae.cacheControl);const Te={};if(ee){const Ae=ee.finish();Ae&&(Te.resourceTiming=JSON.parse(JSON.stringify(Ae)))}ie.vectorTile=ae.vectorTile,ie.parse(ae.vectorTile,this.layerIndex,this.availableImages,this.actor,(Ae,Ee)=>{if(delete this.fetching[H],Ae||!Ee)return V(Ae);V(null,g.extend({rawTileData:se.slice(0)},Ee,he,Te))}),this.loaded=this.loaded||{},this.loaded[H]=ie,this.fetching[H]={rawTileData:se,cacheControl:he,resourceTiming:Te}})}reloadTile(N,V){const H=this.loaded,ee=N.uid;if(H&&H[ee]){const ie=H[ee];ie.showCollisionBoxes=N.showCollisionBoxes,"parsing"===ie.status?ie.parse(ie.vectorTile,this.layerIndex,this.availableImages,this.actor,(ue,ae)=>{if(ue||!ae)return V(ue,ae);let se;if(this.fetching[ee]){const{rawTileData:he,cacheControl:Te,resourceTiming:Ae}=this.fetching[ee];delete this.fetching[ee],se=g.extend({rawTileData:he.slice(0)},ae,Te,Ae)}else se=ae;V(null,se)}):"done"===ie.status&&(ie.vectorTile?ie.parse(ie.vectorTile,this.layerIndex,this.availableImages,this.actor,V):V())}}abortTile(N,V){const H=this.loading,ee=N.uid;H&&H[ee]&&H[ee].abort&&(H[ee].abort(),delete H[ee]),V()}removeTile(N,V){const H=this.loaded,ee=N.uid;H&&H[ee]&&delete H[ee],V()}}class Xa{constructor(){this.loaded={}}loadTile(N,V){const{uid:H,encoding:ee,rawImageData:ie}=N,ue=g.isImageBitmap(ie)?this.getImageData(ie):ie,ae=new g.DEMData(H,ue,ee);this.loaded=this.loaded||{},this.loaded[H]=ae,V(null,ae)}getImageData(N){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(N.width,N.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=N.width,this.offscreenCanvas.height=N.height,this.offscreenCanvasContext.drawImage(N,0,0,N.width,N.height);const V=this.offscreenCanvasContext.getImageData(-1,-1,N.width+2,N.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new g.RGBAImage({width:V.width,height:V.height},V.data)}removeTile(N){const V=this.loaded,H=N.uid;V&&V[H]&&delete V[H]}}function Ao(Y,N){if(0!==Y.length){Ur(Y[0],N);for(var V=1;V<Y.length;V++)Ur(Y[V],!N)}}function Ur(Y,N){for(var V=0,H=0,ee=0,ie=Y.length,ue=ie-1;ee<ie;ue=ee++){var ae=(Y[ee][0]-Y[ue][0])*(Y[ue][1]+Y[ee][1]),se=V+ae;H+=Math.abs(V)>=Math.abs(ae)?V-se+ae:ae-se+V,V=se}V+H>=0!=!!N&&Y.reverse()}var Kn=g.getDefaultExportFromCjs(function Y(N,V){var H,ee=N&&N.type;if("FeatureCollection"===ee)for(H=0;H<N.features.length;H++)Y(N.features[H],V);else if("GeometryCollection"===ee)for(H=0;H<N.geometries.length;H++)Y(N.geometries[H],V);else if("Feature"===ee)Y(N.geometry,V);else if("Polygon"===ee)Ao(N.coordinates,V);else if("MultiPolygon"===ee)for(H=0;H<N.coordinates.length;H++)Ao(N.coordinates[H],V);return N});const xc=g.vectorTile.VectorTileFeature.prototype.toGeoJSON;var qi={exports:{}},Fs=g.pointGeometry,gs=g.vectorTile.VectorTileFeature,Rl=Pr;function Pr(Y,N){this.options=N||{},this.features=Y,this.length=Y.length}function Ls(Y,N){this.id="number"==typeof Y.id?Y.id:void 0,this.type=Y.type,this.rawGeometry=1===Y.type?[Y.geometry]:Y.geometry,this.properties=Y.tags,this.extent=N||4096}Pr.prototype.feature=function(Y){return new Ls(this.features[Y],this.options.extent)},Ls.prototype.loadGeometry=function(){var Y=this.rawGeometry;this.geometry=[];for(var N=0;N<Y.length;N++){for(var V=Y[N],H=[],ee=0;ee<V.length;ee++)H.push(new Fs(V[ee][0],V[ee][1]));this.geometry.push(H)}return this.geometry},Ls.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Y=this.geometry,N=1/0,V=-1/0,H=1/0,ee=-1/0,ie=0;ie<Y.length;ie++)for(var ue=Y[ie],ae=0;ae<ue.length;ae++){var se=ue[ae];N=Math.min(N,se.x),V=Math.max(V,se.x),H=Math.min(H,se.y),ee=Math.max(ee,se.y)}return[N,H,V,ee]},Ls.prototype.toGeoJSON=gs.prototype.toGeoJSON;var Zi=g.pbf,gn=Rl;function oo(Y){var N=new Zi;return function(V,H){for(var ee in V.layers)H.writeMessage(3,mr,V.layers[ee])}(Y,N),N.finish()}function mr(Y,N){var V;N.writeVarintField(15,Y.version||1),N.writeStringField(1,Y.name||""),N.writeVarintField(5,Y.extent||4096);var H={keys:[],values:[],keycache:{},valuecache:{}};for(V=0;V<Y.length;V++)H.feature=Y.feature(V),N.writeMessage(2,ao,H);var ee=H.keys;for(V=0;V<ee.length;V++)N.writeStringField(3,ee[V]);var ie=H.values;for(V=0;V<ie.length;V++)N.writeMessage(4,la,ie[V])}function ao(Y,N){var V=Y.feature;void 0!==V.id&&N.writeVarintField(1,V.id),N.writeMessage(2,ko,Y),N.writeVarintField(3,V.type),N.writeMessage(4,jr,V)}function ko(Y,N){var V=Y.feature,H=Y.keys,ee=Y.values,ie=Y.keycache,ue=Y.valuecache;for(var ae in V.properties){var se=V.properties[ae],he=ie[ae];if(null!==se){void 0===he&&(H.push(ae),ie[ae]=he=H.length-1),N.writeVarint(he);var Te=typeof se;"string"!==Te&&"boolean"!==Te&&"number"!==Te&&(se=JSON.stringify(se));var Ae=Te+":"+se,Ee=ue[Ae];void 0===Ee&&(ee.push(se),ue[Ae]=Ee=ee.length-1),N.writeVarint(Ee)}}}function Po(Y,N){return(N<<3)+(7&Y)}function ts(Y){return Y<<1^Y>>31}function jr(Y,N){for(var V=Y.loadGeometry(),H=Y.type,ee=0,ie=0,ue=V.length,ae=0;ae<ue;ae++){var se=V[ae],he=1;1===H&&(he=se.length),N.writeVarint(Po(1,he));for(var Te=3===H?se.length-1:se.length,Ae=0;Ae<Te;Ae++){1===Ae&&1!==H&&N.writeVarint(Po(2,Te-1));var Ee=se[Ae].x-ee,_t=se[Ae].y-ie;N.writeVarint(ts(Ee)),N.writeVarint(ts(_t)),ee+=Ee,ie+=_t}3===H&&N.writeVarint(Po(7,1))}}function la(Y,N){var V=typeof Y;"string"===V?N.writeStringField(1,Y):"boolean"===V?N.writeBooleanField(7,Y):"number"===V&&(Y%1!=0?N.writeDoubleField(3,Y):Y<0?N.writeSVarintField(6,Y):N.writeVarintField(5,Y))}qi.exports=oo,qi.exports.fromVectorTileJs=oo,qi.exports.fromGeojsonVt=function(Y,N){N=N||{};var V={};for(var H in Y)V[H]=new gn(Y[H].features,N),V[H].name=H,V[H].version=N.version,V[H].extent=N.extent;return oo({layers:V})},qi.exports.GeoJSONWrapper=gn;var ca=g.getDefaultExportFromCjs(qi.exports);const Ln={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Y=>Y},Ro=Math.fround||(Ns=new Float32Array(1),Y=>(Ns[0]=+Y,Ns[0]));var Ns;const ns=3,Yn=5,ci=6;class Ka{constructor(N){this.options=Object.assign(Object.create(Ln),N),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(N){const{log:V,minZoom:H,maxZoom:ee}=this.options;V&&console.time("total time");const ie=`prepare ${N.length} points`;V&&console.time(ie),this.points=N;const ue=[];for(let se=0;se<N.length;se++){const he=N[se];if(!he.geometry)continue;const[Te,Ae]=he.geometry.coordinates,Ee=Ro(_n(Te)),_t=Ro(is(Ae));ue.push(Ee,_t,1/0,se,-1,1),this.options.reduce&&ue.push(0)}let ae=this.trees[ee+1]=this._createTree(ue);V&&console.timeEnd(ie);for(let se=ee;se>=H;se--){const he=+Date.now();ae=this.trees[se]=this._createTree(this._cluster(ae,se)),V&&console.log("z%d: %d clusters in %dms",se,ae.numItems,+Date.now()-he)}return V&&console.timeEnd("total time"),this}getClusters(N,V){let H=((N[0]+180)%360+360)%360-180;const ee=Math.max(-90,Math.min(90,N[1]));let ie=180===N[2]?180:((N[2]+180)%360+360)%360-180;const ue=Math.max(-90,Math.min(90,N[3]));if(N[2]-N[0]>=360)H=-180,ie=180;else if(H>ie){const Ae=this.getClusters([H,ee,180,ue],V),Ee=this.getClusters([-180,ee,ie,ue],V);return Ae.concat(Ee)}const ae=this.trees[this._limitZoom(V)],se=ae.range(_n(H),is(ue),_n(ie),is(ee)),he=ae.data,Te=[];for(const Ae of se){const Ee=this.stride*Ae;Te.push(he[Ee+Yn]>1?Oo(he,Ee,this.clusterProps):this.points[he[Ee+ns]])}return Te}getChildren(N){const V=this._getOriginId(N),H=this._getOriginZoom(N),ee="No cluster with the specified id.",ie=this.trees[H];if(!ie)throw new Error(ee);const ue=ie.data;if(V*this.stride>=ue.length)throw new Error(ee);const ae=this.options.radius/(this.options.extent*Math.pow(2,H-1)),se=ie.within(ue[V*this.stride],ue[V*this.stride+1],ae),he=[];for(const Te of se){const Ae=Te*this.stride;ue[Ae+4]===N&&he.push(ue[Ae+Yn]>1?Oo(ue,Ae,this.clusterProps):this.points[ue[Ae+ns]])}if(0===he.length)throw new Error(ee);return he}getLeaves(N,V,H){const ee=[];return this._appendLeaves(ee,N,V=V||10,H=H||0,0),ee}getTile(N,V,H){const ee=this.trees[this._limitZoom(N)],ie=Math.pow(2,N),{extent:ue,radius:ae}=this.options,se=ae/ue,he=(H-se)/ie,Te=(H+1+se)/ie,Ae={features:[]};return this._addTileFeatures(ee.range((V-se)/ie,he,(V+1+se)/ie,Te),ee.data,V,H,ie,Ae),0===V&&this._addTileFeatures(ee.range(1-se/ie,he,1,Te),ee.data,ie,H,ie,Ae),V===ie-1&&this._addTileFeatures(ee.range(0,he,se/ie,Te),ee.data,-1,H,ie,Ae),Ae.features.length?Ae:null}getClusterExpansionZoom(N){let V=this._getOriginZoom(N)-1;for(;V<=this.options.maxZoom;){const H=this.getChildren(N);if(V++,1!==H.length)break;N=H[0].properties.cluster_id}return V}_appendLeaves(N,V,H,ee,ie){const ue=this.getChildren(V);for(const ae of ue){const se=ae.properties;if(se&&se.cluster?ie+se.point_count<=ee?ie+=se.point_count:ie=this._appendLeaves(N,se.cluster_id,H,ee,ie):ie<ee?ie++:N.push(ae),N.length===H)break}return ie}_createTree(N){const V=new g.KDBush(N.length/this.stride|0,this.options.nodeSize,Float32Array);for(let H=0;H<N.length;H+=this.stride)V.add(N[H],N[H+1]);return V.finish(),V.data=N,V}_addTileFeatures(N,V,H,ee,ie,ue){for(const ae of N){const se=ae*this.stride,he=V[se+Yn]>1;let Te,Ae,Ee;if(he)Te=Vn(V,se,this.clusterProps),Ae=V[se],Ee=V[se+1];else{const ot=this.points[V[se+ns]];Te=ot.properties;const[pt,Dt]=ot.geometry.coordinates;Ae=_n(pt),Ee=is(Dt)}const _t={type:1,geometry:[[Math.round(this.options.extent*(Ae*ie-H)),Math.round(this.options.extent*(Ee*ie-ee))]],tags:Te};let St;St=he||this.options.generateId?V[se+ns]:this.points[V[se+ns]].id,void 0!==St&&(_t.id=St),ue.features.push(_t)}}_limitZoom(N){return Math.max(this.options.minZoom,Math.min(Math.floor(+N),this.options.maxZoom+1))}_cluster(N,V){const{radius:H,extent:ee,reduce:ie,minPoints:ue}=this.options,ae=H/(ee*Math.pow(2,V)),se=N.data,he=[],Te=this.stride;for(let Ae=0;Ae<se.length;Ae+=Te){if(se[Ae+2]<=V)continue;se[Ae+2]=V;const Ee=se[Ae],_t=se[Ae+1],St=N.within(se[Ae],se[Ae+1],ae),ot=se[Ae+Yn];let pt=ot;for(const Dt of St){const Wt=Dt*Te;se[Wt+2]>V&&(pt+=se[Wt+Yn])}if(pt>ot&&pt>=ue){let Dt,Wt=Ee*ot,vn=_t*ot,At=-1;const qt=((Ae/Te|0)<<5)+(V+1)+this.points.length;for(const ln of St){const gt=ln*Te;if(se[gt+2]<=V)continue;se[gt+2]=V;const bn=se[gt+Yn];Wt+=se[gt]*bn,vn+=se[gt+1]*bn,se[gt+4]=qt,ie&&(Dt||(Dt=this._map(se,Ae,!0),At=this.clusterProps.length,this.clusterProps.push(Dt)),ie(Dt,this._map(se,gt)))}se[Ae+4]=qt,he.push(Wt/pt,vn/pt,1/0,qt,-1,pt),ie&&he.push(At)}else{for(let Dt=0;Dt<Te;Dt++)he.push(se[Ae+Dt]);if(pt>1)for(const Dt of St){const Wt=Dt*Te;if(!(se[Wt+2]<=V)){se[Wt+2]=V;for(let vn=0;vn<Te;vn++)he.push(se[Wt+vn])}}}}return he}_getOriginId(N){return N-this.points.length>>5}_getOriginZoom(N){return(N-this.points.length)%32}_map(N,V,H){if(N[V+Yn]>1){const ue=this.clusterProps[N[V+ci]];return H?Object.assign({},ue):ue}const ee=this.points[N[V+ns]].properties,ie=this.options.map(ee);return H&&ie===ee?Object.assign({},ie):ie}}function Oo(Y,N,V){return{type:"Feature",id:Y[N+ns],properties:Vn(Y,N,V),geometry:{type:"Point",coordinates:[(H=Y[N],360*(H-.5)),Ft(Y[N+1])]}};var H}function Vn(Y,N,V){const H=Y[N+Yn],ee=H>=1e4?`${Math.round(H/1e3)}k`:H>=1e3?Math.round(H/100)/10+"k":H,ie=Y[N+ci],ue=-1===ie?{}:Object.assign({},V[ie]);return Object.assign(ue,{cluster:!0,cluster_id:Y[N+ns],point_count:H,point_count_abbreviated:ee})}function _n(Y){return Y/360+.5}function is(Y){const N=Math.sin(Y*Math.PI/180),V=.5-.25*Math.log((1+N)/(1-N))/Math.PI;return V<0?0:V>1?1:V}function Ft(Y){const N=(180-360*Y)*Math.PI/180;return 360*Math.atan(Math.exp(N))/Math.PI-90}function zs(Y,N,V,H){for(var ee,ie=H,ue=V-N>>1,ae=V-N,se=Y[N],he=Y[N+1],Te=Y[V],Ae=Y[V+1],Ee=N+3;Ee<V;Ee+=3){var _t=we(Y[Ee],Y[Ee+1],se,he,Te,Ae);if(_t>ie)ee=Ee,ie=_t;else if(_t===ie){var St=Math.abs(Ee-ue);St<ae&&(ee=Ee,ae=St)}}ie>H&&(ee-N>3&&zs(Y,N,ee,H),Y[ee+2]=ie,V-ee>3&&zs(Y,ee,V,H))}function we(Y,N,V,H,ee,ie){var ue=ee-V,ae=ie-H;if(0!==ue||0!==ae){var se=((Y-V)*ue+(N-H)*ae)/(ue*ue+ae*ae);se>1?(V=ee,H=ie):se>0&&(V+=ue*se,H+=ae*se)}return(ue=Y-V)*ue+(ae=N-H)*ae}function _s(Y,N,V,H){var ee={id:void 0===Y?null:Y,type:N,geometry:V,tags:H,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(ie){var ue=ie.geometry,ae=ie.type;if("Point"===ae||"MultiPoint"===ae||"LineString"===ae)Ya(ie,ue);else if("Polygon"===ae||"MultiLineString"===ae)for(var se=0;se<ue.length;se++)Ya(ie,ue[se]);else if("MultiPolygon"===ae)for(se=0;se<ue.length;se++)for(var he=0;he<ue[se].length;he++)Ya(ie,ue[se][he])}(ee),ee}function Ya(Y,N){for(var V=0;V<N.length;V+=3)Y.minX=Math.min(Y.minX,N[V]),Y.minY=Math.min(Y.minY,N[V+1]),Y.maxX=Math.max(Y.maxX,N[V]),Y.maxY=Math.max(Y.maxY,N[V+1])}function yn(Y,N,V,H){if(N.geometry){var ee=N.geometry.coordinates,ie=N.geometry.type,ue=Math.pow(V.tolerance/((1<<V.maxZoom)*V.extent),2),ae=[],se=N.id;if(V.promoteId?se=N.properties[V.promoteId]:V.generateId&&(se=H||0),"Point"===ie)on(ee,ae);else if("MultiPoint"===ie)for(var he=0;he<ee.length;he++)on(ee[he],ae);else if("LineString"===ie)Ja(ee,ae,ue,!1);else if("MultiLineString"===ie){if(V.lineMetrics){for(he=0;he<ee.length;he++)Ja(ee[he],ae=[],ue,!1),Y.push(_s(se,"LineString",ae,N.properties));return}Qa(ee,ae,ue,!1)}else if("Polygon"===ie)Qa(ee,ae,ue,!0);else{if("MultiPolygon"!==ie){if("GeometryCollection"===ie){for(he=0;he<N.geometry.geometries.length;he++)yn(Y,{id:se,geometry:N.geometry.geometries[he],properties:N.properties},V,H);return}throw new Error("Input data is not a valid GeoJSON object.")}for(he=0;he<ee.length;he++){var Te=[];Qa(ee[he],Te,ue,!0),ae.push(Te)}}Y.push(_s(se,ie,ae,N.properties))}}function on(Y,N){N.push(Su(Y[0])),N.push(Mu(Y[1])),N.push(0)}function Ja(Y,N,V,H){for(var ee,ie,ue=0,ae=0;ae<Y.length;ae++){var se=Su(Y[ae][0]),he=Mu(Y[ae][1]);N.push(se),N.push(he),N.push(0),ae>0&&(ue+=H?(ee*he-se*ie)/2:Math.sqrt(Math.pow(se-ee,2)+Math.pow(he-ie,2))),ee=se,ie=he}var Te=N.length-3;N[2]=1,zs(N,0,Te,V),N[Te+2]=1,N.size=Math.abs(ue),N.start=0,N.end=N.size}function Qa(Y,N,V,H){for(var ee=0;ee<Y.length;ee++){var ie=[];Ja(Y[ee],ie,V,H),N.push(ie)}}function Su(Y){return Y/360+.5}function Mu(Y){var N=Math.sin(Y*Math.PI/180),V=.5-.25*Math.log((1+N)/(1-N))/Math.PI;return V<0?0:V>1?1:V}function Jn(Y,N,V,H,ee,ie,ue,ae){if(H/=N,ie>=(V/=N)&&ue<H)return Y;if(ue<V||ie>=H)return null;for(var se=[],he=0;he<Y.length;he++){var Te=Y[he],Ae=Te.geometry,Ee=Te.type,_t=0===ee?Te.minX:Te.minY,St=0===ee?Te.maxX:Te.maxY;if(_t>=V&&St<H)se.push(Te);else if(!(St<V||_t>=H)){var ot=[];if("Point"===Ee||"MultiPoint"===Ee)el(Ae,ot,V,H,ee);else if("LineString"===Ee)tl(Ae,ot,V,H,ee,!1,ae.lineMetrics);else if("MultiLineString"===Ee)gr(Ae,ot,V,H,ee,!1);else if("Polygon"===Ee)gr(Ae,ot,V,H,ee,!0);else if("MultiPolygon"===Ee)for(var pt=0;pt<Ae.length;pt++){var Dt=[];gr(Ae[pt],Dt,V,H,ee,!0),Dt.length&&ot.push(Dt)}if(ot.length){if(ae.lineMetrics&&"LineString"===Ee){for(pt=0;pt<ot.length;pt++)se.push(_s(Te.id,Ee,ot[pt],Te.tags));continue}"LineString"!==Ee&&"MultiLineString"!==Ee||(1===ot.length?(Ee="LineString",ot=ot[0]):Ee="MultiLineString"),"Point"!==Ee&&"MultiPoint"!==Ee||(Ee=3===ot.length?"Point":"MultiPoint"),se.push(_s(Te.id,Ee,ot,Te.tags))}}}return se.length?se:null}function el(Y,N,V,H,ee){for(var ie=0;ie<Y.length;ie+=3){var ue=Y[ie+ee];ue>=V&&ue<=H&&(N.push(Y[ie]),N.push(Y[ie+1]),N.push(Y[ie+2]))}}function tl(Y,N,V,H,ee,ie,ue){for(var ae,se,he=Be(Y),Te=0===ee?Bs:Fo,Ae=Y.start,Ee=0;Ee<Y.length-3;Ee+=3){var _t=Y[Ee],St=Y[Ee+1],ot=Y[Ee+2],pt=Y[Ee+3],Dt=Y[Ee+4],Wt=0===ee?_t:St,vn=0===ee?pt:Dt,At=!1;ue&&(ae=Math.sqrt(Math.pow(_t-pt,2)+Math.pow(St-Dt,2))),Wt<V?vn>V&&(se=Te(he,_t,St,pt,Dt,V),ue&&(he.start=Ae+ae*se)):Wt>H?vn<H&&(se=Te(he,_t,St,pt,Dt,H),ue&&(he.start=Ae+ae*se)):sr(he,_t,St,ot),vn<V&&Wt>=V&&(se=Te(he,_t,St,pt,Dt,V),At=!0),vn>H&&Wt<=H&&(se=Te(he,_t,St,pt,Dt,H),At=!0),!ie&&At&&(ue&&(he.end=Ae+ae*se),N.push(he),he=Be(Y)),ue&&(Ae+=ae)}var qt=Y.length-3;_t=Y[qt],St=Y[qt+1],ot=Y[qt+2],(Wt=0===ee?_t:St)>=V&&Wt<=H&&sr(he,_t,St,ot),qt=he.length-3,ie&&qt>=3&&(he[qt]!==he[0]||he[qt+1]!==he[1])&&sr(he,he[0],he[1],he[2]),he.length&&N.push(he)}function Be(Y){var N=[];return N.size=Y.size,N.start=Y.start,N.end=Y.end,N}function gr(Y,N,V,H,ee,ie){for(var ue=0;ue<Y.length;ue++)tl(Y[ue],N,V,H,ee,ie,!1)}function sr(Y,N,V,H){Y.push(N),Y.push(V),Y.push(H)}function Bs(Y,N,V,H,ee,ie){var ue=(ie-N)/(H-N);return Y.push(ie),Y.push(V+(ee-V)*ue),Y.push(1),ue}function Fo(Y,N,V,H,ee,ie){var ue=(ie-V)/(ee-V);return Y.push(N+(H-N)*ue),Y.push(ie),Y.push(1),ue}function $e(Y,N){for(var V=[],H=0;H<Y.length;H++){var ee,ie=Y[H],ue=ie.type;if("Point"===ue||"MultiPoint"===ue||"LineString"===ue)ee=Pt(ie.geometry,N);else if("MultiLineString"===ue||"Polygon"===ue){ee=[];for(var ae=0;ae<ie.geometry.length;ae++)ee.push(Pt(ie.geometry[ae],N))}else if("MultiPolygon"===ue)for(ee=[],ae=0;ae<ie.geometry.length;ae++){for(var se=[],he=0;he<ie.geometry[ae].length;he++)se.push(Pt(ie.geometry[ae][he],N));ee.push(se)}V.push(_s(ie.id,ue,ee,ie.tags))}return V}function Pt(Y,N){var V=[];V.size=Y.size,void 0!==Y.start&&(V.start=Y.start,V.end=Y.end);for(var H=0;H<Y.length;H+=3)V.push(Y[H]+N,Y[H+1],Y[H+2]);return V}function Ct(Y,N){if(Y.transformed)return Y;var V,H,ee,ie=1<<Y.z,ue=Y.x,ae=Y.y;for(V=0;V<Y.features.length;V++){var se=Y.features[V],he=se.geometry,Te=se.type;if(se.geometry=[],1===Te)for(H=0;H<he.length;H+=2)se.geometry.push(Wi(he[H],he[H+1],N,ie,ue,ae));else for(H=0;H<he.length;H++){var Ae=[];for(ee=0;ee<he[H].length;ee+=2)Ae.push(Wi(he[H][ee],he[H][ee+1],N,ie,ue,ae));se.geometry.push(Ae)}}return Y.transformed=!0,Y}function Wi(Y,N,V,H,ee,ie){return[Math.round(V*(Y*H-ee)),Math.round(V*(N*H-ie))]}function lo(Y,N,V,H,ee){for(var ie=N===ee.maxZoom?0:ee.tolerance/((1<<N)*ee.extent),ue={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:V,y:H,z:N,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},ae=0;ae<Y.length;ae++){ue.numFeatures++,bt(ue,Y[ae],ie,ee);var se=Y[ae].minX,he=Y[ae].minY,Te=Y[ae].maxX,Ae=Y[ae].maxY;se<ue.minX&&(ue.minX=se),he<ue.minY&&(ue.minY=he),Te>ue.maxX&&(ue.maxX=Te),Ae>ue.maxY&&(ue.maxY=Ae)}return ue}function bt(Y,N,V,H){var ee=N.geometry,ie=N.type,ue=[];if("Point"===ie||"MultiPoint"===ie)for(var ae=0;ae<ee.length;ae+=3)ue.push(ee[ae]),ue.push(ee[ae+1]),Y.numPoints++,Y.numSimplified++;else if("LineString"===ie)Vs(ue,ee,Y,V,!1,!1);else if("MultiLineString"===ie||"Polygon"===ie)for(ae=0;ae<ee.length;ae++)Vs(ue,ee[ae],Y,V,"Polygon"===ie,0===ae);else if("MultiPolygon"===ie)for(var se=0;se<ee.length;se++){var he=ee[se];for(ae=0;ae<he.length;ae++)Vs(ue,he[ae],Y,V,!0,0===ae)}if(ue.length){var Te=N.tags||null;if("LineString"===ie&&H.lineMetrics){for(var Ae in Te={},N.tags)Te[Ae]=N.tags[Ae];Te.mapbox_clip_start=ee.start/ee.size,Te.mapbox_clip_end=ee.end/ee.size}var Ee={geometry:ue,type:"Polygon"===ie||"MultiPolygon"===ie?3:"LineString"===ie||"MultiLineString"===ie?2:1,tags:Te};null!==N.id&&(Ee.id=N.id),Y.features.push(Ee)}}function Vs(Y,N,V,H,ee,ie){var ue=H*H;if(H>0&&N.size<(ee?ue:H))V.numPoints+=N.length/3;else{for(var ae=[],se=0;se<N.length;se+=3)(0===H||N[se+2]>ue)&&(V.numSimplified++,ae.push(N[se]),ae.push(N[se+1])),V.numPoints++;ee&&function(he,Te){for(var Ae=0,Ee=0,_t=he.length,St=_t-2;Ee<_t;St=Ee,Ee+=2)Ae+=(he[Ee]-he[St])*(he[Ee+1]+he[St+1]);if(Ae>0===Te)for(Ee=0,_t=he.length;Ee<_t/2;Ee+=2){var ot=he[Ee],pt=he[Ee+1];he[Ee]=he[_t-2-Ee],he[Ee+1]=he[_t-1-Ee],he[_t-2-Ee]=ot,he[_t-1-Ee]=pt}}(ae,ie),Y.push(ae)}}function Us(Y,N){var V=(N=this.options=function(ee,ie){for(var ue in ie)ee[ue]=ie[ue];return ee}(Object.create(this.options),N)).debug;if(V&&console.time("preprocess data"),N.maxZoom<0||N.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(N.promoteId&&N.generateId)throw new Error("promoteId and generateId cannot be used together.");var ee,ie,ue,ae,se,he,H=function(ee,ie){var ue=[];if("FeatureCollection"===ee.type)for(var ae=0;ae<ee.features.length;ae++)yn(ue,ee.features[ae],ie,ae);else yn(ue,"Feature"===ee.type?ee:{geometry:ee},ie);return ue}(Y,N);this.tiles={},this.tileCoords=[],V&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",N.indexMaxZoom,N.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),ae=ee=H,se=Jn(ee,1,-1-(ue=(ie=N).buffer/ie.extent),ue,0,-1,2,ie),he=Jn(ee,1,1-ue,2+ue,0,-1,2,ie),(se||he)&&(ae=Jn(ee,1,-ue,1+ue,0,-1,2,ie)||[],se&&(ae=$e(se,1).concat(ae)),he&&(ae=ae.concat($e(he,-1)))),(H=ae).length&&this.splitTile(H,0,0,0),V&&(H.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Lo(Y,N,V){return 32*((1<<Y)*V+N)+Y}function rs(Y,N){return N?Y.properties[N]:Y.id}function No(Y,N){if(null==Y)return!0;if("Feature"===Y.type)return null!=rs(Y,N);if("FeatureCollection"===Y.type){const V=new Set;for(const H of Y.features){const ee=rs(H,N);if(null==ee||V.has(ee))return!1;V.add(ee)}return!0}return!1}function Xi(Y,N){const V=new Map;if(null!=Y)if("Feature"===Y.type)V.set(rs(Y,N),Y);else for(const H of Y.features)V.set(rs(H,N),H);return V}function kn(Y,N){const V=Y.tileID.canonical;if(!this._geoJSONIndex)return N(null,null);const H=this._geoJSONIndex.getTile(V.z,V.x,V.y);if(!H)return N(null,null);const ee=new class{constructor(ue){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=g.EXTENT,this.length=ue.length,this._features=ue}feature(ue){return new class{constructor(ae){this._feature=ae,this.extent=g.EXTENT,this.type=ae.type,this.properties=ae.tags,"id"in ae&&!isNaN(ae.id)&&(this.id=parseInt(ae.id,10))}loadGeometry(){if(1===this._feature.type){const ae=[];for(const se of this._feature.geometry)ae.push([new g.Point(se[0],se[1])]);return ae}{const ae=[];for(const se of this._feature.geometry){const he=[];for(const Te of se)he.push(new g.Point(Te[0],Te[1]));ae.push(he)}return ae}}toGeoJSON(ae,se,he){return xc.call(this,ae,se,he)}}(this._features[ue])}}(H.features);let ie=ca(ee);0===ie.byteOffset&&ie.byteLength===ie.buffer.byteLength||(ie=new Uint8Array(ie)),N(null,{vectorTile:ee,rawData:ie.buffer})}Us.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Us.prototype.splitTile=function(Y,N,V,H,ee,ie,ue){for(var ae=[Y,N,V,H],se=this.options,he=se.debug;ae.length;){H=ae.pop(),V=ae.pop(),N=ae.pop(),Y=ae.pop();var Te=1<<N,Ae=Lo(N,V,H),Ee=this.tiles[Ae];if(!Ee&&(he>1&&console.time("creation"),Ee=this.tiles[Ae]=lo(Y,N,V,H,se),this.tileCoords.push({z:N,x:V,y:H}),he)){he>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",N,V,H,Ee.numFeatures,Ee.numPoints,Ee.numSimplified),console.timeEnd("creation"));var _t="z"+N;this.stats[_t]=(this.stats[_t]||0)+1,this.total++}if(Ee.source=Y,ee){if(N===se.maxZoom||N===ee)continue;var St=1<<ee-N;if(V!==Math.floor(ie/St)||H!==Math.floor(ue/St))continue}else if(N===se.indexMaxZoom||Ee.numPoints<=se.indexMaxPoints)continue;if(Ee.source=null,0!==Y.length){he>1&&console.time("clipping");var ot,pt,Dt,Wt,vn,At,qt=.5*se.buffer/se.extent,ln=.5-qt,gt=.5+qt,bn=1+qt;ot=pt=Dt=Wt=null,vn=Jn(Y,Te,V-qt,V+gt,0,Ee.minX,Ee.maxX,se),At=Jn(Y,Te,V+ln,V+bn,0,Ee.minX,Ee.maxX,se),Y=null,vn&&(ot=Jn(vn,Te,H-qt,H+gt,1,Ee.minY,Ee.maxY,se),pt=Jn(vn,Te,H+ln,H+bn,1,Ee.minY,Ee.maxY,se),vn=null),At&&(Dt=Jn(At,Te,H-qt,H+gt,1,Ee.minY,Ee.maxY,se),Wt=Jn(At,Te,H+ln,H+bn,1,Ee.minY,Ee.maxY,se),At=null),he>1&&console.timeEnd("clipping"),ae.push(ot||[],N+1,2*V,2*H),ae.push(pt||[],N+1,2*V,2*H+1),ae.push(Dt||[],N+1,2*V+1,2*H),ae.push(Wt||[],N+1,2*V+1,2*H+1)}}},Us.prototype.getTile=function(Y,N,V){var H=this.options,ee=H.extent,ie=H.debug;if(Y<0||Y>24)return null;var ue=1<<Y,ae=Lo(Y,N=(N%ue+ue)%ue,V);if(this.tiles[ae])return Ct(this.tiles[ae],ee);ie>1&&console.log("drilling down to z%d-%d-%d",Y,N,V);for(var se,he=Y,Te=N,Ae=V;!se&&he>0;)he--,Te=Math.floor(Te/2),Ae=Math.floor(Ae/2),se=this.tiles[Lo(he,Te,Ae)];return se&&se.source?(ie>1&&console.log("found parent tile z%d-%d-%d",he,Te,Ae),ie>1&&console.time("drilling down"),this.splitTile(se.source,he,Te,Ae,Y,N,V),ie>1&&console.timeEnd("drilling down"),this.tiles[ae]?Ct(this.tiles[ae],ee):null):null};class Ol extends Os{constructor(N,V,H,ee){super(N,V,H,kn),this._dataUpdateable=new Map,this.loadGeoJSON=(ie,ue)=>{const{promoteId:ae}=ie;if(ie.request)return g.getJSON(ie.request,(se,he,Te,Ae)=>{this._dataUpdateable=No(he,ae)?Xi(he,ae):void 0,ue(se,he,Te,Ae)});if("string"==typeof ie.data)try{const se=JSON.parse(ie.data);this._dataUpdateable=No(se,ae)?Xi(se,ae):void 0,ue(null,se)}catch{ue(new Error(`Input data given to '${ie.source}' is not a valid GeoJSON object.`))}else ie.dataDiff?this._dataUpdateable?(function(se,he,Te){var Ae,Ee,_t,St;if(he.removeAll&&se.clear(),he.remove)for(const ot of he.remove)se.delete(ot);if(he.add)for(const ot of he.add){const pt=rs(ot,Te);null!=pt&&se.set(pt,ot)}if(he.update)for(const ot of he.update){let pt=se.get(ot.id);if(null==pt)continue;const Dt=!ot.removeAllProperties&&((null===(Ae=ot.removeProperties)||void 0===Ae?void 0:Ae.length)>0||(null===(Ee=ot.addOrUpdateProperties)||void 0===Ee?void 0:Ee.length)>0);if((ot.newGeometry||ot.removeAllProperties||Dt)&&(pt={...pt},se.set(ot.id,pt),Dt&&(pt.properties={...pt.properties})),ot.newGeometry&&(pt.geometry=ot.newGeometry),ot.removeAllProperties)pt.properties={};else if((null===(_t=ot.removeProperties)||void 0===_t?void 0:_t.length)>0)for(const Wt of ot.removeProperties)Object.prototype.hasOwnProperty.call(pt.properties,Wt)&&delete pt.properties[Wt];if((null===(St=ot.addOrUpdateProperties)||void 0===St?void 0:St.length)>0)for(const{key:Wt,value:vn}of ot.addOrUpdateProperties)pt.properties[Wt]=vn}}(this._dataUpdateable,ie.dataDiff,ae),ue(null,{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())})):ue(new Error(`Cannot update existing geojson data in ${ie.source}`)):ue(new Error(`Input data given to '${ie.source}' is not a valid GeoJSON object.`));return{cancel:()=>{}}},ee&&(this.loadGeoJSON=ee)}loadData(N,V){var H;null===(H=this._pendingRequest)||void 0===H||H.cancel(),this._pendingCallback&&this._pendingCallback(null,{abandoned:!0});const ee=!!(N&&N.request&&N.request.collectResourceTiming)&&new g.RequestPerformance(N.request);this._pendingCallback=V,this._pendingRequest=this.loadGeoJSON(N,(ie,ue)=>{if(delete this._pendingCallback,delete this._pendingRequest,ie||!ue)return V(ie);if("object"!=typeof ue)return V(new Error(`Input data given to '${N.source}' is not a valid GeoJSON object.`));{Kn(ue,!0);try{if(N.filter){const se=g.createExpression(N.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===se.result)throw new Error(se.value.map(Te=>`${Te.key}: ${Te.message}`).join(", "));ue={type:"FeatureCollection",features:ue.features.filter(Te=>se.value.evaluate({zoom:0},Te))}}this._geoJSONIndex=N.cluster?new Ka(function({superclusterOptions:se,clusterProperties:he}){if(!he||!se)return se;const Te={},Ae={},Ee={accumulated:null,zoom:0},_t={properties:null},St=Object.keys(he);for(const ot of St){const[pt,Dt]=he[ot],Wt=g.createExpression(Dt),vn=g.createExpression("string"==typeof pt?[pt,["accumulated"],["get",ot]]:pt);Te[ot]=Wt.value,Ae[ot]=vn.value}return se.map=ot=>{_t.properties=ot;const pt={};for(const Dt of St)pt[Dt]=Te[Dt].evaluate(Ee,_t);return pt},se.reduce=(ot,pt)=>{_t.properties=pt;for(const Dt of St)Ee.accumulated=ot[Dt],ot[Dt]=Ae[Dt].evaluate(Ee,_t)},se}(N)).load(ue.features):new Us(se=ue,N.geojsonVtOptions)}catch(se){return V(se)}this.loaded={};const ae={};if(ee){const se=ee.finish();se&&(ae.resourceTiming={},ae.resourceTiming[N.source]=JSON.parse(JSON.stringify(se)))}V(null,ae)}var se})}reloadTile(N,V){const H=this.loaded;return H&&H[N.uid]?super.reloadTile(N,V):this.loadTile(N,V)}removeSource(N,V){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),V()}getClusterExpansionZoom(N,V){try{V(null,this._geoJSONIndex.getClusterExpansionZoom(N.clusterId))}catch(H){V(H)}}getClusterChildren(N,V){try{V(null,this._geoJSONIndex.getChildren(N.clusterId))}catch(H){V(H)}}getClusterLeaves(N,V){try{V(null,this._geoJSONIndex.getLeaves(N.clusterId,N.limit,N.offset))}catch(H){V(H)}}}class js{constructor(N){this.self=N,this.actor=new g.Actor(N,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:Os,geojson:Ol},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(V,H)=>{if(this.workerSourceTypes[V])throw new Error(`Worker source with name "${V}" already registered.`);this.workerSourceTypes[V]=H},this.self.registerRTLTextPlugin=V=>{if(g.plugin.isParsed())throw new Error("RTL text plugin already registered.");g.plugin.applyArabicShaping=V.applyArabicShaping,g.plugin.processBidirectionalText=V.processBidirectionalText,g.plugin.processStyledBidirectionalText=V.processStyledBidirectionalText}}setReferrer(N,V){this.referrer=V}setImages(N,V,H){this.availableImages[N]=V;for(const ee in this.workerSources[N]){const ie=this.workerSources[N][ee];for(const ue in ie)ie[ue].availableImages=V}H()}setLayers(N,V,H){this.getLayerIndex(N).replace(V),H()}updateLayers(N,V,H){this.getLayerIndex(N).update(V.layers,V.removedIds),H()}loadTile(N,V,H){this.getWorkerSource(N,V.type,V.source).loadTile(V,H)}loadDEMTile(N,V,H){this.getDEMWorkerSource(N,V.source).loadTile(V,H)}reloadTile(N,V,H){this.getWorkerSource(N,V.type,V.source).reloadTile(V,H)}abortTile(N,V,H){this.getWorkerSource(N,V.type,V.source).abortTile(V,H)}removeTile(N,V,H){this.getWorkerSource(N,V.type,V.source).removeTile(V,H)}removeDEMTile(N,V){this.getDEMWorkerSource(N,V.source).removeTile(V)}removeSource(N,V,H){if(!this.workerSources[N]||!this.workerSources[N][V.type]||!this.workerSources[N][V.type][V.source])return;const ee=this.workerSources[N][V.type][V.source];delete this.workerSources[N][V.type][V.source],void 0!==ee.removeSource?ee.removeSource(V,H):H()}loadWorkerSource(N,V,H){try{this.self.importScripts(V.url),H()}catch(ee){H(ee.toString())}}syncRTLPluginState(N,V,H){try{g.plugin.setState(V);const ee=g.plugin.getPluginURL();if(g.plugin.isLoaded()&&!g.plugin.isParsed()&&null!=ee){this.self.importScripts(ee);const ie=g.plugin.isParsed();H(ie?void 0:new Error(`RTL Text Plugin failed to import scripts from ${ee}`),ie)}}catch(ee){H(ee.toString())}}getAvailableImages(N){let V=this.availableImages[N];return V||(V=[]),V}getLayerIndex(N){let V=this.layerIndexes[N];return V||(V=this.layerIndexes[N]=new mn),V}getWorkerSource(N,V,H){return this.workerSources[N]||(this.workerSources[N]={}),this.workerSources[N][V]||(this.workerSources[N][V]={}),this.workerSources[N][V][H]||(this.workerSources[N][V][H]=new this.workerSourceTypes[V]({send:(ie,ue,ae)=>{this.actor.send(ie,ue,ae,N)}},this.getLayerIndex(N),this.getAvailableImages(N))),this.workerSources[N][V][H]}getDEMWorkerSource(N,V){return this.demWorkerSources[N]||(this.demWorkerSources[N]={}),this.demWorkerSources[N][V]||(this.demWorkerSources[N][V]=new Xa),this.demWorkerSources[N][V]}}return g.isWorker()&&(self.worker=new js(self)),js}),Iu(0,function(g){class be{static testProp(o){if(!be.docStyle)return o[0];for(let u=0;u<o.length;u++)if(o[u]in be.docStyle)return o[u];return o[0]}static create(o,u,p){const m=window.document.createElement(o);return void 0!==u&&(m.className=u),p&&p.appendChild(m),m}static createNS(o,u){return window.document.createElementNS(o,u)}static disableDrag(){be.docStyle&&be.selectProp&&(be.userSelect=be.docStyle[be.selectProp],be.docStyle[be.selectProp]="none")}static enableDrag(){be.docStyle&&be.selectProp&&(be.docStyle[be.selectProp]=be.userSelect)}static setTransform(o,u){o.style[be.transformProp]=u}static addEventListener(o,u,p,m={}){o.addEventListener(u,p,"passive"in m?m:m.capture)}static removeEventListener(o,u,p,m={}){o.removeEventListener(u,p,"passive"in m?m:m.capture)}static suppressClickInternal(o){o.preventDefault(),o.stopPropagation(),window.removeEventListener("click",be.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",be.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",be.suppressClickInternal,!0)},0)}static mousePos(o,u){const p=o.getBoundingClientRect();return new g.Point(u.clientX-p.left-o.clientLeft,u.clientY-p.top-o.clientTop)}static touchPos(o,u){const p=o.getBoundingClientRect(),m=[];for(let b=0;b<u.length;b++)m.push(new g.Point(u[b].clientX-p.left-o.clientLeft,u[b].clientY-p.top-o.clientTop));return m}static mouseButton(o){return o.button}static remove(o){o.parentNode&&o.parentNode.removeChild(o)}}be.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,be.selectProp=be.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),be.transformProp=be.testProp(["transform","WebkitTransform"]);const Ar={supported:!1,testSupport:function(_){!Os&&kr&&(Xa?Ao(_):yt=_)}};let yt,kr,Os=!1,Xa=!1;function Ao(_){const o=_.createTexture();_.bindTexture(_.TEXTURE_2D,o);try{if(_.texImage2D(_.TEXTURE_2D,0,_.RGBA,_.RGBA,_.UNSIGNED_BYTE,kr),_.isContextLost())return;Ar.supported=!0}catch{}_.deleteTexture(o),Os=!0}var Ur,Kn,_;typeof document<"u"&&(kr=document.createElement("img"),kr.onload=function(){yt&&Ao(yt),yt=null,Xa=!0},kr.onerror=function(){Os=!0,yt=null},kr.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(_){let o,u,p,m;_.resetRequestQueue=()=>{o=[],u=0,p=0,m={}},_.addThrottleControl=k=>{const R=p++;return m[R]=k,R},_.removeThrottleControl=k=>{delete m[k],D()},_.getImage=(k,R,F=!0)=>{Ar.supported&&(k.headers||(k.headers={}),k.headers.accept="image/webp,*/*");const U={requestParameters:k,supportImageRefresh:F,callback:R,cancelled:!1,completed:!1,cancel:()=>{U.completed||U.cancelled||(U.cancelled=!0,U.innerRequest&&(U.innerRequest.cancel(),u--),D())}};return o.push(U),D(),U};const b=k=>{const{requestParameters:R,supportImageRefresh:F,callback:U}=k;return g.extend(R,{type:"image"}),(!1!==F||g.isWorker()||g.getProtocolAction(R.url)||R.headers&&!Object.keys(R.headers).reduce((X,W)=>X&&"accept"===W,!0)?g.makeRequest:M)(R,(X,W,J,q)=>{E(k,U,X,W,J,q)})},E=(k,R,F,U,X,W)=>{var J,q;F?R(F):U instanceof HTMLImageElement||g.isImageBitmap(U)?R(null,U):U&&(J=U,q=(J,q)=>{null!=J?R(J):null!=q&&R(null,q,{cacheControl:X,expires:W})},"function"==typeof createImageBitmap?g.arrayBufferToImageBitmap(J,q):g.arrayBufferToImage(J,q)),k.cancelled||(k.completed=!0,u--,D())},D=()=>{const k=(()=>{const R=Object.keys(m);let F=!1;if(R.length>0)for(const U of R)if(F=m[U](),F)break;return F})()?g.config.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:g.config.MAX_PARALLEL_IMAGE_REQUESTS;for(let R=u;R<k&&o.length>0;R++){const F=o.shift();if(F.cancelled){R--;continue}const U=b(F);u++,F.innerRequest=U}},M=(k,R)=>{const F=new Image,U=k.url;let X=!1;const W=k.credentials;return W&&"include"===W?F.crossOrigin="use-credentials":(W&&"same-origin"===W||!g.sameOrigin(U))&&(F.crossOrigin="anonymous"),F.fetchPriority="high",F.onload=()=>{R(null,F),F.onerror=F.onload=null},F.onerror=()=>{X||R(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.")),F.onerror=F.onload=null},F.src=U,{cancel:()=>{X=!0,F.src=""}}}}(Ur||(Ur={})),Ur.resetRequestQueue(),(_=Kn||(Kn={})).Glyphs="Glyphs",_.Image="Image",_.Source="Source",_.SpriteImage="SpriteImage",_.SpriteJSON="SpriteJSON",_.Style="Style",_.Tile="Tile",_.Unknown="Unknown";class xc{constructor(o){this._transformRequestFn=o}transformRequest(o,u){return this._transformRequestFn&&this._transformRequestFn(o,u)||{url:o}}normalizeSpriteURL(o,u,p){const m=function(b){const E=b.match(qi);if(!E)throw new Error(`Unable to parse URL "${b}"`);return{protocol:E[1],authority:E[2],path:E[3]||"/",params:E[4]?E[4].split("&"):[]}}(o);return m.path+=`${u}${p}`,function(b){const E=b.params.length?`?${b.params.join("&")}`:"";return`${b.protocol}://${b.authority}${b.path}${E}`}(m)}setTransformRequest(o){this._transformRequestFn=o}}const qi=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Fs(_){var o=new g.ARRAY_TYPE(3);return o[0]=_[0],o[1]=_[1],o[2]=_[2],o}var gs,Rl=function(_,o,u){return _[0]=o[0]-u[0],_[1]=o[1]-u[1],_[2]=o[2]-u[2],_};gs=new g.ARRAY_TYPE(3),g.ARRAY_TYPE!=Float32Array&&(gs[0]=0,gs[1]=0,gs[2]=0);var Pr=function(_){var o=_[0],u=_[1];return o*o+u*u};function Ls(_){const o=[];if("string"==typeof _)o.push({id:"default",url:_});else if(_&&_.length>0){const u=[];for(const{id:p,url:m}of _){const b=`${p}${m}`;-1===u.indexOf(b)&&(u.push(b),o.push({id:p,url:m}))}}return o}function Zi(_,o,u,p,m){if(p)return void _(p);if(m!==Object.values(o).length||m!==Object.values(u).length)return;const b={};for(const E in o){b[E]={};const D=g.browser.getImageCanvasContext(u[E]),M=o[E];for(const k in M){const{width:R,height:F,x:U,y:X,sdf:W,pixelRatio:J,stretchX:q,stretchY:le,content:me}=M[k];b[E][k]={data:null,pixelRatio:J,sdf:W,stretchX:q,stretchY:le,content:me,spriteData:{width:R,height:F,x:U,y:X,context:D}}}}_(null,b)}!function(){var _=new g.ARRAY_TYPE(2);g.ARRAY_TYPE!=Float32Array&&(_[0]=0,_[1]=0)}();class gn{constructor(o,u,p,m){this.context=o,this.format=p,this.texture=o.gl.createTexture(),this.update(u,m)}update(o,u,p){const{width:m,height:b}=o,E=!(this.size&&this.size[0]===m&&this.size[1]===b||p),{context:D}=this,{gl:M}=D;if(this.useMipmap=!(!u||!u.useMipmap),M.bindTexture(M.TEXTURE_2D,this.texture),D.pixelStoreUnpackFlipY.set(!1),D.pixelStoreUnpack.set(1),D.pixelStoreUnpackPremultiplyAlpha.set(this.format===M.RGBA&&(!u||!1!==u.premultiply)),E)this.size=[m,b],o instanceof HTMLImageElement||o instanceof HTMLCanvasElement||o instanceof HTMLVideoElement||o instanceof ImageData||g.isImageBitmap(o)?M.texImage2D(M.TEXTURE_2D,0,this.format,this.format,M.UNSIGNED_BYTE,o):M.texImage2D(M.TEXTURE_2D,0,this.format,m,b,0,this.format,M.UNSIGNED_BYTE,o.data);else{const{x:k,y:R}=p||{x:0,y:0};o instanceof HTMLImageElement||o instanceof HTMLCanvasElement||o instanceof HTMLVideoElement||o instanceof ImageData||g.isImageBitmap(o)?M.texSubImage2D(M.TEXTURE_2D,0,k,R,M.RGBA,M.UNSIGNED_BYTE,o):M.texSubImage2D(M.TEXTURE_2D,0,k,R,m,b,M.RGBA,M.UNSIGNED_BYTE,o.data)}this.useMipmap&&this.isSizePowerOfTwo()&&M.generateMipmap(M.TEXTURE_2D)}bind(o,u,p){const{context:m}=this,{gl:b}=m;b.bindTexture(b.TEXTURE_2D,this.texture),p!==b.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(p=b.LINEAR),o!==this.filter&&(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,o),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,p||o),this.filter=o),u!==this.wrap&&(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,u),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,u),this.wrap=u)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:o}=this.context;o.deleteTexture(this.texture),this.texture=null}}function oo(_){const{userImage:o}=_;return!!(o&&o.render&&o.render())&&(_.data.replace(new Uint8Array(o.data.buffer)),!0)}class mr extends g.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new g.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(o){if(this.loaded!==o&&(this.loaded=o,o)){for(const{ids:u,callback:p}of this.requestors)this._notify(u,p);this.requestors=[]}}getImage(o){const u=this.images[o];if(u&&!u.data&&u.spriteData){const p=u.spriteData;u.data=new g.RGBAImage({width:p.width,height:p.height},p.context.getImageData(p.x,p.y,p.width,p.height).data),u.spriteData=null}return u}addImage(o,u){if(this.images[o])throw new Error(`Image id ${o} already exist, use updateImage instead`);this._validate(o,u)&&(this.images[o]=u)}_validate(o,u){let p=!0;const m=u.data||u.spriteData;return this._validateStretch(u.stretchX,m&&m.width)||(this.fire(new g.ErrorEvent(new Error(`Image "${o}" has invalid "stretchX" value`))),p=!1),this._validateStretch(u.stretchY,m&&m.height)||(this.fire(new g.ErrorEvent(new Error(`Image "${o}" has invalid "stretchY" value`))),p=!1),this._validateContent(u.content,u)||(this.fire(new g.ErrorEvent(new Error(`Image "${o}" has invalid "content" value`))),p=!1),p}_validateStretch(o,u){if(!o)return!0;let p=0;for(const m of o){if(m[0]<p||m[1]<m[0]||u<m[1])return!1;p=m[1]}return!0}_validateContent(o,u){if(!o)return!0;if(4!==o.length)return!1;const p=u.spriteData,m=p&&p.width||u.data.width,b=p&&p.height||u.data.height;return!(o[0]<0||m<o[0]||o[1]<0||b<o[1]||o[2]<0||m<o[2]||o[3]<0||b<o[3]||o[2]<o[0]||o[3]<o[1])}updateImage(o,u,p=!0){const m=this.getImage(o);if(p&&(m.data.width!==u.data.width||m.data.height!==u.data.height))throw new Error(`size mismatch between old image (${m.data.width}x${m.data.height}) and new image (${u.data.width}x${u.data.height}).`);u.version=m.version+1,this.images[o]=u,this.updatedImages[o]=!0}removeImage(o){const u=this.images[o];delete this.images[o],delete this.patterns[o],u.userImage&&u.userImage.onRemove&&u.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(o,u){let p=!0;if(!this.isLoaded())for(const m of o)this.images[m]||(p=!1);this.isLoaded()||p?this._notify(o,u):this.requestors.push({ids:o,callback:u})}_notify(o,u){const p={};for(const m of o){let b=this.getImage(m);b||(this.fire(new g.Event("styleimagemissing",{id:m})),b=this.getImage(m)),b?p[m]={data:b.data.clone(),pixelRatio:b.pixelRatio,sdf:b.sdf,version:b.version,stretchX:b.stretchX,stretchY:b.stretchY,content:b.content,hasRenderCallback:!(!b.userImage||!b.userImage.render)}:g.warnOnce(`Image "${m}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}u(null,p)}getPixelSize(){const{width:o,height:u}=this.atlasImage;return{width:o,height:u}}getPattern(o){const u=this.patterns[o],p=this.getImage(o);if(!p)return null;if(u&&u.position.version===p.version)return u.position;if(u)u.position.version=p.version;else{const m={w:p.data.width+2,h:p.data.height+2,x:0,y:0},b=new g.ImagePosition(m,p);this.patterns[o]={bin:m,position:b}}return this._updatePatternAtlas(),this.patterns[o].position}bind(o){const u=o.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new gn(o,this.atlasImage,u.RGBA),this.atlasTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE)}_updatePatternAtlas(){const o=[];for(const b in this.patterns)o.push(this.patterns[b].bin);const{w:u,h:p}=g.potpack(o),m=this.atlasImage;m.resize({width:u||1,height:p||1});for(const b in this.patterns){const{bin:E}=this.patterns[b],D=E.x+1,M=E.y+1,k=this.getImage(b).data,R=k.width,F=k.height;g.RGBAImage.copy(k,m,{x:0,y:0},{x:D,y:M},{width:R,height:F}),g.RGBAImage.copy(k,m,{x:0,y:F-1},{x:D,y:M-1},{width:R,height:1}),g.RGBAImage.copy(k,m,{x:0,y:0},{x:D,y:M+F},{width:R,height:1}),g.RGBAImage.copy(k,m,{x:R-1,y:0},{x:D-1,y:M},{width:1,height:F}),g.RGBAImage.copy(k,m,{x:0,y:0},{x:D+R,y:M},{width:1,height:F})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(o){for(const u of o){if(this.callbackDispatchedThisFrame[u])continue;this.callbackDispatchedThisFrame[u]=!0;const p=this.getImage(u);p||g.warnOnce(`Image with ID: "${u}" was not found`),oo(p)&&this.updateImage(u,p)}}}const ao=1e20;function ko(_,o,u,p,m,b,E,D,M){for(let k=o;k<o+p;k++)Po(_,u*b+k,b,m,E,D,M);for(let k=u;k<u+m;k++)Po(_,k*b+o,1,p,E,D,M)}function Po(_,o,u,p,m,b,E){b[0]=0,E[0]=-ao,E[1]=ao,m[0]=_[o];for(let D=1,M=0,k=0;D<p;D++){m[D]=_[o+D*u];const R=D*D;do{const F=b[M];k=(m[D]-m[F]+R-F*F)/(D-F)/2}while(k<=E[M]&&--M>-1);M++,b[M]=D,E[M]=k,E[M+1]=ao}for(let D=0,M=0;D<p;D++){for(;E[M+1]<D;)M++;const k=b[M],R=D-k;_[o+D*u]=m[k]+R*R}}class ts{constructor(o,u){this.requestManager=o,this.localIdeographFontFamily=u,this.entries={}}setURL(o){this.url=o}getGlyphs(o,u){const p=[];for(const m in o)for(const b of o[m])p.push({stack:m,id:b});g.asyncAll(p,({stack:m,id:b},E)=>{let D=this.entries[m];D||(D=this.entries[m]={glyphs:{},requests:{},ranges:{}});let M=D.glyphs[b];if(void 0!==M)return void E(null,{stack:m,id:b,glyph:M});if(M=this._tinySDF(D,m,b),M)return D.glyphs[b]=M,void E(null,{stack:m,id:b,glyph:M});const k=Math.floor(b/256);if(256*k>65535)return void E(new Error("glyphs > 65535 not supported"));if(D.ranges[k])return void E(null,{stack:m,id:b,glyph:M});if(!this.url)return void E(new Error("glyphsUrl is not set"));let R=D.requests[k];R||(R=D.requests[k]=[],ts.loadGlyphRange(m,k,this.url,this.requestManager,(F,U)=>{if(U){for(const X in U)this._doesCharSupportLocalGlyph(+X)||(D.glyphs[+X]=U[+X]);D.ranges[k]=!0}for(const X of R)X(F,U);delete D.requests[k]})),R.push((F,U)=>{F?E(F):U&&E(null,{stack:m,id:b,glyph:U[b]||null})})},(m,b)=>{if(m)u(m);else if(b){const E={};for(const{stack:D,id:M,glyph:k}of b)(E[D]||(E[D]={}))[M]=k&&{id:k.id,bitmap:k.bitmap.clone(),metrics:k.metrics};u(null,E)}})}_doesCharSupportLocalGlyph(o){return!!this.localIdeographFontFamily&&(g.unicodeBlockLookup["CJK Unified Ideographs"](o)||g.unicodeBlockLookup["Hangul Syllables"](o)||g.unicodeBlockLookup.Hiragana(o)||g.unicodeBlockLookup.Katakana(o))}_tinySDF(o,u,p){const m=this.localIdeographFontFamily;if(!m||!this._doesCharSupportLocalGlyph(p))return;let b=o.tinySDF;if(!b){let D="400";/bold/i.test(u)?D="900":/medium/i.test(u)?D="500":/light/i.test(u)&&(D="200"),b=o.tinySDF=new ts.TinySDF({fontSize:24,buffer:3,radius:8,cutoff:.25,fontFamily:m,fontWeight:D})}const E=b.draw(String.fromCharCode(p));return{id:p,bitmap:new g.AlphaImage({width:E.width||30,height:E.height||30},E.data),metrics:{width:E.glyphWidth||24,height:E.glyphHeight||24,left:E.glyphLeft||0,top:E.glyphTop-27||-8,advance:E.glyphAdvance||24}}}}ts.loadGlyphRange=function(_,o,u,p,m){const b=256*o,E=b+255,D=p.transformRequest(u.replace("{fontstack}",_).replace("{range}",`${b}-${E}`),Kn.Glyphs);g.getArrayBuffer(D,(M,k)=>{if(M)m(M);else if(k){const R={};for(const F of g.parseGlyphPbf(k))R[F.id]=F;m(null,R)}})},ts.TinySDF=class{constructor({fontSize:_=24,buffer:o=3,radius:u=8,cutoff:p=.25,fontFamily:m="sans-serif",fontWeight:b="normal",fontStyle:E="normal"}={}){this.buffer=o,this.cutoff=p,this.radius=u;const D=this.size=_+4*o,M=this._createCanvas(D),k=this.ctx=M.getContext("2d",{willReadFrequently:!0});k.font=`${E} ${b} ${_}px ${m}`,k.textBaseline="alphabetic",k.textAlign="left",k.fillStyle="black",this.gridOuter=new Float64Array(D*D),this.gridInner=new Float64Array(D*D),this.f=new Float64Array(D),this.z=new Float64Array(D+1),this.v=new Uint16Array(D)}_createCanvas(_){const o=document.createElement("canvas");return o.width=o.height=_,o}draw(_){const{width:o,actualBoundingBoxAscent:u,actualBoundingBoxDescent:p,actualBoundingBoxLeft:m,actualBoundingBoxRight:b}=this.ctx.measureText(_),E=Math.ceil(u),D=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(b-m))),M=Math.min(this.size-this.buffer,E+Math.ceil(p)),k=D+2*this.buffer,R=M+2*this.buffer,F=Math.max(k*R,0),U=new Uint8ClampedArray(F),X={data:U,width:k,height:R,glyphWidth:D,glyphHeight:M,glyphTop:E,glyphLeft:0,glyphAdvance:o};if(0===D||0===M)return X;const{ctx:W,buffer:J,gridInner:q,gridOuter:le}=this;W.clearRect(J,J,D,M),W.fillText(_,J,J+E);const me=W.getImageData(J,J,D,M);le.fill(ao,0,F),q.fill(0,0,F);for(let te=0;te<M;te++)for(let ce=0;ce<D;ce++){const ye=me.data[4*(te*D+ce)+3]/255;if(0===ye)continue;const ve=(te+J)*k+ce+J;if(1===ye)le[ve]=0,q[ve]=ao;else{const Se=.5-ye;le[ve]=Se>0?Se*Se:0,q[ve]=Se<0?Se*Se:0}}ko(le,0,0,k,R,k,this.f,this.v,this.z),ko(q,J,J,D,M,k,this.f,this.v,this.z);for(let te=0;te<F;te++){const ce=Math.sqrt(le[te])-Math.sqrt(q[te]);U[te]=Math.round(255-255*(ce/this.radius+this.cutoff))}return X}};class jr{constructor(){this.specification=g.v8Spec.light.position}possiblyEvaluate(o,u){return g.sphericalToCartesian(o.expression.evaluate(u))}interpolate(o,u,p){return{x:g.interpolate.number(o.x,u.x,p),y:g.interpolate.number(o.y,u.y,p),z:g.interpolate.number(o.z,u.z,p)}}}let la,ca;class Ln extends g.Evented{constructor(o){super(),la=la||new g.Properties({anchor:new g.DataConstantProperty(g.v8Spec.light.anchor),position:new jr,color:new g.DataConstantProperty(g.v8Spec.light.color),intensity:new g.DataConstantProperty(g.v8Spec.light.intensity)}),this._transitionable=new g.Transitionable(la),this.setLight(o),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(o,u={}){if(!this._validate(g.validateLight,o,u))for(const p in o){const m=o[p];p.endsWith("-transition")?this._transitionable.setTransition(p.slice(0,-11),m):this._transitionable.setValue(p,m)}}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}_validate(o,u,p){return(!p||!1!==p.validate)&&g.emitValidationErrors(this,o.call(g.validateStyle,g.extend({value:u,style:{glyphs:!0,sprite:!0},styleSpec:g.v8Spec})))}}class Ro{constructor(o,u){this.width=o,this.height=u,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(o,u){const p=o.join(",")+String(u);return this.dashEntry[p]||(this.dashEntry[p]=this.addDash(o,u)),this.dashEntry[p]}getDashRanges(o,u,p){const m=[];let b=o.length%2==1?-o[o.length-1]*p:0,E=o[0]*p,D=!0;m.push({left:b,right:E,isDash:D,zeroLength:0===o[0]});let M=o[0];for(let k=1;k<o.length;k++){D=!D;const R=o[k];b=M*p,M+=R,E=M*p,m.push({left:b,right:E,isDash:D,zeroLength:0===R})}return m}addRoundDash(o,u,p){const m=u/2;for(let b=-p;b<=p;b++){const E=this.width*(this.nextRow+p+b);let D=0,M=o[D];for(let k=0;k<this.width;k++){k/M.right>1&&(M=o[++D]);const R=Math.abs(k-M.left),F=Math.abs(k-M.right),U=Math.min(R,F);let X;const W=b/p*(m+1);if(M.isDash){const J=m-Math.abs(W);X=Math.sqrt(U*U+J*J)}else X=m-Math.sqrt(U*U+W*W);this.data[E+k]=Math.max(0,Math.min(255,X+128))}}}addRegularDash(o){for(let D=o.length-1;D>=0;--D){const M=o[D],k=o[D+1];M.zeroLength?o.splice(D,1):k&&k.isDash===M.isDash&&(k.left=M.left,o.splice(D,1))}const u=o[0],p=o[o.length-1];u.isDash===p.isDash&&(u.left=p.left-this.width,p.right=u.right+this.width);const m=this.width*this.nextRow;let b=0,E=o[b];for(let D=0;D<this.width;D++){D/E.right>1&&(E=o[++b]);const M=Math.abs(D-E.left),k=Math.abs(D-E.right),R=Math.min(M,k);this.data[m+D]=Math.max(0,Math.min(255,(E.isDash?R:-R)+128))}}addDash(o,u){const p=u?7:0,m=2*p+1;if(this.nextRow+m>this.height)return g.warnOnce("LineAtlas out of space"),null;let b=0;for(let D=0;D<o.length;D++)b+=o[D];if(0!==b){const D=this.width/b,M=this.getDashRanges(o,this.width,D);u?this.addRoundDash(M,D,p):this.addRegularDash(M)}const E={y:(this.nextRow+p+.5)/this.height,height:2*p/this.height,width:b};return this.nextRow+=m,this.dirty=!0,E}bind(o){const u=o.gl;this.texture?(u.bindTexture(u.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,u.texSubImage2D(u.TEXTURE_2D,0,0,0,this.width,this.height,u.ALPHA,u.UNSIGNED_BYTE,this.data))):(this.texture=u.createTexture(),u.bindTexture(u.TEXTURE_2D,this.texture),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,u.REPEAT),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,u.REPEAT),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,u.LINEAR),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,u.LINEAR),u.texImage2D(u.TEXTURE_2D,0,u.ALPHA,this.width,this.height,0,u.ALPHA,u.UNSIGNED_BYTE,this.data))}}class Ns{constructor(o,u,p){this.workerPool=o,this.actors=[],this.currentActor=0,this.id=p;const m=this.workerPool.acquire(p);for(let b=0;b<m.length;b++){const E=new Ns.Actor(m[b],u,p);E.name=`Worker ${b}`,this.actors.push(E)}if(!this.actors.length)throw new Error("No actors found")}broadcast(o,u,p){g.asyncAll(this.actors,(m,b)=>{m.send(o,u,b)},p=p||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(o=!0){this.actors.forEach(u=>{u.remove()}),this.actors=[],o&&this.workerPool.release(this.id)}}function ns(_,o,u){const p=function(m,b){if(m)return u(m);if(b){const E=g.pick(g.extend(b,_),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);b.vector_layers&&(E.vectorLayers=b.vector_layers,E.vectorLayerIds=E.vectorLayers.map(D=>D.id)),u(null,E)}};return _.url?g.getJSON(o.transformRequest(_.url,Kn.Source),p):g.browser.frame(()=>p(null,_))}Ns.Actor=g.Actor;class Yn{constructor(o,u){o&&(u?this.setSouthWest(o).setNorthEast(u):Array.isArray(o)&&(4===o.length?this.setSouthWest([o[0],o[1]]).setNorthEast([o[2],o[3]]):this.setSouthWest(o[0]).setNorthEast(o[1])))}setNorthEast(o){return this._ne=o instanceof g.LngLat?new g.LngLat(o.lng,o.lat):g.LngLat.convert(o),this}setSouthWest(o){return this._sw=o instanceof g.LngLat?new g.LngLat(o.lng,o.lat):g.LngLat.convert(o),this}extend(o){const u=this._sw,p=this._ne;let m,b;if(o instanceof g.LngLat)m=o,b=o;else{if(!(o instanceof Yn))return Array.isArray(o)?4===o.length||o.every(Array.isArray)?this.extend(Yn.convert(o)):this.extend(g.LngLat.convert(o)):o&&("lng"in o||"lon"in o)&&"lat"in o?this.extend(g.LngLat.convert(o)):this;if(m=o._sw,b=o._ne,!m||!b)return this}return u||p?(u.lng=Math.min(m.lng,u.lng),u.lat=Math.min(m.lat,u.lat),p.lng=Math.max(b.lng,p.lng),p.lat=Math.max(b.lat,p.lat)):(this._sw=new g.LngLat(m.lng,m.lat),this._ne=new g.LngLat(b.lng,b.lat)),this}getCenter(){return new g.LngLat((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new g.LngLat(this.getWest(),this.getNorth())}getSouthEast(){return new g.LngLat(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(o){const{lng:u,lat:p}=g.LngLat.convert(o);let m=this._sw.lng<=u&&u<=this._ne.lng;return this._sw.lng>this._ne.lng&&(m=this._sw.lng>=u&&u>=this._ne.lng),this._sw.lat<=p&&p<=this._ne.lat&&m}static convert(o){return o instanceof Yn?o:o&&new Yn(o)}static fromLngLat(o,u=0){const p=360*u/40075017,m=p/Math.cos(Math.PI/180*o.lat);return new Yn(new g.LngLat(o.lng-m,o.lat-p),new g.LngLat(o.lng+m,o.lat+p))}}class ci{constructor(o,u,p){this.bounds=Yn.convert(this.validateBounds(o)),this.minzoom=u||0,this.maxzoom=p||24}validateBounds(o){return Array.isArray(o)&&4===o.length?[Math.max(-180,o[0]),Math.max(-90,o[1]),Math.min(180,o[2]),Math.min(90,o[3])]:[-180,-90,180,90]}contains(o){const u=Math.pow(2,o.z),p=Math.floor(g.mercatorXfromLng(this.bounds.getWest())*u),m=Math.floor(g.mercatorYfromLat(this.bounds.getNorth())*u),b=Math.ceil(g.mercatorXfromLng(this.bounds.getEast())*u),E=Math.ceil(g.mercatorYfromLat(this.bounds.getSouth())*u);return o.x>=p&&o.x<b&&o.y>=m&&o.y<E}}class Ka extends g.Evented{constructor(o,u,p,m){if(super(),this.load=()=>{this._loaded=!1,this.fire(new g.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=ns(this._options,this.map._requestManager,(b,E)=>{this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),b?this.fire(new g.ErrorEvent(b)):E&&(g.extend(this,E),E.bounds&&(this.tileBounds=new ci(E.bounds,this.minzoom,this.maxzoom)),this.fire(new g.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new g.Event("data",{dataType:"source",sourceDataType:"content"})))})},this.serialize=()=>g.extend({},this._options),this.id=o,this.dispatcher=p,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,g.extend(this,g.pick(u,["url","scheme","tileSize","promoteId"])),this._options=g.extend({type:"vector"},u),this._collectResourceTiming=u.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(m)}loaded(){return this._loaded}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}onAdd(o){this.map=o,this.load()}setSourceProperty(o){this._tileJSONRequest&&this._tileJSONRequest.cancel(),o(),this.load()}setTiles(o){return this.setSourceProperty(()=>{this._options.tiles=o}),this}setUrl(o){return this.setSourceProperty(()=>{this.url=o,this._options.url=o}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}loadTile(o,u){const p=o.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),m={request:this.map._requestManager.transformRequest(p,Kn.Tile),uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,tileSize:this.tileSize*o.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function b(E,D){return delete o.request,o.aborted?u(null):E&&404!==E.status?u(E):(D&&D.resourceTiming&&(o.resourceTiming=D.resourceTiming),this.map._refreshExpiredTiles&&D&&o.setExpiryData(D),o.loadVectorData(D,this.map.painter),u(null),void(o.reloadCallback&&(this.loadTile(o,o.reloadCallback),o.reloadCallback=null)))}m.request.collectResourceTiming=this._collectResourceTiming,o.actor&&"expired"!==o.state?"loading"===o.state?o.reloadCallback=u:o.request=o.actor.send("reloadTile",m,b.bind(this)):(o.actor=this.dispatcher.getActor(),o.request=o.actor.send("loadTile",m,b.bind(this)))}abortTile(o){o.request&&(o.request.cancel(),delete o.request),o.actor&&o.actor.send("abortTile",{uid:o.uid,type:this.type,source:this.id},void 0)}unloadTile(o){o.unloadVectorData(),o.actor&&o.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id},void 0)}hasTransition(){return!1}}class Oo extends g.Evented{constructor(o,u,p,m){super(),this.id=o,this.dispatcher=p,this.setEventedParent(m),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=g.extend({type:"raster"},u),g.extend(this,g.pick(u,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new g.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=ns(this._options,this.map._requestManager,(o,u)=>{this._tileJSONRequest=null,this._loaded=!0,o?this.fire(new g.ErrorEvent(o)):u&&(g.extend(this,u),u.bounds&&(this.tileBounds=new ci(u.bounds,this.minzoom,this.maxzoom)),this.fire(new g.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new g.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(o){this.map=o,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return g.extend({},this._options)}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}loadTile(o,u){const p=o.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);o.request=Ur.getImage(this.map._requestManager.transformRequest(p,Kn.Tile),(m,b,E)=>{if(delete o.request,o.aborted)o.state="unloaded",u(null);else if(m)o.state="errored",u(m);else if(b){this.map._refreshExpiredTiles&&E&&o.setExpiryData(E);const D=this.map.painter.context,M=D.gl;o.texture=this.map.painter.getTileTexture(b.width),o.texture?o.texture.update(b,{useMipmap:!0}):(o.texture=new gn(D,b,M.RGBA,{useMipmap:!0}),o.texture.bind(M.LINEAR,M.CLAMP_TO_EDGE,M.LINEAR_MIPMAP_NEAREST),D.extTextureFilterAnisotropic&&M.texParameterf(M.TEXTURE_2D,D.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,D.extTextureFilterAnisotropicMax)),o.state="loaded",u(null)}},this.map._refreshExpiredTiles)}abortTile(o,u){o.request&&(o.request.cancel(),delete o.request),u()}unloadTile(o,u){o.texture&&this.map.painter.saveTileTexture(o.texture),u()}hasTransition(){return!1}}class Vn extends Oo{constructor(o,u,p,m){super(o,u,p,m),this.type="raster-dem",this.maxzoom=22,this._options=g.extend({type:"raster-dem"},u),this.encoding=u.encoding||"mapbox"}loadTile(o,u){const p=o.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);function m(b,E){b&&(o.state="errored",u(b)),E&&(o.dem=E,o.needsHillshadePrepare=!0,o.needsTerrainPrepare=!0,o.state="loaded",u(null))}o.request=Ur.getImage(this.map._requestManager.transformRequest(p,Kn.Tile),function(b,E){if(delete o.request,o.aborted)o.state="unloaded",u(null);else if(b)o.state="errored",u(b);else if(E){this.map._refreshExpiredTiles&&o.setExpiryData(E),delete E.cacheControl,delete E.expires;const D=g.isImageBitmap(E)&&(null==ca&&(ca=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof createImageBitmap),ca)?E:g.browser.getImageData(E,1),M={uid:o.uid,coord:o.tileID,source:this.id,rawImageData:D,encoding:this.encoding};o.actor&&"expired"!==o.state||(o.actor=this.dispatcher.getActor(),o.actor.send("loadDEMTile",M,m.bind(this)))}}.bind(this),this.map._refreshExpiredTiles),o.neighboringTiles=this._getNeighboringTiles(o.tileID)}_getNeighboringTiles(o){const u=o.canonical,p=Math.pow(2,u.z),m=(u.x-1+p)%p,b=0===u.x?o.wrap-1:o.wrap,E=(u.x+1+p)%p,D=u.x+1===p?o.wrap+1:o.wrap,M={};return M[new g.OverscaledTileID(o.overscaledZ,b,u.z,m,u.y).key]={backfilled:!1},M[new g.OverscaledTileID(o.overscaledZ,D,u.z,E,u.y).key]={backfilled:!1},u.y>0&&(M[new g.OverscaledTileID(o.overscaledZ,b,u.z,m,u.y-1).key]={backfilled:!1},M[new g.OverscaledTileID(o.overscaledZ,o.wrap,u.z,u.x,u.y-1).key]={backfilled:!1},M[new g.OverscaledTileID(o.overscaledZ,D,u.z,E,u.y-1).key]={backfilled:!1}),u.y+1<p&&(M[new g.OverscaledTileID(o.overscaledZ,b,u.z,m,u.y+1).key]={backfilled:!1},M[new g.OverscaledTileID(o.overscaledZ,o.wrap,u.z,u.x,u.y+1).key]={backfilled:!1},M[new g.OverscaledTileID(o.overscaledZ,D,u.z,E,u.y+1).key]={backfilled:!1}),M}unloadTile(o){o.demTexture&&this.map.painter.saveTileTexture(o.demTexture),o.fbo&&(o.fbo.destroy(),delete o.fbo),o.dem&&delete o.dem,delete o.neighboringTiles,o.state="unloaded",o.actor&&o.actor.send("removeDEMTile",{uid:o.uid,source:this.id})}}class _n extends g.Evented{constructor(o,u,p,m){super(),this.load=()=>{this._updateWorkerData()},this.serialize=()=>g.extend({},this._options,{type:this.type,data:this._data}),this.id=o,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=p.getActor(),this.setEventedParent(m),this._data=u.data,this._options=g.extend({},u),this._collectResourceTiming=u.collectResourceTiming,void 0!==u.maxzoom&&(this.maxzoom=u.maxzoom),u.type&&(this.type=u.type),u.attribution&&(this.attribution=u.attribution),this.promoteId=u.promoteId;const b=g.EXTENT/this.tileSize;this.workerOptions=g.extend({source:this.id,cluster:u.cluster||!1,geojsonVtOptions:{buffer:(void 0!==u.buffer?u.buffer:128)*b,tolerance:(void 0!==u.tolerance?u.tolerance:.375)*b,extent:g.EXTENT,maxZoom:this.maxzoom,lineMetrics:u.lineMetrics||!1,generateId:u.generateId||!1},superclusterOptions:{maxZoom:void 0!==u.clusterMaxZoom?u.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,u.clusterMinPoints||2),extent:g.EXTENT,radius:(u.clusterRadius||50)*b,log:!1,generateId:u.generateId||!1},clusterProperties:u.clusterProperties,filter:u.filter},u.workerOptions),"string"==typeof this.promoteId&&(this.workerOptions.promoteId=this.promoteId)}onAdd(o){this.map=o,this.load()}setData(o){return this._data=o,this._updateWorkerData(),this}updateData(o){return this._updateWorkerData(o),this}setClusterOptions(o){return this.workerOptions.cluster=o.cluster,o&&(void 0!==o.clusterRadius&&(this.workerOptions.superclusterOptions.radius=o.clusterRadius),void 0!==o.clusterMaxZoom&&(this.workerOptions.superclusterOptions.maxZoom=o.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(o,u){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:o,source:this.id},u),this}getClusterChildren(o,u){return this.actor.send("geojson.getClusterChildren",{clusterId:o,source:this.id},u),this}getClusterLeaves(o,u,p,m){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:o,limit:u,offset:p},m),this}_updateWorkerData(o){const u=g.extend({},this.workerOptions);o?u.dataDiff=o:"string"==typeof this._data?(u.request=this.map._requestManager.transformRequest(g.browser.resolveURL(this._data),Kn.Source),u.request.collectResourceTiming=this._collectResourceTiming):u.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new g.Event("dataloading",{dataType:"source"})),this.actor.send(`${this.type}.loadData`,u,(p,m)=>{if(this._pendingLoads--,this._removed||m&&m.abandoned)return void this.fire(new g.Event("dataabort",{dataType:"source"}));let b=null;if(m&&m.resourceTiming&&m.resourceTiming[this.id]&&(b=m.resourceTiming[this.id].slice(0)),p)return void this.fire(new g.ErrorEvent(p));const E={dataType:"source"};this._collectResourceTiming&&b&&b.length>0&&g.extend(E,{resourceTiming:b}),this.fire(new g.Event("data",{...E,sourceDataType:"metadata"})),this.fire(new g.Event("data",{...E,sourceDataType:"content"}))})}loaded(){return 0===this._pendingLoads}loadTile(o,u){const p=o.actor?"reloadTile":"loadTile";o.actor=this.actor;const m={type:this.type,uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};o.request=this.actor.send(p,m,(b,E)=>(delete o.request,o.unloadVectorData(),o.aborted?u(null):b?u(b):(o.loadVectorData(E,this.map.painter,"reloadTile"===p),u(null))))}abortTile(o){o.request&&(o.request.cancel(),delete o.request),o.aborted=!0}unloadTile(o){o.unloadVectorData(),this.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id})}onRemove(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})}hasTransition(){return!1}}var is=g.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Ft extends g.Evented{constructor(o,u,p,m){super(),this.load=(b,E)=>{this._loaded=!1,this.fire(new g.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=Ur.getImage(this.map._requestManager.transformRequest(this.url,Kn.Image),(D,M)=>{this._request=null,this._loaded=!0,D?this.fire(new g.ErrorEvent(D)):M&&(this.image=M,b&&(this.coordinates=b),E&&E(),this._finishLoading())})},this.prepare=()=>{if(0===Object.keys(this.tiles).length||!this.image)return;const b=this.map.painter.context,E=b.gl;this.boundsBuffer||(this.boundsBuffer=b.createVertexBuffer(this._boundsArray,is.members)),this.boundsSegments||(this.boundsSegments=g.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new gn(b,this.image,E.RGBA),this.texture.bind(E.LINEAR,E.CLAMP_TO_EDGE));let D=!1;for(const M in this.tiles){const k=this.tiles[M];"loaded"!==k.state&&(k.state="loaded",k.texture=this.texture,D=!0)}D&&this.fire(new g.Event("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"image",url:this.options.url,coordinates:this.coordinates}),this.id=o,this.dispatcher=p,this.coordinates=u.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(m),this.options=u}loaded(){return this._loaded}updateImage(o){return o.url?(this._request&&(this._request.cancel(),this._request=null),this.options.url=o.url,this.load(o.coordinates,()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new g.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(o){this.map=o,this.load()}onRemove(){this._request&&(this._request.cancel(),this._request=null)}setCoordinates(o){this.coordinates=o;const u=o.map(g.MercatorCoordinate.fromLngLat);this.tileID=function(m){let b=1/0,E=1/0,D=-1/0,M=-1/0;for(const U of m)b=Math.min(b,U.x),E=Math.min(E,U.y),D=Math.max(D,U.x),M=Math.max(M,U.y);const k=Math.max(D-b,M-E),R=Math.max(0,Math.floor(-Math.log(k)/Math.LN2)),F=Math.pow(2,R);return new g.CanonicalTileID(R,Math.floor((b+D)/2*F),Math.floor((E+M)/2*F))}(u),this.minzoom=this.maxzoom=this.tileID.z;const p=u.map(m=>this.tileID.getTilePoint(m)._round());return this._boundsArray=new g.RasterBoundsArray,this._boundsArray.emplaceBack(p[0].x,p[0].y,0,0),this._boundsArray.emplaceBack(p[1].x,p[1].y,g.EXTENT,0),this._boundsArray.emplaceBack(p[3].x,p[3].y,0,g.EXTENT),this._boundsArray.emplaceBack(p[2].x,p[2].y,g.EXTENT,g.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new g.Event("data",{dataType:"source",sourceDataType:"content"})),this}loadTile(o,u){this.tileID&&this.tileID.equals(o.tileID.canonical)?(this.tiles[String(o.tileID.wrap)]=o,o.buckets={},u(null)):(o.state="errored",u(null))}hasTransition(){return!1}}class zs extends Ft{constructor(o,u,p,m){super(o,u,p,m),this.load=()=>{this._loaded=!1;const b=this.options;this.urls=[];for(const E of b.urls)this.urls.push(this.map._requestManager.transformRequest(E,Kn.Source).url);g.getVideo(this.urls,(E,D)=>{this._loaded=!0,E?this.fire(new g.ErrorEvent(E)):D&&(this.video=D,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})},this.prepare=()=>{if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const b=this.map.painter.context,E=b.gl;this.boundsBuffer||(this.boundsBuffer=b.createVertexBuffer(this._boundsArray,is.members)),this.boundsSegments||(this.boundsSegments=g.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(E.LINEAR,E.CLAMP_TO_EDGE),E.texSubImage2D(E.TEXTURE_2D,0,0,0,E.RGBA,E.UNSIGNED_BYTE,this.video)):(this.texture=new gn(b,this.video,E.RGBA),this.texture.bind(E.LINEAR,E.CLAMP_TO_EDGE));let D=!1;for(const M in this.tiles){const k=this.tiles[M];"loaded"!==k.state&&(k.state="loaded",k.texture=this.texture,D=!0)}D&&this.fire(new g.Event("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"video",urls:this.urls,coordinates:this.coordinates}),this.roundZoom=!0,this.type="video",this.options=u}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(o){if(this.video){const u=this.video.seekable;o<u.start(0)||o>u.end(0)?this.fire(new g.ErrorEvent(new g.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${u.start(0)} and ${u.end(0)}-second mark.`))):this.video.currentTime=o}}getVideo(){return this.video}onAdd(o){this.map||(this.map=o,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}hasTransition(){return this.video&&!this.video.paused}}class we extends Ft{constructor(o,u,p,m){super(o,u,p,m),this.load=()=>{this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new g.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},this.prepare=()=>{let b=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,b=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,b=!0),this._hasInvalidDimensions()||0===Object.keys(this.tiles).length)return;const E=this.map.painter.context,D=E.gl;this.boundsBuffer||(this.boundsBuffer=E.createVertexBuffer(this._boundsArray,is.members)),this.boundsSegments||(this.boundsSegments=g.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(b||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new gn(E,this.canvas,D.RGBA,{premultiply:!0});let M=!1;for(const k in this.tiles){const R=this.tiles[k];"loaded"!==R.state&&(R.state="loaded",R.texture=this.texture,M=!0)}M&&this.fire(new g.Event("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"canvas",coordinates:this.coordinates}),u.coordinates?Array.isArray(u.coordinates)&&4===u.coordinates.length&&!u.coordinates.some(b=>!Array.isArray(b)||2!==b.length||b.some(E=>"number"!=typeof E))||this.fire(new g.ErrorEvent(new g.ValidationError(`sources.${o}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new g.ErrorEvent(new g.ValidationError(`sources.${o}`,null,'missing required property "coordinates"'))),u.animate&&"boolean"!=typeof u.animate&&this.fire(new g.ErrorEvent(new g.ValidationError(`sources.${o}`,null,'optional "animate" property must be a boolean value'))),u.canvas?"string"==typeof u.canvas||u.canvas instanceof HTMLCanvasElement||this.fire(new g.ErrorEvent(new g.ValidationError(`sources.${o}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new g.ErrorEvent(new g.ValidationError(`sources.${o}`,null,'missing required property "canvas"'))),this.options=u,this.animate=void 0===u.animate||u.animate}getCanvas(){return this.canvas}onAdd(o){this.map=o,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const o of[this.canvas.width,this.canvas.height])if(isNaN(o)||o<=0)return!0;return!1}}const _s={},Ya=_=>{switch(_){case"geojson":return _n;case"image":return Ft;case"raster":return Oo;case"raster-dem":return Vn;case"vector":return Ka;case"video":return zs;case"canvas":return we}return _s[_]};function yn(_,o){const u=g.create();return g.translate(u,u,[1,1,0]),g.scale(u,u,[.5*_.width,.5*_.height,1]),g.multiply(u,u,_.calculatePosMatrix(o.toUnwrapped()))}function on(_,o,u,p,m,b){const E=function(F,U,X){if(F)for(const W of F){const J=U[W];if(J&&J.source===X&&"fill-extrusion"===J.type)return!0}else for(const W in U){const J=U[W];if(J.source===X&&"fill-extrusion"===J.type)return!0}return!1}(m&&m.layers,o,_.id),D=b.maxPitchScaleFactor(),M=_.tilesIn(p,D,E);M.sort(Ja);const k=[];for(const F of M)k.push({wrappedTileID:F.tileID.wrapped().key,queryResults:F.tile.queryRenderedFeatures(o,u,_._state,F.queryGeometry,F.cameraQueryGeometry,F.scale,m,b,D,yn(_.transform,F.tileID))});const R=function(F){const U={},X={};for(const W of F){const J=W.queryResults,q=W.wrappedTileID,le=X[q]=X[q]||{};for(const me in J){const te=J[me],ce=le[me]=le[me]||{},ye=U[me]=U[me]||[];for(const ve of te)ce[ve.featureIndex]||(ce[ve.featureIndex]=!0,ye.push(ve))}}return U}(k);for(const F in R)R[F].forEach(U=>{const X=U.feature,W=_.getFeatureState(X.layer["source-layer"],X.id);X.source=X.layer.source,X.layer["source-layer"]&&(X.sourceLayer=X.layer["source-layer"]),X.state=W});return R}function Ja(_,o){const u=_.tileID,p=o.tileID;return u.overscaledZ-p.overscaledZ||u.canonical.y-p.canonical.y||u.wrap-p.wrap||u.canonical.x-p.canonical.x}class Qa{constructor(o,u){this.timeAdded=0,this.fadeEndTime=0,this.tileID=o,this.uid=g.uniqueId(),this.uses=0,this.tileSize=u,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(o){const u=o+this.timeAdded;u<this.fadeEndTime||(this.fadeEndTime=u)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}clearTextures(o){this.demTexture&&o.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(o,u,p){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",o){o.featureIndex&&(this.latestFeatureIndex=o.featureIndex,o.rawTileData?(this.latestRawTileData=o.rawTileData,this.latestFeatureIndex.rawTileData=o.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=o.collisionBoxArray,this.buckets=function(m,b){const E={};if(!b)return E;for(const D of m){const M=D.layerIds.map(k=>b.getLayer(k)).filter(Boolean);if(0!==M.length){D.layers=M,D.stateDependentLayerIds&&(D.stateDependentLayers=D.stateDependentLayerIds.map(k=>M.filter(R=>R.id===k)[0]));for(const k of M)E[k.id]=D}}return E}(o.buckets,u.style),this.hasSymbolBuckets=!1;for(const m in this.buckets){const b=this.buckets[m];if(b instanceof g.SymbolBucket){if(this.hasSymbolBuckets=!0,!p)break;b.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const m in this.buckets){const b=this.buckets[m];if(b instanceof g.SymbolBucket&&b.hasRTLText){this.hasRTLText=!0,g.lazyLoadRTLTextPlugin();break}}this.queryPadding=0;for(const m in this.buckets){const b=this.buckets[m];this.queryPadding=Math.max(this.queryPadding,u.style.getLayer(m).queryRadius(b))}o.imageAtlas&&(this.imageAtlas=o.imageAtlas),o.glyphAtlasImage&&(this.glyphAtlasImage=o.glyphAtlasImage)}else this.collisionBoxArray=new g.CollisionBoxArray}unloadVectorData(){for(const o in this.buckets)this.buckets[o].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(o){return this.buckets[o.id]}upload(o){for(const p in this.buckets){const m=this.buckets[p];m.uploadPending()&&m.upload(o)}const u=o.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new gn(o,this.imageAtlas.image,u.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new gn(o,this.glyphAtlasImage,u.ALPHA),this.glyphAtlasImage=null)}prepare(o){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(o,this.imageAtlasTexture)}queryRenderedFeatures(o,u,p,m,b,E,D,M,k,R){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:m,cameraQueryGeometry:b,scale:E,tileSize:this.tileSize,pixelPosMatrix:R,transform:M,params:D,queryPadding:this.queryPadding*k},o,u,p):{}}querySourceFeatures(o,u){const p=this.latestFeatureIndex;if(!p||!p.rawTileData)return;const m=p.loadVTLayers(),b=u&&u.sourceLayer?u.sourceLayer:"",E=m._geojsonTileLayer||m[b];if(!E)return;const D=g.createFilter(u&&u.filter),{z:M,x:k,y:R}=this.tileID.canonical,F={z:M,x:k,y:R};for(let U=0;U<E.length;U++){const X=E.feature(U);if(D.needGeometry){const q=g.toEvaluationFeature(X,!0);if(!D.filter(new g.EvaluationParameters(this.tileID.overscaledZ),q,this.tileID.canonical))continue}else if(!D.filter(new g.EvaluationParameters(this.tileID.overscaledZ),X))continue;const W=p.getId(X,b),J=new g.GeoJSONFeature(X,M,k,R,W);J.tile=F,o.push(J)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(o){const u=this.expirationTime;if(o.cacheControl){const p=g.parseCacheControl(o.cacheControl);p["max-age"]&&(this.expirationTime=Date.now()+1e3*p["max-age"])}else o.expires&&(this.expirationTime=new Date(o.expires).getTime());if(this.expirationTime){const p=Date.now();let m=!1;if(this.expirationTime>p)m=!1;else if(u)if(this.expirationTime<u)m=!0;else{const b=this.expirationTime-u;b?this.expirationTime=p+Math.max(b,3e4):m=!0}else m=!0;m?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(o,u){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||0===Object.keys(o).length)return;const p=this.latestFeatureIndex.loadVTLayers();for(const m in this.buckets){if(!u.style.hasLayer(m))continue;const b=this.buckets[m],E=b.layers[0].sourceLayer||"_geojsonTileLayer",D=p[E],M=o[E];if(!D||!M||0===Object.keys(M).length)continue;b.update(M,D,this.imageAtlas&&this.imageAtlas.patternPositions||{});const k=u&&u.style&&u.style.getLayer(m);k&&(this.queryPadding=Math.max(this.queryPadding,k.queryRadius(b)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<g.browser.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(o){this.symbolFadeHoldUntil=g.browser.now()+o}setDependencies(o,u){const p={};for(const m of u)p[m]=!0;this.dependencies[o]=p}hasDependency(o,u){for(const p of o){const m=this.dependencies[p];if(m)for(const b of u)if(m[b])return!0}return!1}}class Su{constructor(o,u){this.max=o,this.onRemove=u,this.reset()}reset(){for(const o in this.data)for(const u of this.data[o])u.timeout&&clearTimeout(u.timeout),this.onRemove(u.value);return this.data={},this.order=[],this}add(o,u,p){const m=o.wrapped().key;void 0===this.data[m]&&(this.data[m]=[]);const b={value:u,timeout:void 0};if(void 0!==p&&(b.timeout=setTimeout(()=>{this.remove(o,b)},p)),this.data[m].push(b),this.order.push(m),this.order.length>this.max){const E=this._getAndRemoveByKey(this.order[0]);E&&this.onRemove(E)}return this}has(o){return o.wrapped().key in this.data}getAndRemove(o){return this.has(o)?this._getAndRemoveByKey(o.wrapped().key):null}_getAndRemoveByKey(o){const u=this.data[o].shift();return u.timeout&&clearTimeout(u.timeout),0===this.data[o].length&&delete this.data[o],this.order.splice(this.order.indexOf(o),1),u.value}getByKey(o){const u=this.data[o];return u?u[0].value:null}get(o){return this.has(o)?this.data[o.wrapped().key][0].value:null}remove(o,u){if(!this.has(o))return this;const p=o.wrapped().key,m=void 0===u?0:this.data[p].indexOf(u),b=this.data[p][m];return this.data[p].splice(m,1),b.timeout&&clearTimeout(b.timeout),0===this.data[p].length&&delete this.data[p],this.onRemove(b.value),this.order.splice(this.order.indexOf(p),1),this}setMaxSize(o){for(this.max=o;this.order.length>this.max;){const u=this._getAndRemoveByKey(this.order[0]);u&&this.onRemove(u)}return this}filter(o){const u=[];for(const p in this.data)for(const m of this.data[p])o(m.value)||u.push(m);for(const p of u)this.remove(p.value.tileID,p)}}class Mu{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(o,u,p){const m=String(u);if(this.stateChanges[o]=this.stateChanges[o]||{},this.stateChanges[o][m]=this.stateChanges[o][m]||{},g.extend(this.stateChanges[o][m],p),null===this.deletedStates[o]){this.deletedStates[o]={};for(const b in this.state[o])b!==m&&(this.deletedStates[o][b]=null)}else if(this.deletedStates[o]&&null===this.deletedStates[o][m]){this.deletedStates[o][m]={};for(const b in this.state[o][m])p[b]||(this.deletedStates[o][m][b]=null)}else for(const b in p)this.deletedStates[o]&&this.deletedStates[o][m]&&null===this.deletedStates[o][m][b]&&delete this.deletedStates[o][m][b]}removeFeatureState(o,u,p){if(null===this.deletedStates[o])return;const m=String(u);if(this.deletedStates[o]=this.deletedStates[o]||{},p&&void 0!==u)null!==this.deletedStates[o][m]&&(this.deletedStates[o][m]=this.deletedStates[o][m]||{},this.deletedStates[o][m][p]=null);else if(void 0!==u)if(this.stateChanges[o]&&this.stateChanges[o][m])for(p in this.deletedStates[o][m]={},this.stateChanges[o][m])this.deletedStates[o][m][p]=null;else this.deletedStates[o][m]=null;else this.deletedStates[o]=null}getState(o,u){const p=String(u),m=g.extend({},(this.state[o]||{})[p],(this.stateChanges[o]||{})[p]);if(null===this.deletedStates[o])return{};if(this.deletedStates[o]){const b=this.deletedStates[o][u];if(null===b)return{};for(const E in b)delete m[E]}return m}initializeTileState(o,u){o.setFeatureState(this.state,u)}coalesceChanges(o,u){const p={};for(const m in this.stateChanges){this.state[m]=this.state[m]||{};const b={};for(const E in this.stateChanges[m])this.state[m][E]||(this.state[m][E]={}),g.extend(this.state[m][E],this.stateChanges[m][E]),b[E]=this.state[m][E];p[m]=b}for(const m in this.deletedStates){this.state[m]=this.state[m]||{};const b={};if(null===this.deletedStates[m])for(const E in this.state[m])b[E]={},this.state[m][E]={};else for(const E in this.deletedStates[m]){if(null===this.deletedStates[m][E])this.state[m][E]={};else for(const D of Object.keys(this.deletedStates[m][E]))delete this.state[m][E][D];b[E]=this.state[m][E]}p[m]=p[m]||{},g.extend(p[m],b)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(p).length)for(const m in o)o[m].setFeatureState(p,u)}}class Jn extends g.Evented{constructor(o,u,p){super(),this.id=o,this.dispatcher=p,this.on("data",m=>{"source"===m.dataType&&"metadata"===m.sourceDataType&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===m.dataType&&"content"===m.sourceDataType&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((m,b,E,D)=>{const M=new(Ya(b.type))(m,b,E,D);if(M.id!==m)throw new Error(`Expected Source id to be ${m} instead of ${M.id}`);return M})(o,u,p,this),this._tiles={},this._cache=new Su(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new Mu,this._didEmitContent=!1,this._updated=!1}onAdd(o){this.map=o,this._maxTileCacheSize=o?o._maxTileCacheSize:null,this._maxTileCacheZoomLevels=o?o._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(o)}onRemove(o){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(o)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(void 0===this.used&&void 0===this.usedForTerrain||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const o in this._tiles){const u=this._tiles[o];if("loaded"!==u.state&&"errored"!==u.state)return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const o=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,o&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(o,u){return this._source.loadTile(o,u)}_unloadTile(o){if(this._source.unloadTile)return this._source.unloadTile(o,()=>{})}_abortTile(o){this._source.abortTile&&this._source.abortTile(o,()=>{}),this._source.fire(new g.Event("dataabort",{tile:o,coord:o.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(o){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const u in this._tiles){const p=this._tiles[u];p.upload(o),p.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(o=>o.tileID).sort(el).map(o=>o.key)}getRenderableIds(o){const u=[];for(const p in this._tiles)this._isIdRenderable(p,o)&&u.push(this._tiles[p]);return o?u.sort((p,m)=>{const b=p.tileID,E=m.tileID,D=new g.Point(b.canonical.x,b.canonical.y)._rotate(this.transform.angle),M=new g.Point(E.canonical.x,E.canonical.y)._rotate(this.transform.angle);return b.overscaledZ-E.overscaledZ||M.y-D.y||M.x-D.x}).map(p=>p.tileID.key):u.map(p=>p.tileID).sort(el).map(p=>p.key)}hasRenderableParent(o){const u=this.findLoadedParent(o,0);return!!u&&this._isIdRenderable(u.tileID.key)}_isIdRenderable(o,u){return this._tiles[o]&&this._tiles[o].hasData()&&!this._coveredTiles[o]&&(u||!this._tiles[o].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const o in this._tiles)"errored"!==this._tiles[o].state&&this._reloadTile(o,"reloading")}}_reloadTile(o,u){const p=this._tiles[o];p&&("loading"!==p.state&&(p.state=u),this._loadTile(p,this._tileLoaded.bind(this,p,o,u)))}_tileLoaded(o,u,p,m){if(m)return o.state="errored",void(404!==m.status?this._source.fire(new g.ErrorEvent(m,{tile:o})):this.update(this.transform,this.terrain));o.timeAdded=g.browser.now(),"expired"===p&&(o.refreshedUponExpiration=!0),this._setTileReloadTimer(u,o),"raster-dem"===this.getSource().type&&o.dem&&this._backfillDEM(o),this._state.initializeTileState(o,this.map?this.map.painter:null),o.aborted||this._source.fire(new g.Event("data",{dataType:"source",tile:o,coord:o.tileID}))}_backfillDEM(o){const u=this.getRenderableIds();for(let m=0;m<u.length;m++){const b=u[m];if(o.neighboringTiles&&o.neighboringTiles[b]){const E=this.getTileByID(b);p(o,E),p(E,o)}}function p(m,b){m.needsHillshadePrepare=!0,m.needsTerrainPrepare=!0;let E=b.tileID.canonical.x-m.tileID.canonical.x;const D=b.tileID.canonical.y-m.tileID.canonical.y,M=Math.pow(2,m.tileID.canonical.z),k=b.tileID.key;0===E&&0===D||Math.abs(D)>1||(Math.abs(E)>1&&(1===Math.abs(E+M)?E+=M:1===Math.abs(E-M)&&(E-=M)),b.dem&&m.dem&&(m.dem.backfillBorder(b.dem,E,D),m.neighboringTiles&&m.neighboringTiles[k]&&(m.neighboringTiles[k].backfilled=!0)))}}getTile(o){return this.getTileByID(o.key)}getTileByID(o){return this._tiles[o]}_retainLoadedChildren(o,u,p,m){for(const b in this._tiles){let E=this._tiles[b];if(m[b]||!E.hasData()||E.tileID.overscaledZ<=u||E.tileID.overscaledZ>p)continue;let D=E.tileID;for(;E&&E.tileID.overscaledZ>u+1;){const k=E.tileID.scaledTo(E.tileID.overscaledZ-1);E=this._tiles[k.key],E&&E.hasData()&&(D=k)}let M=D;for(;M.overscaledZ>u;)if(M=M.scaledTo(M.overscaledZ-1),o[M.key]){m[D.key]=D;break}}}findLoadedParent(o,u){if(o.key in this._loadedParentTiles){const p=this._loadedParentTiles[o.key];return p&&p.tileID.overscaledZ>=u?p:null}for(let p=o.overscaledZ-1;p>=u;p--){const m=o.scaledTo(p),b=this._getLoadedTile(m);if(b)return b}}_getLoadedTile(o){const u=this._tiles[o.key];return u&&u.hasData()?u:this._cache.getByKey(o.wrapped().key)}updateCacheSize(o){const u=Math.ceil(o.width/this._source.tileSize)+1,p=Math.ceil(o.height/this._source.tileSize)+1,m=Math.floor(u*p*(null===this._maxTileCacheZoomLevels?g.config.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),b="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,m):m;this._cache.setMaxSize(b)}handleWrapJump(o){const u=Math.round((o-(void 0===this._prevLng?o:this._prevLng))/360);if(this._prevLng=o,u){const p={};for(const m in this._tiles){const b=this._tiles[m];b.tileID=b.tileID.unwrapTo(b.tileID.wrap+u),p[b.tileID.key]=b}this._tiles=p;for(const m in this._timers)clearTimeout(this._timers[m]),delete this._timers[m];for(const m in this._tiles)this._setTileReloadTimer(m,this._tiles[m])}}update(o,u){if(this.transform=o,this.terrain=u,!this._sourceLoaded||this._paused)return;let p;this.updateCacheSize(o),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?p=o.getVisibleUnwrappedCoordinates(this._source.tileID).map(R=>new g.OverscaledTileID(R.canonical.z,R.wrap,R.canonical.z,R.canonical.x,R.canonical.y)):(p=o.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:u}),this._source.hasTile&&(p=p.filter(R=>this._source.hasTile(R)))):p=[];const m=o.coveringZoomLevel(this._source),b=Math.max(m-Jn.maxOverzooming,this._source.minzoom),E=Math.max(m+Jn.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const R={};for(const F of p)if(F.canonical.z>this._source.minzoom){const U=F.scaledTo(F.canonical.z-1);R[U.key]=U;const X=F.scaledTo(Math.max(this._source.minzoom,Math.min(F.canonical.z,5)));R[X.key]=X}p=p.concat(Object.values(R))}const D=0===p.length&&!this._updated&&this._didEmitContent;this._updated=!0,D&&this.fire(new g.Event("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const M=this._updateRetainedTiles(p,m);if(tl(this._source.type)){const R={},F={},U=Object.keys(M),X=g.browser.now();for(const W of U){const J=M[W],q=this._tiles[W];if(!q||0!==q.fadeEndTime&&q.fadeEndTime<=X)continue;const le=this.findLoadedParent(J,b);le&&(this._addTile(le.tileID),R[le.tileID.key]=le.tileID),F[W]=J}this._retainLoadedChildren(F,m,E,M);for(const W in R)M[W]||(this._coveredTiles[W]=!0,M[W]=R[W]);if(u){const W={},J={};for(const q of p)this._tiles[q.key].hasData()?W[q.key]=q:J[q.key]=q;for(const q in J){const le=J[q].children(this._source.maxzoom);this._tiles[le[0].key]&&this._tiles[le[1].key]&&this._tiles[le[2].key]&&this._tiles[le[3].key]&&(W[le[0].key]=M[le[0].key]=le[0],W[le[1].key]=M[le[1].key]=le[1],W[le[2].key]=M[le[2].key]=le[2],W[le[3].key]=M[le[3].key]=le[3],delete J[q])}for(const q in J){const le=this.findLoadedParent(J[q],this._source.minzoom);if(le){W[le.tileID.key]=M[le.tileID.key]=le.tileID;for(const me in W)W[me].isChildOf(le.tileID)&&delete W[me]}}for(const q in this._tiles)W[q]||(this._coveredTiles[q]=!0)}}for(const R in M)this._tiles[R].clearFadeHold();const k=g.keysDifference(this._tiles,M);for(const R of k){const F=this._tiles[R];F.hasSymbolBuckets&&!F.holdingForFade()?F.setHoldDuration(this.map._fadeDuration):F.hasSymbolBuckets&&!F.symbolFadeFinished()||this._removeTile(R)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(const o in this._tiles)this._tiles[o].holdingForFade()&&this._removeTile(o)}_updateRetainedTiles(o,u){const p={},m={},b=Math.max(u-Jn.maxOverzooming,this._source.minzoom),E=Math.max(u+Jn.maxUnderzooming,this._source.minzoom),D={};for(const M of o){const k=this._addTile(M);p[M.key]=M,k.hasData()||u<this._source.maxzoom&&(D[M.key]=M)}this._retainLoadedChildren(D,u,E,p);for(const M of o){let k=this._tiles[M.key];if(k.hasData())continue;if(u+1>this._source.maxzoom){const F=M.children(this._source.maxzoom)[0],U=this.getTile(F);if(U&&U.hasData()){p[F.key]=F;continue}}else{const F=M.children(this._source.maxzoom);if(p[F[0].key]&&p[F[1].key]&&p[F[2].key]&&p[F[3].key])continue}let R=k.wasRequested();for(let F=M.overscaledZ-1;F>=b;--F){const U=M.scaledTo(F);if(m[U.key])break;if(m[U.key]=!0,k=this.getTile(U),!k&&R&&(k=this._addTile(U)),k){const X=k.hasData();if((R||X)&&(p[U.key]=U),R=k.wasRequested(),X)break}}}return p}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const o in this._tiles){const u=[];let p,m=this._tiles[o].tileID;for(;m.overscaledZ>0;){if(m.key in this._loadedParentTiles){p=this._loadedParentTiles[m.key];break}u.push(m.key);const b=m.scaledTo(m.overscaledZ-1);if(p=this._getLoadedTile(b),p)break;m=b}for(const b of u)this._loadedParentTiles[b]=p}}_addTile(o){let u=this._tiles[o.key];if(u)return u;u=this._cache.getAndRemove(o),u&&(this._setTileReloadTimer(o.key,u),u.tileID=o,this._state.initializeTileState(u,this.map?this.map.painter:null),this._cacheTimers[o.key]&&(clearTimeout(this._cacheTimers[o.key]),delete this._cacheTimers[o.key],this._setTileReloadTimer(o.key,u)));const p=u;return u||(u=new Qa(o,this._source.tileSize*o.overscaleFactor()),this._loadTile(u,this._tileLoaded.bind(this,u,o.key,u.state))),u.uses++,this._tiles[o.key]=u,p||this._source.fire(new g.Event("dataloading",{tile:u,coord:u.tileID,dataType:"source"})),u}_setTileReloadTimer(o,u){o in this._timers&&(clearTimeout(this._timers[o]),delete this._timers[o]);const p=u.getExpiryTimeout();p&&(this._timers[o]=setTimeout(()=>{this._reloadTile(o,"expired"),delete this._timers[o]},p))}_removeTile(o){const u=this._tiles[o];u&&(u.uses--,delete this._tiles[o],this._timers[o]&&(clearTimeout(this._timers[o]),delete this._timers[o]),u.uses>0||(u.hasData()&&"reloading"!==u.state?this._cache.add(u.tileID,u,u.getExpiryTimeout()):(u.aborted=!0,this._abortTile(u),this._unloadTile(u))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const o in this._tiles)this._removeTile(o);this._cache.reset()}tilesIn(o,u,p){const m=[],b=this.transform;if(!b)return m;const E=p?b.getCameraQueryGeometry(o):o,D=o.map(W=>b.pointCoordinate(W,this.terrain)),M=E.map(W=>b.pointCoordinate(W,this.terrain)),k=this.getIds();let R=1/0,F=1/0,U=-1/0,X=-1/0;for(const W of M)R=Math.min(R,W.x),F=Math.min(F,W.y),U=Math.max(U,W.x),X=Math.max(X,W.y);for(let W=0;W<k.length;W++){const J=this._tiles[k[W]];if(J.holdingForFade())continue;const q=J.tileID,le=Math.pow(2,b.zoom-J.tileID.overscaledZ),me=u*J.queryPadding*g.EXTENT/J.tileSize/le,te=[q.getTilePoint(new g.MercatorCoordinate(R,F)),q.getTilePoint(new g.MercatorCoordinate(U,X))];if(te[0].x-me<g.EXTENT&&te[0].y-me<g.EXTENT&&te[1].x+me>=0&&te[1].y+me>=0){const ce=D.map(ve=>q.getTilePoint(ve)),ye=M.map(ve=>q.getTilePoint(ve));m.push({tile:J,tileID:q,queryGeometry:ce,cameraQueryGeometry:ye,scale:le})}}return m}getVisibleCoordinates(o){const u=this.getRenderableIds(o).map(p=>this._tiles[p].tileID);for(const p of u)p.posMatrix=this.transform.calculatePosMatrix(p.toUnwrapped());return u}hasTransition(){if(this._source.hasTransition())return!0;if(tl(this._source.type)){const o=g.browser.now();for(const u in this._tiles)if(this._tiles[u].fadeEndTime>=o)return!0}return!1}setFeatureState(o,u,p){this._state.updateState(o=o||"_geojsonTileLayer",u,p)}removeFeatureState(o,u,p){this._state.removeFeatureState(o=o||"_geojsonTileLayer",u,p)}getFeatureState(o,u){return this._state.getState(o=o||"_geojsonTileLayer",u)}setDependencies(o,u,p){const m=this._tiles[o];m&&m.setDependencies(u,p)}reloadTilesForDependencies(o,u){for(const p in this._tiles)this._tiles[p].hasDependency(o,u)&&this._reloadTile(p,"reloading");this._cache.filter(p=>!p.hasDependency(o,u))}}function el(_,o){const u=Math.abs(2*_.wrap)-+(_.wrap<0),p=Math.abs(2*o.wrap)-+(o.wrap<0);return _.overscaledZ-o.overscaledZ||p-u||o.canonical.y-_.canonical.y||o.canonical.x-_.canonical.x}function tl(_){return"raster"===_||"image"===_||"video"===_}Jn.maxOverzooming=10,Jn.maxUnderzooming=3;const Be="mapboxgl_preloaded_worker_pool";class gr{constructor(){this.active={}}acquire(o){if(!this.workers)for(this.workers=[];this.workers.length<gr.workerCount;)this.workers.push(new Worker(g.config.WORKER_URL));return this.active[o]=!0,this.workers.slice()}release(o){delete this.active[o],0===this.numActive()&&(this.workers.forEach(u=>{u.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Be]}numActive(){return Object.keys(this.active).length}}const sr=Math.floor(g.browser.hardwareConcurrency/2);let Bs;function Fo(){return Bs||(Bs=new gr),Bs}gr.workerCount=g.isSafari(globalThis)?Math.max(Math.min(sr,3),1):1;class $e{constructor(o,u){this.reset(o,u)}reset(o,u){this.points=o||[],this._distances=[0];for(let p=1;p<this.points.length;p++)this._distances[p]=this._distances[p-1]+this.points[p].dist(this.points[p-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(u||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(o){if(1===this.points.length)return this.points[0];o=g.clamp(o,0,1);let u=1,p=this._distances[u];const m=o*this.paddedLength+this.padding;for(;p<m&&u<this._distances.length;)p=this._distances[++u];const b=u-1,E=this._distances[b],D=p-E,M=D>0?(m-E)/D:0;return this.points[b].mult(1-M).add(this.points[u].mult(M))}}function Pt(_,o){let u=!0;return"always"===_||"never"!==_&&"never"!==o||(u=!1),u}class Ct{constructor(o,u,p){const m=this.boxCells=[],b=this.circleCells=[];this.xCellCount=Math.ceil(o/p),this.yCellCount=Math.ceil(u/p);for(let E=0;E<this.xCellCount*this.yCellCount;E++)m.push([]),b.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=o,this.height=u,this.xScale=this.xCellCount/o,this.yScale=this.yCellCount/u,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(o,u,p,m,b){this._forEachCell(u,p,m,b,this._insertBoxCell,this.boxUid++),this.boxKeys.push(o),this.bboxes.push(u),this.bboxes.push(p),this.bboxes.push(m),this.bboxes.push(b)}insertCircle(o,u,p,m){this._forEachCell(u-m,p-m,u+m,p+m,this._insertCircleCell,this.circleUid++),this.circleKeys.push(o),this.circles.push(u),this.circles.push(p),this.circles.push(m)}_insertBoxCell(o,u,p,m,b,E){this.boxCells[b].push(E)}_insertCircleCell(o,u,p,m,b,E){this.circleCells[b].push(E)}_query(o,u,p,m,b,E,D){if(p<0||o>this.width||m<0||u>this.height)return[];const M=[];if(o<=0&&u<=0&&this.width<=p&&this.height<=m){if(b)return[{key:null,x1:o,y1:u,x2:p,y2:m}];for(let k=0;k<this.boxKeys.length;k++)M.push({key:this.boxKeys[k],x1:this.bboxes[4*k],y1:this.bboxes[4*k+1],x2:this.bboxes[4*k+2],y2:this.bboxes[4*k+3]});for(let k=0;k<this.circleKeys.length;k++){const R=this.circles[3*k],F=this.circles[3*k+1],U=this.circles[3*k+2];M.push({key:this.circleKeys[k],x1:R-U,y1:F-U,x2:R+U,y2:F+U})}}else this._forEachCell(o,u,p,m,this._queryCell,M,{hitTest:b,overlapMode:E,seenUids:{box:{},circle:{}}},D);return M}query(o,u,p,m){return this._query(o,u,p,m,!1,null)}hitTest(o,u,p,m,b,E){return this._query(o,u,p,m,!0,b,E).length>0}hitTestCircle(o,u,p,m,b){const E=o-p,D=o+p,M=u-p,k=u+p;if(D<0||E>this.width||k<0||M>this.height)return!1;const R=[];return this._forEachCell(E,M,D,k,this._queryCellCircle,R,{hitTest:!0,overlapMode:m,circle:{x:o,y:u,radius:p},seenUids:{box:{},circle:{}}},b),R.length>0}_queryCell(o,u,p,m,b,E,D,M){const{seenUids:k,hitTest:R,overlapMode:F}=D,U=this.boxCells[b];if(null!==U){const W=this.bboxes;for(const J of U)if(!k.box[J]){k.box[J]=!0;const q=4*J,le=this.boxKeys[J];if(o<=W[q+2]&&u<=W[q+3]&&p>=W[q+0]&&m>=W[q+1]&&(!M||M(le))&&(!R||!Pt(F,le.overlapMode))&&(E.push({key:le,x1:W[q],y1:W[q+1],x2:W[q+2],y2:W[q+3]}),R))return!0}}const X=this.circleCells[b];if(null!==X){const W=this.circles;for(const J of X)if(!k.circle[J]){k.circle[J]=!0;const q=3*J,le=this.circleKeys[J];if(this._circleAndRectCollide(W[q],W[q+1],W[q+2],o,u,p,m)&&(!M||M(le))&&(!R||!Pt(F,le.overlapMode))){const me=W[q],te=W[q+1],ce=W[q+2];if(E.push({key:le,x1:me-ce,y1:te-ce,x2:me+ce,y2:te+ce}),R)return!0}}}return!1}_queryCellCircle(o,u,p,m,b,E,D,M){const{circle:k,seenUids:R,overlapMode:F}=D,U=this.boxCells[b];if(null!==U){const W=this.bboxes;for(const J of U)if(!R.box[J]){R.box[J]=!0;const q=4*J,le=this.boxKeys[J];if(this._circleAndRectCollide(k.x,k.y,k.radius,W[q+0],W[q+1],W[q+2],W[q+3])&&(!M||M(le))&&!Pt(F,le.overlapMode))return E.push(!0),!0}}const X=this.circleCells[b];if(null!==X){const W=this.circles;for(const J of X)if(!R.circle[J]){R.circle[J]=!0;const q=3*J,le=this.circleKeys[J];if(this._circlesCollide(W[q],W[q+1],W[q+2],k.x,k.y,k.radius)&&(!M||M(le))&&!Pt(F,le.overlapMode))return E.push(!0),!0}}}_forEachCell(o,u,p,m,b,E,D,M){const k=this._convertToXCellCoord(o),R=this._convertToYCellCoord(u),F=this._convertToXCellCoord(p),U=this._convertToYCellCoord(m);for(let X=k;X<=F;X++)for(let W=R;W<=U;W++)if(b.call(this,o,u,p,m,this.xCellCount*W+X,E,D,M))return}_convertToXCellCoord(o){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(o*this.xScale)))}_convertToYCellCoord(o){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(o*this.yScale)))}_circlesCollide(o,u,p,m,b,E){const D=m-o,M=b-u,k=p+E;return k*k>D*D+M*M}_circleAndRectCollide(o,u,p,m,b,E,D){const M=(E-m)/2,k=Math.abs(o-(m+M));if(k>M+p)return!1;const R=(D-b)/2,F=Math.abs(u-(b+R));if(F>R+p)return!1;if(k<=M||F<=R)return!0;const U=k-M,X=F-R;return U*U+X*X<=p*p}}function Wi(_,o,u,p,m){const b=g.create();return o?(g.scale(b,b,[1/m,1/m,1]),u||g.rotateZ(b,b,p.angle)):g.multiply(b,p.labelPlaneMatrix,_),b}function lo(_,o,u,p,m){if(o){const b=g.clone(_);return g.scale(b,b,[m,m,1]),u||g.rotateZ(b,b,-p.angle),b}return p.glCoordMatrix}function bt(_,o,u){let p;u?(p=[_.x,_.y,u(_.x,_.y),1],g.transformMat4(p,p,o)):(p=[_.x,_.y,0,1],ee(p,p,o));const m=p[3];return{point:new g.Point(p[0]/m,p[1]/m),signedDistanceFromCamera:m}}function Vs(_,o){return.5+_/o*.5}function Us(_,o){const u=_[0]/_[3],p=_[1]/_[3];return u>=-o[0]&&u<=o[0]&&p>=-o[1]&&p<=o[1]}function Lo(_,o,u,p,m,b,E,D,M,k){const R=p?_.textSizeData:_.iconSizeData,F=g.evaluateSizeForZoom(R,u.transform.zoom),U=[256/u.width*2+1,256/u.height*2+1],X=p?_.text.dynamicLayoutVertexArray:_.icon.dynamicLayoutVertexArray;X.clear();const W=_.lineVertexArray,J=p?_.text.placedSymbolArray:_.icon.placedSymbolArray,q=u.transform.width/u.transform.height;let le=!1;for(let me=0;me<J.length;me++){const te=J.get(me);if(te.hidden||te.writingMode===g.WritingMode.vertical&&!le){H(te.numGlyphs,X);continue}let ce;if(le=!1,k?(ce=[te.anchorX,te.anchorY,k(te.anchorX,te.anchorY),1],g.transformMat4(ce,ce,o)):(ce=[te.anchorX,te.anchorY,0,1],ee(ce,ce,o)),!Us(ce,U)){H(te.numGlyphs,X);continue}const ye=Vs(u.transform.cameraToCenterDistance,ce[3]),ve=g.evaluateSizeForFeature(R,F,te),Se=E?ve/ye:ve*ye,ke=new g.Point(te.anchorX,te.anchorY),De=bt(ke,m,k).point,Le={projections:{},offsets:{}},We=Xi(te,Se,!1,D,o,m,b,_.glyphOffsetArray,W,X,De,ke,Le,q,M,k);le=We.useVertical,(We.notEnoughRoom||le||We.needsFlipping&&Xi(te,Se,!0,D,o,m,b,_.glyphOffsetArray,W,X,De,ke,Le,q,M,k).notEnoughRoom)&&H(te.numGlyphs,X)}p?_.text.dynamicLayoutVertexBuffer.updateData(X):_.icon.dynamicLayoutVertexBuffer.updateData(X)}function rs(_,o,u,p,m,b,E,D,M,k,R,F,U){const X=D.glyphStartIndex+D.numGlyphs,W=D.lineStartIndex,J=D.lineStartIndex+D.lineLength,q=o.getoffsetX(D.glyphStartIndex),le=o.getoffsetX(X-1),me=N(_*q,u,p,m,b,E,D.segment,W,J,M,k,R,F,U);if(!me)return null;const te=N(_*le,u,p,m,b,E,D.segment,W,J,M,k,R,F,U);return te?{first:me,last:te}:null}function No(_,o,u,p){return _===g.WritingMode.horizontal&&Math.abs(u.y-o.y)>Math.abs(u.x-o.x)*p?{useVertical:!0}:(_===g.WritingMode.vertical?o.y<u.y:o.x>u.x)?{needsFlipping:!0}:null}function Xi(_,o,u,p,m,b,E,D,M,k,R,F,U,X,W,J){const q=o/24,le=_.lineOffsetX*q,me=_.lineOffsetY*q;let te;if(_.numGlyphs>1){const ce=_.glyphStartIndex+_.numGlyphs,ye=_.lineStartIndex,ve=_.lineStartIndex+_.lineLength,Se=rs(q,D,le,me,u,R,F,_,M,b,U,W,J);if(!Se)return{notEnoughRoom:!0};const ke=bt(Se.first.point,E,J).point,De=bt(Se.last.point,E,J).point;if(p&&!u){const Le=No(_.writingMode,ke,De,X);if(Le)return Le}te=[Se.first];for(let Le=_.glyphStartIndex+1;Le<ce-1;Le++)te.push(N(q*D.getoffsetX(Le),le,me,u,R,F,_.segment,ye,ve,M,b,U,W,J));te.push(Se.last)}else{if(p&&!u){const ye=bt(F,m,J).point,ve=_.lineStartIndex+_.segment+1,Se=new g.Point(M.getx(ve),M.gety(ve)),ke=bt(Se,m,J),De=ke.signedDistanceFromCamera>0?ke.point:kn(F,Se,ye,1,m,J),Le=No(_.writingMode,ye,De,X);if(Le)return Le}const ce=N(q*D.getoffsetX(_.glyphStartIndex),le,me,u,R,F,_.segment,_.lineStartIndex,_.lineStartIndex+_.lineLength,M,b,U,W,J);if(!ce)return{notEnoughRoom:!0};te=[ce]}for(const ce of te)g.addDynamicAttributes(k,ce.point,ce.angle);return{}}function kn(_,o,u,p,m,b){const E=bt(_.add(_.sub(o)._unit()),m,b).point,D=u.sub(E);return u.add(D._mult(p/D.mag()))}function Ol(_,o){const{projectionCache:u,lineVertexArray:p,labelPlaneMatrix:m,tileAnchorPoint:b,distanceFromAnchor:E,getElevation:D,previousVertex:M,direction:k,absOffsetX:R}=o;if(u.projections[_])return u.projections[_];const F=new g.Point(p.getx(_),p.gety(_)),U=bt(F,m,D);if(U.signedDistanceFromCamera>0)return u.projections[_]=U.point,U.point;const X=_-k;return kn(0===E?b:new g.Point(p.getx(X),p.gety(X)),F,M,R-E+1,m,D)}function js(_,o,u){return _._unit()._perp()._mult(o*u)}function Y(_,o,u,p,m,b,E,D){const{projectionCache:M,direction:k}=D;if(M.offsets[_])return M.offsets[_];const R=u.add(o);if(_+k<p||_+k>=m)return M.offsets[_]=R,R;const F=Ol(_+k,D),U=js(F.sub(u),E,k),X=u.add(U),W=F.add(U);return M.offsets[_]=g.findLineIntersection(b,R,X,W)||R,M.offsets[_]}function N(_,o,u,p,m,b,E,D,M,k,R,F,U,X){const W=p?_-o:_+o;let J=W>0?1:-1,q=0;p&&(J*=-1,q=Math.PI),J<0&&(q+=Math.PI);let le,me,te=J>0?D+E:D+E+1,ce=m,ye=m,ve=0,Se=0;const ke=Math.abs(W),De=[];let Le;for(;ve+Se<=ke;){if(te+=J,te<D||te>=M)return null;ve+=Se,ye=ce,me=le;const Ue={projectionCache:F,lineVertexArray:k,labelPlaneMatrix:R,tileAnchorPoint:b,distanceFromAnchor:ve,getElevation:X,previousVertex:ye,direction:J,absOffsetX:ke};if(ce=Ol(te,Ue),0===u)De.push(ye),Le=ce.sub(ye);else{let dt;const rt=ce.sub(ye);dt=0===rt.mag()?js(Ol(te+J,Ue).sub(ce),u,J):js(rt,u,J),me||(me=ye.add(dt)),le=Y(te,dt,ce,D,M,me,u,Ue),De.push(me),Le=le.sub(me)}Se=Le.mag()}const We=Le._mult((ke-ve)/Se)._add(me||ye),zt=q+Math.atan2(ce.y-ye.y,ce.x-ye.x);return De.push(We),{point:We,angle:U?zt:0,path:De}}const V=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function H(_,o){for(let u=0;u<_;u++){const p=o.length;o.resize(p+4),o.float32.set(V,3*p)}}function ee(_,o,u){const p=o[0],m=o[1];return _[0]=u[0]*p+u[4]*m+u[12],_[1]=u[1]*p+u[5]*m+u[13],_[3]=u[3]*p+u[7]*m+u[15],_}const ie=100;class ue{constructor(o,u=new Ct(o.width+200,o.height+200,25),p=new Ct(o.width+200,o.height+200,25)){this.transform=o,this.grid=u,this.ignoredGrid=p,this.pitchfactor=Math.cos(o._pitch)*o.cameraToCenterDistance,this.screenRightBoundary=o.width+ie,this.screenBottomBoundary=o.height+ie,this.gridRightBoundary=o.width+200,this.gridBottomBoundary=o.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(o,u,p,m,b,E){const D=this.projectAndGetPerspectiveRatio(m,o.anchorPointX,o.anchorPointY,E),M=p*D.perspectiveRatio,k=o.x1*M+D.point.x,R=o.y1*M+D.point.y,F=o.x2*M+D.point.x,U=o.y2*M+D.point.y;return!this.isInsideGrid(k,R,F,U)||"always"!==u&&this.grid.hitTest(k,R,F,U,u,b)||D.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[k,R,F,U],offscreen:this.isOffscreen(k,R,F,U)}}placeCollisionCircles(o,u,p,m,b,E,D,M,k,R,F,U,X,W){const J=[],q=new g.Point(u.anchorX,u.anchorY),le=bt(q,E,W),me=Vs(this.transform.cameraToCenterDistance,le.signedDistanceFromCamera),te=(R?b/me:b*me)/g.ONE_EM,ce=bt(q,D,W).point,ye=rs(te,m,u.lineOffsetX*te,u.lineOffsetY*te,!1,ce,q,u,p,D,{projections:{},offsets:{}},!1,W);let ve=!1,Se=!1,ke=!0;if(ye){const De=.5*U*me+X,Le=new g.Point(-100,-100),We=new g.Point(this.screenRightBoundary,this.screenBottomBoundary),zt=new $e,Ue=ye.first,dt=ye.last;let rt=[];for(let ht=Ue.path.length-1;ht>=1;ht--)rt.push(Ue.path[ht]);for(let ht=1;ht<dt.path.length;ht++)rt.push(dt.path[ht]);const Pn=2.5*De;if(M){const ht=rt.map(Lt=>bt(Lt,M,W));rt=ht.some(Lt=>Lt.signedDistanceFromCamera<=0)?[]:ht.map(Lt=>Lt.point)}let Bt=[];if(rt.length>0){const ht=rt[0].clone(),Lt=rt[0].clone();for(let jn=1;jn<rt.length;jn++)ht.x=Math.min(ht.x,rt[jn].x),ht.y=Math.min(ht.y,rt[jn].y),Lt.x=Math.max(Lt.x,rt[jn].x),Lt.y=Math.max(Lt.y,rt[jn].y);Bt=ht.x>=Le.x&&Lt.x<=We.x&&ht.y>=Le.y&&Lt.y<=We.y?[rt]:Lt.x<Le.x||ht.x>We.x||Lt.y<Le.y||ht.y>We.y?[]:g.clipLine([rt],Le.x,Le.y,We.x,We.y)}for(const ht of Bt){zt.reset(ht,.25*De);let Lt=0;Lt=zt.length<=.5*De?1:Math.ceil(zt.paddedLength/Pn)+1;for(let jn=0;jn<Lt;jn++){const un=jn/Math.max(Lt-1,1),Fr=zt.lerp(un),xi=Fr.x+ie,zn=Fr.y+ie;J.push(xi,zn,De,0);const Ai=xi-De,Es=zn-De,Ws=xi+De,go=zn+De;if(ke=ke&&this.isOffscreen(Ai,Es,Ws,go),Se=Se||this.isInsideGrid(Ai,Es,Ws,go),"always"!==o&&this.grid.hitTestCircle(xi,zn,De,o,F)&&(ve=!0,!k))return{circles:[],offscreen:!1,collisionDetected:ve}}}}return{circles:!k&&ve||!Se||me<this.perspectiveRatioCutoff?[]:J,offscreen:ke,collisionDetected:ve}}queryRenderedSymbols(o){if(0===o.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const u=[];let p=1/0,m=1/0,b=-1/0,E=-1/0;for(const R of o){const F=new g.Point(R.x+ie,R.y+ie);p=Math.min(p,F.x),m=Math.min(m,F.y),b=Math.max(b,F.x),E=Math.max(E,F.y),u.push(F)}const D=this.grid.query(p,m,b,E).concat(this.ignoredGrid.query(p,m,b,E)),M={},k={};for(const R of D){const F=R.key;if(void 0===M[F.bucketInstanceId]&&(M[F.bucketInstanceId]={}),M[F.bucketInstanceId][F.featureIndex])continue;const U=[new g.Point(R.x1,R.y1),new g.Point(R.x2,R.y1),new g.Point(R.x2,R.y2),new g.Point(R.x1,R.y2)];g.polygonIntersectsPolygon(u,U)&&(M[F.bucketInstanceId][F.featureIndex]=!0,void 0===k[F.bucketInstanceId]&&(k[F.bucketInstanceId]=[]),k[F.bucketInstanceId].push(F.featureIndex))}return k}insertCollisionBox(o,u,p,m,b,E){(p?this.ignoredGrid:this.grid).insert({bucketInstanceId:m,featureIndex:b,collisionGroupID:E,overlapMode:u},o[0],o[1],o[2],o[3])}insertCollisionCircles(o,u,p,m,b,E){const D=p?this.ignoredGrid:this.grid,M={bucketInstanceId:m,featureIndex:b,collisionGroupID:E,overlapMode:u};for(let k=0;k<o.length;k+=4)D.insertCircle(M,o[k],o[k+1],o[k+2])}projectAndGetPerspectiveRatio(o,u,p,m){let b;return m?(b=[u,p,m(u,p),1],g.transformMat4(b,b,o)):(b=[u,p,0,1],ee(b,b,o)),{point:new g.Point((b[0]/b[3]+1)/2*this.transform.width+ie,(-b[1]/b[3]+1)/2*this.transform.height+ie),perspectiveRatio:.5+this.transform.cameraToCenterDistance/b[3]*.5}}isOffscreen(o,u,p,m){return p<ie||o>=this.screenRightBoundary||m<ie||u>this.screenBottomBoundary}isInsideGrid(o,u,p,m){return p>=0&&o<this.gridRightBoundary&&m>=0&&u<this.gridBottomBoundary}getViewportMatrix(){const o=g.identity([]);return g.translate(o,o,[-100,-100,0]),o}}function ae(_,o,u){return o*(g.EXTENT/(_.tileSize*Math.pow(2,u-_.tileID.overscaledZ)))}class se{constructor(o,u,p,m){this.opacity=o?Math.max(0,Math.min(1,o.opacity+(o.placed?u:-u))):m&&p?1:0,this.placed=p}isHidden(){return 0===this.opacity&&!this.placed}}class he{constructor(o,u,p,m,b){this.text=new se(o?o.text:null,u,p,b),this.icon=new se(o?o.icon:null,u,m,b)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Te{constructor(o,u,p){this.text=o,this.icon=u,this.skipFade=p}}class Ae{constructor(){this.invProjMatrix=g.create(),this.viewportMatrix=g.create(),this.circles=[]}}class Ee{constructor(o,u,p,m,b){this.bucketInstanceId=o,this.featureIndex=u,this.sourceLayerIndex=p,this.bucketIndex=m,this.tileID=b}}class _t{constructor(o){this.crossSourceCollisions=o,this.maxGroupID=0,this.collisionGroups={}}get(o){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[o]){const u=++this.maxGroupID;this.collisionGroups[o]={ID:u,predicate:p=>p.collisionGroupID===u}}return this.collisionGroups[o]}}function St(_,o,u,p,m){const{horizontalAlign:b,verticalAlign:E}=g.getAnchorAlignment(_);return new g.Point(-(b-.5)*o+p[0]*m,-(E-.5)*u+p[1]*m)}function ot(_,o,u,p,m,b){const{x1:E,x2:D,y1:M,y2:k,anchorPointX:R,anchorPointY:F}=_,U=new g.Point(o,u);return p&&U._rotate(m?b:-b),{x1:E+U.x,y1:M+U.y,x2:D+U.x,y2:k+U.y,anchorPointX:R,anchorPointY:F}}class pt{constructor(o,u,p,m,b){this.transform=o.clone(),this.terrain=u,this.collisionIndex=new ue(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=p,this.retainedQueryData={},this.collisionGroups=new _t(m),this.collisionCircleArrays={},this.prevPlacement=b,b&&(b.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(o,u,p,m){const b=p.getBucket(u),E=p.latestFeatureIndex;if(!b||!E||u.id!==b.layerIds[0])return;const D=p.collisionBoxArray,M=b.layers[0].layout,k=Math.pow(2,this.transform.zoom-p.tileID.overscaledZ),R=p.tileSize/g.EXTENT,F=this.transform.calculatePosMatrix(p.tileID.toUnwrapped()),U="map"===M.get("text-pitch-alignment"),X="map"===M.get("text-rotation-alignment"),W=ae(p,1,this.transform.zoom),J=Wi(F,U,X,this.transform,W);let q=null;if(U){const me=lo(F,U,X,this.transform,W);q=g.multiply([],this.transform.labelPlaneMatrix,me)}this.retainedQueryData[b.bucketInstanceId]=new Ee(b.bucketInstanceId,E,b.sourceLayerIndex,b.index,p.tileID);const le={bucket:b,layout:M,posMatrix:F,textLabelPlaneMatrix:J,labelToScreenMatrix:q,scale:k,textPixelRatio:R,holdingForFade:p.holdingForFade(),collisionBoxArray:D,partiallyEvaluatedTextSize:g.evaluateSizeForZoom(b.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(b.sourceID)};if(m)for(const me of b.sortKeyRanges){const{sortKey:te,symbolInstanceStart:ce,symbolInstanceEnd:ye}=me;o.push({sortKey:te,symbolInstanceStart:ce,symbolInstanceEnd:ye,parameters:le})}else o.push({symbolInstanceStart:0,symbolInstanceEnd:b.symbolInstances.length,parameters:le})}attemptAnchorPlacement(o,u,p,m,b,E,D,M,k,R,F,U,X,W,J,q){const le=g.TextAnchorEnum[o.textAnchor],me=[o.textOffset0,o.textOffset1],te=St(le,p,m,me,b),ce=this.collisionIndex.placeCollisionBox(ot(u,te.x,te.y,E,D,this.transform.angle),F,M,k,R.predicate,q);if((!J||0!==this.collisionIndex.placeCollisionBox(ot(J,te.x,te.y,E,D,this.transform.angle),F,M,k,R.predicate,q).box.length)&&ce.box.length>0){let ye;if(this.prevPlacement&&this.prevPlacement.variableOffsets[U.crossTileID]&&this.prevPlacement.placements[U.crossTileID]&&this.prevPlacement.placements[U.crossTileID].text&&(ye=this.prevPlacement.variableOffsets[U.crossTileID].anchor),0===U.crossTileID)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[U.crossTileID]={textOffset:me,width:p,height:m,anchor:le,textBoxScale:b,prevAnchor:ye},this.markUsedJustification(X,le,U,W),X.allowVerticalPlacement&&(this.markUsedOrientation(X,W,U),this.placedOrientations[U.crossTileID]=W),{shift:te,placedGlyphBoxes:ce}}}placeLayerBucketPart(o,u,p){const{bucket:m,layout:b,posMatrix:E,textLabelPlaneMatrix:D,labelToScreenMatrix:M,textPixelRatio:k,holdingForFade:R,collisionBoxArray:F,partiallyEvaluatedTextSize:U,collisionGroup:X}=o.parameters,W=b.get("text-optional"),J=b.get("icon-optional"),q=g.getOverlapMode(b,"text-overlap","text-allow-overlap"),le="always"===q,me=g.getOverlapMode(b,"icon-overlap","icon-allow-overlap"),te="always"===me,ce="map"===b.get("text-rotation-alignment"),ye="map"===b.get("text-pitch-alignment"),ve="none"!==b.get("icon-text-fit"),Se="viewport-y"===b.get("symbol-z-order"),ke=le&&(te||!m.hasIconData()||J),De=te&&(le||!m.hasTextData()||W);!m.collisionArrays&&F&&m.deserializeCollisionBoxes(F);const Le=this.retainedQueryData[m.bucketInstanceId].tileID,We=this.terrain?(Ue,dt)=>this.terrain.getElevation(Le,Ue,dt):null,zt=(Ue,dt)=>{var rt,Pn;if(u[Ue.crossTileID])return;if(R)return void(this.placements[Ue.crossTileID]=new Te(!1,!1,!1));let Bt=!1,ht=!1,Lt=!0,jn=null,un={box:null,offscreen:null},Fr={box:null,offscreen:null},xi=null,zn=null,Ai=null,Es=0,Ws=0,go=0;dt.textFeatureIndex?Es=dt.textFeatureIndex:Ue.useRuntimeCollisionCircles&&(Es=Ue.featureIndex),dt.verticalTextFeatureIndex&&(Ws=dt.verticalTextFeatureIndex);const Kl=dt.textBox;if(Kl){const wi=mi=>{let ki=g.WritingMode.horizontal;if(m.allowVerticalPlacement&&!mi&&this.prevPlacement){const xr=this.prevPlacement.placedOrientations[Ue.crossTileID];xr&&(this.placedOrientations[Ue.crossTileID]=xr,ki=xr,this.markUsedOrientation(m,ki,Ue))}return ki},Ci=(mi,ki)=>{if(m.allowVerticalPlacement&&Ue.numVerticalGlyphVertices>0&&dt.verticalTextBox){for(const xr of m.writingModes)if(xr===g.WritingMode.vertical?(un=ki(),Fr=un):un=mi(),un&&un.box&&un.box.length)break}else un=mi()},Bi=Ue.textAnchorOffsetStartIndex,_l=Ue.textAnchorOffsetEndIndex;if(_l===Bi){const mi=(ki,xr)=>{const Wn=this.collisionIndex.placeCollisionBox(ki,q,k,E,X.predicate,We);return Wn&&Wn.box&&Wn.box.length&&(this.markUsedOrientation(m,xr,Ue),this.placedOrientations[Ue.crossTileID]=xr),Wn};Ci(()=>mi(Kl,g.WritingMode.horizontal),()=>{const ki=dt.verticalTextBox;return m.allowVerticalPlacement&&Ue.numVerticalGlyphVertices>0&&ki?mi(ki,g.WritingMode.vertical):{box:null,offscreen:null}}),wi(un&&un.box&&un.box.length)}else{let mi=g.TextAnchorEnum[null===(Pn=null===(rt=this.prevPlacement)||void 0===rt?void 0:rt.variableOffsets[Ue.crossTileID])||void 0===Pn?void 0:Pn.anchor];const ki=(Wn,Xs,cs)=>{const Zo=Wn.x2-Wn.x1,Zd=Wn.y2-Wn.y1,wa=Ue.textBoxScale,Wd=ve&&"never"===me?Xs:null;let Ca={box:[],offscreen:!1},Xn="never"===q?1:2,jc="never";mi&&Xn++;for(let Xd=0;Xd<Xn;Xd++){for(let yo=Bi;yo<_l;yo++){const Bn=m.textAnchorOffsets.get(yo);if(mi&&Bn.textAnchor!==mi)continue;const Ea=this.attemptAnchorPlacement(Bn,Wn,Zo,Zd,wa,ce,ye,k,E,X,jc,Ue,m,cs,Wd,We);if(Ea&&(Ca=Ea.placedGlyphBoxes,Ca&&Ca.box&&Ca.box.length))return Bt=!0,jn=Ea.shift,Ca}mi?mi=null:jc=q}return Ca};Ci(()=>ki(Kl,dt.iconBox,g.WritingMode.horizontal),()=>{const Wn=dt.verticalTextBox;return m.allowVerticalPlacement&&!(un&&un.box&&un.box.length)&&Ue.numVerticalGlyphVertices>0&&Wn?ki(Wn,dt.verticalIconBox,g.WritingMode.vertical):{box:null,offscreen:null}}),un&&(Bt=un.box,Lt=un.offscreen);const xr=wi(un&&un.box);if(!Bt&&this.prevPlacement){const Wn=this.prevPlacement.variableOffsets[Ue.crossTileID];Wn&&(this.variableOffsets[Ue.crossTileID]=Wn,this.markUsedJustification(m,Wn.anchor,Ue,xr))}}}if(xi=un,Bt=xi&&xi.box&&xi.box.length>0,Lt=xi&&xi.offscreen,Ue.useRuntimeCollisionCircles){const wi=m.text.placedSymbolArray.get(Ue.centerJustifiedTextSymbolIndex),Ci=g.evaluateSizeForFeature(m.textSizeData,U,wi),Bi=b.get("text-padding");zn=this.collisionIndex.placeCollisionCircles(q,wi,m.lineVertexArray,m.glyphOffsetArray,Ci,E,D,M,p,ye,X.predicate,Ue.collisionCircleDiameter,Bi,We),zn.circles.length&&zn.collisionDetected&&!p&&g.warnOnce("Collisions detected, but collision boxes are not shown"),Bt=le||zn.circles.length>0&&!zn.collisionDetected,Lt=Lt&&zn.offscreen}if(dt.iconFeatureIndex&&(go=dt.iconFeatureIndex),dt.iconBox){const wi=Ci=>{const Bi=ve&&jn?ot(Ci,jn.x,jn.y,ce,ye,this.transform.angle):Ci;return this.collisionIndex.placeCollisionBox(Bi,me,k,E,X.predicate,We)};Fr&&Fr.box&&Fr.box.length&&dt.verticalIconBox?(Ai=wi(dt.verticalIconBox),ht=Ai.box.length>0):(Ai=wi(dt.iconBox),ht=Ai.box.length>0),Lt=Lt&&Ai.offscreen}const qo=W||0===Ue.numHorizontalGlyphVertices&&0===Ue.numVerticalGlyphVertices,_o=J||0===Ue.numIconVertices;if(qo||_o?_o?qo||(ht=ht&&Bt):Bt=ht&&Bt:ht=Bt=ht&&Bt,Bt&&xi&&xi.box&&this.collisionIndex.insertCollisionBox(xi.box,q,b.get("text-ignore-placement"),m.bucketInstanceId,Fr&&Fr.box&&Ws?Ws:Es,X.ID),ht&&Ai&&this.collisionIndex.insertCollisionBox(Ai.box,me,b.get("icon-ignore-placement"),m.bucketInstanceId,go,X.ID),zn&&(Bt&&this.collisionIndex.insertCollisionCircles(zn.circles,q,b.get("text-ignore-placement"),m.bucketInstanceId,Es,X.ID),p)){const wi=m.bucketInstanceId;let Ci=this.collisionCircleArrays[wi];void 0===Ci&&(Ci=this.collisionCircleArrays[wi]=new Ae);for(let Bi=0;Bi<zn.circles.length;Bi+=4)Ci.circles.push(zn.circles[Bi+0]),Ci.circles.push(zn.circles[Bi+1]),Ci.circles.push(zn.circles[Bi+2]),Ci.circles.push(zn.collisionDetected?1:0)}if(0===Ue.crossTileID)throw new Error("symbolInstance.crossTileID can't be 0");if(0===m.bucketInstanceId)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Ue.crossTileID]=new Te(Bt||ke,ht||De,Lt||m.justReloaded),u[Ue.crossTileID]=!0};if(Se){if(0!==o.symbolInstanceStart)throw new Error("bucket.bucketInstanceId should be 0");const Ue=m.getSortedSymbolIndexes(this.transform.angle);for(let dt=Ue.length-1;dt>=0;--dt){const rt=Ue[dt];zt(m.symbolInstances.get(rt),m.collisionArrays[rt])}}else for(let Ue=o.symbolInstanceStart;Ue<o.symbolInstanceEnd;Ue++)zt(m.symbolInstances.get(Ue),m.collisionArrays[Ue]);if(p&&m.bucketInstanceId in this.collisionCircleArrays){const Ue=this.collisionCircleArrays[m.bucketInstanceId];g.invert(Ue.invProjMatrix,E),Ue.viewportMatrix=this.collisionIndex.getViewportMatrix()}m.justReloaded=!1}markUsedJustification(o,u,p,m){let b;b=m===g.WritingMode.vertical?p.verticalPlacedTextSymbolIndex:{left:p.leftJustifiedTextSymbolIndex,center:p.centerJustifiedTextSymbolIndex,right:p.rightJustifiedTextSymbolIndex}[g.getAnchorJustification(u)];const E=[p.leftJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.rightJustifiedTextSymbolIndex,p.verticalPlacedTextSymbolIndex];for(const D of E)D>=0&&(o.text.placedSymbolArray.get(D).crossTileID=b>=0&&D!==b?0:p.crossTileID)}markUsedOrientation(o,u,p){const m=u===g.WritingMode.horizontal||u===g.WritingMode.horizontalOnly?u:0,b=u===g.WritingMode.vertical?u:0,E=[p.leftJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.rightJustifiedTextSymbolIndex];for(const D of E)o.text.placedSymbolArray.get(D).placedOrientation=m;p.verticalPlacedTextSymbolIndex&&(o.text.placedSymbolArray.get(p.verticalPlacedTextSymbolIndex).placedOrientation=b)}commit(o){this.commitTime=o,this.zoomAtLastRecencyCheck=this.transform.zoom;const u=this.prevPlacement;let p=!1;this.prevZoomAdjustment=u?u.zoomAdjustment(this.transform.zoom):0;const m=u?u.symbolFadeChange(o):1,b=u?u.opacities:{},E=u?u.variableOffsets:{},D=u?u.placedOrientations:{};for(const M in this.placements){const k=this.placements[M],R=b[M];R?(this.opacities[M]=new he(R,m,k.text,k.icon),p=p||k.text!==R.text.placed||k.icon!==R.icon.placed):(this.opacities[M]=new he(null,m,k.text,k.icon,k.skipFade),p=p||k.text||k.icon)}for(const M in b){const k=b[M];if(!this.opacities[M]){const R=new he(k,m,!1,!1);R.isHidden()||(this.opacities[M]=R,p=p||k.text.placed||k.icon.placed)}}for(const M in E)this.variableOffsets[M]||!this.opacities[M]||this.opacities[M].isHidden()||(this.variableOffsets[M]=E[M]);for(const M in D)this.placedOrientations[M]||!this.opacities[M]||this.opacities[M].isHidden()||(this.placedOrientations[M]=D[M]);if(u&&void 0===u.lastPlacementChangeTime)throw new Error("Last placement time for previous placement is not defined");p?this.lastPlacementChangeTime=o:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=u?u.lastPlacementChangeTime:o)}updateLayerOpacities(o,u){const p={};for(const m of u){const b=m.getBucket(o);b&&m.latestFeatureIndex&&o.id===b.layerIds[0]&&this.updateBucketOpacities(b,p,m.collisionBoxArray)}}updateBucketOpacities(o,u,p){o.hasTextData()&&(o.text.opacityVertexArray.clear(),o.text.hasVisibleVertices=!1),o.hasIconData()&&(o.icon.opacityVertexArray.clear(),o.icon.hasVisibleVertices=!1),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexArray.clear(),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexArray.clear();const m=o.layers[0],b=m.layout,E=new he(null,0,!1,!1,!0),D=b.get("text-allow-overlap"),M=b.get("icon-allow-overlap"),k=m._unevaluatedLayout.hasValue("text-variable-anchor")||m._unevaluatedLayout.hasValue("text-variable-anchor-offset"),R="map"===b.get("text-rotation-alignment"),F="map"===b.get("text-pitch-alignment"),U="none"!==b.get("icon-text-fit"),X=new he(null,0,D&&(M||!o.hasIconData()||b.get("icon-optional")),M&&(D||!o.hasTextData()||b.get("text-optional")),!0);!o.collisionArrays&&p&&(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData())&&o.deserializeCollisionBoxes(p);const W=(J,q,le)=>{for(let me=0;me<q/4;me++)J.opacityVertexArray.emplaceBack(le);J.hasVisibleVertices=J.hasVisibleVertices||le!==ui};for(let J=0;J<o.symbolInstances.length;J++){const q=o.symbolInstances.get(J),{numHorizontalGlyphVertices:le,numVerticalGlyphVertices:me,crossTileID:te}=q;let ce=this.opacities[te];u[te]?ce=E:ce||(ce=X,this.opacities[te]=ce),u[te]=!0;const ye=q.numIconVertices>0,ve=this.placedOrientations[q.crossTileID],Se=ve===g.WritingMode.vertical,ke=ve===g.WritingMode.horizontal||ve===g.WritingMode.horizontalOnly;if(le>0||me>0){const De=or(ce.text);W(o.text,le,Se?ui:De),W(o.text,me,ke?ui:De);const Le=ce.text.isHidden();[q.rightJustifiedTextSymbolIndex,q.centerJustifiedTextSymbolIndex,q.leftJustifiedTextSymbolIndex].forEach(Ue=>{Ue>=0&&(o.text.placedSymbolArray.get(Ue).hidden=Le||Se?1:0)}),q.verticalPlacedTextSymbolIndex>=0&&(o.text.placedSymbolArray.get(q.verticalPlacedTextSymbolIndex).hidden=Le||ke?1:0);const We=this.variableOffsets[q.crossTileID];We&&this.markUsedJustification(o,We.anchor,q,ve);const zt=this.placedOrientations[q.crossTileID];zt&&(this.markUsedJustification(o,"left",q,zt),this.markUsedOrientation(o,zt,q))}if(ye){const De=or(ce.icon),Le=!(U&&q.verticalPlacedIconSymbolIndex&&Se);q.placedIconSymbolIndex>=0&&(W(o.icon,q.numIconVertices,Le?De:ui),o.icon.placedSymbolArray.get(q.placedIconSymbolIndex).hidden=ce.icon.isHidden()),q.verticalPlacedIconSymbolIndex>=0&&(W(o.icon,q.numVerticalIconVertices,Le?ui:De),o.icon.placedSymbolArray.get(q.verticalPlacedIconSymbolIndex).hidden=ce.icon.isHidden())}if(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData()){const De=o.collisionArrays[J];if(De){let Le=new g.Point(0,0);if(De.textBox||De.verticalTextBox){let zt=!0;if(k){const Ue=this.variableOffsets[te];Ue?(Le=St(Ue.anchor,Ue.width,Ue.height,Ue.textOffset,Ue.textBoxScale),R&&Le._rotate(F?this.transform.angle:-this.transform.angle)):zt=!1}De.textBox&&Dt(o.textCollisionBox.collisionVertexArray,ce.text.placed,!zt||Se,Le.x,Le.y),De.verticalTextBox&&Dt(o.textCollisionBox.collisionVertexArray,ce.text.placed,!zt||ke,Le.x,Le.y)}const We=!(ke||!De.verticalIconBox);De.iconBox&&Dt(o.iconCollisionBox.collisionVertexArray,ce.icon.placed,We,U?Le.x:0,U?Le.y:0),De.verticalIconBox&&Dt(o.iconCollisionBox.collisionVertexArray,ce.icon.placed,!We,U?Le.x:0,U?Le.y:0)}}}if(o.sortFeatures(this.transform.angle),this.retainedQueryData[o.bucketInstanceId]&&(this.retainedQueryData[o.bucketInstanceId].featureSortOrder=o.featureSortOrder),o.hasTextData()&&o.text.opacityVertexBuffer&&o.text.opacityVertexBuffer.updateData(o.text.opacityVertexArray),o.hasIconData()&&o.icon.opacityVertexBuffer&&o.icon.opacityVertexBuffer.updateData(o.icon.opacityVertexArray),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexBuffer&&o.iconCollisionBox.collisionVertexBuffer.updateData(o.iconCollisionBox.collisionVertexArray),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexBuffer&&o.textCollisionBox.collisionVertexBuffer.updateData(o.textCollisionBox.collisionVertexArray),o.text.opacityVertexArray.length!==o.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${o.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${o.text.layoutVertexArray.length}) / 4`);if(o.icon.opacityVertexArray.length!==o.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${o.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${o.icon.layoutVertexArray.length}) / 4`);if(o.bucketInstanceId in this.collisionCircleArrays){const J=this.collisionCircleArrays[o.bucketInstanceId];o.placementInvProjMatrix=J.invProjMatrix,o.placementViewportMatrix=J.viewportMatrix,o.collisionCircleArray=J.circles,delete this.collisionCircleArrays[o.bucketInstanceId]}}symbolFadeChange(o){return 0===this.fadeDuration?1:(o-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(o){return Math.max(0,(this.transform.zoom-o)/1.5)}hasTransitions(o){return this.stale||o-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(o,u){const p=this.zoomAtLastRecencyCheck===u?1-this.zoomAdjustment(u):1;return this.zoomAtLastRecencyCheck=u,this.commitTime+this.fadeDuration*p>o}setStale(){this.stale=!0}}function Dt(_,o,u,p,m){_.emplaceBack(o?1:0,u?1:0,p||0,m||0),_.emplaceBack(o?1:0,u?1:0,p||0,m||0),_.emplaceBack(o?1:0,u?1:0,p||0,m||0),_.emplaceBack(o?1:0,u?1:0,p||0,m||0)}const Wt=Math.pow(2,25),vn=Math.pow(2,24),At=Math.pow(2,17),qt=Math.pow(2,16),ln=Math.pow(2,9),gt=Math.pow(2,8),bn=Math.pow(2,1);function or(_){if(0===_.opacity&&!_.placed)return 0;if(1===_.opacity&&_.placed)return 4294967295;const o=_.placed?1:0,u=Math.floor(127*_.opacity);return u*Wt+o*vn+u*At+o*qt+u*ln+o*gt+u*bn+o}const ui=0;class $r{constructor(o){this._sortAcrossTiles="viewport-y"!==o.layout.get("symbol-z-order")&&!o.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(o,u,p,m,b){const E=this._bucketParts;for(;this._currentTileIndex<o.length;)if(u.getBucketParts(E,m,o[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,b())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,E.sort((D,M)=>D.sortKey-M.sortKey));this._currentPartIndex<E.length;)if(u.placeLayerBucketPart(E[this._currentPartIndex],this._seenCrossTileIDs,p),this._currentPartIndex++,b())return!0;return!1}}class Tu{constructor(o,u,p,m,b,E,D,M){this.placement=new pt(o,u,E,D,M),this._currentPlacementIndex=p.length-1,this._forceFullPlacement=m,this._showCollisionBoxes=b,this._done=!1}isDone(){return this._done}continuePlacement(o,u,p){const m=g.browser.now(),b=()=>!this._forceFullPlacement&&g.browser.now()-m>2;for(;this._currentPlacementIndex>=0;){const E=u[o[this._currentPlacementIndex]],D=this.placement.collisionIndex.transform.zoom;if("symbol"===E.type&&(!E.minzoom||E.minzoom<=D)&&(!E.maxzoom||E.maxzoom>D)){if(this._inProgressLayer||(this._inProgressLayer=new $r(E)),this._inProgressLayer.continuePlacement(p[E.source],this.placement,this._showCollisionBoxes,E,b))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(o){return this.placement.commit(o),this.placement}}const Ki=512/g.EXTENT/2;class ar{constructor(o,u,p){this.tileID=o,this.bucketInstanceId=p,this._symbolsByKey={};const m=new Map;for(let b=0;b<u.length;b++){const E=u.get(b),D=E.key,M=m.get(D);M?M.push(E):m.set(D,[E])}for(const[b,E]of m){const D={positions:E.map(M=>({x:Math.floor(M.anchorX*Ki),y:Math.floor(M.anchorY*Ki)})),crossTileIDs:E.map(M=>M.crossTileID)};if(D.positions.length>128){const M=new g.KDBush(D.positions.length,16,Uint16Array);for(const{x:k,y:R}of D.positions)M.add(k,R);M.finish(),delete D.positions,D.index=M}this._symbolsByKey[b]=D}}getScaledCoordinates(o,u){const{x:p,y:m,z:b}=this.tileID.canonical,{x:E,y:D,z:M}=u.canonical,k=Ki/Math.pow(2,M-b),R=(D*g.EXTENT+o.anchorY)*k,F=m*g.EXTENT*Ki;return{x:Math.floor((E*g.EXTENT+o.anchorX)*k-p*g.EXTENT*Ki),y:Math.floor(R-F)}}findMatches(o,u,p){const m=this.tileID.canonical.z<u.canonical.z?1:Math.pow(2,this.tileID.canonical.z-u.canonical.z);for(let b=0;b<o.length;b++){const E=o.get(b);if(E.crossTileID)continue;const D=this._symbolsByKey[E.key];if(!D)continue;const M=this.getScaledCoordinates(E,u);if(D.index){const k=D.index.range(M.x-m,M.y-m,M.x+m,M.y+m).sort();for(const R of k){const F=D.crossTileIDs[R];if(!p[F]){p[F]=!0,E.crossTileID=F;break}}}else if(D.positions)for(let k=0;k<D.positions.length;k++){const R=D.positions[k],F=D.crossTileIDs[k];if(Math.abs(R.x-M.x)<=m&&Math.abs(R.y-M.y)<=m&&!p[F]){p[F]=!0,E.crossTileID=F;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:o})=>o)}}class Bd{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Fl{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(o){const u=Math.round((o-this.lng)/360);if(0!==u)for(const p in this.indexes){const m=this.indexes[p],b={};for(const E in m){const D=m[E];D.tileID=D.tileID.unwrapTo(D.tileID.wrap+u),b[D.tileID.key]=D}this.indexes[p]=b}this.lng=o}addBucket(o,u,p){if(this.indexes[o.overscaledZ]&&this.indexes[o.overscaledZ][o.key]){if(this.indexes[o.overscaledZ][o.key].bucketInstanceId===u.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(o.overscaledZ,this.indexes[o.overscaledZ][o.key])}for(let b=0;b<u.symbolInstances.length;b++)u.symbolInstances.get(b).crossTileID=0;this.usedCrossTileIDs[o.overscaledZ]||(this.usedCrossTileIDs[o.overscaledZ]={});const m=this.usedCrossTileIDs[o.overscaledZ];for(const b in this.indexes){const E=this.indexes[b];if(Number(b)>o.overscaledZ)for(const D in E){const M=E[D];M.tileID.isChildOf(o)&&M.findMatches(u.symbolInstances,o,m)}else{const D=E[o.scaledTo(Number(b)).key];D&&D.findMatches(u.symbolInstances,o,m)}}for(let b=0;b<u.symbolInstances.length;b++){const E=u.symbolInstances.get(b);E.crossTileID||(E.crossTileID=p.generate(),m[E.crossTileID]=!0)}return void 0===this.indexes[o.overscaledZ]&&(this.indexes[o.overscaledZ]={}),this.indexes[o.overscaledZ][o.key]=new ar(o,u.symbolInstances,u.bucketInstanceId),!0}removeBucketCrossTileIDs(o,u){for(const p of u.getCrossTileIDsLists())for(const m of p)delete this.usedCrossTileIDs[o][m]}removeStaleBuckets(o){let u=!1;for(const p in this.indexes){const m=this.indexes[p];for(const b in m)o[m[b].bucketInstanceId]||(this.removeBucketCrossTileIDs(p,m[b]),delete m[b],u=!0)}return u}}class ii{constructor(){this.layerIndexes={},this.crossTileIDs=new Bd,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(o,u,p){let m=this.layerIndexes[o.id];void 0===m&&(m=this.layerIndexes[o.id]=new Fl);let b=!1;const E={};m.handleWrapJump(p);for(const D of u){const M=D.getBucket(o);M&&o.id===M.layerIds[0]&&(M.bucketInstanceId||(M.bucketInstanceId=++this.maxBucketInstanceId),m.addBucket(D.tileID,M,this.crossTileIDs)&&(b=!0),E[M.bucketInstanceId]=!0)}return m.removeStaleBuckets(E)&&(b=!0),b}pruneUnusedLayers(o){const u={};o.forEach(p=>{u[p]=!0});for(const p in this.layerIndexes)u[p]||delete this.layerIndexes[p]}}const zo=(_,o)=>g.emitValidationErrors(_,o&&o.filter(u=>"source.canvas"!==u.identifier)),ua=g.pick(g.operations,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setGlyphs","setSprite"]),di=g.pick(g.operations,["setCenter","setZoom","setBearing","setPitch"]),wc=g.emptyStyle();class Yi extends g.Evented{constructor(o,u={}){super(),this.map=o,this.dispatcher=new Ns(Fo(),this,o._getMapId()),this.imageManager=new mr,this.imageManager.setEventedParent(this),this.glyphManager=new ts(o._requestManager,u.localIdeographFontFamily),this.lineAtlas=new Ro(256,512),this.crossTileSymbolIndex=new ii,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new g.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",g.getReferrer());const p=this;this._rtlTextPluginCallback=Yi.registerForPluginStateChange(m=>{p.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:m.pluginStatus,pluginURL:m.pluginURL},(b,E)=>{if(g.triggerPluginCompletionEvent(b),E&&E.every(D=>D))for(const D in p.sourceCaches){const M=p.sourceCaches[D].getSource().type;"vector"!==M&&"geojson"!==M||p.sourceCaches[D].reload()}})}),this.on("data",m=>{if("source"!==m.dataType||"metadata"!==m.sourceDataType)return;const b=this.sourceCaches[m.sourceId];if(!b)return;const E=b.getSource();if(E&&E.vectorLayerIds)for(const D in this._layers){const M=this._layers[D];M.source===E.id&&this._validateLayer(M)}})}loadURL(o,u={},p){this.fire(new g.Event("dataloading",{dataType:"style"})),u.validate="boolean"!=typeof u.validate||u.validate;const m=this.map._requestManager.transformRequest(o,Kn.Style);this._request=g.getJSON(m,(b,E)=>{this._request=null,b?this.fire(new g.ErrorEvent(b)):E&&this._load(E,u,p)})}loadJSON(o,u={},p){this.fire(new g.Event("dataloading",{dataType:"style"})),this._request=g.browser.frame(()=>{this._request=null,u.validate=!1!==u.validate,this._load(o,u,p)})}loadEmpty(){this.fire(new g.Event("dataloading",{dataType:"style"})),this._load(wc,{validate:!1})}_load(o,u,p){var m;const b=u.transformStyle?u.transformStyle(p,o):o;if(!u.validate||!zo(this,g.validateStyle(b))){this._loaded=!0,this.stylesheet=b;for(const E in b.sources)this.addSource(E,b.sources[E],{validate:!1});b.sprite?this._loadSprite(b.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(b.glyphs),this._createLayers(),this.light=new Ln(this.stylesheet.light),this.map.setTerrain(null!==(m=this.stylesheet.terrain)&&void 0!==m?m:null),this.fire(new g.Event("data",{dataType:"style"})),this.fire(new g.Event("style.load"))}}_createLayers(){const o=g.derefLayers(this.stylesheet.layers);this.dispatcher.broadcast("setLayers",o),this._order=o.map(u=>u.id),this._layers={},this._serializedLayers=null;for(const u of o){const p=g.createStyleLayer(u);p.setEventedParent(this,{layer:{id:u.id}}),this._layers[u.id]=p}}_loadSprite(o,u=!1,p=void 0){this.imageManager.setLoaded(!1),this._spriteRequest=function(m,b,E,D){const M=Ls(m),k=M.length,R=E>1?"@2x":"",F={},U={},X={};for(const{id:W,url:J}of M){const q=b.transformRequest(b.normalizeSpriteURL(J,R,".json"),Kn.SpriteJSON),le=`${W}_${q.url}`;F[le]=g.getJSON(q,(ce,ye)=>{delete F[le],U[W]=ye,Zi(D,U,X,ce,k)});const me=b.transformRequest(b.normalizeSpriteURL(J,R,".png"),Kn.SpriteImage),te=`${W}_${me.url}`;F[te]=Ur.getImage(me,(ce,ye)=>{delete F[te],X[W]=ye,Zi(D,U,X,ce,k)})}return{cancel(){for(const W of Object.values(F))W.cancel()}}}(o,this.map._requestManager,this.map.getPixelRatio(),(m,b)=>{if(this._spriteRequest=null,m)this.fire(new g.ErrorEvent(m));else if(b)for(const E in b){this._spritesImagesIds[E]=[];const D=this._spritesImagesIds[E]?this._spritesImagesIds[E].filter(M=>!(M in b)):[];for(const M of D)this.imageManager.removeImage(M),this._changedImages[M]=!0;for(const M in b[E]){const k="default"===E?M:`${E}:${M}`;this._spritesImagesIds[E].push(k),k in this.imageManager.images?this.imageManager.updateImage(k,b[E][M],!1):this.imageManager.addImage(k,b[E][M]),u&&(this._changedImages[k]=!0)}}this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),u&&(this._changed=!0),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new g.Event("data",{dataType:"style"})),p&&p(m)})}_unloadSprite(){for(const o of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(o),this._changedImages[o]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new g.Event("data",{dataType:"style"}))}_validateLayer(o){const u=this.sourceCaches[o.source];if(!u)return;const p=o.sourceLayer;if(!p)return;const m=u.getSource();("geojson"===m.type||m.vectorLayerIds&&-1===m.vectorLayerIds.indexOf(p))&&this.fire(new g.ErrorEvent(new Error(`Source layer "${p}" does not exist on source "${m.id}" as specified by style layer "${o.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const o in this.sourceCaches)if(!this.sourceCaches[o].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(o){const u=this._serializedAllLayers();if(!o||0===o.length)return Object.values(u);const p=[];for(const m of o)u[m]&&p.push(u[m]);return p}_serializedAllLayers(){let o=this._serializedLayers;if(o)return o;o=this._serializedLayers={};const u=Object.keys(this._layers);for(const p of u){const m=this._layers[p];"custom"!==m.type&&(o[p]=m.serialize())}return o}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const o in this.sourceCaches)if(this.sourceCaches[o].hasTransition())return!0;for(const o in this._layers)if(this._layers[o].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(o){if(!this._loaded)return;const u=this._changed;if(this._changed){const m=Object.keys(this._updatedLayers),b=Object.keys(this._removedLayers);(m.length||b.length)&&this._updateWorkerLayers(m,b);for(const E in this._updatedSources){const D=this._updatedSources[E];if("reload"===D)this._reloadSource(E);else{if("clear"!==D)throw new Error(`Invalid action ${D}`);this._clearSource(E)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const E in this._updatedPaintProps)this._layers[E].updateTransitions(o);this.light.updateTransitions(o),this._resetUpdates()}const p={};for(const m in this.sourceCaches){const b=this.sourceCaches[m];p[m]=b.used,b.used=!1}for(const m of this._order){const b=this._layers[m];b.recalculate(o,this._availableImages),!b.isHidden(o.zoom)&&b.source&&(this.sourceCaches[b.source].used=!0)}for(const m in p){const b=this.sourceCaches[m];p[m]!==b.used&&b.fire(new g.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:m}))}this.light.recalculate(o),this.z=o.zoom,u&&this.fire(new g.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const o=Object.keys(this._changedImages);if(o.length){for(const u in this.sourceCaches)this.sourceCaches[u].reloadTilesForDependencies(["icons","patterns"],o);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const o in this.sourceCaches)this.sourceCaches[o].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(o,u){this.dispatcher.broadcast("updateLayers",{layers:this._serializeByIds(o),removedIds:u})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(o,u={}){this._checkLoaded();const p=this.serialize();if(o=u.transformStyle?u.transformStyle(p,o):o,zo(this,g.validateStyle(o)))return!1;(o=g.clone$1(o)).layers=g.derefLayers(o.layers);const m=g.diffStyles(p,o).filter(E=>!(E.command in di));if(0===m.length)return!1;const b=m.filter(E=>!(E.command in ua));if(b.length>0)throw new Error(`Unimplemented: ${b.map(E=>E.command).join(", ")}.`);for(const E of m)"setTransition"!==E.command&&this[E.command].apply(this,E.args);return this.stylesheet=o,!0}addImage(o,u){if(this.getImage(o))return this.fire(new g.ErrorEvent(new Error(`An image named "${o}" already exists.`)));this.imageManager.addImage(o,u),this._afterImageUpdated(o)}updateImage(o,u){this.imageManager.updateImage(o,u)}getImage(o){return this.imageManager.getImage(o)}removeImage(o){if(!this.getImage(o))return this.fire(new g.ErrorEvent(new Error(`An image named "${o}" does not exist.`)));this.imageManager.removeImage(o),this._afterImageUpdated(o)}_afterImageUpdated(o){this._availableImages=this.imageManager.listImages(),this._changedImages[o]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new g.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(o,u,p={}){if(this._checkLoaded(),void 0!==this.sourceCaches[o])throw new Error(`Source "${o}" already exists.`);if(!u.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(u).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(u.type)>=0&&this._validate(g.validateStyle.source,`sources.${o}`,u,null,p))return;this.map&&this.map._collectResourceTiming&&(u.collectResourceTiming=!0);const m=this.sourceCaches[o]=new Jn(o,u,this.dispatcher);m.style=this,m.setEventedParent(this,()=>({isSourceLoaded:m.loaded(),source:m.serialize(),sourceId:o})),m.onAdd(this.map),this._changed=!0}removeSource(o){if(this._checkLoaded(),void 0===this.sourceCaches[o])throw new Error("There is no source with this ID");for(const p in this._layers)if(this._layers[p].source===o)return this.fire(new g.ErrorEvent(new Error(`Source "${o}" cannot be removed while layer "${p}" is using it.`)));const u=this.sourceCaches[o];delete this.sourceCaches[o],delete this._updatedSources[o],u.fire(new g.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:o})),u.setEventedParent(null),u.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(o,u){if(this._checkLoaded(),void 0===this.sourceCaches[o])throw new Error(`There is no source with this ID=${o}`);const p=this.sourceCaches[o].getSource();if("geojson"!==p.type)throw new Error(`geojsonSource.type is ${p.type}, which is !== 'geojson`);p.setData(u),this._changed=!0}getSource(o){return this.sourceCaches[o]&&this.sourceCaches[o].getSource()}addLayer(o,u,p={}){this._checkLoaded();const m=o.id;if(this.getLayer(m))return void this.fire(new g.ErrorEvent(new Error(`Layer "${m}" already exists on this map.`)));let b;if("custom"===o.type){if(zo(this,g.validateCustomStyleLayer(o)))return;b=g.createStyleLayer(o)}else{if("source"in o&&"object"==typeof o.source&&(this.addSource(m,o.source),o=g.clone$1(o),o=g.extend(o,{source:m})),this._validate(g.validateStyle.layer,`layers.${m}`,o,{arrayIndex:-1},p))return;b=g.createStyleLayer(o),this._validateLayer(b),b.setEventedParent(this,{layer:{id:m}})}const E=u?this._order.indexOf(u):this._order.length;if(u&&-1===E)this.fire(new g.ErrorEvent(new Error(`Cannot add layer "${m}" before non-existing layer "${u}".`)));else{if(this._order.splice(E,0,m),this._layerOrderChanged=!0,this._layers[m]=b,this._removedLayers[m]&&b.source&&"custom"!==b.type){const D=this._removedLayers[m];delete this._removedLayers[m],D.type!==b.type?this._updatedSources[b.source]="clear":(this._updatedSources[b.source]="reload",this.sourceCaches[b.source].pause())}this._updateLayer(b),b.onAdd&&b.onAdd(this.map)}}moveLayer(o,u){if(this._checkLoaded(),this._changed=!0,!this._layers[o])return void this.fire(new g.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot be moved.`)));if(o===u)return;const p=this._order.indexOf(o);this._order.splice(p,1);const m=u?this._order.indexOf(u):this._order.length;u&&-1===m?this.fire(new g.ErrorEvent(new Error(`Cannot move layer "${o}" before non-existing layer "${u}".`))):(this._order.splice(m,0,o),this._layerOrderChanged=!0)}removeLayer(o){this._checkLoaded();const u=this._layers[o];if(!u)return void this.fire(new g.ErrorEvent(new Error(`Cannot remove non-existing layer "${o}".`)));u.setEventedParent(null);const p=this._order.indexOf(o);this._order.splice(p,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[o]=u,delete this._layers[o],this._serializedLayers&&delete this._serializedLayers[o],delete this._updatedLayers[o],delete this._updatedPaintProps[o],u.onRemove&&u.onRemove(this.map)}getLayer(o){return this._layers[o]}hasLayer(o){return o in this._layers}setLayerZoomRange(o,u,p){this._checkLoaded();const m=this.getLayer(o);m?m.minzoom===u&&m.maxzoom===p||(null!=u&&(m.minzoom=u),null!=p&&(m.maxzoom=p),this._updateLayer(m)):this.fire(new g.ErrorEvent(new Error(`Cannot set the zoom range of non-existing layer "${o}".`)))}setFilter(o,u,p={}){this._checkLoaded();const m=this.getLayer(o);if(m){if(!g.deepEqual(m.filter,u))return null==u?(m.filter=void 0,void this._updateLayer(m)):void(this._validate(g.validateStyle.filter,`layers.${m.id}.filter`,u,null,p)||(m.filter=g.clone$1(u),this._updateLayer(m)))}else this.fire(new g.ErrorEvent(new Error(`Cannot filter non-existing layer "${o}".`)))}getFilter(o){return g.clone$1(this.getLayer(o).filter)}setLayoutProperty(o,u,p,m={}){this._checkLoaded();const b=this.getLayer(o);b?g.deepEqual(b.getLayoutProperty(u),p)||(b.setLayoutProperty(u,p,m),this._updateLayer(b)):this.fire(new g.ErrorEvent(new Error(`Cannot style non-existing layer "${o}".`)))}getLayoutProperty(o,u){const p=this.getLayer(o);if(p)return p.getLayoutProperty(u);this.fire(new g.ErrorEvent(new Error(`Cannot get style of non-existing layer "${o}".`)))}setPaintProperty(o,u,p,m={}){this._checkLoaded();const b=this.getLayer(o);b?g.deepEqual(b.getPaintProperty(u),p)||(b.setPaintProperty(u,p,m)&&this._updateLayer(b),this._changed=!0,this._updatedPaintProps[o]=!0):this.fire(new g.ErrorEvent(new Error(`Cannot style non-existing layer "${o}".`)))}getPaintProperty(o,u){return this.getLayer(o).getPaintProperty(u)}setFeatureState(o,u){this._checkLoaded();const p=o.source,m=o.sourceLayer,b=this.sourceCaches[p];if(void 0===b)return void this.fire(new g.ErrorEvent(new Error(`The source '${p}' does not exist in the map's style.`)));const E=b.getSource().type;"geojson"===E&&m?this.fire(new g.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):"vector"!==E||m?(void 0===o.id&&this.fire(new g.ErrorEvent(new Error("The feature id parameter must be provided."))),b.setFeatureState(m,o.id,u)):this.fire(new g.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(o,u){this._checkLoaded();const p=o.source,m=this.sourceCaches[p];if(void 0===m)return void this.fire(new g.ErrorEvent(new Error(`The source '${p}' does not exist in the map's style.`)));const b=m.getSource().type,E="vector"===b?o.sourceLayer:void 0;"vector"!==b||E?u&&"string"!=typeof o.id&&"number"!=typeof o.id?this.fire(new g.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):m.removeFeatureState(E,o.id,u):this.fire(new g.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(o){this._checkLoaded();const u=o.source,p=o.sourceLayer,m=this.sourceCaches[u];if(void 0!==m)return"vector"!==m.getSource().type||p?(void 0===o.id&&this.fire(new g.ErrorEvent(new Error("The feature id parameter must be provided."))),m.getFeatureState(p,o.id)):void this.fire(new g.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new g.ErrorEvent(new Error(`The source '${u}' does not exist in the map's style.`)))}getTransition(){return g.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const o=g.mapObject(this.sourceCaches,m=>m.serialize()),u=this._serializeByIds(this._order),p=this.stylesheet;return g.filterObject({version:p.version,name:p.name,metadata:p.metadata,light:p.light,center:p.center,zoom:p.zoom,bearing:p.bearing,pitch:p.pitch,sprite:p.sprite,glyphs:p.glyphs,transition:p.transition,sources:o,layers:u},m=>void 0!==m)}_updateLayer(o){this._updatedLayers[o.id]=!0,o.source&&!this._updatedSources[o.source]&&"raster"!==this.sourceCaches[o.source].getSource().type&&(this._updatedSources[o.source]="reload",this.sourceCaches[o.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(o){const u=E=>"fill-extrusion"===this._layers[E].type,p={},m=[];for(let E=this._order.length-1;E>=0;E--){const D=this._order[E];if(u(D)){p[D]=E;for(const M of o){const k=M[D];if(k)for(const R of k)m.push(R)}}}m.sort((E,D)=>D.intersectionZ-E.intersectionZ);const b=[];for(let E=this._order.length-1;E>=0;E--){const D=this._order[E];if(u(D))for(let M=m.length-1;M>=0;M--){const k=m[M].feature;if(p[k.layer.id]<E)break;b.push(k),m.pop()}else for(const M of o){const k=M[D];if(k)for(const R of k)b.push(R.feature)}}return b}queryRenderedFeatures(o,u,p){u&&u.filter&&this._validate(g.validateStyle.filter,"queryRenderedFeatures.filter",u.filter,null,u);const m={};if(u&&u.layers){if(!Array.isArray(u.layers))return this.fire(new g.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const D of u.layers){const M=this._layers[D];if(!M)return this.fire(new g.ErrorEvent(new Error(`The layer '${D}' does not exist in the map's style and cannot be queried for features.`))),[];m[M.source]=!0}}const b=[];u.availableImages=this._availableImages;const E=this._serializedAllLayers();for(const D in this.sourceCaches)u.layers&&!m[D]||b.push(on(this.sourceCaches[D],this._layers,E,o,u,p));return this.placement&&b.push(function(D,M,k,R,F,U,X){const W={},J=U.queryRenderedSymbols(R),q=[];for(const le of Object.keys(J).map(Number))q.push(X[le]);q.sort(Ja);for(const le of q){const me=le.featureIndex.lookupSymbolFeatures(J[le.bucketInstanceId],M,le.bucketIndex,le.sourceLayerIndex,F.filter,F.layers,F.availableImages,D);for(const te in me){const ce=W[te]=W[te]||[],ye=me[te];ye.sort((ve,Se)=>{const ke=le.featureSortOrder;if(ke){const De=ke.indexOf(ve.featureIndex);return ke.indexOf(Se.featureIndex)-De}return Se.featureIndex-ve.featureIndex});for(const ve of ye)ce.push(ve)}}for(const le in W)W[le].forEach(me=>{const te=me.feature,ce=k[D[le].source].getFeatureState(te.layer["source-layer"],te.id);te.source=te.layer.source,te.layer["source-layer"]&&(te.sourceLayer=te.layer["source-layer"]),te.state=ce});return W}(this._layers,E,this.sourceCaches,o,u,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(b)}querySourceFeatures(o,u){u&&u.filter&&this._validate(g.validateStyle.filter,"querySourceFeatures.filter",u.filter,null,u);const p=this.sourceCaches[o];return p?function(m,b){const E=m.getRenderableIds().map(k=>m.getTileByID(k)),D=[],M={};for(let k=0;k<E.length;k++){const R=E[k],F=R.tileID.canonical.key;M[F]||(M[F]=!0,R.querySourceFeatures(D,b))}return D}(p,u):[]}addSourceType(o,u,p){return Ya(o)?p(new Error(`A source type called "${o}" already exists.`)):(_s[o]=u,u.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:o,url:u.workerSourceURL},p):p(null,null))}getLight(){return this.light.getLight()}setLight(o,u={}){this._checkLoaded();const p=this.light.getLight();let m=!1;for(const E in o)if(!g.deepEqual(o[E],p[E])){m=!0;break}if(!m)return;const b={now:g.browser.now(),transition:g.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(o,u),this.light.updateTransitions(b)}_validate(o,u,p,m,b={}){return(!b||!1!==b.validate)&&zo(this,o.call(g.validateStyle,g.extend({key:u,style:this.serialize(),value:p,styleSpec:g.v8Spec},m)))}_remove(o=!0){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),g.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const u in this._layers)this._layers[u].setEventedParent(null);for(const u in this.sourceCaches){const p=this.sourceCaches[u];p.setEventedParent(null),p.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove(o)}_clearSource(o){this.sourceCaches[o].clearTiles()}_reloadSource(o){this.sourceCaches[o].resume(),this.sourceCaches[o].reload()}_updateSources(o){for(const u in this.sourceCaches)this.sourceCaches[u].update(o,this.map.terrain)}_generateCollisionBoxes(){for(const o in this.sourceCaches)this._reloadSource(o)}_updatePlacement(o,u,p,m,b=!1){let E=!1,D=!1;const M={};for(const k of this._order){const R=this._layers[k];if("symbol"!==R.type)continue;if(!M[R.source]){const U=this.sourceCaches[R.source];M[R.source]=U.getRenderableIds(!0).map(X=>U.getTileByID(X)).sort((X,W)=>W.tileID.overscaledZ-X.tileID.overscaledZ||(X.tileID.isLessThan(W.tileID)?-1:1))}const F=this.crossTileSymbolIndex.addLayer(R,M[R.source],o.center.lng);E=E||F}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((b=b||this._layerOrderChanged||0===p)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(g.browser.now(),o.zoom))&&(this.pauseablePlacement=new Tu(o,this.map.terrain,this._order,b,u,p,m,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,M),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(g.browser.now()),D=!0),E&&this.pauseablePlacement.placement.setStale()),D||E)for(const k of this._order){const R=this._layers[k];"symbol"===R.type&&this.placement.updateLayerOpacities(R,M[R.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(g.browser.now())}_releaseSymbolFadeTiles(){for(const o in this.sourceCaches)this.sourceCaches[o].releaseSymbolFadeTiles()}getImages(o,u,p){this.imageManager.getImages(u.icons,p),this._updateTilesForChangedImages();const m=this.sourceCaches[u.source];m&&m.setDependencies(u.tileID.key,u.type,u.icons)}getGlyphs(o,u,p){this.glyphManager.getGlyphs(u.stacks,p);const m=this.sourceCaches[u.source];m&&m.setDependencies(u.tileID.key,u.type,[""])}getResource(o,u,p){return g.makeRequest(u,p)}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(o,u={}){this._checkLoaded(),o&&this._validate(g.validateStyle.glyphs,"glyphs",o,null,u)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=o,this.glyphManager.entries={},this.glyphManager.setURL(o))}addSprite(o,u,p={},m){this._checkLoaded();const b=[{id:o,url:u}],E=[...Ls(this.stylesheet.sprite),...b];this._validate(g.validateStyle.sprite,"sprite",E,null,p)||(this.stylesheet.sprite=E,this._loadSprite(b,!0,m))}removeSprite(o){this._checkLoaded();const u=Ls(this.stylesheet.sprite);if(u.find(p=>p.id===o)){if(this._spritesImagesIds[o])for(const p of this._spritesImagesIds[o])this.imageManager.removeImage(p),this._changedImages[p]=!0;u.splice(u.findIndex(p=>p.id===o),1),this.stylesheet.sprite=u.length>0?u:void 0,delete this._spritesImagesIds[o],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new g.Event("data",{dataType:"style"}))}else this.fire(new g.ErrorEvent(new Error(`Sprite "${o}" doesn't exists on this map.`)))}getSprite(){return Ls(this.stylesheet.sprite)}setSprite(o,u={},p){this._checkLoaded(),o&&this._validate(g.validateStyle.sprite,"sprite",o,null,u)||(this.stylesheet.sprite=o,o?this._loadSprite(o,!0,p):(this._unloadSprite(),p&&p(null)))}}Yi.registerForPluginStateChange=g.registerForPluginStateChange;var Cc=g.createLayout([{name:"a_pos",type:"Int16",components:2}]),$s="attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_depth;void main() {float extent=8192.0;float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/extent;gl_Position=u_matrix*vec4(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}";const Qn={prelude:hn("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\n","#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}\n#ifdef TERRAIN3D\nuniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;\n#endif\nconst highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {\n#ifdef TERRAIN3D\nhighp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));\n#else\nreturn 1.0;\n#endif\n}float calculate_visibility(vec4 pos) {\n#ifdef TERRAIN3D\nvec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;\n#else\nreturn 1.0;\n#endif\n}float ele(vec2 pos) {\n#ifdef TERRAIN3D\nvec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;\n#else\nreturn 0.0;\n#endif\n}float get_elevation(vec2 pos) {\n#ifdef TERRAIN3D\nvec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;\n#else\nreturn 0.0;\n#endif\n}"),background:hn("uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:hn("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:hn("varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}"),clippingMask:hn("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:hn("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}"),heatmapTexture:hn("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:hn("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:hn("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:hn("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:hn("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_FragColor=color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);}"),fillOutline:hn("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),fillOutlinePattern:hn("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),fillPattern:hn("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}"),fillExtrusion:hn("varying vec4 v_color;void main() {gl_FragColor=v_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;\n#ifdef TERRAIN3D\nattribute vec2 a_centroid;\n#endif\nvarying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 normal=a_normal_ed.xyz;\n#ifdef TERRAIN3D\nfloat height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);\n#else\nfloat height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;\n#endif\nbase=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}"),fillExtrusionPattern:hn("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;\n#ifdef TERRAIN3D\nattribute vec2 a_centroid;\n#endif\nvarying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;\n#ifdef TERRAIN3D\nfloat height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);\n#else\nfloat height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;\n#endif\nbase=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0\n? a_pos\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}"),hillshadePrepare:hn("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:hn("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;\n#define PI 3.141592653589793\nvoid main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:hn("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_width2=vec2(outset,inset);}"),lineGradient:hn("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_width2=vec2(outset,inset);}"),linePattern:hn("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}"),lineSDF:hn("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}"),raster:hn("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:hn("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}"),symbolSDF:hn("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"),symbolTextAndIcon:hn("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}"),terrain:hn("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",$s),terrainDepth:hn("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",$s),terrainCoords:hn("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",$s)};function hn(_,o){const u=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,p=o.match(/attribute ([\w]+) ([\w]+)/g),m=_.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),b=o.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),E=b?b.concat(m):m,D={};return{fragmentSource:_=_.replace(u,(M,k,R,F,U)=>(D[U]=!0,"define"===k?`\n#ifndef HAS_UNIFORM_u_${U}\nvarying ${R} ${F} ${U};\n#else\nuniform ${R} ${F} u_${U};\n#endif\n`:`\n#ifdef HAS_UNIFORM_u_${U}\n    ${R} ${F} ${U} = u_${U};\n#endif\n`)),vertexSource:o=o.replace(u,(M,k,R,F,U)=>{const X="float"===F?"vec2":"vec4",W=U.match(/color/)?"color":X;return D[U]?"define"===k?`\n#ifndef HAS_UNIFORM_u_${U}\nuniform lowp float u_${U}_t;\nattribute ${R} ${X} a_${U};\nvarying ${R} ${F} ${U};\n#else\nuniform ${R} ${F} u_${U};\n#endif\n`:"vec4"===W?`\n#ifndef HAS_UNIFORM_u_${U}\n    ${U} = a_${U};\n#else\n    ${R} ${F} ${U} = u_${U};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${U}\n    ${U} = unpack_mix_${W}(a_${U}, u_${U}_t);\n#else\n    ${R} ${F} ${U} = u_${U};\n#endif\n`:"define"===k?`\n#ifndef HAS_UNIFORM_u_${U}\nuniform lowp float u_${U}_t;\nattribute ${R} ${X} a_${U};\n#else\nuniform ${R} ${F} u_${U};\n#endif\n`:"vec4"===W?`\n#ifndef HAS_UNIFORM_u_${U}\n    ${R} ${F} ${U} = a_${U};\n#else\n    ${R} ${F} ${U} = u_${U};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${U}\n    ${R} ${F} ${U} = unpack_mix_${W}(a_${U}, u_${U}_t);\n#else\n    ${R} ${F} ${U} = u_${U};\n#endif\n`}),staticAttributes:p,staticUniforms:E}}class _r{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(o,u,p,m,b,E,D,M,k){this.context=o;let R=this.boundPaintVertexBuffers.length!==m.length;for(let F=0;!R&&F<m.length;F++)this.boundPaintVertexBuffers[F]!==m[F]&&(R=!0);!this.vao||this.boundProgram!==u||this.boundLayoutVertexBuffer!==p||R||this.boundIndexBuffer!==b||this.boundVertexOffset!==E||this.boundDynamicVertexBuffer!==D||this.boundDynamicVertexBuffer2!==M||this.boundDynamicVertexBuffer3!==k?this.freshBind(u,p,m,b,E,D,M,k):(o.bindVertexArray.set(this.vao),D&&D.bind(),b&&b.dynamicDraw&&b.bind(),M&&M.bind(),k&&k.bind())}freshBind(o,u,p,m,b,E,D,M){const k=o.numAttributes,R=this.context,F=R.gl;this.vao&&this.destroy(),this.vao=R.createVertexArray(),R.bindVertexArray.set(this.vao),this.boundProgram=o,this.boundLayoutVertexBuffer=u,this.boundPaintVertexBuffers=p,this.boundIndexBuffer=m,this.boundVertexOffset=b,this.boundDynamicVertexBuffer=E,this.boundDynamicVertexBuffer2=D,this.boundDynamicVertexBuffer3=M,u.enableAttributes(F,o);for(const U of p)U.enableAttributes(F,o);E&&E.enableAttributes(F,o),D&&D.enableAttributes(F,o),M&&M.enableAttributes(F,o),u.bind(),u.setVertexAttribPointers(F,o,b);for(const U of p)U.bind(),U.setVertexAttribPointers(F,o,b);E&&(E.bind(),E.setVertexAttribPointers(F,o,b)),m&&m.bind(),D&&(D.bind(),D.setVertexAttribPointers(F,o,b)),M&&(M.bind(),M.setVertexAttribPointers(F,o,b)),R.currentNumAttributes=k}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}function Et(_){const o=[];for(let u=0;u<_.length;u++){if(null===_[u])continue;const p=_[u].split(" ");o.push(p.pop())}return o}class co{constructor(o,u,p,m,b,E){const D=o.gl;this.program=D.createProgram();const M=Et(u.staticAttributes),k=p?p.getBinderAttributes():[],R=M.concat(k),F=Qn.prelude.staticUniforms?Et(Qn.prelude.staticUniforms):[],U=u.staticUniforms?Et(u.staticUniforms):[],X=p?p.getBinderUniforms():[],W=F.concat(U).concat(X),J=[];for(const ve of W)J.indexOf(ve)<0&&J.push(ve);const q=p?p.defines():[];b&&q.push("#define OVERDRAW_INSPECTOR;"),E&&q.push("#define TERRAIN3D;");const le=q.concat(Qn.prelude.fragmentSource,u.fragmentSource).join("\n"),me=q.concat(Qn.prelude.vertexSource,u.vertexSource).join("\n"),te=D.createShader(D.FRAGMENT_SHADER);if(D.isContextLost())return void(this.failedToCreate=!0);if(D.shaderSource(te,le),D.compileShader(te),!D.getShaderParameter(te,D.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${D.getShaderInfoLog(te)}`);D.attachShader(this.program,te);const ce=D.createShader(D.VERTEX_SHADER);if(D.isContextLost())return void(this.failedToCreate=!0);if(D.shaderSource(ce,me),D.compileShader(ce),!D.getShaderParameter(ce,D.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${D.getShaderInfoLog(ce)}`);D.attachShader(this.program,ce),this.attributes={};const ye={};this.numAttributes=R.length;for(let ve=0;ve<this.numAttributes;ve++)R[ve]&&(D.bindAttribLocation(this.program,ve,R[ve]),this.attributes[R[ve]]=ve);if(D.linkProgram(this.program),!D.getProgramParameter(this.program,D.LINK_STATUS))throw new Error(`Program failed to link: ${D.getProgramInfoLog(this.program)}`);D.deleteShader(ce),D.deleteShader(te);for(let ve=0;ve<J.length;ve++){const Se=J[ve];if(Se&&!ye[Se]){const ke=D.getUniformLocation(this.program,Se);ke&&(ye[Se]=ke)}}var ve,Se;this.fixedUniforms=m(o,ye),this.terrainUniforms={u_depth:new g.Uniform1i(ve=o,(Se=ye).u_depth),u_terrain:new g.Uniform1i(ve,Se.u_terrain),u_terrain_dim:new g.Uniform1f(ve,Se.u_terrain_dim),u_terrain_matrix:new g.UniformMatrix4f(ve,Se.u_terrain_matrix),u_terrain_unpack:new g.Uniform4f(ve,Se.u_terrain_unpack),u_terrain_exaggeration:new g.Uniform1f(ve,Se.u_terrain_exaggeration)},this.binderUniforms=p?p.getUniforms(o,ye):[]}draw(o,u,p,m,b,E,D,M,k,R,F,U,X,W,J,q,le,me){const te=o.gl;if(this.failedToCreate)return;if(o.program.set(this.program),o.setDepthMode(p),o.setStencilMode(m),o.setColorMode(b),o.setCullFace(E),M){o.activeTexture.set(te.TEXTURE2),te.bindTexture(te.TEXTURE_2D,M.depthTexture),o.activeTexture.set(te.TEXTURE3),te.bindTexture(te.TEXTURE_2D,M.texture);for(const ye in this.terrainUniforms)this.terrainUniforms[ye].set(M[ye])}for(const ye in this.fixedUniforms)this.fixedUniforms[ye].set(D[ye]);J&&J.setUniforms(o,this.binderUniforms,X,{zoom:W});let ce=0;switch(u){case te.LINES:ce=2;break;case te.TRIANGLES:ce=3;break;case te.LINE_STRIP:ce=1}for(const ye of U.get()){const ve=ye.vaos||(ye.vaos={});(ve[k]||(ve[k]=new _r)).bind(o,this,R,J?J.getPaintVertexBuffers():[],F,ye.vertexOffset,q,le,me),te.drawElements(u,ye.primitiveLength*ce,te.UNSIGNED_SHORT,ye.primitiveOffset*ce*2)}}}function nl(_,o,u){const p=1/ae(u,1,o.transform.tileZoom),m=Math.pow(2,u.tileID.overscaledZ),b=u.tileSize*Math.pow(2,o.transform.tileZoom)/m,E=b*(u.tileID.canonical.x+u.tileID.wrap*m),D=b*u.tileID.canonical.y;return{u_image:0,u_texsize:u.imageAtlasTexture.size,u_scale:[p,_.fromScale,_.toScale],u_fade:_.t,u_pixel_coord_upper:[E>>16,D>>16],u_pixel_coord_lower:[65535&E,65535&D]}}const lr=(_,o,u,p)=>{const m=o.style.light,b=m.properties.get("position"),E=[b.x,b.y,b.z],D=(k=new g.ARRAY_TYPE(9),g.ARRAY_TYPE!=Float32Array&&(k[1]=0,k[2]=0,k[3]=0,k[5]=0,k[6]=0,k[7]=0),k[0]=1,k[4]=1,k[8]=1,k);var k;"viewport"===m.properties.get("anchor")&&function(k,R){var F=Math.sin(R),U=Math.cos(R);k[0]=U,k[1]=F,k[2]=0,k[3]=-F,k[4]=U,k[5]=0,k[6]=0,k[7]=0,k[8]=1}(D,-o.transform.angle),function(k,R,F){var U=R[0],X=R[1],W=R[2];k[0]=U*F[0]+X*F[3]+W*F[6],k[1]=U*F[1]+X*F[4]+W*F[7],k[2]=U*F[2]+X*F[5]+W*F[8]}(E,E,D);const M=m.properties.get("color");return{u_matrix:_,u_lightpos:E,u_lightintensity:m.properties.get("intensity"),u_lightcolor:[M.r,M.g,M.b],u_vertical_gradient:+u,u_opacity:p}},Cp=(_,o,u,p,m,b,E)=>g.extend(lr(_,o,u,p),nl(b,o,E),{u_height_factor:-Math.pow(2,m.overscaledZ)/E.tileSize/8}),Vd=_=>({u_matrix:_}),an=(_,o,u,p)=>g.extend(Vd(_),nl(u,o,p)),Ec=(_,o)=>({u_matrix:_,u_world:o}),vi=(_,o,u,p,m)=>g.extend(an(_,o,u,p),{u_world:m}),Au=(_,o,u,p)=>{const m=_.transform;let b,E;if("map"===p.paint.get("circle-pitch-alignment")){const D=ae(u,1,m.zoom);b=!0,E=[D,D]}else b=!1,E=m.pixelsToGLUnits;return{u_camera_to_center_distance:m.cameraToCenterDistance,u_scale_with_map:+("map"===p.paint.get("circle-pitch-scale")),u_matrix:_.translatePosMatrix(o.posMatrix,u,p.paint.get("circle-translate"),p.paint.get("circle-translate-anchor")),u_pitch_with_map:+b,u_device_pixel_ratio:_.pixelRatio,u_extrude_scale:E}},Ud=(_,o,u)=>{const p=ae(u,1,o.zoom),m=Math.pow(2,o.zoom-u.tileID.overscaledZ),b=u.tileID.overscaleFactor();return{u_matrix:_,u_camera_to_center_distance:o.cameraToCenterDistance,u_pixels_to_tile_units:p,u_extrude_scale:[o.pixelsToGLUnits[0]/(p*m),o.pixelsToGLUnits[1]/(p*m)],u_overscale_factor:b}},pn=(_,o,u=1)=>({u_matrix:_,u_color:o,u_overlay:0,u_overlay_scale:u}),It=_=>({u_matrix:_}),Dc=(_,o,u,p)=>({u_matrix:_,u_extrude_scale:ae(o,1,u),u_intensity:p});function Ic(_,o){const u=Math.pow(2,o.canonical.z),p=o.canonical.y;return[new g.MercatorCoordinate(0,p/u).toLngLat().lat,new g.MercatorCoordinate(0,(p+1)/u).toLngLat().lat]}const ku=(_,o,u,p)=>{const m=_.transform;return{u_matrix:Qt(_,o,u,p),u_ratio:1/ae(o,1,m.zoom),u_device_pixel_ratio:_.pixelRatio,u_units_to_pixels:[1/m.pixelsToGLUnits[0],1/m.pixelsToGLUnits[1]]}},Pu=(_,o,u,p,m)=>g.extend(ku(_,o,u,m),{u_image:0,u_image_height:p}),Pe=(_,o,u,p,m)=>{const b=_.transform,E=vt(o,b);return{u_matrix:Qt(_,o,u,m),u_texsize:o.imageAtlasTexture.size,u_ratio:1/ae(o,1,b.zoom),u_device_pixel_ratio:_.pixelRatio,u_image:0,u_scale:[E,p.fromScale,p.toScale],u_fade:p.t,u_units_to_pixels:[1/b.pixelsToGLUnits[0],1/b.pixelsToGLUnits[1]]}},da=(_,o,u,p,m,b)=>{const E=_.lineAtlas,D=vt(o,_.transform),M="round"===u.layout.get("line-cap"),k=E.getDash(p.from,M),R=E.getDash(p.to,M),F=k.width*m.fromScale,U=R.width*m.toScale;return g.extend(ku(_,o,u,b),{u_patternscale_a:[D/F,-k.height/2],u_patternscale_b:[D/U,-R.height/2],u_sdfgamma:E.width/(256*Math.min(F,U)*_.pixelRatio)/2,u_image:0,u_tex_y_a:k.y,u_tex_y_b:R.y,u_mix:m.t})};function vt(_,o){return 1/ae(_,1,o.tileZoom)}function Qt(_,o,u,p){return _.translatePosMatrix(p?p.posMatrix:o.tileID.posMatrix,o,u.paint.get("line-translate"),u.paint.get("line-translate-anchor"))}const Sc=(_,o,u,p,m)=>{return{u_matrix:_,u_tl_parent:o,u_scale_parent:u,u_buffer_scale:1,u_fade_t:p.mix,u_opacity:p.opacity*m.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:m.paint.get("raster-brightness-min"),u_brightness_high:m.paint.get("raster-brightness-max"),u_saturation_factor:(E=m.paint.get("raster-saturation"),E>0?1-1/(1.001-E):-E),u_contrast_factor:(b=m.paint.get("raster-contrast"),b>0?1/(1-b):1+b),u_spin_weights:Mc(m.paint.get("raster-hue-rotate"))};var b,E};function Mc(_){_*=Math.PI/180;const o=Math.sin(_),u=Math.cos(_);return[(2*u+1)/3,(-Math.sqrt(3)*o-u+1)/3,(Math.sqrt(3)*o-u+1)/3]}const Ll=(_,o,u,p,m,b,E,D,M,k)=>{const R=m.transform;return{u_is_size_zoom_constant:+("constant"===_||"source"===_),u_is_size_feature_constant:+("constant"===_||"camera"===_),u_size_t:o?o.uSizeT:0,u_size:o?o.uSize:0,u_camera_to_center_distance:R.cameraToCenterDistance,u_pitch:R.pitch/360*2*Math.PI,u_rotate_symbol:+u,u_aspect_ratio:R.width/R.height,u_fade_change:m.options.fadeDuration?m.symbolFadeChange:1,u_matrix:b,u_label_plane_matrix:E,u_coord_matrix:D,u_is_text:+M,u_pitch_with_map:+p,u_texsize:k,u_texture:0}},ha=(_,o,u,p,m,b,E,D,M,k,R)=>{const F=m.transform;return g.extend(Ll(_,o,u,p,m,b,E,D,M,k),{u_gamma_scale:p?Math.cos(F._pitch)*F.cameraToCenterDistance:1,u_device_pixel_ratio:m.pixelRatio,u_is_halo:+R})},Ji=(_,o,u,p,m,b,E,D,M,k)=>g.extend(ha(_,o,u,p,m,b,E,D,!0,M,!0),{u_texsize_icon:k,u_texture_icon:1}),il=(_,o,u)=>({u_matrix:_,u_opacity:o,u_color:u}),Tc=(_,o,u,p,m,b)=>g.extend(function(E,D,M,k){const R=M.imageManager.getPattern(E.from.toString()),F=M.imageManager.getPattern(E.to.toString()),{width:U,height:X}=M.imageManager.getPixelSize(),W=Math.pow(2,k.tileID.overscaledZ),J=k.tileSize*Math.pow(2,M.transform.tileZoom)/W,q=J*(k.tileID.canonical.x+k.tileID.wrap*W),le=J*k.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:R.tl,u_pattern_br_a:R.br,u_pattern_tl_b:F.tl,u_pattern_br_b:F.br,u_texsize:[U,X],u_mix:D.t,u_pattern_size_a:R.displaySize,u_pattern_size_b:F.displaySize,u_scale_a:D.fromScale,u_scale_b:D.toScale,u_tile_units_to_pixels:1/ae(k,1,M.transform.tileZoom),u_pixel_coord_upper:[q>>16,le>>16],u_pixel_coord_lower:[65535&q,65535&le]}}(p,b,u,m),{u_matrix:_,u_opacity:o}),ss={fillExtrusion:(_,o)=>({u_matrix:new g.UniformMatrix4f(_,o.u_matrix),u_lightpos:new g.Uniform3f(_,o.u_lightpos),u_lightintensity:new g.Uniform1f(_,o.u_lightintensity),u_lightcolor:new g.Uniform3f(_,o.u_lightcolor),u_vertical_gradient:new g.Uniform1f(_,o.u_vertical_gradient),u_opacity:new g.Uniform1f(_,o.u_opacity)}),fillExtrusionPattern:(_,o)=>({u_matrix:new g.UniformMatrix4f(_,o.u_matrix),u_lightpos:new g.Uniform3f(_,o.u_lightpos),u_lightintensity:new g.Uniform1f(_,o.u_lightintensity),u_lightcolor:new g.Uniform3f(_,o.u_lightcolor),u_vertical_gradient:new g.Uniform1f(_,o.u_vertical_gradient),u_height_factor:new g.Uniform1f(_,o.u_height_factor),u_image:new g.Uniform1i(_,o.u_image),u_texsize:new g.Uniform2f(_,o.u_texsize),u_pixel_coord_upper:new g.Uniform2f(_,o.u_pixel_coord_upper),u_pixel_coord_lower:new g.Uniform2f(_,o.u_pixel_coord_lower),u_scale:new g.Uniform3f(_,o.u_scale),u_fade:new g.Uniform1f(_,o.u_fade),u_opacity:new g.Uniform1f(_,o.u_opacity)}),fill:(_,o)=>({u_matrix:new g.UniformMatrix4f(_,o.u_matrix)}),fillPattern:(_,o)=>({u_matrix:new g.UniformMatrix4f(_,o.u_matrix),u_image:new g.Uniform1i(_,o.u_image),u_texsize:new g.Uniform2f(_,o.u_texsize),u_pixel_coord_upper:new g.Uniform2f(_,o.u_pixel_coord_upper),u_pixel_coord_lower:new g.Uniform2f(_,o.u_pixel_coord_lower),u_scale:new g.Uniform3f(_,o.u_scale),u_fade:new g.Uniform1f(_,o.u_fade)}),fillOutline:(_,o)=>({u_matrix:new g.UniformMatrix4f(_,o.u_matrix),u_world:new g.Uniform2f(_,o.u_world)}),fillOutlinePattern:(_,o)=>({u_matrix:new g.UniformMatrix4f(_,o.u_matrix),u_world:new g.Uniform2f(_,o.u_world),u_image:new g.Uniform1i(_,o.u_image),u_texsize:new g.Uniform2f(_,o.u_texsize),u_pixel_coord_upper:new g.Uniform2f(_,o.u_pixel_coord_upper),u_pixel_coord_lower:new g.Uniform2f(_,o.u_pixel_coord_lower),u_scale:new g.Uniform3f(_,o.u_scale),u_fade:new g.Uniform1f(_,o.u_fade)}),circle:(_,o)=>({u_camera_to_center_distance:new g.Uniform1f(_,o.u_camera_to_center_distance),u_scale_with_map:new g.Uniform1i(_,o.u_scale_with_map),u_pitch_with_map:new g.Uniform1i(_,o.u_pitch_with_map),u_extrude_scale:new g.Uniform2f(_,o.u_extrude_scale),u_device_pixel_ratio:new g.Uniform1f(_,o.u_device_pixel_ratio),u_matrix:new g.UniformMatrix4f(_,o.u_matrix)}),collisionBox:(_,o)=>({u_matrix:new g.UniformMatrix4f(_,o.u_matrix),u_camera_to_center_distance:new g.Uniform1f(_,o.u_camera_to_center_distance),u_pixels_to_tile_units:new g.Uniform1f(_,o.u_pixels_to_tile_units),u_extrude_scale:new g.Uniform2f(_,o.u_extrude_scale),u_overscale_factor:new g.Uniform1f(_,o.u_overscale_factor)}),collisionCircle:(_,o)=>({u_matrix:new g.UniformMatrix4f(_,o.u_matrix),u_inv_matrix:new g.UniformMatrix4f(_,o.u_inv_matrix),u_camera_to_center_distance:new g.Uniform1f(_,o.u_camera_to_center_distance),u_viewport_size:new g.Uniform2f(_,o.u_viewport_size)}),debug:(_,o)=>({u_color:new g.UniformColor(_,o.u_color),u_matrix:new g.UniformMatrix4f(_,o.u_matrix),u_overlay:new g.Uniform1i(_,o.u_overlay),u_overlay_scale:new g.Uniform1f(_,o.u_overlay_scale)}),clippingMask:(_,o)=>({u_matrix:new g.UniformMatrix4f(_,o.u_matrix)}),heatmap:(_,o)=>({u_extrude_scale:new g.Uniform1f(_,o.u_extrude_scale),u_intensity:new g.Uniform1f(_,o.u_intensity),u_matrix:new g.UniformMatrix4f(_,o.u_matrix)}),heatmapTexture:(_,o)=>({u_matrix:new g.UniformMatrix4f(_,o.u_matrix),u_world:new g.Uniform2f(_,o.u_world),u_image:new g.Uniform1i(_,o.u_image),u_color_ramp:new g.Uniform1i(_,o.u_color_ramp),u_opacity:new g.Uniform1f(_,o.u_opacity)}),hillshade:(_,o)=>({u_matrix:new g.UniformMatrix4f(_,o.u_matrix),u_image:new g.Uniform1i(_,o.u_image),u_latrange:new g.Uniform2f(_,o.u_latrange),u_light:new g.Uniform2f(_,o.u_light),u_shadow:new g.UniformColor(_,o.u_shadow),u_highlight:new g.UniformColor(_,o.u_highlight),u_accent:new g.UniformColor(_,o.u_accent)}),hillshadePrepare:(_,o)=>({u_matrix:new g.UniformMatrix4f(_,o.u_matrix),u_image:new g.Uniform1i(_,o.u_image),u_dimension:new g.Uniform2f(_,o.u_dimension),u_zoom:new g.Uniform1f(_,o.u_zoom),u_unpack:new g.Uniform4f(_,o.u_unpack)}),line:(_,o)=>({u_matrix:new g.UniformMatrix4f(_,o.u_matrix),u_ratio:new g.Uniform1f(_,o.u_ratio),u_device_pixel_ratio:new g.Uniform1f(_,o.u_device_pixel_ratio),u_units_to_pixels:new g.Uniform2f(_,o.u_units_to_pixels)}),lineGradient:(_,o)=>({u_matrix:new g.UniformMatrix4f(_,o.u_matrix),u_ratio:new g.Uniform1f(_,o.u_ratio),u_device_pixel_ratio:new g.Uniform1f(_,o.u_device_pixel_ratio),u_units_to_pixels:new g.Uniform2f(_,o.u_units_to_pixels),u_image:new g.Uniform1i(_,o.u_image),u_image_height:new g.Uniform1f(_,o.u_image_height)}),linePattern:(_,o)=>({u_matrix:new g.UniformMatrix4f(_,o.u_matrix),u_texsize:new g.Uniform2f(_,o.u_texsize),u_ratio:new g.Uniform1f(_,o.u_ratio),u_device_pixel_ratio:new g.Uniform1f(_,o.u_device_pixel_ratio),u_image:new g.Uniform1i(_,o.u_image),u_units_to_pixels:new g.Uniform2f(_,o.u_units_to_pixels),u_scale:new g.Uniform3f(_,o.u_scale),u_fade:new g.Uniform1f(_,o.u_fade)}),lineSDF:(_,o)=>({u_matrix:new g.UniformMatrix4f(_,o.u_matrix),u_ratio:new g.Uniform1f(_,o.u_ratio),u_device_pixel_ratio:new g.Uniform1f(_,o.u_device_pixel_ratio),u_units_to_pixels:new g.Uniform2f(_,o.u_units_to_pixels),u_patternscale_a:new g.Uniform2f(_,o.u_patternscale_a),u_patternscale_b:new g.Uniform2f(_,o.u_patternscale_b),u_sdfgamma:new g.Uniform1f(_,o.u_sdfgamma),u_image:new g.Uniform1i(_,o.u_image),u_tex_y_a:new g.Uniform1f(_,o.u_tex_y_a),u_tex_y_b:new g.Uniform1f(_,o.u_tex_y_b),u_mix:new g.Uniform1f(_,o.u_mix)}),raster:(_,o)=>({u_matrix:new g.UniformMatrix4f(_,o.u_matrix),u_tl_parent:new g.Uniform2f(_,o.u_tl_parent),u_scale_parent:new g.Uniform1f(_,o.u_scale_parent),u_buffer_scale:new g.Uniform1f(_,o.u_buffer_scale),u_fade_t:new g.Uniform1f(_,o.u_fade_t),u_opacity:new g.Uniform1f(_,o.u_opacity),u_image0:new g.Uniform1i(_,o.u_image0),u_image1:new g.Uniform1i(_,o.u_image1),u_brightness_low:new g.Uniform1f(_,o.u_brightness_low),u_brightness_high:new g.Uniform1f(_,o.u_brightness_high),u_saturation_factor:new g.Uniform1f(_,o.u_saturation_factor),u_contrast_factor:new g.Uniform1f(_,o.u_contrast_factor),u_spin_weights:new g.Uniform3f(_,o.u_spin_weights)}),symbolIcon:(_,o)=>({u_is_size_zoom_constant:new g.Uniform1i(_,o.u_is_size_zoom_constant),u_is_size_feature_constant:new g.Uniform1i(_,o.u_is_size_feature_constant),u_size_t:new g.Uniform1f(_,o.u_size_t),u_size:new g.Uniform1f(_,o.u_size),u_camera_to_center_distance:new g.Uniform1f(_,o.u_camera_to_center_distance),u_pitch:new g.Uniform1f(_,o.u_pitch),u_rotate_symbol:new g.Uniform1i(_,o.u_rotate_symbol),u_aspect_ratio:new g.Uniform1f(_,o.u_aspect_ratio),u_fade_change:new g.Uniform1f(_,o.u_fade_change),u_matrix:new g.UniformMatrix4f(_,o.u_matrix),u_label_plane_matrix:new g.UniformMatrix4f(_,o.u_label_plane_matrix),u_coord_matrix:new g.UniformMatrix4f(_,o.u_coord_matrix),u_is_text:new g.Uniform1i(_,o.u_is_text),u_pitch_with_map:new g.Uniform1i(_,o.u_pitch_with_map),u_texsize:new g.Uniform2f(_,o.u_texsize),u_texture:new g.Uniform1i(_,o.u_texture)}),symbolSDF:(_,o)=>({u_is_size_zoom_constant:new g.Uniform1i(_,o.u_is_size_zoom_constant),u_is_size_feature_constant:new g.Uniform1i(_,o.u_is_size_feature_constant),u_size_t:new g.Uniform1f(_,o.u_size_t),u_size:new g.Uniform1f(_,o.u_size),u_camera_to_center_distance:new g.Uniform1f(_,o.u_camera_to_center_distance),u_pitch:new g.Uniform1f(_,o.u_pitch),u_rotate_symbol:new g.Uniform1i(_,o.u_rotate_symbol),u_aspect_ratio:new g.Uniform1f(_,o.u_aspect_ratio),u_fade_change:new g.Uniform1f(_,o.u_fade_change),u_matrix:new g.UniformMatrix4f(_,o.u_matrix),u_label_plane_matrix:new g.UniformMatrix4f(_,o.u_label_plane_matrix),u_coord_matrix:new g.UniformMatrix4f(_,o.u_coord_matrix),u_is_text:new g.Uniform1i(_,o.u_is_text),u_pitch_with_map:new g.Uniform1i(_,o.u_pitch_with_map),u_texsize:new g.Uniform2f(_,o.u_texsize),u_texture:new g.Uniform1i(_,o.u_texture),u_gamma_scale:new g.Uniform1f(_,o.u_gamma_scale),u_device_pixel_ratio:new g.Uniform1f(_,o.u_device_pixel_ratio),u_is_halo:new g.Uniform1i(_,o.u_is_halo)}),symbolTextAndIcon:(_,o)=>({u_is_size_zoom_constant:new g.Uniform1i(_,o.u_is_size_zoom_constant),u_is_size_feature_constant:new g.Uniform1i(_,o.u_is_size_feature_constant),u_size_t:new g.Uniform1f(_,o.u_size_t),u_size:new g.Uniform1f(_,o.u_size),u_camera_to_center_distance:new g.Uniform1f(_,o.u_camera_to_center_distance),u_pitch:new g.Uniform1f(_,o.u_pitch),u_rotate_symbol:new g.Uniform1i(_,o.u_rotate_symbol),u_aspect_ratio:new g.Uniform1f(_,o.u_aspect_ratio),u_fade_change:new g.Uniform1f(_,o.u_fade_change),u_matrix:new g.UniformMatrix4f(_,o.u_matrix),u_label_plane_matrix:new g.UniformMatrix4f(_,o.u_label_plane_matrix),u_coord_matrix:new g.UniformMatrix4f(_,o.u_coord_matrix),u_is_text:new g.Uniform1i(_,o.u_is_text),u_pitch_with_map:new g.Uniform1i(_,o.u_pitch_with_map),u_texsize:new g.Uniform2f(_,o.u_texsize),u_texsize_icon:new g.Uniform2f(_,o.u_texsize_icon),u_texture:new g.Uniform1i(_,o.u_texture),u_texture_icon:new g.Uniform1i(_,o.u_texture_icon),u_gamma_scale:new g.Uniform1f(_,o.u_gamma_scale),u_device_pixel_ratio:new g.Uniform1f(_,o.u_device_pixel_ratio),u_is_halo:new g.Uniform1i(_,o.u_is_halo)}),background:(_,o)=>({u_matrix:new g.UniformMatrix4f(_,o.u_matrix),u_opacity:new g.Uniform1f(_,o.u_opacity),u_color:new g.UniformColor(_,o.u_color)}),backgroundPattern:(_,o)=>({u_matrix:new g.UniformMatrix4f(_,o.u_matrix),u_opacity:new g.Uniform1f(_,o.u_opacity),u_image:new g.Uniform1i(_,o.u_image),u_pattern_tl_a:new g.Uniform2f(_,o.u_pattern_tl_a),u_pattern_br_a:new g.Uniform2f(_,o.u_pattern_br_a),u_pattern_tl_b:new g.Uniform2f(_,o.u_pattern_tl_b),u_pattern_br_b:new g.Uniform2f(_,o.u_pattern_br_b),u_texsize:new g.Uniform2f(_,o.u_texsize),u_mix:new g.Uniform1f(_,o.u_mix),u_pattern_size_a:new g.Uniform2f(_,o.u_pattern_size_a),u_pattern_size_b:new g.Uniform2f(_,o.u_pattern_size_b),u_scale_a:new g.Uniform1f(_,o.u_scale_a),u_scale_b:new g.Uniform1f(_,o.u_scale_b),u_pixel_coord_upper:new g.Uniform2f(_,o.u_pixel_coord_upper),u_pixel_coord_lower:new g.Uniform2f(_,o.u_pixel_coord_lower),u_tile_units_to_pixels:new g.Uniform1f(_,o.u_tile_units_to_pixels)}),terrain:(_,o)=>({u_matrix:new g.UniformMatrix4f(_,o.u_matrix),u_texture:new g.Uniform1i(_,o.u_texture),u_ele_delta:new g.Uniform1f(_,o.u_ele_delta)}),terrainDepth:(_,o)=>({u_matrix:new g.UniformMatrix4f(_,o.u_matrix),u_ele_delta:new g.Uniform1f(_,o.u_ele_delta)}),terrainCoords:(_,o)=>({u_matrix:new g.UniformMatrix4f(_,o.u_matrix),u_texture:new g.Uniform1i(_,o.u_texture),u_terrain_coords_id:new g.Uniform1f(_,o.u_terrain_coords_id),u_ele_delta:new g.Uniform1f(_,o.u_ele_delta)})};class Si{constructor(o,u,p){this.context=o;const m=o.gl;this.buffer=m.createBuffer(),this.dynamicDraw=!!p,this.context.unbindVAO(),o.bindElementBuffer.set(this.buffer),m.bufferData(m.ELEMENT_ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?m.DYNAMIC_DRAW:m.STATIC_DRAW),this.dynamicDraw||delete u.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(o){const u=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),u.bufferSubData(u.ELEMENT_ARRAY_BUFFER,0,o.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const jd={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Ru{constructor(o,u,p,m){this.length=u.length,this.attributes=p,this.itemSize=u.bytesPerElement,this.dynamicDraw=m,this.context=o;const b=o.gl;this.buffer=b.createBuffer(),o.bindVertexBuffer.set(this.buffer),b.bufferData(b.ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?b.DYNAMIC_DRAW:b.STATIC_DRAW),this.dynamicDraw||delete u.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(o){if(o.length!==this.length)throw new Error(`Length of new data is ${o.length}, which doesn't match current length of ${this.length}`);const u=this.context.gl;this.bind(),u.bufferSubData(u.ARRAY_BUFFER,0,o.arrayBuffer)}enableAttributes(o,u){for(let p=0;p<this.attributes.length;p++){const m=u.attributes[this.attributes[p].name];void 0!==m&&o.enableVertexAttribArray(m)}}setVertexAttribPointers(o,u,p){for(let m=0;m<this.attributes.length;m++){const b=this.attributes[m],E=u.attributes[b.name];void 0!==E&&o.vertexAttribPointer(E,b.components,o[jd[b.type]],!1,this.itemSize,b.offset+this.itemSize*(p||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Nl=new WeakMap;function zl(_){if(Nl.has(_))return Nl.get(_);{const o=_.getParameter(_.VERSION).startsWith("WebGL 2.0");return Nl.set(_,o),o}}class en{constructor(o){this.gl=o.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(o){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Ou extends en{getDefault(){return g.Color.transparent}set(o){const u=this.current;(o.r!==u.r||o.g!==u.g||o.b!==u.b||o.a!==u.a||this.dirty)&&(this.gl.clearColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class Fu extends en{getDefault(){return 1}set(o){(o!==this.current||this.dirty)&&(this.gl.clearDepth(o),this.current=o,this.dirty=!1)}}class $d extends en{getDefault(){return 0}set(o){(o!==this.current||this.dirty)&&(this.gl.clearStencil(o),this.current=o,this.dirty=!1)}}class yr extends en{getDefault(){return[!0,!0,!0,!0]}set(o){const u=this.current;(o[0]!==u[0]||o[1]!==u[1]||o[2]!==u[2]||o[3]!==u[3]||this.dirty)&&(this.gl.colorMask(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class Mt extends en{getDefault(){return!0}set(o){(o!==this.current||this.dirty)&&(this.gl.depthMask(o),this.current=o,this.dirty=!1)}}class Ep extends en{getDefault(){return 255}set(o){(o!==this.current||this.dirty)&&(this.gl.stencilMask(o),this.current=o,this.dirty=!1)}}class Bl extends en{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(o){const u=this.current;(o.func!==u.func||o.ref!==u.ref||o.mask!==u.mask||this.dirty)&&(this.gl.stencilFunc(o.func,o.ref,o.mask),this.current=o,this.dirty=!1)}}class Rm extends en{getDefault(){const o=this.gl;return[o.KEEP,o.KEEP,o.KEEP]}set(o){const u=this.current;(o[0]!==u[0]||o[1]!==u[1]||o[2]!==u[2]||this.dirty)&&(this.gl.stencilOp(o[0],o[1],o[2]),this.current=o,this.dirty=!1)}}class ct extends en{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;o?u.enable(u.STENCIL_TEST):u.disable(u.STENCIL_TEST),this.current=o,this.dirty=!1}}class Om extends en{getDefault(){return[0,1]}set(o){const u=this.current;(o[0]!==u[0]||o[1]!==u[1]||this.dirty)&&(this.gl.depthRange(o[0],o[1]),this.current=o,this.dirty=!1)}}class Fi extends en{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;o?u.enable(u.DEPTH_TEST):u.disable(u.DEPTH_TEST),this.current=o,this.dirty=!1}}class Ac extends en{getDefault(){return this.gl.LESS}set(o){(o!==this.current||this.dirty)&&(this.gl.depthFunc(o),this.current=o,this.dirty=!1)}}class Dp extends en{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;o?u.enable(u.BLEND):u.disable(u.BLEND),this.current=o,this.dirty=!1}}class kc extends en{getDefault(){const o=this.gl;return[o.ONE,o.ZERO]}set(o){const u=this.current;(o[0]!==u[0]||o[1]!==u[1]||this.dirty)&&(this.gl.blendFunc(o[0],o[1]),this.current=o,this.dirty=!1)}}class Pc extends en{getDefault(){return g.Color.transparent}set(o){const u=this.current;(o.r!==u.r||o.g!==u.g||o.b!==u.b||o.a!==u.a||this.dirty)&&(this.gl.blendColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class rl extends en{getDefault(){return this.gl.FUNC_ADD}set(o){(o!==this.current||this.dirty)&&(this.gl.blendEquation(o),this.current=o,this.dirty=!1)}}class sl extends en{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;o?u.enable(u.CULL_FACE):u.disable(u.CULL_FACE),this.current=o,this.dirty=!1}}class Bo extends en{getDefault(){return this.gl.BACK}set(o){(o!==this.current||this.dirty)&&(this.gl.cullFace(o),this.current=o,this.dirty=!1)}}class Lu extends en{getDefault(){return this.gl.CCW}set(o){(o!==this.current||this.dirty)&&(this.gl.frontFace(o),this.current=o,this.dirty=!1)}}class Hd extends en{getDefault(){return null}set(o){(o!==this.current||this.dirty)&&(this.gl.useProgram(o),this.current=o,this.dirty=!1)}}class Ut extends en{getDefault(){return this.gl.TEXTURE0}set(o){(o!==this.current||this.dirty)&&(this.gl.activeTexture(o),this.current=o,this.dirty=!1)}}class uo extends en{getDefault(){const o=this.gl;return[0,0,o.drawingBufferWidth,o.drawingBufferHeight]}set(o){const u=this.current;(o[0]!==u[0]||o[1]!==u[1]||o[2]!==u[2]||o[3]!==u[3]||this.dirty)&&(this.gl.viewport(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class Nu extends en{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;u.bindFramebuffer(u.FRAMEBUFFER,o),this.current=o,this.dirty=!1}}class Mi extends en{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;u.bindRenderbuffer(u.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class pa extends en{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;u.bindTexture(u.TEXTURE_2D,o),this.current=o,this.dirty=!1}}class Ip extends en{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;u.bindBuffer(u.ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class Dn extends en{getDefault(){return null}set(o){const u=this.gl;u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class cn extends en{getDefault(){return null}set(o){var u;if(o===this.current&&!this.dirty)return;const p=this.gl;zl(p)?p.bindVertexArray(o):null===(u=p.getExtension("OES_vertex_array_object"))||void 0===u||u.bindVertexArrayOES(o),this.current=o,this.dirty=!1}}class zu extends en{getDefault(){return 4}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_ALIGNMENT,o),this.current=o,this.dirty=!1}}class Bu extends en{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o),this.current=o,this.dirty=!1}}class Rc extends en{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_FLIP_Y_WEBGL,o),this.current=o,this.dirty=!1}}class Vo extends en{constructor(o,u){super(o),this.context=o,this.parent=u}getDefault(){return null}}class Vu extends Vo{setDirty(){this.dirty=!0}set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,o,0),this.current=o,this.dirty=!1}}class Sp extends Vo{set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferRenderbuffer(u.FRAMEBUFFER,u.DEPTH_ATTACHMENT,u.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class Oc extends Vo{set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferRenderbuffer(u.FRAMEBUFFER,u.DEPTH_STENCIL_ATTACHMENT,u.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class Fm{constructor(o,u,p,m,b){this.context=o,this.width=u,this.height=p;const E=o.gl,D=this.framebuffer=E.createFramebuffer();if(this.colorAttachment=new Vu(o,D),m)this.depthAttachment=b?new Oc(o,D):new Sp(o,D);else if(b)throw new Error("Stencil cannot be setted without depth");if(E.checkFramebufferStatus(E.FRAMEBUFFER)!==E.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const o=this.context.gl,u=this.colorAttachment.get();if(u&&o.deleteTexture(u),this.depthAttachment){const p=this.depthAttachment.get();p&&o.deleteRenderbuffer(p)}o.deleteFramebuffer(this.framebuffer)}}class ri{constructor(o,u,p){this.blendFunction=o,this.blendColor=u,this.mask=p}}ri.Replace=[1,0],ri.disabled=new ri(ri.Replace,g.Color.transparent,[!1,!1,!1,!1]),ri.unblended=new ri(ri.Replace,g.Color.transparent,[!0,!0,!0,!0]),ri.alphaBlended=new ri([1,771],g.Color.transparent,[!0,!0,!0,!0]);class Uu{constructor(o){var u,p;if(this.gl=o,this.clearColor=new Ou(this),this.clearDepth=new Fu(this),this.clearStencil=new $d(this),this.colorMask=new yr(this),this.depthMask=new Mt(this),this.stencilMask=new Ep(this),this.stencilFunc=new Bl(this),this.stencilOp=new Rm(this),this.stencilTest=new ct(this),this.depthRange=new Om(this),this.depthTest=new Fi(this),this.depthFunc=new Ac(this),this.blend=new Dp(this),this.blendFunc=new kc(this),this.blendColor=new Pc(this),this.blendEquation=new rl(this),this.cullFace=new sl(this),this.cullFaceSide=new Bo(this),this.frontFace=new Lu(this),this.program=new Hd(this),this.activeTexture=new Ut(this),this.viewport=new uo(this),this.bindFramebuffer=new Nu(this),this.bindRenderbuffer=new Mi(this),this.bindTexture=new pa(this),this.bindVertexBuffer=new Ip(this),this.bindElementBuffer=new Dn(this),this.bindVertexArray=new cn(this),this.pixelStoreUnpack=new zu(this),this.pixelStoreUnpackPremultiplyAlpha=new Bu(this),this.pixelStoreUnpackFlipY=new Rc(this),this.extTextureFilterAnisotropic=o.getExtension("EXT_texture_filter_anisotropic")||o.getExtension("MOZ_EXT_texture_filter_anisotropic")||o.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=o.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=o.getParameter(o.MAX_TEXTURE_SIZE),zl(o)){this.HALF_FLOAT=o.HALF_FLOAT;const m=o.getExtension("EXT_color_buffer_half_float");this.RGBA16F=null!==(u=o.RGBA16F)&&void 0!==u?u:m?.RGBA16F_EXT,this.RGB16F=null!==(p=o.RGB16F)&&void 0!==p?p:m?.RGB16F_EXT,o.getExtension("EXT_color_buffer_float")}else{o.getExtension("EXT_color_buffer_half_float"),o.getExtension("OES_texture_half_float_linear");const m=o.getExtension("OES_texture_half_float");this.HALF_FLOAT=m?.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(o,u){return new Si(this,o,u)}createVertexBuffer(o,u,p){return new Ru(this,o,u,p)}createRenderbuffer(o,u,p){const m=this.gl,b=m.createRenderbuffer();return this.bindRenderbuffer.set(b),m.renderbufferStorage(m.RENDERBUFFER,o,u,p),this.bindRenderbuffer.set(null),b}createFramebuffer(o,u,p,m){return new Fm(this,o,u,p,m)}clear({color:o,depth:u,stencil:p}){const m=this.gl;let b=0;o&&(b|=m.COLOR_BUFFER_BIT,this.clearColor.set(o),this.colorMask.set([!0,!0,!0,!0])),void 0!==u&&(b|=m.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(u),this.depthMask.set(!0)),void 0!==p&&(b|=m.STENCIL_BUFFER_BIT,this.clearStencil.set(p),this.stencilMask.set(255)),m.clear(b)}setCullFace(o){!1===o.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(o.mode),this.frontFace.set(o.frontFace))}setDepthMode(o){o.func!==this.gl.ALWAYS||o.mask?(this.depthTest.set(!0),this.depthFunc.set(o.func),this.depthMask.set(o.mask),this.depthRange.set(o.range)):this.depthTest.set(!1)}setStencilMode(o){o.test.func!==this.gl.ALWAYS||o.mask?(this.stencilTest.set(!0),this.stencilMask.set(o.mask),this.stencilOp.set([o.fail,o.depthFail,o.pass]),this.stencilFunc.set({func:o.test.func,ref:o.ref,mask:o.test.mask})):this.stencilTest.set(!1)}setColorMode(o){g.deepEqual(o.blendFunction,ri.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(o.blendFunction),this.blendColor.set(o.blendColor)),this.colorMask.set(o.mask)}createVertexArray(){var o;return zl(this.gl)?this.gl.createVertexArray():null===(o=this.gl.getExtension("OES_vertex_array_object"))||void 0===o?void 0:o.createVertexArrayOES()}deleteVertexArray(o){var u;return zl(this.gl)?this.gl.deleteVertexArray(o):null===(u=this.gl.getExtension("OES_vertex_array_object"))||void 0===u?void 0:u.deleteVertexArrayOES(o)}unbindVAO(){this.bindVertexArray.set(null)}}class jt{constructor(o,u,p){this.func=o,this.mask=u,this.range=p}}jt.ReadOnly=!1,jt.ReadWrite=!0,jt.disabled=new jt(519,jt.ReadOnly,[0,1]);class fn{constructor(o,u,p,m,b,E){this.test=o,this.ref=u,this.mask=p,this.fail=m,this.depthFail=b,this.pass=E}}fn.disabled=new fn({func:519,mask:0},0,0,7680,7680,7680);class In{constructor(o,u,p){this.enable=o,this.mode=u,this.frontFace=p}}let Hs;function Vl(_,o,u,p,m,b,E){const D=_.context,M=D.gl,k=_.useProgram("collisionBox"),R=[];let F=0,U=0;for(let te=0;te<p.length;te++){const ce=p[te],ye=o.getTile(ce),ve=ye.getBucket(u);if(!ve)continue;let Se=ce.posMatrix;0===m[0]&&0===m[1]||(Se=_.translatePosMatrix(ce.posMatrix,ye,m,b));const ke=E?ve.textCollisionBox:ve.iconCollisionBox,De=ve.collisionCircleArray;if(De.length>0){const Le=g.create(),We=Se;g.mul(Le,ve.placementInvProjMatrix,_.transform.glCoordMatrix),g.mul(Le,Le,ve.placementViewportMatrix),R.push({circleArray:De,circleOffset:U,transform:We,invTransform:Le,coord:ce}),F+=De.length/4,U=F}ke&&k.draw(D,M.LINES,jt.disabled,fn.disabled,_.colorModeForRenderPass(),In.disabled,Ud(Se,_.transform,ye),_.style.map.terrain&&_.style.map.terrain.getTerrainData(ce),u.id,ke.layoutVertexBuffer,ke.indexBuffer,ke.segments,null,_.transform.zoom,null,null,ke.collisionVertexBuffer)}if(!E||!R.length)return;const X=_.useProgram("collisionCircle"),W=new g.CollisionCircleLayoutArray;W.resize(4*F),W._trim();let J=0;for(const te of R)for(let ce=0;ce<te.circleArray.length/4;ce++){const ye=4*ce,ve=te.circleArray[ye+0],Se=te.circleArray[ye+1],ke=te.circleArray[ye+2],De=te.circleArray[ye+3];W.emplace(J++,ve,Se,ke,De,0),W.emplace(J++,ve,Se,ke,De,1),W.emplace(J++,ve,Se,ke,De,2),W.emplace(J++,ve,Se,ke,De,3)}(!Hs||Hs.length<2*F)&&(Hs=function(te){const ce=2*te,ye=new g.QuadTriangleArray;ye.resize(ce),ye._trim();for(let ve=0;ve<ce;ve++){const Se=6*ve;ye.uint16[Se+0]=4*ve+0,ye.uint16[Se+1]=4*ve+1,ye.uint16[Se+2]=4*ve+2,ye.uint16[Se+3]=4*ve+2,ye.uint16[Se+4]=4*ve+3,ye.uint16[Se+5]=4*ve+0}return ye}(F));const q=D.createIndexBuffer(Hs,!0),le=D.createVertexBuffer(W,g.collisionCircleLayout.members,!0);for(const te of R){const ce={u_matrix:te.transform,u_inv_matrix:te.invTransform,u_camera_to_center_distance:(me=_.transform).cameraToCenterDistance,u_viewport_size:[me.width,me.height]};X.draw(D,M.TRIANGLES,jt.disabled,fn.disabled,_.colorModeForRenderPass(),In.disabled,ce,_.style.map.terrain&&_.style.map.terrain.getTerrainData(te.coord),u.id,le,q,g.SegmentVector.simpleSegment(0,2*te.circleOffset,te.circleArray.length,te.circleArray.length/2),null,_.transform.zoom,null,null,null)}var me;le.destroy(),q.destroy()}In.disabled=new In(!1,1029,2305),In.backCCW=new In(!0,1029,2305);const ju=g.identity(new Float32Array(16));function Mp(_,o,u,p,m,b){const{horizontalAlign:E,verticalAlign:D}=g.getAnchorAlignment(_);return new g.Point((-(E-.5)*o/m+p[0])*b,(-(D-.5)*u/m+p[1])*b)}function Lc(_,o,u,p,m,b,E,D,M,k,R){const F=_.text.placedSymbolArray,U=_.text.dynamicLayoutVertexArray,X=_.icon.dynamicLayoutVertexArray,W={};U.clear();for(let J=0;J<F.length;J++){const q=F.get(J),le=q.hidden||!q.crossTileID||_.allowVerticalPlacement&&!q.placedOrientation?null:p[q.crossTileID];if(le){const me=new g.Point(q.anchorX,q.anchorY),te=bt(me,u?E:b,R),ce=Vs(m.cameraToCenterDistance,te.signedDistanceFromCamera);let ye=g.evaluateSizeForFeature(_.textSizeData,M,q)*ce/g.ONE_EM;u&&(ye*=_.tilePixelRatio/D);const{width:ve,height:Se,anchor:ke,textOffset:De,textBoxScale:Le}=le,We=Mp(ke,ve,Se,De,Le,ye),zt=u?bt(me.add(We),b,R).point:te.point.add(o?We.rotate(-m.angle):We),Ue=_.allowVerticalPlacement&&q.placedOrientation===g.WritingMode.vertical?Math.PI/2:0;for(let dt=0;dt<q.numGlyphs;dt++)g.addDynamicAttributes(U,zt,Ue);k&&q.associatedIconIndex>=0&&(W[q.associatedIconIndex]={shiftedAnchor:zt,angle:Ue})}else H(q.numGlyphs,U)}if(k){X.clear();const J=_.icon.placedSymbolArray;for(let q=0;q<J.length;q++){const le=J.get(q);if(le.hidden)H(le.numGlyphs,X);else{const me=W[q];if(me)for(let te=0;te<le.numGlyphs;te++)g.addDynamicAttributes(X,me.shiftedAnchor,me.angle);else H(le.numGlyphs,X)}}_.icon.dynamicLayoutVertexBuffer.updateData(X)}_.text.dynamicLayoutVertexBuffer.updateData(U)}function ol(_,o,u){return u.iconsInText&&o?"symbolTextAndIcon":_?"symbolSDF":"symbolIcon"}function $u(_,o,u,p,m,b,E,D,M,k,R,F){const U=_.context,X=U.gl,W=_.transform,J="map"===D,q="map"===M,le="viewport"!==D&&"point"!==u.layout.get("symbol-placement"),me=J&&!q&&!le,te=!u.layout.get("symbol-sort-key").isConstant();let ce=!1;const ye=_.depthModeForSublayer(0,jt.ReadOnly),ve=u._unevaluatedLayout.hasValue("text-variable-anchor")||u._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Se=[];for(const ke of p){const De=o.getTile(ke),Le=De.getBucket(u);if(!Le)continue;const We=m?Le.text:Le.icon;if(!We||!We.segments.get().length||!We.hasVisibleVertices)continue;const zt=We.programConfigurations.get(u.id),Ue=m||Le.sdfIcons,dt=m?Le.textSizeData:Le.iconSizeData,rt=q||0!==W.pitch,Pn=_.useProgram(ol(Ue,m,Le),zt),Bt=g.evaluateSizeForZoom(dt,W.zoom),ht=_.style.map.terrain&&_.style.map.terrain.getTerrainData(ke);let Lt,jn,un,Fr,xi=[0,0],zn=null;if(m)jn=De.glyphAtlasTexture,un=X.LINEAR,Lt=De.glyphAtlasTexture.size,Le.iconsInText&&(xi=De.imageAtlasTexture.size,zn=De.imageAtlasTexture,Fr=rt||_.options.rotating||_.options.zooming||"composite"===dt.kind||"camera"===dt.kind?X.LINEAR:X.NEAREST);else{const mi=1!==u.layout.get("icon-size").constantOr(0)||Le.iconsNeedLinear;jn=De.imageAtlasTexture,un=Ue||_.options.rotating||_.options.zooming||mi||rt?X.LINEAR:X.NEAREST,Lt=De.imageAtlasTexture.size}const Ai=ae(De,1,_.transform.zoom),Es=Wi(ke.posMatrix,q,J,_.transform,Ai),Ws=lo(ke.posMatrix,q,J,_.transform,Ai),go=ve&&Le.hasTextData(),Kl="none"!==u.layout.get("icon-text-fit")&&go&&Le.hasIconData();if(le){const mi=_.style.map.terrain?(xr,Wn)=>_.style.map.terrain.getElevation(ke,xr,Wn):null,ki="map"===u.layout.get("text-rotation-alignment");Lo(Le,ke.posMatrix,_,m,Es,Ws,q,k,ki,mi)}const qo=_.translatePosMatrix(ke.posMatrix,De,b,E),_o=le||m&&ve||Kl?ju:Es,wi=_.translatePosMatrix(Ws,De,b,E,!0),Ci=Ue&&0!==u.paint.get(m?"text-halo-width":"icon-halo-width").constantOr(1);let Bi;Bi=Ue?Le.iconsInText?Ji(dt.kind,Bt,me,q,_,qo,_o,wi,Lt,xi):ha(dt.kind,Bt,me,q,_,qo,_o,wi,m,Lt,!0):Ll(dt.kind,Bt,me,q,_,qo,_o,wi,m,Lt);const _l={program:Pn,buffers:We,uniformValues:Bi,atlasTexture:jn,atlasTextureIcon:zn,atlasInterpolation:un,atlasInterpolationIcon:Fr,isSDF:Ue,hasHalo:Ci};if(te&&Le.canOverlap){ce=!0;const mi=We.segments.get();for(const ki of mi)Se.push({segments:new g.SegmentVector([ki]),sortKey:ki.sortKey,state:_l,terrainData:ht})}else Se.push({segments:We.segments,sortKey:0,state:_l,terrainData:ht})}ce&&Se.sort((ke,De)=>ke.sortKey-De.sortKey);for(const ke of Se){const De=ke.state;if(U.activeTexture.set(X.TEXTURE0),De.atlasTexture.bind(De.atlasInterpolation,X.CLAMP_TO_EDGE),De.atlasTextureIcon&&(U.activeTexture.set(X.TEXTURE1),De.atlasTextureIcon&&De.atlasTextureIcon.bind(De.atlasInterpolationIcon,X.CLAMP_TO_EDGE)),De.isSDF){const Le=De.uniformValues;De.hasHalo&&(Le.u_is_halo=1,os(De.buffers,ke.segments,u,_,De.program,ye,R,F,Le,ke.terrainData)),Le.u_is_halo=0}os(De.buffers,ke.segments,u,_,De.program,ye,R,F,De.uniformValues,ke.terrainData)}}function os(_,o,u,p,m,b,E,D,M,k){const R=p.context;m.draw(R,R.gl.TRIANGLES,b,E,D,In.disabled,M,k,u.id,_.layoutVertexBuffer,_.indexBuffer,o,u.paint,p.transform.zoom,_.programConfigurations.get(u.id),_.dynamicLayoutVertexBuffer,_.opacityVertexBuffer)}function Nc(_,o,u,p,m){if(!u||!p||!p.imageAtlas)return;const b=p.imageAtlas.patternPositions;let E=b[u.to.toString()],D=b[u.from.toString()];if(!E||!D){const M=m.getPaintProperty(o);E=b[M],D=b[M]}E&&D&&_.setConstantPatternPositions(E,D)}function nt(_,o,u,p,m,b,E){const D=_.context.gl,M="fill-pattern",k=u.paint.get(M),R=k&&k.constantOr(1),F=u.getCrossfadeParameters();let U,X,W,J,q;E?(X=R&&!u.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",U=D.LINES):(X=R?"fillPattern":"fill",U=D.TRIANGLES);const le=k.constantOr(null);for(const me of p){const te=o.getTile(me);if(R&&!te.patternsLoaded())continue;const ce=te.getBucket(u);if(!ce)continue;const ye=ce.programConfigurations.get(u.id),ve=_.useProgram(X,ye),Se=_.style.map.terrain&&_.style.map.terrain.getTerrainData(me);R&&(_.context.activeTexture.set(D.TEXTURE0),te.imageAtlasTexture.bind(D.LINEAR,D.CLAMP_TO_EDGE),ye.updatePaintBuffers(F)),Nc(ye,M,le,te,u);const ke=Se?me:null,De=_.translatePosMatrix(ke?ke.posMatrix:me.posMatrix,te,u.paint.get("fill-translate"),u.paint.get("fill-translate-anchor"));if(E){J=ce.indexBuffer2,q=ce.segments2;const Le=[D.drawingBufferWidth,D.drawingBufferHeight];W="fillOutlinePattern"===X&&R?vi(De,_,F,te,Le):Ec(De,Le)}else J=ce.indexBuffer,q=ce.segments,W=R?an(De,_,F,te):Vd(De);ve.draw(_.context,U,m,_.stencilModeForClipping(me),b,In.disabled,W,Se,u.id,ce.layoutVertexBuffer,J,q,u.paint,_.transform.zoom,ye)}}function Ul(_,o,u,p,m,b,E){const D=_.context,M=D.gl,k="fill-extrusion-pattern",R=u.paint.get(k),F=R.constantOr(1),U=u.getCrossfadeParameters(),X=u.paint.get("fill-extrusion-opacity"),W=R.constantOr(null);for(const J of p){const q=o.getTile(J),le=q.getBucket(u);if(!le)continue;const me=_.style.map.terrain&&_.style.map.terrain.getTerrainData(J),te=le.programConfigurations.get(u.id),ce=_.useProgram(F?"fillExtrusionPattern":"fillExtrusion",te);F&&(_.context.activeTexture.set(M.TEXTURE0),q.imageAtlasTexture.bind(M.LINEAR,M.CLAMP_TO_EDGE),te.updatePaintBuffers(U)),Nc(te,k,W,q,u);const ye=_.translatePosMatrix(J.posMatrix,q,u.paint.get("fill-extrusion-translate"),u.paint.get("fill-extrusion-translate-anchor")),ve=u.paint.get("fill-extrusion-vertical-gradient"),Se=F?Cp(ye,_,ve,X,J,U,q):lr(ye,_,ve,X);ce.draw(D,D.gl.TRIANGLES,m,b,E,In.backCCW,Se,me,u.id,le.layoutVertexBuffer,le.indexBuffer,le.segments,u.paint,_.transform.zoom,te,_.style.map.terrain&&le.centroidVertexBuffer)}}function Ke(_,o,u,p,m,b,E){const D=_.context,M=D.gl,k=u.fbo;if(!k)return;const R=_.useProgram("hillshade"),F=_.style.map.terrain&&_.style.map.terrain.getTerrainData(o);D.activeTexture.set(M.TEXTURE0),M.bindTexture(M.TEXTURE_2D,k.colorAttachment.get()),R.draw(D,M.TRIANGLES,m,b,E,In.disabled,((U,X,W,J)=>{const q=W.paint.get("hillshade-shadow-color"),le=W.paint.get("hillshade-highlight-color"),me=W.paint.get("hillshade-accent-color");let te=W.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===W.paint.get("hillshade-illumination-anchor")&&(te-=U.transform.angle);const ce=!U.options.moving;return{u_matrix:J?J.posMatrix:U.transform.calculatePosMatrix(X.tileID.toUnwrapped(),ce),u_image:0,u_latrange:Ic(0,X.tileID),u_light:[W.paint.get("hillshade-exaggeration"),te],u_shadow:q,u_highlight:le,u_accent:me}})(_,u,p,F?o:null),F,p.id,_.rasterBoundsBuffer,_.quadTriangleIndexBuffer,_.rasterBoundsSegments)}function al(_,o,u,p,m,b){const E=_.context,D=E.gl,M=o.dem;if(M&&M.data){const k=M.dim,R=M.stride,F=M.getPixels();if(E.activeTexture.set(D.TEXTURE1),E.pixelStoreUnpackPremultiplyAlpha.set(!1),o.demTexture=o.demTexture||_.getTileTexture(R),o.demTexture){const X=o.demTexture;X.update(F,{premultiply:!1}),X.bind(D.NEAREST,D.CLAMP_TO_EDGE)}else o.demTexture=new gn(E,F,D.RGBA,{premultiply:!1}),o.demTexture.bind(D.NEAREST,D.CLAMP_TO_EDGE);E.activeTexture.set(D.TEXTURE0);let U=o.fbo;if(!U){const X=new gn(E,{width:k,height:k,data:null},D.RGBA);X.bind(D.LINEAR,D.CLAMP_TO_EDGE),U=o.fbo=E.createFramebuffer(k,k,!0,!1),U.colorAttachment.set(X.texture)}E.bindFramebuffer.set(U.framebuffer),E.viewport.set([0,0,k,k]),_.useProgram("hillshadePrepare").draw(E,D.TRIANGLES,p,m,b,In.disabled,((X,W)=>{const J=W.stride,q=g.create();return g.ortho(q,0,g.EXTENT,-g.EXTENT,0,0,1),g.translate(q,q,[0,-g.EXTENT,0]),{u_matrix:q,u_image:1,u_dimension:[J,J],u_zoom:X.overscaledZ,u_unpack:W.getUnpackVector()}})(o.tileID,M),null,u.id,_.rasterBoundsBuffer,_.quadTriangleIndexBuffer,_.rasterBoundsSegments),o.needsHillshadePrepare=!1}}function Hu(_,o,u,p,m,b){const E=p.paint.get("raster-fade-duration");if(!b&&E>0){const D=g.browser.now(),M=(D-_.timeAdded)/E,k=o?(D-o.timeAdded)/E:-1,R=u.getSource(),F=m.coveringZoomLevel({tileSize:R.tileSize,roundZoom:R.roundZoom}),U=!o||Math.abs(o.tileID.overscaledZ-F)>Math.abs(_.tileID.overscaledZ-F),X=U&&_.refreshedUponExpiration?1:g.clamp(U?M:1-k,0,1);return _.refreshedUponExpiration&&M>=1&&(_.refreshedUponExpiration=!1),o?{opacity:1,mix:1-X}:{opacity:X,mix:0}}return{opacity:1,mix:0}}const ll=new g.Color(1,0,0,1),hi=new g.Color(0,1,0,1),fa=new g.Color(0,0,1,1),as=new g.Color(1,0,1,1),ys=new g.Color(0,1,1,1);function ma(_,o,u,p){Li(_,0,o+u/2,_.transform.width,u,p)}function Hr(_,o,u,p){Li(_,o-u/2,0,u,_.transform.height,p)}function Li(_,o,u,p,m,b){const E=_.context,D=E.gl;D.enable(D.SCISSOR_TEST),D.scissor(o*_.pixelRatio,u*_.pixelRatio,p*_.pixelRatio,m*_.pixelRatio),E.clear({color:b}),D.disable(D.SCISSOR_TEST)}function Zt(_,o,u){const p=_.context,m=p.gl,b=u.posMatrix,E=_.useProgram("debug"),D=jt.disabled,M=fn.disabled,k=_.colorModeForRenderPass(),R="$debug",F=_.style.map.terrain&&_.style.map.terrain.getTerrainData(u);p.activeTexture.set(m.TEXTURE0);const U=o.getTileByID(u.key).latestRawTileData,X=Math.floor((U&&U.byteLength||0)/1024),W=o.getTile(u).tileSize,J=512/Math.min(W,512)*(u.overscaledZ/_.transform.zoom)*.5;let q=u.canonical.toString();u.overscaledZ!==u.canonical.z&&(q+=` => ${u.overscaledZ}`),function(le,me){le.initDebugOverlayCanvas();const te=le.debugOverlayCanvas,ce=le.context.gl,ye=le.debugOverlayCanvas.getContext("2d");ye.clearRect(0,0,te.width,te.height),ye.shadowColor="white",ye.shadowBlur=2,ye.lineWidth=1.5,ye.strokeStyle="white",ye.textBaseline="top",ye.font="bold 36px Open Sans, sans-serif",ye.fillText(me,5,5),ye.strokeText(me,5,5),le.debugOverlayTexture.update(te),le.debugOverlayTexture.bind(ce.LINEAR,ce.CLAMP_TO_EDGE)}(_,`${q} ${X}kB`),E.draw(p,m.TRIANGLES,D,M,ri.alphaBlended,In.disabled,pn(b,g.Color.transparent,J),null,R,_.debugBuffer,_.quadTriangleIndexBuffer,_.debugSegments),E.draw(p,m.LINE_STRIP,D,M,k,In.disabled,pn(b,g.Color.red),F,R,_.debugBuffer,_.tileBorderIndexBuffer,_.debugSegments)}function ga(_,o,u){const p=_.context,m=p.gl,b=_.colorModeForRenderPass(),E=new jt(m.LEQUAL,jt.ReadWrite,_.depthRangeFor3D),D=_.useProgram("terrain"),M=o.getTerrainMesh();p.bindFramebuffer.set(null),p.viewport.set([0,0,_.width,_.height]);for(const k of u){const R=_.renderToTexture.getTexture(k),F=o.getTerrainData(k.tileID);p.activeTexture.set(m.TEXTURE0),m.bindTexture(m.TEXTURE_2D,R.texture);const U={u_matrix:_.transform.calculatePosMatrix(k.tileID.toUnwrapped()),u_texture:0,u_ele_delta:o.getMeshFrameDelta(_.transform.zoom)};D.draw(p,m.TRIANGLES,E,fn.disabled,b,In.backCCW,U,F,"terrain",M.vertexBuffer,M.indexBuffer,M.segments)}}class zc{constructor(o,u){this.context=new Uu(o),this.transform=u,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:g.create(),renderTime:0},this.setup(),this.numSublayers=Jn.maxUnderzooming+Jn.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new ii}resize(o,u,p){if(this.width=Math.floor(o*p),this.height=Math.floor(u*p),this.pixelRatio=p,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const m of this.style._order)this.style._layers[m].resize()}setup(){const o=this.context,u=new g.PosArray;u.emplaceBack(0,0),u.emplaceBack(g.EXTENT,0),u.emplaceBack(0,g.EXTENT),u.emplaceBack(g.EXTENT,g.EXTENT),this.tileExtentBuffer=o.createVertexBuffer(u,Cc.members),this.tileExtentSegments=g.SegmentVector.simpleSegment(0,0,4,2);const p=new g.PosArray;p.emplaceBack(0,0),p.emplaceBack(g.EXTENT,0),p.emplaceBack(0,g.EXTENT),p.emplaceBack(g.EXTENT,g.EXTENT),this.debugBuffer=o.createVertexBuffer(p,Cc.members),this.debugSegments=g.SegmentVector.simpleSegment(0,0,4,5);const m=new g.RasterBoundsArray;m.emplaceBack(0,0,0,0),m.emplaceBack(g.EXTENT,0,g.EXTENT,0),m.emplaceBack(0,g.EXTENT,0,g.EXTENT),m.emplaceBack(g.EXTENT,g.EXTENT,g.EXTENT,g.EXTENT),this.rasterBoundsBuffer=o.createVertexBuffer(m,is.members),this.rasterBoundsSegments=g.SegmentVector.simpleSegment(0,0,4,2);const b=new g.PosArray;b.emplaceBack(0,0),b.emplaceBack(1,0),b.emplaceBack(0,1),b.emplaceBack(1,1),this.viewportBuffer=o.createVertexBuffer(b,Cc.members),this.viewportSegments=g.SegmentVector.simpleSegment(0,0,4,2);const E=new g.LineStripIndexArray;E.emplaceBack(0),E.emplaceBack(1),E.emplaceBack(3),E.emplaceBack(2),E.emplaceBack(0),this.tileBorderIndexBuffer=o.createIndexBuffer(E);const D=new g.TriangleIndexArray;D.emplaceBack(0,1,2),D.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=o.createIndexBuffer(D);const M=this.context.gl;this.stencilClearMode=new fn({func:M.ALWAYS,mask:0},0,255,M.ZERO,M.ZERO,M.ZERO)}clearStencil(){const o=this.context,u=o.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const p=g.create();g.ortho(p,0,this.width,this.height,0,0,1),g.scale(p,p,[u.drawingBufferWidth,u.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(o,u.TRIANGLES,jt.disabled,this.stencilClearMode,ri.disabled,In.disabled,It(p),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(o,u){if(this.currentStencilSource===o.source||!o.isTileClipped()||!u||!u.length)return;this.currentStencilSource=o.source;const p=this.context,m=p.gl;this.nextStencilID+u.length>256&&this.clearStencil(),p.setColorMode(ri.disabled),p.setDepthMode(jt.disabled);const b=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const E of u){const D=this._tileClippingMaskIDs[E.key]=this.nextStencilID++,M=this.style.map.terrain&&this.style.map.terrain.getTerrainData(E);b.draw(p,m.TRIANGLES,jt.disabled,new fn({func:m.ALWAYS,mask:0},D,255,m.KEEP,m.KEEP,m.REPLACE),ri.disabled,In.disabled,It(E.posMatrix),M,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const o=this.nextStencilID++,u=this.context.gl;return new fn({func:u.NOTEQUAL,mask:255},o,255,u.KEEP,u.KEEP,u.REPLACE)}stencilModeForClipping(o){const u=this.context.gl;return new fn({func:u.EQUAL,mask:255},this._tileClippingMaskIDs[o.key],0,u.KEEP,u.KEEP,u.REPLACE)}stencilConfigForOverlap(o){const u=this.context.gl,p=o.sort((E,D)=>D.overscaledZ-E.overscaledZ),m=p[p.length-1].overscaledZ,b=p[0].overscaledZ-m+1;if(b>1){this.currentStencilSource=void 0,this.nextStencilID+b>256&&this.clearStencil();const E={};for(let D=0;D<b;D++)E[D+m]=new fn({func:u.GEQUAL,mask:255},D+this.nextStencilID,255,u.KEEP,u.KEEP,u.REPLACE);return this.nextStencilID+=b,[E,p]}return[{[m]:fn.disabled},p]}colorModeForRenderPass(){const o=this.context.gl;return this._showOverdrawInspector?new ri([o.CONSTANT_COLOR,o.ONE],new g.Color(.125,.125,.125,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?ri.unblended:ri.alphaBlended}depthModeForSublayer(o,u,p){if(!this.opaquePassEnabledForLayer())return jt.disabled;const m=1-((1+this.currentLayer)*this.numSublayers+o)*this.depthEpsilon;return new jt(p||this.context.gl.LEQUAL,u,[m,m])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(o,u){this.style=o,this.options=u,this.lineAtlas=o.lineAtlas,this.imageManager=o.imageManager,this.glyphManager=o.glyphManager,this.symbolFadeChange=o.placement.symbolFadeChange(g.browser.now()),this.imageManager.beginFrame();const p=this.style._order,m=this.style.sourceCaches,b={},E={},D={};for(const M in m){const k=m[M];k.used&&k.prepare(this.context),b[M]=k.getVisibleCoordinates(),E[M]=b[M].slice().reverse(),D[M]=k.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let M=0;M<p.length;M++)if(this.style._layers[p[M]].is3D()){this.opaquePassCutoff=M;break}if(this.renderToTexture){this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0;const M=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime);(this.terrainFacilitator.dirty||!g.equals(this.terrainFacilitator.matrix,this.transform.projMatrix)||M.length)&&(g.copy(this.terrainFacilitator.matrix,this.transform.projMatrix),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(k,R){const F=k.context,U=F.gl,X=ri.unblended,W=new jt(U.LEQUAL,jt.ReadWrite,[0,1]),J=R.getTerrainMesh(),q=R.sourceCache.getRenderableTiles(),le=k.useProgram("terrainDepth");F.bindFramebuffer.set(R.getFramebuffer("depth").framebuffer),F.viewport.set([0,0,k.width/devicePixelRatio,k.height/devicePixelRatio]),F.clear({color:g.Color.transparent,depth:1});for(const me of q){const te=R.getTerrainData(me.tileID),ce={u_matrix:k.transform.calculatePosMatrix(me.tileID.toUnwrapped()),u_ele_delta:R.getMeshFrameDelta(k.transform.zoom)};le.draw(F,U.TRIANGLES,W,fn.disabled,X,In.backCCW,ce,te,"terrain",J.vertexBuffer,J.indexBuffer,J.segments)}F.bindFramebuffer.set(null),F.viewport.set([0,0,k.width,k.height])}(this,this.style.map.terrain),function(k,R){const F=k.context,U=F.gl,X=ri.unblended,W=new jt(U.LEQUAL,jt.ReadWrite,[0,1]),J=R.getTerrainMesh(),q=R.getCoordsTexture(),le=R.sourceCache.getRenderableTiles(),me=k.useProgram("terrainCoords");F.bindFramebuffer.set(R.getFramebuffer("coords").framebuffer),F.viewport.set([0,0,k.width/devicePixelRatio,k.height/devicePixelRatio]),F.clear({color:g.Color.transparent,depth:1}),R.coordsIndex=[];for(const te of le){const ce=R.getTerrainData(te.tileID);F.activeTexture.set(U.TEXTURE0),U.bindTexture(U.TEXTURE_2D,q.texture);const ye={u_matrix:k.transform.calculatePosMatrix(te.tileID.toUnwrapped()),u_terrain_coords_id:(255-R.coordsIndex.length)/255,u_texture:0,u_ele_delta:R.getMeshFrameDelta(k.transform.zoom)};me.draw(F,U.TRIANGLES,W,fn.disabled,X,In.backCCW,ye,ce,"terrain",J.vertexBuffer,J.indexBuffer,J.segments),R.coordsIndex.push(te.tileID.key)}F.bindFramebuffer.set(null),F.viewport.set([0,0,k.width,k.height])}(this,this.style.map.terrain))}this.renderPass="offscreen";for(const M of p){const k=this.style._layers[M];if(!k.hasOffscreenPass()||k.isHidden(this.transform.zoom))continue;const R=E[k.source];("custom"===k.type||R.length)&&this.renderLayer(this,m[k.source],k,R)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:u.showOverdrawInspector?g.Color.black:g.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=u.showOverdrawInspector,this.depthRangeFor3D=[0,1-(o._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=p.length-1;this.currentLayer>=0;this.currentLayer--){const M=this.style._layers[p[this.currentLayer]],k=m[M.source],R=b[M.source];this._renderTileClippingMasks(M,R),this.renderLayer(this,k,M,R)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<p.length;this.currentLayer++){const M=this.style._layers[p[this.currentLayer]],k=m[M.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(M))continue;const R=("symbol"===M.type?D:E)[M.source];this._renderTileClippingMasks(M,b[M.source]),this.renderLayer(this,k,M,R)}if(this.options.showTileBoundaries){const M=function(k,R){let F=null;const U=Object.values(k._layers).flatMap(q=>q.source&&!q.isHidden(R)?[k.sourceCaches[q.source]]:[]),X=U.filter(q=>"vector"===q.getSource().type),W=U.filter(q=>"vector"!==q.getSource().type),J=q=>{(!F||F.getSource().maxzoom<q.getSource().maxzoom)&&(F=q)};return X.forEach(q=>J(q)),F||W.forEach(q=>J(q)),F}(this.style,this.transform.zoom);M&&function(k,R,F){for(let U=0;U<F.length;U++)Zt(k,R,F[U])}(this,M,M.getVisibleCoordinates())}this.options.showPadding&&function(M){const k=M.transform.padding;ma(M,M.transform.height-(k.top||0),3,ll),ma(M,k.bottom||0,3,hi),Hr(M,k.left||0,3,fa),Hr(M,M.transform.width-(k.right||0),3,as);const R=M.transform.centerPoint;var F,U,X,W;Li(F=M,(U=R.x)-1,(X=M.transform.height-R.y)-10,2,20,W=ys),Li(F,U-10,X-1,20,2,W)}(this),this.context.setDefault()}renderLayer(o,u,p,m){if(!p.isHidden(this.transform.zoom)&&("background"===p.type||"custom"===p.type||(m||[]).length))switch(this.id=p.id,p.type){case"symbol":!function(b,E,D,M,k){if("translucent"!==b.renderPass)return;const R=fn.disabled,F=b.colorModeForRenderPass();(D._unevaluatedLayout.hasValue("text-variable-anchor")||D._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(U,X,W,J,q,le,me){const te=X.transform,ce="map"===q,ye="map"===le;for(const ve of U){const Se=J.getTile(ve),ke=Se.getBucket(W);if(!ke||!ke.text||!ke.text.segments.get().length)continue;const De=g.evaluateSizeForZoom(ke.textSizeData,te.zoom),Le=ae(Se,1,X.transform.zoom),We=Wi(ve.posMatrix,ye,ce,X.transform,Le),zt="none"!==W.layout.get("icon-text-fit")&&ke.hasIconData();if(De){const Ue=Math.pow(2,te.zoom-Se.tileID.overscaledZ);Lc(ke,ce,ye,me,te,We,ve.posMatrix,Ue,De,zt,X.style.map.terrain?(dt,rt)=>X.style.map.terrain.getElevation(ve,dt,rt):null)}}}(M,b,D,E,D.layout.get("text-rotation-alignment"),D.layout.get("text-pitch-alignment"),k),0!==D.paint.get("icon-opacity").constantOr(1)&&$u(b,E,D,M,!1,D.paint.get("icon-translate"),D.paint.get("icon-translate-anchor"),D.layout.get("icon-rotation-alignment"),D.layout.get("icon-pitch-alignment"),D.layout.get("icon-keep-upright"),R,F),0!==D.paint.get("text-opacity").constantOr(1)&&$u(b,E,D,M,!0,D.paint.get("text-translate"),D.paint.get("text-translate-anchor"),D.layout.get("text-rotation-alignment"),D.layout.get("text-pitch-alignment"),D.layout.get("text-keep-upright"),R,F),E.map.showCollisionBoxes&&(Vl(b,E,D,M,D.paint.get("text-translate"),D.paint.get("text-translate-anchor"),!0),Vl(b,E,D,M,D.paint.get("icon-translate"),D.paint.get("icon-translate-anchor"),!1))}(o,u,p,m,this.style.placement.variableOffsets);break;case"circle":!function(b,E,D,M){if("translucent"!==b.renderPass)return;const k=D.paint.get("circle-opacity"),R=D.paint.get("circle-stroke-width"),F=D.paint.get("circle-stroke-opacity"),U=!D.layout.get("circle-sort-key").isConstant();if(0===k.constantOr(1)&&(0===R.constantOr(1)||0===F.constantOr(1)))return;const X=b.context,W=X.gl,J=b.depthModeForSublayer(0,jt.ReadOnly),q=fn.disabled,le=b.colorModeForRenderPass(),me=[];for(let te=0;te<M.length;te++){const ce=M[te],ye=E.getTile(ce),ve=ye.getBucket(D);if(!ve)continue;const Se=ve.programConfigurations.get(D.id),ke=b.useProgram("circle",Se),De=ve.layoutVertexBuffer,Le=ve.indexBuffer,We=b.style.map.terrain&&b.style.map.terrain.getTerrainData(ce),zt={programConfiguration:Se,program:ke,layoutVertexBuffer:De,indexBuffer:Le,uniformValues:Au(b,ce,ye,D),terrainData:We};if(U){const Ue=ve.segments.get();for(const dt of Ue)me.push({segments:new g.SegmentVector([dt]),sortKey:dt.sortKey,state:zt})}else me.push({segments:ve.segments,sortKey:0,state:zt})}U&&me.sort((te,ce)=>te.sortKey-ce.sortKey);for(const te of me){const{programConfiguration:ce,program:ye,layoutVertexBuffer:ve,indexBuffer:Se,uniformValues:ke,terrainData:De}=te.state;ye.draw(X,W.TRIANGLES,J,q,le,In.disabled,ke,De,D.id,ve,Se,te.segments,D.paint,b.transform.zoom,ce)}}(o,u,p,m);break;case"heatmap":!function(b,E,D,M){if(0!==D.paint.get("heatmap-opacity"))if("offscreen"===b.renderPass){const k=b.context,R=k.gl,F=fn.disabled,U=new ri([R.ONE,R.ONE],g.Color.transparent,[!0,!0,!0,!0]);(function(X,W,J){const q=X.gl;X.activeTexture.set(q.TEXTURE1),X.viewport.set([0,0,W.width/4,W.height/4]);let le=J.heatmapFbo;if(le)q.bindTexture(q.TEXTURE_2D,le.colorAttachment.get()),X.bindFramebuffer.set(le.framebuffer);else{const me=q.createTexture();q.bindTexture(q.TEXTURE_2D,me),q.texParameteri(q.TEXTURE_2D,q.TEXTURE_WRAP_S,q.CLAMP_TO_EDGE),q.texParameteri(q.TEXTURE_2D,q.TEXTURE_WRAP_T,q.CLAMP_TO_EDGE),q.texParameteri(q.TEXTURE_2D,q.TEXTURE_MIN_FILTER,q.LINEAR),q.texParameteri(q.TEXTURE_2D,q.TEXTURE_MAG_FILTER,q.LINEAR),le=J.heatmapFbo=X.createFramebuffer(W.width/4,W.height/4,!1,!1),function(te,ce,ye,ve){var Se,ke;const De=te.gl,Le=null!==(Se=te.HALF_FLOAT)&&void 0!==Se?Se:De.UNSIGNED_BYTE,We=null!==(ke=te.RGBA16F)&&void 0!==ke?ke:De.RGBA;De.texImage2D(De.TEXTURE_2D,0,We,ce.width/4,ce.height/4,0,De.RGBA,Le,null),ve.colorAttachment.set(ye)}(X,W,me,le)}})(k,b,D),k.clear({color:g.Color.transparent});for(let X=0;X<M.length;X++){const W=M[X];if(E.hasRenderableParent(W))continue;const J=E.getTile(W),q=J.getBucket(D);if(!q)continue;const le=q.programConfigurations.get(D.id),me=b.useProgram("heatmap",le),{zoom:te}=b.transform;me.draw(k,R.TRIANGLES,jt.disabled,F,U,In.disabled,Dc(W.posMatrix,J,te,D.paint.get("heatmap-intensity")),null,D.id,q.layoutVertexBuffer,q.indexBuffer,q.segments,D.paint,b.transform.zoom,le)}k.viewport.set([0,0,b.width,b.height])}else"translucent"===b.renderPass&&(b.context.setColorMode(b.colorModeForRenderPass()),function(k,R){const F=k.context,U=F.gl,X=R.heatmapFbo;if(!X)return;F.activeTexture.set(U.TEXTURE0),U.bindTexture(U.TEXTURE_2D,X.colorAttachment.get()),F.activeTexture.set(U.TEXTURE1);let W=R.colorRampTexture;W||(W=R.colorRampTexture=new gn(F,R.colorRamp,U.RGBA)),W.bind(U.LINEAR,U.CLAMP_TO_EDGE),k.useProgram("heatmapTexture").draw(F,U.TRIANGLES,jt.disabled,fn.disabled,k.colorModeForRenderPass(),In.disabled,((J,q,le,me)=>{const te=g.create();g.ortho(te,0,J.width,J.height,0,0,1);const ce=J.context.gl;return{u_matrix:te,u_world:[ce.drawingBufferWidth,ce.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:q.paint.get("heatmap-opacity")}})(k,R),null,R.id,k.viewportBuffer,k.quadTriangleIndexBuffer,k.viewportSegments,R.paint,k.transform.zoom)}(b,D))}(o,u,p,m);break;case"line":!function(b,E,D,M){if("translucent"!==b.renderPass)return;const k=D.paint.get("line-opacity"),R=D.paint.get("line-width");if(0===k.constantOr(1)||0===R.constantOr(1))return;const F=b.depthModeForSublayer(0,jt.ReadOnly),U=b.colorModeForRenderPass(),X=D.paint.get("line-dasharray"),W=D.paint.get("line-pattern"),J=W.constantOr(1),q=D.paint.get("line-gradient"),le=D.getCrossfadeParameters(),me=J?"linePattern":X?"lineSDF":q?"lineGradient":"line",te=b.context,ce=te.gl;let ye=!0;for(const ve of M){const Se=E.getTile(ve);if(J&&!Se.patternsLoaded())continue;const ke=Se.getBucket(D);if(!ke)continue;const De=ke.programConfigurations.get(D.id),Le=b.context.program.get(),We=b.useProgram(me,De),zt=ye||We.program!==Le,Ue=b.style.map.terrain&&b.style.map.terrain.getTerrainData(ve),dt=W.constantOr(null);if(dt&&Se.imageAtlas){const Bt=Se.imageAtlas,ht=Bt.patternPositions[dt.to.toString()],Lt=Bt.patternPositions[dt.from.toString()];ht&&Lt&&De.setConstantPatternPositions(ht,Lt)}const rt=Ue?ve:null,Pn=J?Pe(b,Se,D,le,rt):X?da(b,Se,D,X,le,rt):q?Pu(b,Se,D,ke.lineClipsArray.length,rt):ku(b,Se,D,rt);if(J)te.activeTexture.set(ce.TEXTURE0),Se.imageAtlasTexture.bind(ce.LINEAR,ce.CLAMP_TO_EDGE),De.updatePaintBuffers(le);else if(X&&(zt||b.lineAtlas.dirty))te.activeTexture.set(ce.TEXTURE0),b.lineAtlas.bind(te);else if(q){const Bt=ke.gradients[D.id];let ht=Bt.texture;if(D.gradientVersion!==Bt.version){let Lt=256;if(D.stepInterpolant){const jn=E.getSource().maxzoom,un=ve.canonical.z===jn?Math.ceil(1<<b.transform.maxZoom-ve.canonical.z):1;Lt=g.clamp(g.nextPowerOfTwo(ke.maxLineLength/g.EXTENT*1024*un),256,te.maxTextureSize)}Bt.gradient=g.renderColorRamp({expression:D.gradientExpression(),evaluationKey:"lineProgress",resolution:Lt,image:Bt.gradient||void 0,clips:ke.lineClipsArray}),Bt.texture?Bt.texture.update(Bt.gradient):Bt.texture=new gn(te,Bt.gradient,ce.RGBA),Bt.version=D.gradientVersion,ht=Bt.texture}te.activeTexture.set(ce.TEXTURE0),ht.bind(D.stepInterpolant?ce.NEAREST:ce.LINEAR,ce.CLAMP_TO_EDGE)}We.draw(te,ce.TRIANGLES,F,b.stencilModeForClipping(ve),U,In.disabled,Pn,Ue,D.id,ke.layoutVertexBuffer,ke.indexBuffer,ke.segments,D.paint,b.transform.zoom,De,ke.layoutVertexBuffer2),ye=!1}}(o,u,p,m);break;case"fill":!function(b,E,D,M){const k=D.paint.get("fill-color"),R=D.paint.get("fill-opacity");if(0===R.constantOr(1))return;const F=b.colorModeForRenderPass(),U=D.paint.get("fill-pattern"),X=b.opaquePassEnabledForLayer()&&!U.constantOr(1)&&1===k.constantOr(g.Color.transparent).a&&1===R.constantOr(0)?"opaque":"translucent";if(b.renderPass===X){const W=b.depthModeForSublayer(1,"opaque"===b.renderPass?jt.ReadWrite:jt.ReadOnly);nt(b,E,D,M,W,F,!1)}if("translucent"===b.renderPass&&D.paint.get("fill-antialias")){const W=b.depthModeForSublayer(D.getPaintProperty("fill-outline-color")?2:0,jt.ReadOnly);nt(b,E,D,M,W,F,!0)}}(o,u,p,m);break;case"fill-extrusion":!function(b,E,D,M){const k=D.paint.get("fill-extrusion-opacity");if(0!==k&&"translucent"===b.renderPass){const R=new jt(b.context.gl.LEQUAL,jt.ReadWrite,b.depthRangeFor3D);if(1!==k||D.paint.get("fill-extrusion-pattern").constantOr(1))Ul(b,E,D,M,R,fn.disabled,ri.disabled),Ul(b,E,D,M,R,b.stencilModeFor3D(),b.colorModeForRenderPass());else{const F=b.colorModeForRenderPass();Ul(b,E,D,M,R,fn.disabled,F)}}}(o,u,p,m);break;case"hillshade":!function(b,E,D,M){if("offscreen"!==b.renderPass&&"translucent"!==b.renderPass)return;const k=b.context,R=b.depthModeForSublayer(0,jt.ReadOnly),F=b.colorModeForRenderPass(),[U,X]="translucent"===b.renderPass?b.stencilConfigForOverlap(M):[{},M];for(const W of X){const J=E.getTile(W);void 0!==J.needsHillshadePrepare&&J.needsHillshadePrepare&&"offscreen"===b.renderPass?al(b,J,D,R,fn.disabled,F):"translucent"===b.renderPass&&Ke(b,W,J,D,R,U[W.overscaledZ],F)}k.viewport.set([0,0,b.width,b.height])}(o,u,p,m);break;case"raster":!function(b,E,D,M){if("translucent"!==b.renderPass||0===D.paint.get("raster-opacity")||!M.length)return;const k=b.context,R=k.gl,F=E.getSource(),U=b.useProgram("raster"),X=b.colorModeForRenderPass(),[W,J]=F instanceof Ft?[{},M]:b.stencilConfigForOverlap(M),q=J[J.length-1].overscaledZ,le=!b.options.moving;for(const me of J){const te=b.depthModeForSublayer(me.overscaledZ-q,1===D.paint.get("raster-opacity")?jt.ReadWrite:jt.ReadOnly,R.LESS),ce=E.getTile(me);ce.registerFadeDuration(D.paint.get("raster-fade-duration"));const ye=E.findLoadedParent(me,0),ve=Hu(ce,ye,E,D,b.transform,b.style.map.terrain);let Se,ke;const De="nearest"===D.paint.get("raster-resampling")?R.NEAREST:R.LINEAR;k.activeTexture.set(R.TEXTURE0),ce.texture.bind(De,R.CLAMP_TO_EDGE,R.LINEAR_MIPMAP_NEAREST),k.activeTexture.set(R.TEXTURE1),ye?(ye.texture.bind(De,R.CLAMP_TO_EDGE,R.LINEAR_MIPMAP_NEAREST),Se=Math.pow(2,ye.tileID.overscaledZ-ce.tileID.overscaledZ),ke=[ce.tileID.canonical.x*Se%1,ce.tileID.canonical.y*Se%1]):ce.texture.bind(De,R.CLAMP_TO_EDGE,R.LINEAR_MIPMAP_NEAREST);const Le=b.style.map.terrain&&b.style.map.terrain.getTerrainData(me),We=Le?me:null,zt=We?We.posMatrix:b.transform.calculatePosMatrix(me.toUnwrapped(),le),Ue=Sc(zt,ke||[0,0],Se||1,ve,D);F instanceof Ft?U.draw(k,R.TRIANGLES,te,fn.disabled,X,In.disabled,Ue,Le,D.id,F.boundsBuffer,b.quadTriangleIndexBuffer,F.boundsSegments):U.draw(k,R.TRIANGLES,te,W[me.overscaledZ],X,In.disabled,Ue,Le,D.id,b.rasterBoundsBuffer,b.quadTriangleIndexBuffer,b.rasterBoundsSegments)}}(o,u,p,m);break;case"background":!function(b,E,D,M){const k=D.paint.get("background-color"),R=D.paint.get("background-opacity");if(0===R)return;const F=b.context,U=F.gl,X=b.transform,W=X.tileSize,J=D.paint.get("background-pattern");if(b.isPatternMissing(J))return;const q=!J&&1===k.a&&1===R&&b.opaquePassEnabledForLayer()?"opaque":"translucent";if(b.renderPass!==q)return;const le=fn.disabled,me=b.depthModeForSublayer(0,"opaque"===q?jt.ReadWrite:jt.ReadOnly),te=b.colorModeForRenderPass(),ce=b.useProgram(J?"backgroundPattern":"background"),ye=M||X.coveringTiles({tileSize:W,terrain:b.style.map.terrain});J&&(F.activeTexture.set(U.TEXTURE0),b.imageManager.bind(b.context));const ve=D.getCrossfadeParameters();for(const Se of ye){const ke=M?Se.posMatrix:b.transform.calculatePosMatrix(Se.toUnwrapped()),De=J?Tc(ke,R,b,J,{tileID:Se,tileSize:W},ve):il(ke,R,k),Le=b.style.map.terrain&&b.style.map.terrain.getTerrainData(Se);ce.draw(F,U.TRIANGLES,me,le,te,In.disabled,De,Le,D.id,b.tileExtentBuffer,b.quadTriangleIndexBuffer,b.tileExtentSegments)}}(o,0,p,m);break;case"custom":!function(b,E,D){const M=b.context,k=D.implementation;if("offscreen"===b.renderPass){const R=k.prerender;R&&(b.setCustomLayerDefaults(),M.setColorMode(b.colorModeForRenderPass()),R.call(k,M.gl,b.transform.customLayerMatrix()),M.setDirty(),b.setBaseState())}else if("translucent"===b.renderPass){b.setCustomLayerDefaults(),M.setColorMode(b.colorModeForRenderPass()),M.setStencilMode(fn.disabled);const R="3d"===k.renderingMode?new jt(b.context.gl.LEQUAL,jt.ReadWrite,b.depthRangeFor3D):b.depthModeForSublayer(0,jt.ReadOnly);M.setDepthMode(R),k.render(M.gl,b.transform.customLayerMatrix()),M.setDirty(),b.setBaseState(),M.bindFramebuffer.set(null)}}(o,0,p)}}translatePosMatrix(o,u,p,m,b){if(!p[0]&&!p[1])return o;const E=b?"map"===m?this.transform.angle:0:"viewport"===m?-this.transform.angle:0;if(E){const k=Math.sin(E),R=Math.cos(E);p=[p[0]*R-p[1]*k,p[0]*k+p[1]*R]}const D=[b?p[0]:ae(u,p[0],this.transform.zoom),b?p[1]:ae(u,p[1],this.transform.zoom),0],M=new Float32Array(16);return g.translate(M,o,D),M}saveTileTexture(o){const u=this._tileTextures[o.size[0]];u?u.push(o):this._tileTextures[o.size[0]]=[o]}getTileTexture(o){const u=this._tileTextures[o];return u&&u.length>0?u.pop():null}isPatternMissing(o){if(!o)return!1;if(!o.from||!o.to)return!0;const u=this.imageManager.getPattern(o.from.toString()),p=this.imageManager.getPattern(o.to.toString());return!u||!p}useProgram(o,u){this.cache=this.cache||{};const p=o+(u?u.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[p]||(this.cache[p]=new co(this.context,Qn[o],u,ss[o],this._showOverdrawInspector,this.style.map.terrain)),this.cache[p]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const o=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(o.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new gn(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:o,drawingBufferHeight:u}=this.context.gl;return this.width!==o||this.height!==u}}class cl{constructor(o,u){this.points=o,this.planes=u}static fromInvProjectionMatrix(o,u,p){const m=Math.pow(2,p),b=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(D=>{const M=1/(D=g.transformMat4([],D,o))[3]/u*m;return g.mul$1(D,D,[M,M,1/D[3],M])}),E=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(D=>{const M=function(U,X){var W=X[0],J=X[1],q=X[2],le=W*W+J*J+q*q;return le>0&&(le=1/Math.sqrt(le)),U[0]=X[0]*le,U[1]=X[1]*le,U[2]=X[2]*le,U}([],(U=[],X=Rl([],b[D[0]],b[D[1]]),W=Rl([],b[D[2]],b[D[1]]),J=X[0],me=W[0],U[0]=(q=X[1])*(ce=W[2])-(le=X[2])*(te=W[1]),U[1]=le*me-J*ce,U[2]=J*te-q*me,U)),k=-((R=M)[0]*(F=b[D[1]])[0]+R[1]*F[1]+R[2]*F[2]);var U,X,W,J,q,le,me,te,ce,R,F;return M.concat(k)});return new cl(b,E)}}class ul{constructor(o,u){var p,m,b;this.min=o,this.max=u,this.center=function(p,m,b){return p[0]=.5*m[0],p[1]=.5*m[1],p[2]=.5*m[2],p}([],((p=[])[0]=(m=this.min)[0]+(b=this.max)[0],p[1]=m[1]+b[1],p[2]=m[2]+b[2],p))}quadrant(o){const u=[o%2==0,o<2],p=Fs(this.min),m=Fs(this.max);for(let b=0;b<u.length;b++)p[b]=u[b]?this.min[b]:this.center[b],m[b]=u[b]?this.center[b]:this.max[b];return m[2]=this.max[2],new ul(p,m)}distanceX(o){return Math.max(Math.min(this.max[0],o[0]),this.min[0])-o[0]}distanceY(o){return Math.max(Math.min(this.max[1],o[1]),this.min[1])-o[1]}intersects(o){const u=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let p=!0;for(let m=0;m<o.planes.length;m++){const b=o.planes[m];let E=0;for(let D=0;D<u.length;D++)g.dot(b,u[D])>=0&&E++;if(0===E)return 0;E!==u.length&&(p=!1)}if(p)return 2;for(let m=0;m<3;m++){let b=Number.MAX_VALUE,E=-Number.MAX_VALUE;for(let D=0;D<o.points.length;D++){const M=o.points[D][m]-this.min[m];b=Math.min(b,M),E=Math.max(E,M)}if(E<0||b>this.max[m]-this.min[m])return 0}return 1}}class ls{constructor(o=0,u=0,p=0,m=0){if(isNaN(o)||o<0||isNaN(u)||u<0||isNaN(p)||p<0||isNaN(m)||m<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=o,this.bottom=u,this.left=p,this.right=m}interpolate(o,u,p){return null!=u.top&&null!=o.top&&(this.top=g.interpolate.number(o.top,u.top,p)),null!=u.bottom&&null!=o.bottom&&(this.bottom=g.interpolate.number(o.bottom,u.bottom,p)),null!=u.left&&null!=o.left&&(this.left=g.interpolate.number(o.left,u.left,p)),null!=u.right&&null!=o.right&&(this.right=g.interpolate.number(o.right,u.right,p)),this}getCenter(o,u){const p=g.clamp((this.left+o-this.right)/2,0,o),m=g.clamp((this.top+u-this.bottom)/2,0,u);return new g.Point(p,m)}equals(o){return this.top===o.top&&this.bottom===o.bottom&&this.left===o.left&&this.right===o.right}clone(){return new ls(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}class Uo{constructor(o,u,p,m,b){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=void 0===b||!!b,this._minZoom=o||0,this._maxZoom=u||22,this._minPitch=p??0,this._maxPitch=m??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new g.LngLat(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new ls,this._posMatrixCache={},this._alignedPosMatrixCache={},this._minEleveationForCurrentTile=0}clone(){const o=new Uo(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return o.apply(this),o}apply(o){this.tileSize=o.tileSize,this.latRange=o.latRange,this.width=o.width,this.height=o.height,this._center=o._center,this._elevation=o._elevation,this._minEleveationForCurrentTile=o._minEleveationForCurrentTile,this.zoom=o.zoom,this.angle=o.angle,this._fov=o._fov,this._pitch=o._pitch,this._unmodified=o._unmodified,this._edgeInsets=o._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(o){this._minZoom!==o&&(this._minZoom=o,this.zoom=Math.max(this.zoom,o))}get maxZoom(){return this._maxZoom}set maxZoom(o){this._maxZoom!==o&&(this._maxZoom=o,this.zoom=Math.min(this.zoom,o))}get minPitch(){return this._minPitch}set minPitch(o){this._minPitch!==o&&(this._minPitch=o,this.pitch=Math.max(this.pitch,o))}get maxPitch(){return this._maxPitch}set maxPitch(o){this._maxPitch!==o&&(this._maxPitch=o,this.pitch=Math.min(this.pitch,o))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(o){void 0===o?o=!0:null===o&&(o=!1),this._renderWorldCopies=o}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new g.Point(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(o){const u=-g.wrap(o,-180,180)*Math.PI/180;var p;this.angle!==u&&(this._unmodified=!1,this.angle=u,this._calcMatrices(),this.rotationMatrix=(p=new g.ARRAY_TYPE(4),g.ARRAY_TYPE!=Float32Array&&(p[1]=0,p[2]=0),p[0]=1,p[3]=1,p),function(p,m,b){var E=m[0],D=m[1],M=m[2],k=m[3],R=Math.sin(b),F=Math.cos(b);p[0]=E*F+M*R,p[1]=D*F+k*R,p[2]=E*-R+M*F,p[3]=D*-R+k*F}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(o){const u=g.clamp(o,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==u&&(this._unmodified=!1,this._pitch=u,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(o){o=Math.max(.01,Math.min(60,o)),this._fov!==o&&(this._unmodified=!1,this._fov=o/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(o){const u=Math.min(Math.max(o,this.minZoom),this.maxZoom);this._zoom!==u&&(this._unmodified=!1,this._zoom=u,this.tileZoom=Math.max(0,Math.floor(u)),this.scale=this.zoomScale(u),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(o){o.lat===this._center.lat&&o.lng===this._center.lng||(this._unmodified=!1,this._center=o,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(o){o!==this._elevation&&(this._elevation=o,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(o){this._edgeInsets.equals(o)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,o,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(o){return this._edgeInsets.equals(o)}interpolatePadding(o,u,p){this._unmodified=!1,this._edgeInsets.interpolate(o,u,p),this._constrain(),this._calcMatrices()}coveringZoomLevel(o){const u=(o.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/o.tileSize));return Math.max(0,u)}getVisibleUnwrappedCoordinates(o){const u=[new g.UnwrappedTileID(0,o)];if(this._renderWorldCopies){const p=this.pointCoordinate(new g.Point(0,0)),m=this.pointCoordinate(new g.Point(this.width,0)),b=this.pointCoordinate(new g.Point(this.width,this.height)),E=this.pointCoordinate(new g.Point(0,this.height)),D=Math.floor(Math.min(p.x,m.x,b.x,E.x)),M=Math.floor(Math.max(p.x,m.x,b.x,E.x)),k=1;for(let R=D-k;R<=M+k;R++)0!==R&&u.push(new g.UnwrappedTileID(R,o))}return u}coveringTiles(o){var u,p;let m=this.coveringZoomLevel(o);const b=m;if(void 0!==o.minzoom&&m<o.minzoom)return[];void 0!==o.maxzoom&&m>o.maxzoom&&(m=o.maxzoom);const E=this.pointCoordinate(this.getCameraPoint()),D=g.MercatorCoordinate.fromLngLat(this.center),M=Math.pow(2,m),k=[M*E.x,M*E.y,0],R=[M*D.x,M*D.y,0],F=cl.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,m);let U=o.minzoom||0;!o.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(U=m);const X=o.terrain?2/Math.min(this.tileSize,o.tileSize)*this.tileSize:3,W=te=>({aabb:new ul([te*M,0,0],[(te+1)*M,M,0]),zoom:0,x:0,y:0,wrap:te,fullyVisible:!1}),J=[],q=[],le=m,me=o.reparseOverscaled?b:m;if(this._renderWorldCopies)for(let te=1;te<=3;te++)J.push(W(-te)),J.push(W(te));for(J.push(W(0));J.length>0;){const te=J.pop(),ce=te.x,ye=te.y;let ve=te.fullyVisible;if(!ve){const We=te.aabb.intersects(F);if(0===We)continue;ve=2===We}const Se=o.terrain?k:R,ke=te.aabb.distanceX(Se),De=te.aabb.distanceY(Se),Le=Math.max(Math.abs(ke),Math.abs(De));if(te.zoom===le||Le>X+(1<<le-te.zoom)-2&&te.zoom>=U){const We=le-te.zoom,zt=k[0]-.5-(ce<<We),Ue=k[1]-.5-(ye<<We);q.push({tileID:new g.OverscaledTileID(te.zoom===le?me:te.zoom,te.wrap,te.zoom,ce,ye),distanceSq:Pr([R[0]-.5-ce,R[1]-.5-ye]),tileDistanceToCamera:Math.sqrt(zt*zt+Ue*Ue)})}else for(let We=0;We<4;We++){const zt=(ce<<1)+We%2,Ue=(ye<<1)+(We>>1),dt=te.zoom+1;let rt=te.aabb.quadrant(We);if(o.terrain){const Pn=new g.OverscaledTileID(dt,te.wrap,dt,zt,Ue),Bt=o.terrain.getMinMaxElevation(Pn),ht=null!==(u=Bt.minElevation)&&void 0!==u?u:this.elevation,Lt=null!==(p=Bt.maxElevation)&&void 0!==p?p:this.elevation;rt=new ul([rt.min[0],rt.min[1],ht],[rt.max[0],rt.max[1],Lt])}J.push({aabb:rt,zoom:dt,x:zt,y:Ue,wrap:te.wrap,fullyVisible:ve})}}return q.sort((te,ce)=>te.distanceSq-ce.distanceSq).map(te=>te.tileID)}resize(o,u){this.width=o,this.height=u,this.pixelsToGLUnits=[2/o,-2/u],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(o){return Math.pow(2,o)}scaleZoom(o){return Math.log(o)/Math.LN2}project(o){const u=g.clamp(o.lat,-this.maxValidLatitude,this.maxValidLatitude);return new g.Point(g.mercatorXfromLng(o.lng)*this.worldSize,g.mercatorYfromLat(u)*this.worldSize)}unproject(o){return new g.MercatorCoordinate(o.x/this.worldSize,o.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(o){const u=this.pointLocation(this.centerPoint,o),p=o.getElevationForLngLatZoom(u,this.tileZoom);if(!(this.elevation-p))return;const m=this.getCameraPosition(),b=g.MercatorCoordinate.fromLngLat(m.lngLat,m.altitude),E=g.MercatorCoordinate.fromLngLat(u,p),D=b.x-E.x,M=b.y-E.y,k=b.z-E.z,R=Math.sqrt(D*D+M*M+k*k),F=this.scaleZoom(this.cameraToCenterDistance/R/this.tileSize);this._elevation=p,this._center=u,this.zoom=F}setLocationAtPoint(o,u){const p=this.pointCoordinate(u),m=this.pointCoordinate(this.centerPoint),b=this.locationCoordinate(o),E=new g.MercatorCoordinate(b.x-(p.x-m.x),b.y-(p.y-m.y));this.center=this.coordinateLocation(E),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(o,u){return u?this.coordinatePoint(this.locationCoordinate(o),u.getElevationForLngLatZoom(o,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(o))}pointLocation(o,u){return this.coordinateLocation(this.pointCoordinate(o,u))}locationCoordinate(o){return g.MercatorCoordinate.fromLngLat(o)}coordinateLocation(o){return o&&o.toLngLat()}pointCoordinate(o,u){if(u){const U=u.pointCoordinate(o);if(null!=U)return U}const p=[o.x,o.y,0,1],m=[o.x,o.y,1,1];g.transformMat4(p,p,this.pixelMatrixInverse),g.transformMat4(m,m,this.pixelMatrixInverse);const b=p[3],E=m[3],D=p[1]/b,M=m[1]/E,k=p[2]/b,R=m[2]/E,F=k===R?0:(0-k)/(R-k);return new g.MercatorCoordinate(g.interpolate.number(p[0]/b,m[0]/E,F)/this.worldSize,g.interpolate.number(D,M,F)/this.worldSize)}coordinatePoint(o,u=0,p=this.pixelMatrix){const m=[o.x*this.worldSize,o.y*this.worldSize,u,1];return g.transformMat4(m,m,p),new g.Point(m[0]/m[3],m[1]/m[3])}getBounds(){const o=Math.max(0,this.height/2-this.getHorizon());return(new Yn).extend(this.pointLocation(new g.Point(0,o))).extend(this.pointLocation(new g.Point(this.width,o))).extend(this.pointLocation(new g.Point(this.width,this.height))).extend(this.pointLocation(new g.Point(0,this.height)))}getMaxBounds(){return this.latRange&&2===this.latRange.length&&this.lngRange&&2===this.lngRange.length?new Yn([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(o){o?(this.lngRange=[o.getWest(),o.getEast()],this.latRange=[o.getSouth(),o.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(o,u=!1){const p=o.key,m=u?this._alignedPosMatrixCache:this._posMatrixCache;if(m[p])return m[p];const b=o.canonical,E=this.worldSize/this.zoomScale(b.z),D=b.x+Math.pow(2,b.z)*o.wrap,M=g.identity(new Float64Array(16));return g.translate(M,M,[D*E,b.y*E,0]),g.scale(M,M,[E/g.EXTENT,E/g.EXTENT,1]),g.multiply(M,u?this.alignedProjMatrix:this.projMatrix,M),m[p]=new Float32Array(M),m[p]}customLayerMatrix(){return this.mercatorMatrix.slice()}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let o,u,p,m,b=-90,E=90,D=-180,M=180;const k=this.size,R=this._unmodified;if(this.latRange){const X=this.latRange;b=g.mercatorYfromLat(X[1])*this.worldSize,E=g.mercatorYfromLat(X[0])*this.worldSize,o=E-b<k.y?k.y/(E-b):0}if(this.lngRange){const X=this.lngRange;D=g.wrap(g.mercatorXfromLng(X[0])*this.worldSize,0,this.worldSize),M=g.wrap(g.mercatorXfromLng(X[1])*this.worldSize,0,this.worldSize),M<D&&(M+=this.worldSize),u=M-D<k.x?k.x/(M-D):0}const F=this.point,U=Math.max(u||0,o||0);if(U)return this.center=this.unproject(new g.Point(u?(M+D)/2:F.x,o?(E+b)/2:F.y)),this.zoom+=this.scaleZoom(U),this._unmodified=R,void(this._constraining=!1);if(this.latRange){const X=F.y,W=k.y/2;X-W<b&&(m=b+W),X+W>E&&(m=E-W)}if(this.lngRange){const X=(D+M)/2,W=g.wrap(F.x,X-this.worldSize/2,X+this.worldSize/2),J=k.x/2;W-J<D&&(p=D+J),W+J>M&&(p=M-J)}void 0===p&&void 0===m||(this.center=this.unproject(new g.Point(void 0!==p?p:F.x,void 0!==m?m:F.y)).wrap()),this._unmodified=R,this._constraining=!1}_calcMatrices(){if(!this.height)return;const o=this.centerOffset,u=this.point.x,p=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=g.mercatorZfromAltitude(1,this.center.lat)*this.worldSize;let m=g.identity(new Float64Array(16));g.scale(m,m,[this.width/2,-this.height/2,1]),g.translate(m,m,[1,-1,0]),this.labelPlaneMatrix=m,m=g.identity(new Float64Array(16)),g.scale(m,m,[1,-1,1]),g.translate(m,m,[-1,-1,0]),g.scale(m,m,[2/this.width,2/this.height,1]),this.glCoordMatrix=m;const b=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),E=Math.min(this.elevation,this._minEleveationForCurrentTile),D=b-E*this._pixelPerMeter/Math.cos(this._pitch),M=E<0?D:b,k=Math.PI/2+this._pitch,R=this._fov*(.5+o.y/this.height),F=Math.sin(R)*M/Math.sin(g.clamp(Math.PI-k-R,.01,Math.PI-.01)),U=this.getHorizon(),X=2*Math.atan(U/this.cameraToCenterDistance)*(.5+o.y/(2*U)),W=Math.sin(X)*M/Math.sin(g.clamp(Math.PI-k-X,.01,Math.PI-.01)),J=Math.min(F,W),q=1.01*(Math.cos(Math.PI/2-this._pitch)*J+M),le=this.height/50;m=new Float64Array(16),g.perspective(m,this._fov,this.width/this.height,le,q),m[8]=2*-o.x/this.width,m[9]=2*o.y/this.height,g.scale(m,m,[1,-1,1]),g.translate(m,m,[0,0,-this.cameraToCenterDistance]),g.rotateX(m,m,this._pitch),g.rotateZ(m,m,this.angle),g.translate(m,m,[-u,-p,0]),this.mercatorMatrix=g.scale([],m,[this.worldSize,this.worldSize,this.worldSize]),g.scale(m,m,[1,1,this._pixelPerMeter]),this.pixelMatrix=g.multiply(new Float64Array(16),this.labelPlaneMatrix,m),g.translate(m,m,[0,0,-this.elevation]),this.projMatrix=m,this.invProjMatrix=g.invert([],m),this.pixelMatrix3D=g.multiply(new Float64Array(16),this.labelPlaneMatrix,m);const me=this.width%2/2,te=this.height%2/2,ce=Math.cos(this.angle),ye=Math.sin(this.angle),ve=u-Math.round(u)+ce*me+ye*te,Se=p-Math.round(p)+ce*te+ye*me,ke=new Float64Array(m);if(g.translate(ke,ke,[ve>.5?ve-1:ve,Se>.5?Se-1:Se,0]),this.alignedProjMatrix=ke,m=g.invert(new Float64Array(16),this.pixelMatrix),!m)throw new Error("failed to invert matrix");this.pixelMatrixInverse=m,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const o=this.pointCoordinate(new g.Point(0,0)),u=[o.x*this.worldSize,o.y*this.worldSize,0,1];return g.transformMat4(u,u,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const o=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new g.Point(0,o))}getCameraQueryGeometry(o){const u=this.getCameraPoint();if(1===o.length)return[o[0],u];{let p=u.x,m=u.y,b=u.x,E=u.y;for(const D of o)p=Math.min(p,D.x),m=Math.min(m,D.y),b=Math.max(b,D.x),E=Math.max(E,D.y);return[new g.Point(p,m),new g.Point(b,m),new g.Point(b,E),new g.Point(p,E),new g.Point(p,m)]}}}function ho(_,o){let u,p=!1,m=null,b=null;const E=()=>{m=null,p&&(_.apply(b,u),m=setTimeout(E,o),p=!1)};return(...D)=>(p=!0,b=this,u=D,m||E(),m)}class Gu{constructor(o){this._getCurrentHash=()=>{const u=window.location.hash.replace("#","");if(this._hashName){let p;return u.split("&").map(m=>m.split("=")).forEach(m=>{m[0]===this._hashName&&(p=m)}),(p&&p[1]||"").split("/")}return u.split("/")},this._onHashChange=()=>{const u=this._getCurrentHash();if(u.length>=3&&!u.some(p=>isNaN(p))){const p=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(u[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+u[2],+u[1]],zoom:+u[0],bearing:p,pitch:+(u[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{const u=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,u)}catch{}},this._updateHash=ho(this._updateHashUnthrottled,300),this._hashName=o&&encodeURIComponent(o)}addTo(o){return this._map=o,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(o){const u=this._map.getCenter(),p=Math.round(100*this._map.getZoom())/100,m=Math.ceil((p*Math.LN2+Math.log(512/360/.5))/Math.LN10),b=Math.pow(10,m),E=Math.round(u.lng*b)/b,D=Math.round(u.lat*b)/b,M=this._map.getBearing(),k=this._map.getPitch();let R="";if(R+=o?`/${E}/${D}/${p}`:`${p}/${D}/${E}`,(M||k)&&(R+="/"+Math.round(10*M)/10),k&&(R+=`/${Math.round(k)}`),this._hashName){const F=this._hashName;let U=!1;const X=window.location.hash.slice(1).split("&").map(W=>{const J=W.split("=")[0];return J===F?(U=!0,`${J}=${R}`):W}).filter(W=>W);return U||X.push(`${F}=${R}`),`#${X.join("&")}`}return`#${R}`}}const _a={linearity:.3,easing:g.bezier(0,0,.3,1)},qu=g.extend({deceleration:2500,maxSpeed:1400},_a),Zu=g.extend({deceleration:20,maxSpeed:1400},_a),dl=g.extend({deceleration:1e3,maxSpeed:360},_a),Wu=g.extend({deceleration:1e3,maxSpeed:90},_a);class hl{constructor(o){this._map=o,this.clear()}clear(){this._inertiaBuffer=[]}record(o){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:g.browser.now(),settings:o})}_drainInertiaBuffer(){const o=this._inertiaBuffer,u=g.browser.now();for(;o.length>0&&u-o[0].time>160;)o.shift()}_onMoveEnd(o){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const u={zoom:0,bearing:0,pitch:0,pan:new g.Point(0,0),pinchAround:void 0,around:void 0};for(const{settings:b}of this._inertiaBuffer)u.zoom+=b.zoomDelta||0,u.bearing+=b.bearingDelta||0,u.pitch+=b.pitchDelta||0,b.panDelta&&u.pan._add(b.panDelta),b.around&&(u.around=b.around),b.pinchAround&&(u.pinchAround=b.pinchAround);const p=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,m={};if(u.pan.mag()){const b=Rr(u.pan.mag(),p,g.extend({},qu,o||{}));m.offset=u.pan.mult(b.amount/u.pan.mag()),m.center=this._map.transform.center,jl(m,b)}if(u.zoom){const b=Rr(u.zoom,p,Zu);m.zoom=this._map.transform.zoom+b.amount,jl(m,b)}if(u.bearing){const b=Rr(u.bearing,p,dl);m.bearing=this._map.transform.bearing+g.clamp(b.amount,-179,179),jl(m,b)}if(u.pitch){const b=Rr(u.pitch,p,Wu);m.pitch=this._map.transform.pitch+b.amount,jl(m,b)}if(m.zoom||m.bearing){const b=void 0===u.pinchAround?u.around:u.pinchAround;m.around=b?this._map.unproject(b):this._map.getCenter()}return this.clear(),g.extend(m,{noMoveStart:!0})}}function jl(_,o){(!_.duration||_.duration<o.duration)&&(_.duration=o.duration,_.easing=o.easing)}function Rr(_,o,u){const{maxSpeed:p,linearity:m,deceleration:b}=u,E=g.clamp(_*m/(o/1e3),-p,p),D=Math.abs(E)/(b*m);return{easing:u.easing,duration:1e3*D,amount:E*(D/2)}}class bi extends g.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,u,p,m={}){const b=be.mousePos(u.getCanvasContainer(),p),E=u.unproject(b);super(o,g.extend({point:b,lngLat:E,originalEvent:p},m)),this._defaultPrevented=!1,this.target=u}}class $l extends g.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,u,p){const m="touchend"===o?p.changedTouches:p.touches,b=be.touchPos(u.getCanvasContainer(),m),E=b.map(M=>u.unproject(M)),D=b.reduce((M,k,R,F)=>M.add(k.div(F.length)),new g.Point(0,0));super(o,{points:b,point:D,lngLats:E,lngLat:u.unproject(D),originalEvent:p}),this._defaultPrevented=!1}}class Ti extends g.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,u,p){super(o,{originalEvent:p}),this._defaultPrevented=!1}}class Hl{constructor(o,u){this._map=o,this._clickTolerance=u.clickTolerance}reset(){delete this._mousedownPos}wheel(o){return this._firePreventable(new Ti(o.type,this._map,o))}mousedown(o,u){return this._mousedownPos=u,this._firePreventable(new bi(o.type,this._map,o))}mouseup(o){this._map.fire(new bi(o.type,this._map,o))}click(o,u){this._mousedownPos&&this._mousedownPos.dist(u)>=this._clickTolerance||this._map.fire(new bi(o.type,this._map,o))}dblclick(o){return this._firePreventable(new bi(o.type,this._map,o))}mouseover(o){this._map.fire(new bi(o.type,this._map,o))}mouseout(o){this._map.fire(new bi(o.type,this._map,o))}touchstart(o){return this._firePreventable(new $l(o.type,this._map,o))}touchmove(o){this._map.fire(new $l(o.type,this._map,o))}touchend(o){this._map.fire(new $l(o.type,this._map,o))}touchcancel(o){this._map.fire(new $l(o.type,this._map,o))}_firePreventable(o){if(this._map.fire(o),o.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Gd{constructor(o){this._map=o}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(o){this._map.fire(new bi(o.type,this._map,o))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new bi("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(o){this._delayContextMenu?this._contextMenuEvent=o:this._ignoreContextMenu||this._map.fire(new bi(o.type,this._map,o)),this._map.listens("contextmenu")&&o.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Gl{constructor(o){this._map=o}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(o){return this.transform.pointLocation(g.Point.convert(o),this._map.terrain)}}class Tp{constructor(o,u){this._map=o,this._tr=new Gl(o),this._el=o.getCanvasContainer(),this._container=o.getContainer(),this._clickTolerance=u.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(o,u){this.isEnabled()&&o.shiftKey&&0===o.button&&(be.disableDrag(),this._startPos=this._lastPos=u,this._active=!0)}mousemoveWindow(o,u){if(!this._active)return;const p=u;if(this._lastPos.equals(p)||!this._box&&p.dist(this._startPos)<this._clickTolerance)return;const m=this._startPos;this._lastPos=p,this._box||(this._box=be.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",o));const b=Math.min(m.x,p.x),E=Math.max(m.x,p.x),D=Math.min(m.y,p.y),M=Math.max(m.y,p.y);be.setTransform(this._box,`translate(${b}px,${D}px)`),this._box.style.width=E-b+"px",this._box.style.height=M-D+"px"}mouseupWindow(o,u){if(!this._active||0!==o.button)return;const p=this._startPos,m=u;if(this.reset(),be.suppressClick(),p.x!==m.x||p.y!==m.y)return this._map.fire(new g.Event("boxzoomend",{originalEvent:o})),{cameraAnimation:b=>b.fitScreenCoordinates(p,m,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",o)}keydown(o){this._active&&27===o.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",o))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(be.remove(this._box),this._box=null),be.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(o,u){return this._map.fire(new g.Event(o,{originalEvent:u}))}}function Bc(_,o){if(_.length!==o.length)throw new Error(`The number of touches and points are not equal - touches ${_.length}, points ${o.length}`);const u={};for(let p=0;p<_.length;p++)u[_[p].identifier]=o[p];return u}class ql{constructor(o){this.reset(),this.numTouches=o.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(o,u,p){(this.centroid||p.length>this.numTouches)&&(this.aborted=!0),this.aborted||(void 0===this.startTime&&(this.startTime=o.timeStamp),p.length===this.numTouches&&(this.centroid=function(m){const b=new g.Point(0,0);for(const E of m)b._add(E);return b.div(m.length)}(u),this.touches=Bc(p,u)))}touchmove(o,u,p){if(this.aborted||!this.centroid)return;const m=Bc(p,u);for(const b in this.touches){const E=m[b];(!E||E.dist(this.touches[b])>30)&&(this.aborted=!0)}}touchend(o,u,p){if((!this.centroid||o.timeStamp-this.startTime>500)&&(this.aborted=!0),0===p.length){const m=!this.aborted&&this.centroid;if(this.reset(),m)return m}}}class vs{constructor(o){this.singleTap=new ql(o),this.numTaps=o.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(o,u,p){this.singleTap.touchstart(o,u,p)}touchmove(o,u,p){this.singleTap.touchmove(o,u,p)}touchend(o,u,p){const m=this.singleTap.touchend(o,u,p);if(m){const b=o.timeStamp-this.lastTime<500,E=!this.lastTap||this.lastTap.dist(m)<30;if(b&&E||this.reset(),this.count++,this.lastTime=o.timeStamp,this.lastTap=m,this.count===this.numTaps)return this.reset(),m}}}class Je{constructor(o){this._tr=new Gl(o),this._zoomIn=new vs({numTouches:1,numTaps:2}),this._zoomOut=new vs({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(o,u,p){this._zoomIn.touchstart(o,u,p),this._zoomOut.touchstart(o,u,p)}touchmove(o,u,p){this._zoomIn.touchmove(o,u,p),this._zoomOut.touchmove(o,u,p)}touchend(o,u,p){const m=this._zoomIn.touchend(o,u,p),b=this._zoomOut.touchend(o,u,p),E=this._tr;return m?(this._active=!0,o.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:D=>D.easeTo({duration:300,zoom:E.zoom+1,around:E.unproject(m)},{originalEvent:o})}):b?(this._active=!0,o.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:D=>D.easeTo({duration:300,zoom:E.zoom-1,around:E.unproject(b)},{originalEvent:o})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class pl{constructor(o){this._enabled=!!o.enable,this._moveStateManager=o.moveStateManager,this._clickTolerance=o.clickTolerance||1,this._moveFunction=o.move,this._activateOnStart=!!o.activateOnStart,o.assignEvents(this),this.reset()}reset(o){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(o)}_move(...o){const u=this._moveFunction(...o);if(u.bearingDelta||u.pitchDelta||u.around||u.panDelta)return this._active=!0,u}dragStart(o,u){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(o)&&(this._moveStateManager.startMove(o),this._lastPoint=u.length?u[0]:u,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(o,u){if(!this.isEnabled())return;const p=this._lastPoint;if(!p)return;if(o.preventDefault(),!this._moveStateManager.isValidMoveEvent(o))return void this.reset(o);const m=u.length?u[0]:u;return!this._moved&&m.dist(p)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=m,this._move(p,m))}dragEnd(o){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(o)&&(this._moved&&be.suppressClick(),this.reset(o))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Zl={0:1,2:2};class Nn{constructor(o){this._correctEvent=o.checkCorrectEvent}startMove(o){const u=be.mouseButton(o);this._eventButton=u}endMove(o){delete this._eventButton}isValidStartEvent(o){return this._correctEvent(o)}isValidMoveEvent(o){return!function(u,p){const m=Zl[p];return void 0===u.buttons||(u.buttons&m)!==m}(o,this._eventButton)}isValidEndEvent(o){return be.mouseButton(o)===this._eventButton}}class Xu{constructor(){this._firstTouch=void 0}_isOneFingerTouch(o){return 1===o.targetTouches.length}_isSameTouchEvent(o){return o.targetTouches[0].identifier===this._firstTouch}startMove(o){this._firstTouch=o.targetTouches[0].identifier}endMove(o){delete this._firstTouch}isValidStartEvent(o){return this._isOneFingerTouch(o)}isValidMoveEvent(o){return this._isOneFingerTouch(o)&&this._isSameTouchEvent(o)}isValidEndEvent(o){return this._isOneFingerTouch(o)&&this._isSameTouchEvent(o)}}const Ge=_=>{_.mousedown=_.dragStart,_.mousemoveWindow=_.dragMove,_.mouseup=_.dragEnd,_.contextmenu=function(o){o.preventDefault()}},Vc=({enable:_,clickTolerance:o,bearingDegreesPerPixelMoved:u=.8})=>{const p=new Nn({checkCorrectEvent:m=>0===be.mouseButton(m)&&m.ctrlKey||2===be.mouseButton(m)});return new pl({clickTolerance:o,move:(m,b)=>({bearingDelta:(b.x-m.x)*u}),moveStateManager:p,enable:_,assignEvents:Ge})},Ni=({enable:_,clickTolerance:o,pitchDegreesPerPixelMoved:u=-.5})=>{const p=new Nn({checkCorrectEvent:m=>0===be.mouseButton(m)&&m.ctrlKey||2===be.mouseButton(m)});return new pl({clickTolerance:o,move:(m,b)=>({pitchDelta:(b.y-m.y)*u}),moveStateManager:p,enable:_,assignEvents:Ge})};class Ap{constructor(o,u){this._minTouches=o.cooperativeGestures?2:1,this._clickTolerance=o.clickTolerance||1,this._map=u,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new g.Point(0,0),setTimeout(()=>{this._cancelCooperativeMessage=!1},200)}touchstart(o,u,p){return this._calculateTransform(o,u,p)}touchmove(o,u,p){if(this._map._cooperativeGestures&&(2===this._minTouches&&p.length<2&&!this._cancelCooperativeMessage?this._map._onCooperativeGesture(o,!1,p.length):this._cancelCooperativeMessage||(this._cancelCooperativeMessage=!0)),this._active&&!(p.length<this._minTouches))return o.preventDefault(),this._calculateTransform(o,u,p)}touchend(o,u,p){this._calculateTransform(o,u,p),this._active&&p.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(o,u,p){p.length>0&&(this._active=!0);const m=Bc(p,u),b=new g.Point(0,0),E=new g.Point(0,0);let D=0;for(const k in m){const R=m[k],F=this._touches[k];F&&(b._add(R),E._add(R.sub(F)),D++,m[k]=R)}if(this._touches=m,D<this._minTouches||!E.mag())return;const M=E.div(D);return this._sum._add(M),this._sum.mag()<this._clickTolerance?void 0:{around:b.div(D),panDelta:M}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class fl{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(o,u,p){this._firstTwoTouches||p.length<2||(this._firstTwoTouches=[p[0].identifier,p[1].identifier],this._start([u[0],u[1]]))}touchmove(o,u,p){if(!this._firstTwoTouches)return;o.preventDefault();const[m,b]=this._firstTwoTouches,E=xt(p,u,m),D=xt(p,u,b);if(!E||!D)return;const M=this._aroundCenter?null:E.add(D).div(2);return this._move([E,D],M,o)}touchend(o,u,p){if(!this._firstTwoTouches)return;const[m,b]=this._firstTwoTouches,E=xt(p,u,m),D=xt(p,u,b);E&&D||(this._active&&be.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(o){this._enabled=!0,this._aroundCenter=!!o&&"center"===o.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function xt(_,o,u){for(let p=0;p<_.length;p++)if(_[p].identifier===u)return o[p]}function Qi(_,o){return Math.log(_/o)/Math.LN2}class tn extends fl{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(o){this._startDistance=this._distance=o[0].dist(o[1])}_move(o,u){const p=this._distance;if(this._distance=o[0].dist(o[1]),this._active||!(Math.abs(Qi(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Qi(this._distance,p),pinchAround:u}}}function zi(_,o){return 180*_.angleWith(o)/Math.PI}class er extends fl{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(o){this._startVector=this._vector=o[0].sub(o[1]),this._minDiameter=o[0].dist(o[1])}_move(o,u){const p=this._vector;if(this._vector=o[0].sub(o[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:zi(this._vector,p),pinchAround:u}}_isBelowThreshold(o){this._minDiameter=Math.min(this._minDiameter,o.mag());const u=25/(Math.PI*this._minDiameter)*360,p=zi(o,this._startVector);return Math.abs(p)<u}}function Gs(_){return Math.abs(_.y)>Math.abs(_.x)}class vr extends fl{constructor(o){super(),this._map=o}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(o,u,p){super.touchstart(o,u,p),this._currentTouchCount=p.length}_start(o){this._lastPoints=o,Gs(o[0].sub(o[1]))&&(this._valid=!1)}_move(o,u,p){if(this._map._cooperativeGestures&&this._currentTouchCount<3)return;const m=o[0].sub(this._lastPoints[0]),b=o[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(m,b,p.timeStamp),this._valid?(this._lastPoints=o,this._active=!0,{pitchDelta:(m.y+b.y)/2*-.5}):void 0}gestureBeginsVertically(o,u,p){if(void 0!==this._valid)return this._valid;const m=o.mag()>=2,b=u.mag()>=2;if(!m&&!b)return;if(!m||!b)return void 0===this._firstMove&&(this._firstMove=p),p-this._firstMove<100&&void 0;const E=o.y>0==u.y>0;return Gs(o)&&Gs(u)&&E}}const Uc={panStep:100,bearingStep:15,pitchStep:10};class br{constructor(o){this._tr=new Gl(o);const u=Uc;this._panStep=u.panStep,this._bearingStep=u.bearingStep,this._pitchStep=u.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(o){if(o.altKey||o.ctrlKey||o.metaKey)return;let u=0,p=0,m=0,b=0,E=0;switch(o.keyCode){case 61:case 107:case 171:case 187:u=1;break;case 189:case 109:case 173:u=-1;break;case 37:o.shiftKey?p=-1:(o.preventDefault(),b=-1);break;case 39:o.shiftKey?p=1:(o.preventDefault(),b=1);break;case 38:o.shiftKey?m=1:(o.preventDefault(),E=-1);break;case 40:o.shiftKey?m=-1:(o.preventDefault(),E=1);break;default:return}return this._rotationDisabled&&(p=0,m=0),{cameraAnimation:D=>{const M=this._tr;D.easeTo({duration:300,easeId:"keyboardHandler",easing:bs,zoom:u?Math.round(M.zoom)+u*(o.shiftKey?2:1):M.zoom,bearing:M.bearing+p*this._bearingStep,pitch:M.pitch+m*this._pitchStep,offset:[-b*this._panStep,-E*this._panStep],center:M.center},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function bs(_){return _*(2-_)}const Ku=4.000244140625;class Yu{constructor(o,u){this._onTimeout=p=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(p)},this._map=o,this._tr=new Gl(o),this._el=o.getCanvasContainer(),this._triggerRenderFrame=u,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(o){this._defaultZoomRate=o}setWheelZoomRate(o){this._wheelZoomRate=o}isEnabled(){return!!this._enabled}isActive(){return!!this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(o){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!o&&"center"===o.around)}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(o){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!o[this._map._metaKey])return;o.preventDefault()}let u=o.deltaMode===WheelEvent.DOM_DELTA_LINE?40*o.deltaY:o.deltaY;const p=g.browser.now(),m=p-(this._lastWheelEventTime||0);this._lastWheelEventTime=p,0!==u&&u%Ku==0?this._type="wheel":0!==u&&Math.abs(u)<4?this._type="trackpad":m>400?(this._type=null,this._lastValue=u,this._timeout=setTimeout(this._onTimeout,40,o)):this._type||(this._type=Math.abs(m*u)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,u+=this._lastValue)),o.shiftKey&&u&&(u/=4),this._type&&(this._lastWheelEvent=o,this._delta-=u,this._active||this._start(o)),o.preventDefault()}_start(o){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const u=be.mousePos(this._el,o),p=this._tr;this._around=g.LngLat.convert(this._aroundCenter?p.center:p.unproject(u)),this._aroundPoint=p.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const o=this._tr.transform;if(0!==this._delta){const D="wheel"===this._type&&Math.abs(this._delta)>Ku?this._wheelZoomRate:this._defaultZoomRate;let M=2/(1+Math.exp(-Math.abs(this._delta*D)));this._delta<0&&0!==M&&(M=1/M);const k="number"==typeof this._targetZoom?o.zoomScale(this._targetZoom):o.scale;this._targetZoom=Math.min(o.maxZoom,Math.max(o.minZoom,o.scaleZoom(k*M))),"wheel"===this._type&&(this._startZoom=o.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const u="number"==typeof this._targetZoom?this._targetZoom:o.zoom,p=this._startZoom,m=this._easing;let b,E=!1;if("wheel"===this._type&&p&&m){const D=Math.min((g.browser.now()-this._lastWheelEventTime)/200,1),M=m(D);b=g.interpolate.number(p,u,M),D<1?this._frameId||(this._frameId=!0):E=!0}else b=u,E=!0;return this._active=!0,E&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!E,zoomDelta:b-o.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(o){let u=g.defaultEasing;if(this._prevEase){const p=this._prevEase,m=(g.browser.now()-p.start)/p.duration,b=p.easing(m+.01)-p.easing(m),E=.27/Math.sqrt(b*b+1e-4)*.01,D=Math.sqrt(.0729-E*E);u=g.bezier(E,D,.25,1)}return this._prevEase={start:g.browser.now(),duration:o,easing:u},u}reset(){this._active=!1}}class Gn{constructor(o,u){this._clickZoom=o,this._tapZoom=u}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Qe{constructor(o){this._tr=new Gl(o),this.reset()}reset(){this._active=!1}dblclick(o,u){return o.preventDefault(),{cameraAnimation:p=>{p.easeTo({duration:300,zoom:this._tr.zoom+(o.shiftKey?-1:1),around:this._tr.unproject(u)},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ot{constructor(){this._tap=new vs({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(o,u,p){if(!this._swipePoint)if(this._tapTime){const m=u[0],b=o.timeStamp-this._tapTime<500,E=this._tapPoint.dist(m)<30;b&&E?p.length>0&&(this._swipePoint=m,this._swipeTouch=p[0].identifier):this.reset()}else this._tap.touchstart(o,u,p)}touchmove(o,u,p){if(this._tapTime){if(this._swipePoint){if(p[0].identifier!==this._swipeTouch)return;const m=u[0],b=m.y-this._swipePoint.y;return this._swipePoint=m,o.preventDefault(),this._active=!0,{zoomDelta:b/128}}}else this._tap.touchmove(o,u,p)}touchend(o,u,p){if(this._tapTime)this._swipePoint&&0===p.length&&this.reset();else{const m=this._tap.touchend(o,u,p);m&&(this._tapTime=o.timeStamp,this._tapPoint=m)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Xt{constructor(o,u,p){this._el=o,this._mousePan=u,this._touchPan=p}enable(o){this._inertiaOptions=o||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Kt{constructor(o,u,p){this._pitchWithRotate=o.pitchWithRotate,this._mouseRotate=u,this._mousePitch=p}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class jo{constructor(o,u,p,m){this._el=o,this._touchZoom=u,this._touchRotate=p,this._tapDragZoom=m,this._rotationDisabled=!1,this._enabled=!0}enable(o){this._touchZoom.enable(o),this._rotationDisabled||this._touchRotate.enable(o),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const pi=_=>_.zoom||_.drag||_.pitch||_.rotate;class ya extends g.Event{}function qn(_){return _.panDelta&&_.panDelta.mag()||_.zoomDelta||_.bearingDelta||_.pitchDelta}class po{constructor(o,u){this.handleWindowEvent=m=>{this.handleEvent(m,`${m.type}Window`)},this.handleEvent=(m,b)=>{if("blur"===m.type)return void this.stop(!0);this._updatingCamera=!0;const E="renderFrame"===m.type?void 0:m,D={needsRenderFrame:!1},M={},k={},R=m.touches,F=R?this._getMapTouches(R):void 0,U=F?be.touchPos(this._el,F):be.mousePos(this._el,m);for(const{handlerName:J,handler:q,allowed:le}of this._handlers){if(!q.isEnabled())continue;let me;this._blockedByActive(k,le,J)?q.reset():q[b||m.type]&&(me=q[b||m.type](m,U,F),this.mergeHandlerResult(D,M,me,J,E),me&&me.needsRenderFrame&&this._triggerRenderFrame()),(me||q.isActive())&&(k[J]=q)}const X={};for(const J in this._previousActiveHandlers)k[J]||(X[J]=E);this._previousActiveHandlers=k,(Object.keys(X).length||qn(D))&&(this._changes.push([D,M,X]),this._triggerRenderFrame()),(Object.keys(k).length||qn(D))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:W}=D;W&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],W(this._map))},this._map=o,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new hl(o),this._bearingSnap=u.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(u);const p=this._el;this._listeners=[[p,"touchstart",{passive:!0}],[p,"touchmove",{passive:!1}],[p,"touchend",void 0],[p,"touchcancel",void 0],[p,"mousedown",void 0],[p,"mousemove",void 0],[p,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[p,"mouseover",void 0],[p,"mouseout",void 0],[p,"dblclick",void 0],[p,"click",void 0],[p,"keydown",{capture:!1}],[p,"keyup",void 0],[p,"wheel",{passive:!1}],[p,"contextmenu",void 0],[window,"blur",void 0]];for(const[m,b,E]of this._listeners)be.addEventListener(m,b,m===document?this.handleWindowEvent:this.handleEvent,E)}destroy(){for(const[o,u,p]of this._listeners)be.removeEventListener(o,u,o===document?this.handleWindowEvent:this.handleEvent,p)}_addDefaultHandlers(o){const u=this._map,p=u.getCanvasContainer();this._add("mapEvent",new Hl(u,o));const m=u.boxZoom=new Tp(u,o);this._add("boxZoom",m),o.interactive&&o.boxZoom&&m.enable();const b=new Je(u),E=new Qe(u);u.doubleClickZoom=new Gn(E,b),this._add("tapZoom",b),this._add("clickZoom",E),o.interactive&&o.doubleClickZoom&&u.doubleClickZoom.enable();const D=new Ot;this._add("tapDragZoom",D);const M=u.touchPitch=new vr(u);this._add("touchPitch",M),o.interactive&&o.touchPitch&&u.touchPitch.enable(o.touchPitch);const k=Vc(o),R=Ni(o);u.dragRotate=new Kt(o,k,R),this._add("mouseRotate",k,["mousePitch"]),this._add("mousePitch",R,["mouseRotate"]),o.interactive&&o.dragRotate&&u.dragRotate.enable();const F=(({enable:le,clickTolerance:me})=>{const te=new Nn({checkCorrectEvent:ce=>0===be.mouseButton(ce)&&!ce.ctrlKey});return new pl({clickTolerance:me,move:(ce,ye)=>({around:ye,panDelta:ye.sub(ce)}),activateOnStart:!0,moveStateManager:te,enable:le,assignEvents:Ge})})(o),U=new Ap(o,u);u.dragPan=new Xt(p,F,U),this._add("mousePan",F),this._add("touchPan",U,["touchZoom","touchRotate"]),o.interactive&&o.dragPan&&u.dragPan.enable(o.dragPan);const X=new er,W=new tn;u.touchZoomRotate=new jo(p,W,X,D),this._add("touchRotate",X,["touchPan","touchZoom"]),this._add("touchZoom",W,["touchPan","touchRotate"]),o.interactive&&o.touchZoomRotate&&u.touchZoomRotate.enable(o.touchZoomRotate);const J=u.scrollZoom=new Yu(u,()=>this._triggerRenderFrame());this._add("scrollZoom",J,["mousePan"]),o.interactive&&o.scrollZoom&&u.scrollZoom.enable(o.scrollZoom);const q=u.keyboard=new br(u);this._add("keyboard",q),o.interactive&&o.keyboard&&u.keyboard.enable(),this._add("blockableMapEvent",new Gd(u))}_add(o,u,p){this._handlers.push({handlerName:o,handler:u,allowed:p}),this._handlersById[o]=u}stop(o){if(!this._updatingCamera){for(const{handler:u}of this._handlers)u.reset();this._inertia.clear(),this._fireEvents({},{},o),this._changes=[]}}isActive(){for(const{handler:o}of this._handlers)if(o.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!pi(this._eventsInProgress)||this.isZooming()}_blockedByActive(o,u,p){for(const m in o)if(m!==p&&(!u||u.indexOf(m)<0))return!0;return!1}_getMapTouches(o){const u=[];for(const p of o)this._el.contains(p.target)&&u.push(p);return u}mergeHandlerResult(o,u,p,m,b){if(!p)return;g.extend(o,p);const E={handlerName:m,originalEvent:p.originalEvent||b};void 0!==p.zoomDelta&&(u.zoom=E),void 0!==p.panDelta&&(u.drag=E),void 0!==p.pitchDelta&&(u.pitch=E),void 0!==p.bearingDelta&&(u.rotate=E)}_applyChanges(){const o={},u={},p={};for(const[m,b,E]of this._changes)m.panDelta&&(o.panDelta=(o.panDelta||new g.Point(0,0))._add(m.panDelta)),m.zoomDelta&&(o.zoomDelta=(o.zoomDelta||0)+m.zoomDelta),m.bearingDelta&&(o.bearingDelta=(o.bearingDelta||0)+m.bearingDelta),m.pitchDelta&&(o.pitchDelta=(o.pitchDelta||0)+m.pitchDelta),void 0!==m.around&&(o.around=m.around),void 0!==m.pinchAround&&(o.pinchAround=m.pinchAround),m.noInertia&&(o.noInertia=m.noInertia),g.extend(u,b),g.extend(p,E);this._updateMapTransform(o,u,p),this._changes=[]}_updateMapTransform(o,u,p){const m=this._map,b=m._getTransformForUpdate(),E=m.terrain;if(!(qn(o)||E&&this._terrainMovement))return this._fireEvents(u,p,!0);let{panDelta:D,zoomDelta:M,bearingDelta:k,pitchDelta:R,around:F,pinchAround:U}=o;void 0!==U&&(F=U),m._stop(!0),F=F||m.transform.centerPoint;const X=b.pointLocation(D?F.sub(D):F);k&&(b.bearing+=k),R&&(b.pitch+=R),M&&(b.zoom+=M),E?this._terrainMovement||!u.drag&&!u.zoom?u.drag&&this._terrainMovement?b.center=b.pointLocation(b.centerPoint.sub(D)):b.setLocationAtPoint(X,F):(this._terrainMovement=!0,this._map._elevationFreeze=!0,b.setLocationAtPoint(X,F),this._map.once("moveend",()=>{this._map._elevationFreeze=!1,this._terrainMovement=!1,b.recalculateZoom(m.terrain)})):b.setLocationAtPoint(X,F),m._applyUpdatedTransform(b),this._map._update(),o.noInertia||this._inertia.record(o),this._fireEvents(u,p,!0)}_fireEvents(o,u,p){const m=pi(this._eventsInProgress),b=pi(o),E={};for(const R in o){const{originalEvent:F}=o[R];this._eventsInProgress[R]||(E[`${R}start`]=F),this._eventsInProgress[R]=o[R]}!m&&b&&this._fireEvent("movestart",b.originalEvent);for(const R in E)this._fireEvent(R,E[R]);b&&this._fireEvent("move",b.originalEvent);for(const R in o){const{originalEvent:F}=o[R];this._fireEvent(R,F)}const D={};let M;for(const R in this._eventsInProgress){const{handlerName:F,originalEvent:U}=this._eventsInProgress[R];this._handlersById[F].isActive()||(delete this._eventsInProgress[R],M=u[F]||U,D[`${R}end`]=M)}for(const R in D)this._fireEvent(R,D[R]);const k=pi(this._eventsInProgress);if(p&&(m||b)&&!k){this._updatingCamera=!0;const R=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),F=U=>0!==U&&-this._bearingSnap<U&&U<this._bearingSnap;R?(F(R.bearing||this._map.getBearing())&&(R.bearing=0),R.freezeElevation=!0,this._map.easeTo(R,{originalEvent:M})):(this._map.fire(new g.Event("moveend",{originalEvent:M})),F(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(o,u){this._map.fire(new g.Event(o,u?{originalEvent:u}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(o=>{delete this._frameId,this.handleEvent(new ya("renderFrame",{timeStamp:o})),this._applyChanges()})}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}class ml extends g.Evented{constructor(o,u){super(),this._renderFrameCallback=()=>{const p=Math.min((g.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(p)),p<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=o,this._bearingSnap=u.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new g.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(o,u){return this.jumpTo({center:o},u)}panBy(o,u,p){return o=g.Point.convert(o).mult(-1),this.panTo(this.transform.center,g.extend({offset:o},u),p)}panTo(o,u,p){return this.easeTo(g.extend({center:o},u),p)}getZoom(){return this.transform.zoom}setZoom(o,u){return this.jumpTo({zoom:o},u),this}zoomTo(o,u,p){return this.easeTo(g.extend({zoom:o},u),p)}zoomIn(o,u){return this.zoomTo(this.getZoom()+1,o,u),this}zoomOut(o,u){return this.zoomTo(this.getZoom()-1,o,u),this}getBearing(){return this.transform.bearing}setBearing(o,u){return this.jumpTo({bearing:o},u),this}getPadding(){return this.transform.padding}setPadding(o,u){return this.jumpTo({padding:o},u),this}rotateTo(o,u,p){return this.easeTo(g.extend({bearing:o},u),p)}resetNorth(o,u){return this.rotateTo(0,g.extend({duration:1e3},o),u),this}resetNorthPitch(o,u){return this.easeTo(g.extend({bearing:0,pitch:0,duration:1e3},o),u),this}snapToNorth(o,u){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(o,u):this}getPitch(){return this.transform.pitch}setPitch(o,u){return this.jumpTo({pitch:o},u),this}cameraForBounds(o,u){o=Yn.convert(o);const p=u&&u.bearing||0;return this._cameraForBoxAndBearing(o.getNorthWest(),o.getSouthEast(),p,u)}_cameraForBoxAndBearing(o,u,p,m){const b={top:0,bottom:0,right:0,left:0};if("number"==typeof(m=g.extend({padding:b,offset:[0,0],maxZoom:this.transform.maxZoom},m)).padding){const ye=m.padding;m.padding={top:ye,bottom:ye,right:ye,left:ye}}m.padding=g.extend(b,m.padding);const E=this.transform,D=E.padding,M=E.project(g.LngLat.convert(o)),k=E.project(g.LngLat.convert(u)),R=M.rotate(-p*Math.PI/180),F=k.rotate(-p*Math.PI/180),U=new g.Point(Math.max(R.x,F.x),Math.max(R.y,F.y)),X=new g.Point(Math.min(R.x,F.x),Math.min(R.y,F.y)),W=U.sub(X),J=(E.width-(D.left+D.right+m.padding.left+m.padding.right))/W.x,q=(E.height-(D.top+D.bottom+m.padding.top+m.padding.bottom))/W.y;if(q<0||J<0)return void g.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const le=Math.min(E.scaleZoom(E.scale*Math.min(J,q)),m.maxZoom),me=g.Point.convert(m.offset),te=new g.Point((m.padding.left-m.padding.right)/2,(m.padding.top-m.padding.bottom)/2).rotate(p*Math.PI/180),ce=me.add(te).mult(E.scale/E.zoomScale(le));return{center:E.unproject(M.add(k).div(2).sub(ce)),zoom:le,bearing:p}}fitBounds(o,u,p){return this._fitInternal(this.cameraForBounds(o,u),u,p)}fitScreenCoordinates(o,u,p,m,b){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(g.Point.convert(o)),this.transform.pointLocation(g.Point.convert(u)),p,m),m,b)}_fitInternal(o,u,p){return o?(delete(u=g.extend(o,u)).padding,u.linear?this.easeTo(u,p):this.flyTo(u,p)):this}jumpTo(o,u){this.stop();const p=this._getTransformForUpdate();let m=!1,b=!1,E=!1;return"zoom"in o&&p.zoom!==+o.zoom&&(m=!0,p.zoom=+o.zoom),void 0!==o.center&&(p.center=g.LngLat.convert(o.center)),"bearing"in o&&p.bearing!==+o.bearing&&(b=!0,p.bearing=+o.bearing),"pitch"in o&&p.pitch!==+o.pitch&&(E=!0,p.pitch=+o.pitch),null==o.padding||p.isPaddingEqual(o.padding)||(p.padding=o.padding),this._applyUpdatedTransform(p),this.fire(new g.Event("movestart",u)).fire(new g.Event("move",u)),m&&this.fire(new g.Event("zoomstart",u)).fire(new g.Event("zoom",u)).fire(new g.Event("zoomend",u)),b&&this.fire(new g.Event("rotatestart",u)).fire(new g.Event("rotate",u)).fire(new g.Event("rotateend",u)),E&&this.fire(new g.Event("pitchstart",u)).fire(new g.Event("pitch",u)).fire(new g.Event("pitchend",u)),this.fire(new g.Event("moveend",u))}calculateCameraOptionsFromTo(o,u,p,m=0){const b=g.MercatorCoordinate.fromLngLat(o,u),E=g.MercatorCoordinate.fromLngLat(p,m),D=E.x-b.x,M=E.y-b.y,k=E.z-b.z,R=Math.hypot(D,M,k);if(0===R)throw new Error("Can't calculate camera options with same From and To");const F=Math.hypot(D,M),U=this.transform.scaleZoom(this.transform.cameraToCenterDistance/R/this.transform.tileSize),X=180*Math.atan2(D,-M)/Math.PI;let W=180*Math.acos(F/R)/Math.PI;return W=k<0?90-W:90+W,{center:E.toLngLat(),zoom:U,pitch:W,bearing:X}}easeTo(o,u){this._stop(!1,o.easeId),(!1===(o=g.extend({offset:[0,0],duration:500,easing:g.defaultEasing},o)).animate||!o.essential&&g.browser.prefersReducedMotion)&&(o.duration=0);const p=this._getTransformForUpdate(),m=this.getZoom(),b=this.getBearing(),E=this.getPitch(),D=this.getPadding(),M="zoom"in o?+o.zoom:m,k="bearing"in o?this._normalizeBearing(o.bearing,b):b,R="pitch"in o?+o.pitch:E,F="padding"in o?o.padding:p.padding,U=g.Point.convert(o.offset);let X=p.centerPoint.add(U);const W=p.pointLocation(X),J=g.LngLat.convert(o.center||W);this._normalizeCenter(J);const q=p.project(W),le=p.project(J).sub(q),me=p.zoomScale(M-m);let te,ce;o.around&&(te=g.LngLat.convert(o.around),ce=p.locationPoint(te));const ye={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||M!==m,this._rotating=this._rotating||b!==k,this._pitching=this._pitching||R!==E,this._padding=!p.isPaddingEqual(F),this._easeId=o.easeId,this._prepareEase(u,o.noMoveStart,ye),this.terrain&&this._prepareElevation(J),this._ease(ve=>{if(this._zooming&&(p.zoom=g.interpolate.number(m,M,ve)),this._rotating&&(p.bearing=g.interpolate.number(b,k,ve)),this._pitching&&(p.pitch=g.interpolate.number(E,R,ve)),this._padding&&(p.interpolatePadding(D,F,ve),X=p.centerPoint.add(U)),this.terrain&&!o.freezeElevation&&this._updateElevation(ve),te)p.setLocationAtPoint(te,ce);else{const Se=p.zoomScale(p.zoom-m),ke=M>m?Math.min(2,me):Math.max(.5,me),De=Math.pow(ke,1-ve),Le=p.unproject(q.add(le.mult(ve*De)).mult(Se));p.setLocationAtPoint(p.renderWorldCopies?Le.wrap():Le,X)}this._applyUpdatedTransform(p),this._fireMoveEvents(u)},ve=>{this.terrain&&this._finalizeElevation(),this._afterEase(u,ve)},o),this}_prepareEase(o,u,p={}){this._moving=!0,u||p.moving||this.fire(new g.Event("movestart",o)),this._zooming&&!p.zooming&&this.fire(new g.Event("zoomstart",o)),this._rotating&&!p.rotating&&this.fire(new g.Event("rotatestart",o)),this._pitching&&!p.pitching&&this.fire(new g.Event("pitchstart",o))}_prepareElevation(o){this._elevationCenter=o,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(o,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(o){this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);const u=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(o<1&&u!==this._elevationTarget){const p=this._elevationTarget-this._elevationStart;this._elevationStart+=o*(p-(u-(p*o+this._elevationStart))/(1-o)),this._elevationTarget=u}this.transform.elevation=g.interpolate.number(this._elevationStart,this._elevationTarget,o)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_applyUpdatedTransform(o){if(!this.transformCameraUpdate)return;const u=o.clone(),{center:p,zoom:m,pitch:b,bearing:E,elevation:D}=this.transformCameraUpdate(u);p&&(u.center=p),void 0!==m&&(u.zoom=m),void 0!==b&&(u.pitch=b),void 0!==E&&(u.bearing=E),void 0!==D&&(u.elevation=D),this.transform.apply(u)}_fireMoveEvents(o){this.fire(new g.Event("move",o)),this._zooming&&this.fire(new g.Event("zoom",o)),this._rotating&&this.fire(new g.Event("rotate",o)),this._pitching&&this.fire(new g.Event("pitch",o))}_afterEase(o,u){if(this._easeId&&u&&this._easeId===u)return;delete this._easeId;const p=this._zooming,m=this._rotating,b=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,p&&this.fire(new g.Event("zoomend",o)),m&&this.fire(new g.Event("rotateend",o)),b&&this.fire(new g.Event("pitchend",o)),this.fire(new g.Event("moveend",o))}flyTo(o,u){if(!o.essential&&g.browser.prefersReducedMotion){const rt=g.pick(o,["center","zoom","bearing","pitch","around"]);return this.jumpTo(rt,u)}this.stop(),o=g.extend({offset:[0,0],speed:1.2,curve:1.42,easing:g.defaultEasing},o);const p=this._getTransformForUpdate(),m=this.getZoom(),b=this.getBearing(),E=this.getPitch(),D=this.getPadding(),M="zoom"in o?g.clamp(+o.zoom,p.minZoom,p.maxZoom):m,k="bearing"in o?this._normalizeBearing(o.bearing,b):b,R="pitch"in o?+o.pitch:E,F="padding"in o?o.padding:p.padding,U=p.zoomScale(M-m),X=g.Point.convert(o.offset);let W=p.centerPoint.add(X);const J=p.pointLocation(W),q=g.LngLat.convert(o.center||J);this._normalizeCenter(q);const le=p.project(J),me=p.project(q).sub(le);let te=o.curve;const ce=Math.max(p.width,p.height),ye=ce/U,ve=me.mag();if("minZoom"in o){const rt=g.clamp(Math.min(o.minZoom,m,M),p.minZoom,p.maxZoom),Pn=ce/p.zoomScale(rt-m);te=Math.sqrt(Pn/ve*2)}const Se=te*te;function ke(rt){const Pn=(ye*ye-ce*ce+(rt?-1:1)*Se*Se*ve*ve)/(2*(rt?ye:ce)*Se*ve);return Math.log(Math.sqrt(Pn*Pn+1)-Pn)}function De(rt){return(Math.exp(rt)-Math.exp(-rt))/2}function Le(rt){return(Math.exp(rt)+Math.exp(-rt))/2}const We=ke(!1);let zt=function(rt){return Le(We)/Le(We+te*rt)},Ue=function(rt){return ce*((Le(We)*(De(Pn=We+te*rt)/Le(Pn))-De(We))/Se)/ve;var Pn},dt=(ke(!0)-We)/te;if(Math.abs(ve)<1e-6||!isFinite(dt)){if(Math.abs(ce-ye)<1e-6)return this.easeTo(o,u);const rt=ye<ce?-1:1;dt=Math.abs(Math.log(ye/ce))/te,Ue=function(){return 0},zt=function(Pn){return Math.exp(rt*te*Pn)}}return o.duration="duration"in o?+o.duration:1e3*dt/("screenSpeed"in o?+o.screenSpeed/te:+o.speed),o.maxDuration&&o.duration>o.maxDuration&&(o.duration=0),this._zooming=!0,this._rotating=b!==k,this._pitching=R!==E,this._padding=!p.isPaddingEqual(F),this._prepareEase(u,!1),this.terrain&&this._prepareElevation(q),this._ease(rt=>{const Pn=rt*dt,Bt=1/zt(Pn);p.zoom=1===rt?M:m+p.scaleZoom(Bt),this._rotating&&(p.bearing=g.interpolate.number(b,k,rt)),this._pitching&&(p.pitch=g.interpolate.number(E,R,rt)),this._padding&&(p.interpolatePadding(D,F,rt),W=p.centerPoint.add(X)),this.terrain&&!o.freezeElevation&&this._updateElevation(rt);const ht=1===rt?q:p.unproject(le.add(me.mult(Ue(Pn))).mult(Bt));p.setLocationAtPoint(p.renderWorldCopies?ht.wrap():ht,W),this._applyUpdatedTransform(p),this._fireMoveEvents(u)},()=>{this.terrain&&this._finalizeElevation(),this._afterEase(u)},o),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(o,u){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const p=this._onEaseEnd;delete this._onEaseEnd,p.call(this,u)}if(!o){const p=this.handlers;p&&p.stop(!1)}return this}_ease(o,u,p){!1===p.animate||0===p.duration?(o(1),u()):(this._easeStart=g.browser.now(),this._easeOptions=p,this._onEaseFrame=o,this._onEaseEnd=u,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(o,u){o=g.wrap(o,-180,180);const p=Math.abs(o-u);return Math.abs(o-360-u)<p&&(o-=360),Math.abs(o+360-u)<p&&(o+=360),o}_normalizeCenter(o){const u=this.transform;if(!u.renderWorldCopies||u.lngRange)return;const p=o.lng-u.center.lng;o.lng+=p>180?-360:p<-180?360:0}queryTerrainElevation(o){return this.terrain?this.terrain.getElevationForLngLatZoom(g.LngLat.convert(o),this.transform.tileZoom)-this.transform.elevation:null}}class wt{constructor(o={}){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=u=>{!u||"metadata"!==u.sourceDataType&&"visibility"!==u.sourceDataType&&"style"!==u.dataType&&"terrain"!==u.type||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?!1===this._compact?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=o}getDefaultPosition(){return"bottom-right"}onAdd(o){return this._map=o,this._compact=this.options&&this.options.compact,this._container=be.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=be.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=be.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){be.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(o,u){const p=this._map._getUIString(`AttributionControl.${u}`);o.title=p,o.setAttribute("aria-label",p)}_updateAttributions(){if(!this._map.style)return;let o=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?o=o.concat(this.options.customAttribution.map(m=>"string"!=typeof m?"":m)):"string"==typeof this.options.customAttribution&&o.push(this.options.customAttribution)),this._map.style.stylesheet){const m=this._map.style.stylesheet;this.styleOwner=m.owner,this.styleId=m.id}const u=this._map.style.sourceCaches;for(const m in u){const b=u[m];if(b.used||b.usedForTerrain){const E=b.getSource();E.attribution&&o.indexOf(E.attribution)<0&&o.push(E.attribution)}}o=o.filter(m=>String(m).trim()),o.sort((m,b)=>m.length-b.length),o=o.filter((m,b)=>{for(let E=b+1;E<o.length;E++)if(o[E].indexOf(m)>=0)return!1;return!0});const p=o.join(" | ");p!==this._attribHTML&&(this._attribHTML=p,o.length?(this._innerContainer.innerHTML=p,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class fo{constructor(o={}){this._updateCompact=()=>{const u=this._container.children;if(u.length){const p=u[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?!1!==this._compact&&p.classList.add("maplibregl-compact"):p.classList.remove("maplibregl-compact")}},this.options=o}getDefaultPosition(){return"bottom-left"}onAdd(o){this._map=o,this._compact=this.options&&this.options.compact,this._container=be.create("div","maplibregl-ctrl");const u=be.create("a","maplibregl-ctrl-logo");return u.target="_blank",u.rel="noopener nofollow",u.href="https://maplibre.org/",u.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),u.setAttribute("rel","noopener nofollow"),this._container.appendChild(u),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){be.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class lt{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(o){const u=++this._id;return this._queue.push({callback:o,id:u,cancelled:!1}),u}remove(o){const u=this._currentlyRunning,p=u?this._queue.concat(u):this._queue;for(const m of p)if(m.id===o)return void(m.cancelled=!0)}run(o=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const u=this._currentlyRunning=this._queue;this._queue=[];for(const p of u)if(!p.cancelled&&(p.callback(o),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}const ft={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.enableTerrain":"Enable terrain","TerrainControl.disableTerrain":"Disable terrain"};var Zn=g.createLayout([{name:"a_pos3d",type:"Int16",components:3}]);class va extends g.Evented{constructor(o){super(),this.sourceCache=o,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,o.usedForTerrain=!0,o.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(o,u){this.sourceCache.update(o,u),this._renderableTilesKeys=[];const p={};for(const m of o.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:u}))p[m.key]=!0,this._renderableTilesKeys.push(m.key),this._tiles[m.key]||(m.posMatrix=new Float64Array(16),g.ortho(m.posMatrix,0,g.EXTENT,0,g.EXTENT,0,1),this._tiles[m.key]=new Qa(m,this.tileSize));for(const m in this._tiles)p[m]||delete this._tiles[m]}freeRtt(o){for(const u in this._tiles){const p=this._tiles[u];(!o||p.tileID.equals(o)||p.tileID.isChildOf(o)||o.isChildOf(p.tileID))&&(p.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(o=>this.getTileByID(o))}getTileByID(o){return this._tiles[o]}getTerrainCoords(o){const u={};for(const p of this._renderableTilesKeys){const m=this._tiles[p].tileID;if(m.canonical.equals(o.canonical)){const b=o.clone();b.posMatrix=new Float64Array(16),g.ortho(b.posMatrix,0,g.EXTENT,0,g.EXTENT,0,1),u[p]=b}else if(m.canonical.isChildOf(o.canonical)){const b=o.clone();b.posMatrix=new Float64Array(16);const E=m.canonical.z-o.canonical.z,D=m.canonical.x-(m.canonical.x>>E<<E),M=m.canonical.y-(m.canonical.y>>E<<E),k=g.EXTENT>>E;g.ortho(b.posMatrix,0,k,0,k,0,1),g.translate(b.posMatrix,b.posMatrix,[-D*k,-M*k,0]),u[p]=b}else if(o.canonical.isChildOf(m.canonical)){const b=o.clone();b.posMatrix=new Float64Array(16);const E=o.canonical.z-m.canonical.z,D=o.canonical.x-(o.canonical.x>>E<<E),M=o.canonical.y-(o.canonical.y>>E<<E),k=g.EXTENT>>E;g.ortho(b.posMatrix,0,g.EXTENT,0,g.EXTENT,0,1),g.translate(b.posMatrix,b.posMatrix,[D*k,M*k,0]),g.scale(b.posMatrix,b.posMatrix,[1/2**E,1/2**E,0]),u[p]=b}}return u}getSourceTile(o,u){const p=this.sourceCache._source;let m=o.overscaledZ-this.deltaZoom;if(m>p.maxzoom&&(m=p.maxzoom),m<p.minzoom)return null;this._sourceTileCache[o.key]||(this._sourceTileCache[o.key]=o.scaledTo(m).key);let b=this.sourceCache.getTileByID(this._sourceTileCache[o.key]);if((!b||!b.dem)&&u)for(;m>=p.minzoom&&(!b||!b.dem);)b=this.sourceCache.getTileByID(o.scaledTo(m--).key);return b}tilesAfterTime(o=Date.now()){return Object.values(this._tiles).filter(u=>u.timeAdded>=o)}}class $o{constructor(o,u,p){this.painter=o,this.sourceCache=new va(u),this.options=p,this.exaggeration="number"==typeof p.exaggeration?p.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(o,u,p,m=g.EXTENT){var b;if(!(u>=0&&u<m&&p>=0&&p<m))return 0;const E=this.getTerrainData(o),D=null===(b=E.tile)||void 0===b?void 0:b.dem;if(!D)return 0;const M=((W=[])[0]=(q=E.u_terrain_matrix)[0]*(le=(J=[u/m*g.EXTENT,p/m*g.EXTENT])[0])+q[4]*(me=J[1])+q[12],W[1]=q[1]*le+q[5]*me+q[13],W),k=[M[0]*D.dim,M[1]*D.dim],R=Math.floor(k[0]),F=Math.floor(k[1]),U=k[0]-R,X=k[1]-F;var W,J,q,le,me;return D.get(R,F)*(1-U)*(1-X)+D.get(R+1,F)*U*(1-X)+D.get(R,F+1)*(1-U)*X+D.get(R+1,F+1)*U*X}getElevationForLngLatZoom(o,u){const{tileID:p,mercatorX:m,mercatorY:b}=this._getOverscaledTileIDFromLngLatZoom(o,u);return this.getElevation(p,m%g.EXTENT,b%g.EXTENT,g.EXTENT)}getElevation(o,u,p,m=g.EXTENT){return this.getDEMElevation(o,u,p,m)*this.exaggeration}getTerrainData(o){if(!this._emptyDemTexture){const m=this.painter.context,b=new g.RGBAImage({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new gn(m,b,m.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new gn(m,new g.RGBAImage({width:1,height:1}),m.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(m.gl.NEAREST,m.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=g.identity([])}const u=this.sourceCache.getSourceTile(o,!0);if(u&&u.dem&&(!u.demTexture||u.needsTerrainPrepare)){const m=this.painter.context;u.demTexture=this.painter.getTileTexture(u.dem.stride),u.demTexture?u.demTexture.update(u.dem.getPixels(),{premultiply:!1}):u.demTexture=new gn(m,u.dem.getPixels(),m.gl.RGBA,{premultiply:!1}),u.demTexture.bind(m.gl.NEAREST,m.gl.CLAMP_TO_EDGE),u.needsTerrainPrepare=!1}const p=u&&u+u.tileID.key+o.key;if(p&&!this._demMatrixCache[p]){const m=this.sourceCache.sourceCache._source.maxzoom;let b=o.canonical.z-u.tileID.canonical.z;o.overscaledZ>o.canonical.z&&(o.canonical.z>=m?b=o.canonical.z-m:g.warnOnce("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const E=o.canonical.x-(o.canonical.x>>b<<b),D=o.canonical.y-(o.canonical.y>>b<<b),M=g.fromScaling(new Float64Array(16),[1/(g.EXTENT<<b),1/(g.EXTENT<<b),0]);g.translate(M,M,[E*g.EXTENT,D*g.EXTENT,0]),this._demMatrixCache[o.key]={matrix:M,coord:o}}return{u_depth:2,u_terrain:3,u_terrain_dim:u&&u.dem&&u.dem.dim||1,u_terrain_matrix:p?this._demMatrixCache[o.key].matrix:this._emptyDemMatrix,u_terrain_unpack:u&&u.dem&&u.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(u&&u.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:u}}getFramebuffer(o){const u=this.painter,p=u.width/devicePixelRatio,m=u.height/devicePixelRatio;return!this._fbo||this._fbo.width===p&&this._fbo.height===m||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new gn(u.context,{width:p,height:m,data:null},u.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(u.context.gl.NEAREST,u.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new gn(u.context,{width:p,height:m,data:null},u.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(u.context.gl.NEAREST,u.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=u.context.createFramebuffer(p,m,!0,!1),this._fbo.depthAttachment.set(u.context.createRenderbuffer(u.context.gl.DEPTH_COMPONENT16,p,m))),this._fbo.colorAttachment.set("coords"===o?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const o=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const u=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let b=0,E=0;b<this._coordsTextureSize;b++)for(let D=0;D<this._coordsTextureSize;D++,E+=4)u[E+0]=255&D,u[E+1]=255&b,u[E+2]=D>>8<<4|b>>8,u[E+3]=0;const p=new g.RGBAImage({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(u.buffer)),m=new gn(o,p,o.gl.RGBA,{premultiply:!1});return m.bind(o.gl.NEAREST,o.gl.CLAMP_TO_EDGE),this._coordsTexture=m,m}pointCoordinate(o){const u=new Uint8Array(4),p=this.painter.context,m=p.gl;p.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),m.readPixels(o.x,this.painter.height/devicePixelRatio-o.y-1,1,1,m.RGBA,m.UNSIGNED_BYTE,u),p.bindFramebuffer.set(null);const b=u[0]+(u[2]>>4<<8),E=u[1]+((15&u[2])<<8),D=this.coordsIndex[255-u[3]],M=D&&this.sourceCache.getTileByID(D);if(!M)return null;const k=this._coordsTextureSize,R=(1<<M.tileID.canonical.z)*k;return new g.MercatorCoordinate((M.tileID.canonical.x*k+b)/R,(M.tileID.canonical.y*k+E)/R,this.getElevation(M.tileID,b,E,k))}getTerrainMesh(){if(this._mesh)return this._mesh;const o=this.painter.context,u=new g.Pos3dArray,p=new g.TriangleIndexArray,m=this.meshSize,b=g.EXTENT/m,E=m*m;for(let F=0;F<=m;F++)for(let U=0;U<=m;U++)u.emplaceBack(U*b,F*b,0);for(let F=0;F<E;F+=m+1)for(let U=0;U<m;U++)p.emplaceBack(U+F,m+U+F+1,m+U+F+2),p.emplaceBack(U+F,m+U+F+2,U+F+1);const D=u.length,M=D+2*(m+1);for(const F of[0,1])for(let U=0;U<=m;U++)for(const X of[0,1])u.emplaceBack(U*b,F*g.EXTENT,X);for(let F=0;F<2*m;F+=2)p.emplaceBack(M+F,M+F+1,M+F+3),p.emplaceBack(M+F,M+F+3,M+F+2),p.emplaceBack(D+F,D+F+3,D+F+1),p.emplaceBack(D+F,D+F+2,D+F+3);const k=u.length,R=k+2*(m+1);for(const F of[0,1])for(let U=0;U<=m;U++)for(const X of[0,1])u.emplaceBack(F*g.EXTENT,U*b,X);for(let F=0;F<2*m;F+=2)p.emplaceBack(k+F,k+F+1,k+F+3),p.emplaceBack(k+F,k+F+3,k+F+2),p.emplaceBack(R+F,R+F+3,R+F+1),p.emplaceBack(R+F,R+F+2,R+F+3);return this._mesh={indexBuffer:o.createIndexBuffer(p),vertexBuffer:o.createVertexBuffer(u,Zn.members),segments:g.SegmentVector.simpleSegment(0,0,u.length,p.length)},this._mesh}getMeshFrameDelta(o){return 2*Math.PI*g.earthRadius/Math.pow(2,o)/5}getMinTileElevationForLngLatZoom(o,u){var p;const{tileID:m}=this._getOverscaledTileIDFromLngLatZoom(o,u);return null!==(p=this.getMinMaxElevation(m).minElevation)&&void 0!==p?p:0}getMinMaxElevation(o){const u=this.getTerrainData(o).tile,p={minElevation:null,maxElevation:null};return u&&u.dem&&(p.minElevation=u.dem.min*this.exaggeration,p.maxElevation=u.dem.max*this.exaggeration),p}_getOverscaledTileIDFromLngLatZoom(o,u){const p=g.MercatorCoordinate.fromLngLat(o.wrap()),m=(1<<u)*g.EXTENT,b=p.x*m,E=p.y*m,D=Math.floor(b/g.EXTENT),M=Math.floor(E/g.EXTENT);return{tileID:new g.OverscaledTileID(u,0,u,D,M),mercatorX:b,mercatorY:E}}}class ei{constructor(o,u,p){this._context=o,this._size=u,this._tileSize=p,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const o of this._objects)o.texture.destroy(),o.fbo.destroy()}_createObject(o){const u=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),p=new gn(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return p.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),u.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),u.colorAttachment.set(p.texture),{id:o,fbo:u,texture:p,stamp:-1,inUse:!1}}getObjectForId(o){return this._objects[o]}useObject(o){o.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(u=>o.id!==u),this._recentlyUsed.push(o.id)}stampObject(o){o.stamp=++this._stamp}getOrCreateFreeObject(){for(const u of this._recentlyUsed)if(!this._objects[u].inUse)return this._objects[u];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const o=this._createObject(this._objects.length);return this._objects.push(o),o}freeObject(o){o.inUse=!1}freeAllObjects(){for(const o of this._objects)this.freeObject(o)}isFull(){return!(this._objects.length<this._size)&&!1===this._objects.some(o=>!o.inUse)}}const xs={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class ws{constructor(o,u){this.painter=o,this.terrain=u,this.pool=new ei(o.context,30,u.sourceCache.tileSize*u.qualityFactor)}destruct(){this.pool.destruct()}getTexture(o){return this.pool.getObjectForId(o.rtt[this._stacks.length-1].id).texture}prepareForRender(o,u){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=o._order.filter(p=>!o._layers[p].isHidden(u)),this._coordsDescendingInv={};for(const p in o.sourceCaches){this._coordsDescendingInv[p]={};const m=o.sourceCaches[p].getVisibleCoordinates();for(const b of m){const E=this.terrain.sourceCache.getTerrainCoords(b);for(const D in E)this._coordsDescendingInv[p][D]||(this._coordsDescendingInv[p][D]=[]),this._coordsDescendingInv[p][D].push(E[D])}}this._coordsDescendingInvStr={};for(const p of o._order){const m=o._layers[p],b=m.source;if(xs[m.type]&&!this._coordsDescendingInvStr[b]){this._coordsDescendingInvStr[b]={};for(const E in this._coordsDescendingInv[b])this._coordsDescendingInvStr[b][E]=this._coordsDescendingInv[b][E].map(D=>D.key).sort().join()}}for(const p of this._renderableTiles)for(const m in this._coordsDescendingInvStr){const b=this._coordsDescendingInvStr[m][p.tileID.key];b&&b!==p.rttCoords[m]&&(p.rtt=[])}}renderLayer(o){if(o.isHidden(this.painter.transform.zoom))return!1;const u=o.type,p=this.painter,m=this._renderableLayerIds[this._renderableLayerIds.length-1]===o.id;if(xs[u]&&(this._prevType&&xs[this._prevType]||this._stacks.push([]),this._prevType=u,this._stacks[this._stacks.length-1].push(o.id),!m))return!0;if(xs[this._prevType]||xs[u]&&m){this._prevType=u;const b=this._stacks.length-1,E=this._stacks[b]||[];for(const D of this._renderableTiles){if(this.pool.isFull()&&(ga(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(D),D.rtt[b]){const k=this.pool.getObjectForId(D.rtt[b].id);if(k.stamp===D.rtt[b].stamp){this.pool.useObject(k);continue}}const M=this.pool.getOrCreateFreeObject();this.pool.useObject(M),this.pool.stampObject(M),D.rtt[b]={id:M.id,stamp:M.stamp},p.context.bindFramebuffer.set(M.fbo.framebuffer),p.context.clear({color:g.Color.transparent,stencil:0}),p.currentStencilSource=void 0;for(let k=0;k<E.length;k++){const R=p.style._layers[E[k]],F=R.source?this._coordsDescendingInv[R.source][D.tileID.key]:[D.tileID];p.context.viewport.set([0,0,M.fbo.width,M.fbo.height]),p._renderTileClippingMasks(R,F),p.renderLayer(p,p.style.sourceCaches[R.source],R,F),R.source&&(D.rttCoords[R.source]=this._coordsDescendingInvStr[R.source][D.tileID.key])}}return ga(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),xs[u]}return!1}}const Gr={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:void 0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:g.config.MAX_TILE_CACHE_ZOOM_LEVELS,localIdeographFontFamily:"sans-serif",transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,validateStyle:!0,maxCanvasSize:[4096,4096]},Sn=_=>{_.touchstart=_.dragStart,_.touchmoveWindow=_.dragMove,_.touchend=_.dragEnd},Un={showCompass:!0,showZoom:!0,visualizePitch:!1};class Ht{constructor(o,u,p=!1){this.mousedown=E=>{this.startMouse(g.extend({},E,{ctrlKey:!0,preventDefault:()=>E.preventDefault()}),be.mousePos(this.element,E)),be.addEventListener(window,"mousemove",this.mousemove),be.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=E=>{this.moveMouse(E,be.mousePos(this.element,E))},this.mouseup=E=>{this.mouseRotate.dragEnd(E),this.mousePitch&&this.mousePitch.dragEnd(E),this.offTemp()},this.touchstart=E=>{1!==E.targetTouches.length?this.reset():(this._startPos=this._lastPos=be.touchPos(this.element,E.targetTouches)[0],this.startTouch(E,this._startPos),be.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),be.addEventListener(window,"touchend",this.touchend))},this.touchmove=E=>{1!==E.targetTouches.length?this.reset():(this._lastPos=be.touchPos(this.element,E.targetTouches)[0],this.moveTouch(E,this._lastPos))},this.touchend=E=>{0===E.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;const m=o.dragRotate._mouseRotate.getClickTolerance(),b=o.dragRotate._mousePitch.getClickTolerance();this.element=u,this.mouseRotate=Vc({clickTolerance:m,enable:!0}),this.touchRotate=(({enable:E,clickTolerance:D,bearingDegreesPerPixelMoved:M=.8})=>{const k=new Xu;return new pl({clickTolerance:D,move:(R,F)=>({bearingDelta:(F.x-R.x)*M}),moveStateManager:k,enable:E,assignEvents:Sn})})({clickTolerance:m,enable:!0}),this.map=o,p&&(this.mousePitch=Ni({clickTolerance:b,enable:!0}),this.touchPitch=(({enable:E,clickTolerance:D,pitchDegreesPerPixelMoved:M=-.5})=>{const k=new Xu;return new pl({clickTolerance:D,move:(R,F)=>({pitchDelta:(F.y-R.y)*M}),moveStateManager:k,enable:E,assignEvents:Sn})})({clickTolerance:b,enable:!0})),be.addEventListener(u,"mousedown",this.mousedown),be.addEventListener(u,"touchstart",this.touchstart,{passive:!1}),be.addEventListener(u,"touchcancel",this.reset)}startMouse(o,u){this.mouseRotate.dragStart(o,u),this.mousePitch&&this.mousePitch.dragStart(o,u),be.disableDrag()}startTouch(o,u){this.touchRotate.dragStart(o,u),this.touchPitch&&this.touchPitch.dragStart(o,u),be.disableDrag()}moveMouse(o,u){const p=this.map,{bearingDelta:m}=this.mouseRotate.dragMove(o,u)||{};if(m&&p.setBearing(p.getBearing()+m),this.mousePitch){const{pitchDelta:b}=this.mousePitch.dragMove(o,u)||{};b&&p.setPitch(p.getPitch()+b)}}moveTouch(o,u){const p=this.map,{bearingDelta:m}=this.touchRotate.dragMove(o,u)||{};if(m&&p.setBearing(p.getBearing()+m),this.touchPitch){const{pitchDelta:b}=this.touchPitch.dragMove(o,u)||{};b&&p.setPitch(p.getPitch()+b)}}off(){const o=this.element;be.removeEventListener(o,"mousedown",this.mousedown),be.removeEventListener(o,"touchstart",this.touchstart,{passive:!1}),be.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),be.removeEventListener(window,"touchend",this.touchend),be.removeEventListener(o,"touchcancel",this.reset),this.offTemp()}offTemp(){be.enableDrag(),be.removeEventListener(window,"mousemove",this.mousemove),be.removeEventListener(window,"mouseup",this.mouseup),be.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),be.removeEventListener(window,"touchend",this.touchend)}}let Cs;function ba(_,o,u){if(_=new g.LngLat(_.lng,_.lat),o){const p=new g.LngLat(_.lng-360,_.lat),m=new g.LngLat(_.lng+360,_.lat),b=u.locationPoint(_).distSqr(o);u.locationPoint(p).distSqr(o)<b?_=p:u.locationPoint(m).distSqr(o)<b&&(_=m)}for(;Math.abs(_.lng-u.center.lng)>180;){const p=u.locationPoint(_);if(p.x>=0&&p.y>=0&&p.x<=u.width&&p.y<=u.height)break;_.lng>u.center.lng?_.lng-=360:_.lng+=360}return _}const gl={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function qr(_,o,u){const p=_.classList;for(const m in gl)p.remove(`maplibregl-${u}-anchor-${m}`);p.add(`maplibregl-${u}-anchor-${o}`)}class Go extends g.Evented{constructor(o){if(super(),this._onKeyPress=u=>{const p=u.code,m=u.charCode||u.keyCode;"Space"!==p&&"Enter"!==p&&32!==m&&13!==m||this.togglePopup()},this._onMapClick=u=>{const p=u.originalEvent.target,m=this._element;this._popup&&(p===m||m.contains(p))&&this.togglePopup()},this._update=u=>{if(!this._map)return;this._map.transform.renderWorldCopies&&(this._lngLat=ba(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);let p="";"viewport"===this._rotationAlignment||"auto"===this._rotationAlignment?p=`rotateZ(${this._rotation}deg)`:"map"===this._rotationAlignment&&(p=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let m="";"viewport"===this._pitchAlignment||"auto"===this._pitchAlignment?m="rotateX(0deg)":"map"===this._pitchAlignment&&(m=`rotateX(${this._map.getPitch()}deg)`),u&&"moveend"!==u.type||(this._pos=this._pos.round()),be.setTransform(this._element,`${gl[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${m} ${p}`),this._map.terrain&&!this._opacityTimeout&&(this._opacityTimeout=setTimeout(()=>{const b=this._map.unproject(this._pos),E=40075016.686*Math.abs(Math.cos(this._lngLat.lat*Math.PI/180))/Math.pow(2,this._map.transform.tileZoom+8);this._element.style.opacity=b.distanceTo(this._lngLat)>20*E?"0.2":"1.0",this._opacityTimeout=null},100))},this._onMove=u=>{if(!this._isDragging){const p=this._clickTolerance||this._map._clickTolerance;this._isDragging=u.point.dist(this._pointerdownPos)>=p}this._isDragging&&(this._pos=u.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new g.Event("dragstart"))),this.fire(new g.Event("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new g.Event("dragend")),this._state="inactive"},this._addDragHandler=u=>{this._element.contains(u.originalEvent.target)&&(u.preventDefault(),this._positionDelta=u.point.sub(this._pos).add(this._offset),this._pointerdownPos=u.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=o&&o.anchor||"center",this._color=o&&o.color||"#3FB1CE",this._scale=o&&o.scale||1,this._draggable=o&&o.draggable||!1,this._clickTolerance=o&&o.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=o&&o.rotation||0,this._rotationAlignment=o&&o.rotationAlignment||"auto",this._pitchAlignment=o&&o.pitchAlignment&&"auto"!==o.pitchAlignment?o.pitchAlignment:this._rotationAlignment,o&&o.element)this._element=o.element,this._offset=g.Point.convert(o&&o.offset||[0,0]);else{this._defaultMarker=!0,this._element=be.create("div"),this._element.setAttribute("aria-label","Map marker");const u=be.createNS("http://www.w3.org/2000/svg","svg"),p=41,m=27;u.setAttributeNS(null,"display","block"),u.setAttributeNS(null,"height",`${p}px`),u.setAttributeNS(null,"width",`${m}px`),u.setAttributeNS(null,"viewBox",`0 0 ${m} ${p}`);const b=be.createNS("http://www.w3.org/2000/svg","g");b.setAttributeNS(null,"stroke","none"),b.setAttributeNS(null,"stroke-width","1"),b.setAttributeNS(null,"fill","none"),b.setAttributeNS(null,"fill-rule","evenodd");const E=be.createNS("http://www.w3.org/2000/svg","g");E.setAttributeNS(null,"fill-rule","nonzero");const D=be.createNS("http://www.w3.org/2000/svg","g");D.setAttributeNS(null,"transform","translate(3.0, 29.0)"),D.setAttributeNS(null,"fill","#000000");const M=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const le of M){const me=be.createNS("http://www.w3.org/2000/svg","ellipse");me.setAttributeNS(null,"opacity","0.04"),me.setAttributeNS(null,"cx","10.5"),me.setAttributeNS(null,"cy","5.80029008"),me.setAttributeNS(null,"rx",le.rx),me.setAttributeNS(null,"ry",le.ry),D.appendChild(me)}const k=be.createNS("http://www.w3.org/2000/svg","g");k.setAttributeNS(null,"fill",this._color);const R=be.createNS("http://www.w3.org/2000/svg","path");R.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),k.appendChild(R);const F=be.createNS("http://www.w3.org/2000/svg","g");F.setAttributeNS(null,"opacity","0.25"),F.setAttributeNS(null,"fill","#000000");const U=be.createNS("http://www.w3.org/2000/svg","path");U.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),F.appendChild(U);const X=be.createNS("http://www.w3.org/2000/svg","g");X.setAttributeNS(null,"transform","translate(6.0, 7.0)"),X.setAttributeNS(null,"fill","#FFFFFF");const W=be.createNS("http://www.w3.org/2000/svg","g");W.setAttributeNS(null,"transform","translate(8.0, 8.0)");const J=be.createNS("http://www.w3.org/2000/svg","circle");J.setAttributeNS(null,"fill","#000000"),J.setAttributeNS(null,"opacity","0.25"),J.setAttributeNS(null,"cx","5.5"),J.setAttributeNS(null,"cy","5.5"),J.setAttributeNS(null,"r","5.4999962");const q=be.createNS("http://www.w3.org/2000/svg","circle");q.setAttributeNS(null,"fill","#FFFFFF"),q.setAttributeNS(null,"cx","5.5"),q.setAttributeNS(null,"cy","5.5"),q.setAttributeNS(null,"r","5.4999962"),W.appendChild(J),W.appendChild(q),E.appendChild(D),E.appendChild(k),E.appendChild(F),E.appendChild(X),E.appendChild(W),u.appendChild(E),u.setAttributeNS(null,"height",p*this._scale+"px"),u.setAttributeNS(null,"width",m*this._scale+"px"),this._element.appendChild(u),this._offset=g.Point.convert(o&&o.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",u=>{u.preventDefault()}),this._element.addEventListener("mousedown",u=>{u.preventDefault()}),qr(this._element,this._anchor,"marker"),o&&o.className)for(const u of o.className.split(" "))this._element.classList.add(u);this._popup=null}addTo(o){return this.remove(),this._map=o,o.getCanvasContainer().appendChild(this._element),o.on("move",this._update),o.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),be.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(o){return this._lngLat=g.LngLat.convert(o),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(o){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),o){if(!("offset"in o.options)){const m=Math.abs(13.5)/Math.SQRT2;o.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[m,-1*(24.6+m)],"bottom-right":[-m,-1*(24.6+m)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=o,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}getPopup(){return this._popup}togglePopup(){const o=this._popup;return o?(o.isOpen()?o.remove():o.addTo(this._map),this):this}getOffset(){return this._offset}setOffset(o){return this._offset=g.Point.convert(o),this._update(),this}addClassName(o){this._element.classList.add(o)}removeClassName(o){this._element.classList.remove(o)}toggleClassName(o){return this._element.classList.toggle(o)}setDraggable(o){return this._draggable=!!o,this._map&&(o?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(o){return this._rotation=o||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(o){return this._rotationAlignment=o||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(o){return this._pitchAlignment=o&&"auto"!==o?o:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}const qs={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Zs=0,ti=!1;const qd={maxWidth:100,unit:"metric"};function tr(_,o,u){const p=u&&u.maxWidth||100,m=_._container.clientHeight/2,b=_.unproject([0,m]),E=_.unproject([p,m]),D=b.distanceTo(E);if(u&&"imperial"===u.unit){const M=3.2808*D;M>5280?fi(o,p,M/5280,_._getUIString("ScaleControl.Miles")):fi(o,p,M,_._getUIString("ScaleControl.Feet"))}else u&&"nautical"===u.unit?fi(o,p,D/1852,_._getUIString("ScaleControl.NauticalMiles")):D>=1e3?fi(o,p,D/1e3,_._getUIString("ScaleControl.Kilometers")):fi(o,p,D,_._getUIString("ScaleControl.Meters"))}function fi(_,o,u,p){const m=function(b){const E=Math.pow(10,`${Math.floor(b)}`.length-1);let D=b/E;return D=D>=10?10:D>=5?5:D>=3?3:D>=2?2:D>=1?1:function(M){const k=Math.pow(10,Math.ceil(-Math.log(M)/Math.LN10));return Math.round(M*k)/k}(D),E*D}(u);_.style.width=o*(m/u)+"px",_.innerHTML=`${m}&nbsp;${p}`}const Wl={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},mo=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function xa(_){if(_){if("number"==typeof _){const o=Math.round(Math.abs(_)/Math.SQRT2);return{center:new g.Point(0,0),top:new g.Point(0,_),"top-left":new g.Point(o,o),"top-right":new g.Point(-o,o),bottom:new g.Point(0,-_),"bottom-left":new g.Point(o,-o),"bottom-right":new g.Point(-o,-o),left:new g.Point(_,0),right:new g.Point(-_,0)}}if(_ instanceof g.Point||Array.isArray(_)){const o=g.Point.convert(_);return{center:o,top:o,"top-left":o,"top-right":o,bottom:o,"bottom-left":o,"bottom-right":o,left:o,right:o}}return{center:g.Point.convert(_.center||[0,0]),top:g.Point.convert(_.top||[0,0]),"top-left":g.Point.convert(_["top-left"]||[0,0]),"top-right":g.Point.convert(_["top-right"]||[0,0]),bottom:g.Point.convert(_.bottom||[0,0]),"bottom-left":g.Point.convert(_["bottom-left"]||[0,0]),"bottom-right":g.Point.convert(_["bottom-right"]||[0,0]),left:g.Point.convert(_.left||[0,0]),right:g.Point.convert(_.right||[0,0])}}return xa(new g.Point(0,0))}const Or={extend:(_,...o)=>g.extend(_,...o),run(_){_()},logToElement(_,o=!1,u="log"){const p=window.document.getElementById(u);p&&(o&&(p.innerHTML=""),p.innerHTML+=`<br>${_}`)}};class rn{static get version(){return"3.3.1"}static get workerCount(){return gr.workerCount}static set workerCount(o){gr.workerCount=o}static get maxParallelImageRequests(){return g.config.MAX_PARALLEL_IMAGE_REQUESTS}static set maxParallelImageRequests(o){g.config.MAX_PARALLEL_IMAGE_REQUESTS=o}static get workerUrl(){return g.config.WORKER_URL}static set workerUrl(o){g.config.WORKER_URL=o}static addProtocol(o,u){g.config.REGISTERED_PROTOCOLS[o]=u}static removeProtocol(o){delete g.config.REGISTERED_PROTOCOLS[o]}}return rn.Map=class extends ml{constructor(_){if(g.PerformanceUtils.mark(g.PerformanceMarkers.create),null!=(_=g.extend({},Gr,_)).minZoom&&null!=_.maxZoom&&_.minZoom>_.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=_.minPitch&&null!=_.maxPitch&&_.minPitch>_.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=_.minPitch&&_.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=_.maxPitch&&_.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new Uo(_.minZoom,_.maxZoom,_.minPitch,_.maxPitch,_.renderWorldCopies),{bearingSnap:_.bearingSnap}),this._cooperativeGesturesOnWheel=o=>{this._onCooperativeGesture(o,o[this._metaKey],1)},this._contextLost=o=>{o.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new g.Event("webglcontextlost",{originalEvent:o}))},this._contextRestored=o=>{this._setupPainter(),this.resize(),this._update(),this.fire(new g.Event("webglcontextrestored",{originalEvent:o}))},this._onMapScroll=o=>{if(o.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=_.interactive,this._cooperativeGestures=_.cooperativeGestures,this._metaKey=0===navigator.platform.indexOf("Mac")?"metaKey":"ctrlKey",this._maxTileCacheSize=_.maxTileCacheSize,this._maxTileCacheZoomLevels=_.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=_.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=_.preserveDrawingBuffer,this._antialias=_.antialias,this._trackResize=_.trackResize,this._bearingSnap=_.bearingSnap,this._refreshExpiredTiles=_.refreshExpiredTiles,this._fadeDuration=_.fadeDuration,this._crossSourceCollisions=_.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=_.collectResourceTiming,this._renderTaskQueue=new lt,this._controls=[],this._mapId=g.uniqueId(),this._locale=g.extend({},ft,_.locale),this._clickTolerance=_.clickTolerance,this._overridePixelRatio=_.pixelRatio,this._maxCanvasSize=_.maxCanvasSize,this.transformCameraUpdate=_.transformCameraUpdate,this._imageQueueHandle=Ur.addThrottleControl(()=>this.isMoving()),this._requestManager=new xc(_.transformRequest),"string"==typeof _.container){if(this._container=document.getElementById(_.container),!this._container)throw new Error(`Container '${_.container}' not found.`)}else{if(!(_.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=_.container}if(_.maxBounds&&this.setMaxBounds(_.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let o=!1;const u=ho(p=>{this._trackResize&&!this._removed&&this.resize(p)._update()},50);this._resizeObserver=new ResizeObserver(p=>{o?u(p):o=!0}),this._resizeObserver.observe(this._container)}this.handlers=new po(this,_),this._cooperativeGestures&&this._setupCooperativeGestures(),this._hash=_.hash&&new Gu("string"==typeof _.hash&&_.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:_.center,zoom:_.zoom,bearing:_.bearing,pitch:_.pitch}),_.bounds&&(this.resize(),this.fitBounds(_.bounds,g.extend({},_.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=_.localIdeographFontFamily,this._validateStyle=_.validateStyle,_.style&&this.setStyle(_.style,{localIdeographFontFamily:_.localIdeographFontFamily}),_.attributionControl&&this.addControl(new wt({customAttribution:_.customAttribution})),_.maplibreLogo&&this.addControl(new fo,_.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",o=>{this._update("style"===o.dataType),this.fire(new g.Event(`${o.dataType}data`,o))}),this.on("dataloading",o=>{this.fire(new g.Event(`${o.dataType}dataloading`,o))}),this.on("dataabort",o=>{this.fire(new g.Event("sourcedataabort",o))})}_getMapId(){return this._mapId}addControl(_,o){if(void 0===o&&(o=_.getDefaultPosition?_.getDefaultPosition():"top-right"),!_||!_.onAdd)return this.fire(new g.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const u=_.onAdd(this);this._controls.push(_);const p=this._controlPositions[o];return-1!==o.indexOf("bottom")?p.insertBefore(u,p.firstChild):p.appendChild(u),this}removeControl(_){if(!_||!_.onRemove)return this.fire(new g.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const o=this._controls.indexOf(_);return o>-1&&this._controls.splice(o,1),_.onRemove(this),this}hasControl(_){return this._controls.indexOf(_)>-1}calculateCameraOptionsFromTo(_,o,u,p){return null==p&&this.terrain&&(p=this.terrain.getElevationForLngLatZoom(u,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(_,o,u,p)}resize(_){var o;const u=this._containerDimensions(),p=u[0],m=u[1],b=this._getClampedPixelRatio(p,m);if(this._resizeCanvas(p,m,b),this.painter.resize(p,m,b),this.painter.overLimit()){const D=this.painter.context.gl;this._maxCanvasSize=[D.drawingBufferWidth,D.drawingBufferHeight];const M=this._getClampedPixelRatio(p,m);this._resizeCanvas(p,m,M),this.painter.resize(p,m,M)}this.transform.resize(p,m),null===(o=this._requestedCameraState)||void 0===o||o.resize(p,m);const E=!this._moving;return E&&(this.stop(),this.fire(new g.Event("movestart",_)).fire(new g.Event("move",_))),this.fire(new g.Event("resize",_)),E&&this.fire(new g.Event("moveend",_)),this}_getClampedPixelRatio(_,o){const{0:u,1:p}=this._maxCanvasSize,m=this.getPixelRatio(),b=_*m,E=o*m;return Math.min(b>u?u/b:1,E>p?p/E:1)*m}getPixelRatio(){var _;return null!==(_=this._overridePixelRatio)&&void 0!==_?_:devicePixelRatio}setPixelRatio(_){this._overridePixelRatio=_,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(_){return this.transform.setMaxBounds(Yn.convert(_)),this._update()}setMinZoom(_){if((_=_??-2)>=-2&&_<=this.transform.maxZoom)return this.transform.minZoom=_,this._update(),this.getZoom()<_&&this.setZoom(_),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(_){if((_=_??22)>=this.transform.minZoom)return this.transform.maxZoom=_,this._update(),this.getZoom()>_&&this.setZoom(_),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(_){if((_=_??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(_>=0&&_<=this.transform.maxPitch)return this.transform.minPitch=_,this._update(),this.getPitch()<_&&this.setPitch(_),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(_){if((_=_??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(_>=this.transform.minPitch)return this.transform.maxPitch=_,this._update(),this.getPitch()>_&&this.setPitch(_),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(_){return this.transform.renderWorldCopies=_,this._update()}getCooperativeGestures(){return this._cooperativeGestures}setCooperativeGestures(_){return this._cooperativeGestures=_,this._cooperativeGestures?this._setupCooperativeGestures():this._destroyCooperativeGestures(),this}project(_){return this.transform.locationPoint(g.LngLat.convert(_),this.style&&this.terrain)}unproject(_){return this.transform.pointLocation(g.Point.convert(_),this.terrain)}isMoving(){var _;return this._moving||(null===(_=this.handlers)||void 0===_?void 0:_.isMoving())}isZooming(){var _;return this._zooming||(null===(_=this.handlers)||void 0===_?void 0:_.isZooming())}isRotating(){var _;return this._rotating||(null===(_=this.handlers)||void 0===_?void 0:_.isRotating())}_createDelegatedListener(_,o,u){if("mouseenter"===_||"mouseover"===_){let p=!1;return{layer:o,listener:u,delegates:{mousemove:b=>{const E=this.getLayer(o)?this.queryRenderedFeatures(b.point,{layers:[o]}):[];E.length?p||(p=!0,u.call(this,new bi(_,this,b.originalEvent,{features:E}))):p=!1},mouseout:()=>{p=!1}}}}if("mouseleave"===_||"mouseout"===_){let p=!1;return{layer:o,listener:u,delegates:{mousemove:E=>{(this.getLayer(o)?this.queryRenderedFeatures(E.point,{layers:[o]}):[]).length?p=!0:p&&(p=!1,u.call(this,new bi(_,this,E.originalEvent)))},mouseout:E=>{p&&(p=!1,u.call(this,new bi(_,this,E.originalEvent)))}}}}{const p=m=>{const b=this.getLayer(o)?this.queryRenderedFeatures(m.point,{layers:[o]}):[];b.length&&(m.features=b,u.call(this,m),delete m.features)};return{layer:o,listener:u,delegates:{[_]:p}}}}on(_,o,u){if(void 0===u)return super.on(_,o);const p=this._createDelegatedListener(_,o,u);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[_]=this._delegatedListeners[_]||[],this._delegatedListeners[_].push(p);for(const m in p.delegates)this.on(m,p.delegates[m]);return this}once(_,o,u){if(void 0===u)return super.once(_,o);const p=this._createDelegatedListener(_,o,u);for(const m in p.delegates)this.once(m,p.delegates[m]);return this}off(_,o,u){return void 0===u?super.off(_,o):(this._delegatedListeners&&this._delegatedListeners[_]&&(p=>{const m=this._delegatedListeners[_];for(let b=0;b<m.length;b++){const E=m[b];if(E.layer===o&&E.listener===u){for(const D in E.delegates)this.off(D,E.delegates[D]);return m.splice(b,1),this}}})(),this)}queryRenderedFeatures(_,o){if(!this.style)return[];let u;const p=_ instanceof g.Point||Array.isArray(_),m=p?_:[[0,0],[this.transform.width,this.transform.height]];if(o=o||(p?{}:_)||{},m instanceof g.Point||"number"==typeof m[0])u=[g.Point.convert(m)];else{const b=g.Point.convert(m[0]),E=g.Point.convert(m[1]);u=[b,new g.Point(E.x,b.y),E,new g.Point(b.x,E.y),b]}return this.style.queryRenderedFeatures(u,o,this.transform)}querySourceFeatures(_,o){return this.style.querySourceFeatures(_,o)}setStyle(_,o){return!1!==(o=g.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},o)).diff&&o.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&_?(this._diffStyle(_,o),this):(this._localIdeographFontFamily=o.localIdeographFontFamily,this._updateStyle(_,o))}setTransformRequest(_){return this._requestManager.setTransformRequest(_),this}_getUIString(_){const o=this._locale[_];if(null==o)throw new Error(`Missing UI string '${_}'`);return o}_updateStyle(_,o){if(o.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(_,o));const u=this.style&&o.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!_)),_?(this.style=new Yi(this,o||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof _?this.style.loadURL(_,o,u):this.style.loadJSON(_,o,u),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Yi(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(_,o){if("string"==typeof _){const u=this._requestManager.transformRequest(_,Kn.Style);g.getJSON(u,(p,m)=>{p?this.fire(new g.ErrorEvent(p)):m&&this._updateDiff(m,o)})}else"object"==typeof _&&this._updateDiff(_,o)}_updateDiff(_,o){try{this.style.setState(_,o)&&this._update(!0)}catch(u){g.warnOnce(`Unable to perform style diff: ${u.message||u.error||u}.  Rebuilding the style from scratch.`),this._updateStyle(_,o)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():g.warnOnce("There is no style added to the map.")}addSource(_,o){return this._lazyInitEmptyStyle(),this.style.addSource(_,o),this._update(!0)}isSourceLoaded(_){const o=this.style&&this.style.sourceCaches[_];if(void 0!==o)return o.loaded();this.fire(new g.ErrorEvent(new Error(`There is no source with ID '${_}'`)))}setTerrain(_){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),_){const o=this.style.sourceCaches[_.source];if(!o)throw new Error(`cannot load terrain, because there exists no source with ID: ${_.source}`);for(const u in this.style._layers){const p=this.style._layers[u];"hillshade"===p.type&&p.source===_.source&&g.warnOnce("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new $o(this.painter,o,_),this.painter.renderToTexture=new ws(this.painter,this.terrain),this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=u=>{"style"===u.dataType?this.terrain.sourceCache.freeRtt():"source"===u.dataType&&u.tile&&(u.sourceId!==_.source||this._elevationFreeze||(this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(u.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform._minEleveationForCurrentTile=0,this.transform.elevation=0;return this.fire(new g.Event("terrain",{terrain:_})),this}getTerrain(){var _,o;return null!==(o=null===(_=this.terrain)||void 0===_?void 0:_.options)&&void 0!==o?o:null}areTilesLoaded(){const _=this.style&&this.style.sourceCaches;for(const o in _){const u=_[o]._tiles;for(const p in u){const m=u[p];if("loaded"!==m.state&&"errored"!==m.state)return!1}}return!0}addSourceType(_,o,u){return this._lazyInitEmptyStyle(),this.style.addSourceType(_,o,u)}removeSource(_){return this.style.removeSource(_),this._update(!0)}getSource(_){return this.style.getSource(_)}addImage(_,o,u={}){const{pixelRatio:p=1,sdf:m=!1,stretchX:b,stretchY:E,content:D}=u;if(this._lazyInitEmptyStyle(),!(o instanceof HTMLImageElement||g.isImageBitmap(o))){if(void 0===o.width||void 0===o.height)return this.fire(new g.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:M,height:k,data:R}=o,F=o;return this.style.addImage(_,{data:new g.RGBAImage({width:M,height:k},new Uint8Array(R)),pixelRatio:p,stretchX:b,stretchY:E,content:D,sdf:m,version:0,userImage:F}),F.onAdd&&F.onAdd(this,_),this}}{const{width:M,height:k,data:R}=g.browser.getImageData(o);this.style.addImage(_,{data:new g.RGBAImage({width:M,height:k},R),pixelRatio:p,stretchX:b,stretchY:E,content:D,sdf:m,version:0})}}updateImage(_,o){const u=this.style.getImage(_);if(!u)return this.fire(new g.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const p=o instanceof HTMLImageElement||g.isImageBitmap(o)?g.browser.getImageData(o):o,{width:m,height:b,data:E}=p;if(void 0===m||void 0===b)return this.fire(new g.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(m!==u.data.width||b!==u.data.height)return this.fire(new g.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image")));const D=!(o instanceof HTMLImageElement||g.isImageBitmap(o));return u.data.replace(E,D),this.style.updateImage(_,u),this}getImage(_){return this.style.getImage(_)}hasImage(_){return _?!!this.style.getImage(_):(this.fire(new g.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(_){this.style.removeImage(_)}loadImage(_,o){Ur.getImage(this._requestManager.transformRequest(_,Kn.Image),o)}listImages(){return this.style.listImages()}addLayer(_,o){return this._lazyInitEmptyStyle(),this.style.addLayer(_,o),this._update(!0)}moveLayer(_,o){return this.style.moveLayer(_,o),this._update(!0)}removeLayer(_){return this.style.removeLayer(_),this._update(!0)}getLayer(_){return this.style.getLayer(_)}setLayerZoomRange(_,o,u){return this.style.setLayerZoomRange(_,o,u),this._update(!0)}setFilter(_,o,u={}){return this.style.setFilter(_,o,u),this._update(!0)}getFilter(_){return this.style.getFilter(_)}setPaintProperty(_,o,u,p={}){return this.style.setPaintProperty(_,o,u,p),this._update(!0)}getPaintProperty(_,o){return this.style.getPaintProperty(_,o)}setLayoutProperty(_,o,u,p={}){return this.style.setLayoutProperty(_,o,u,p),this._update(!0)}getLayoutProperty(_,o){return this.style.getLayoutProperty(_,o)}setGlyphs(_,o={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(_,o),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(_,o,u={}){return this._lazyInitEmptyStyle(),this.style.addSprite(_,o,u,p=>{p||this._update(!0)}),this}removeSprite(_){return this._lazyInitEmptyStyle(),this.style.removeSprite(_),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(_,o={}){return this._lazyInitEmptyStyle(),this.style.setSprite(_,o,u=>{u||this._update(!0)}),this}setLight(_,o={}){return this._lazyInitEmptyStyle(),this.style.setLight(_,o),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(_,o){return this.style.setFeatureState(_,o),this._update()}removeFeatureState(_,o){return this.style.removeFeatureState(_,o),this._update()}getFeatureState(_){return this.style.getFeatureState(_)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let _=0,o=0;return this._container&&(_=this._container.clientWidth||400,o=this._container.clientHeight||300),[_,o]}_setupContainer(){const _=this._container;_.classList.add("maplibregl-map");const o=this._canvasContainer=be.create("div","maplibregl-canvas-container",_);this._interactive&&o.classList.add("maplibregl-interactive"),this._canvas=be.create("canvas","maplibregl-canvas",o),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const u=this._containerDimensions(),p=this._getClampedPixelRatio(u[0],u[1]);this._resizeCanvas(u[0],u[1],p);const m=this._controlContainer=be.create("div","maplibregl-control-container",_),b=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(E=>{b[E]=be.create("div",`maplibregl-ctrl-${E} `,m)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_setupCooperativeGestures(){this._cooperativeGesturesScreen=be.create("div","maplibregl-cooperative-gesture-screen",this._container);let _="boolean"!=typeof this._cooperativeGestures&&this._cooperativeGestures.windowsHelpText?this._cooperativeGestures.windowsHelpText:"Use Ctrl + scroll to zoom the map";0===navigator.platform.indexOf("Mac")&&(_="boolean"!=typeof this._cooperativeGestures&&this._cooperativeGestures.macHelpText?this._cooperativeGestures.macHelpText:"Use \u2318 + scroll to zoom the map"),this._cooperativeGesturesScreen.innerHTML=`\n            <div class="maplibregl-desktop-message">${_}</div>\n            <div class="maplibregl-mobile-message">${"boolean"!=typeof this._cooperativeGestures&&this._cooperativeGestures.mobileHelpText?this._cooperativeGestures.mobileHelpText:"Use two fingers to move the map"}</div>\n        `,this._cooperativeGesturesScreen.setAttribute("aria-hidden","true"),this._canvasContainer.addEventListener("wheel",this._cooperativeGesturesOnWheel,!1),this._canvasContainer.classList.add("maplibregl-cooperative-gestures")}_destroyCooperativeGestures(){be.remove(this._cooperativeGesturesScreen),this._canvasContainer.removeEventListener("wheel",this._cooperativeGesturesOnWheel,!1),this._canvasContainer.classList.remove("maplibregl-cooperative-gestures")}_resizeCanvas(_,o,u){this._canvas.width=Math.floor(u*_),this._canvas.height=Math.floor(u*o),this._canvas.style.width=`${_}px`,this._canvas.style.height=`${o}px`}_setupPainter(){const _={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let o=null;this._canvas.addEventListener("webglcontextcreationerror",p=>{o={requestedAttributes:_},p&&(o.statusMessage=p.statusMessage,o.type=p.type)},{once:!0});const u=this._canvas.getContext("webgl2",_)||this._canvas.getContext("webgl",_);if(!u){const p="Failed to initialize WebGL";throw o?(o.message=p,new Error(JSON.stringify(o))):new Error(p)}this.painter=new zc(u,this.transform),Ar.testSupport(u)}_onCooperativeGesture(_,o,u){return!o&&u<2&&(this._cooperativeGesturesScreen.classList.add("maplibregl-show"),setTimeout(()=>{this._cooperativeGesturesScreen.classList.remove("maplibregl-show")},100)),!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(_){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||_,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(_){return this._update(),this._renderTaskQueue.add(_)}_cancelRenderFrame(_){this._renderTaskQueue.remove(_)}_render(_){const o=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(_),this._removed)return;let u=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const m=this.transform.zoom,b=g.browser.now();this.style.zoomHistory.update(m,b);const E=new g.EvaluationParameters(m,{now:b,fadeDuration:o,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),D=E.crossFadingFactor();1===D&&D===this._crossFadingFactor||(u=!0,this._crossFadingFactor=D),this.style.update(E)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform._minEleveationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,o,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:o,showPadding:this.showPadding}),this.fire(new g.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,g.PerformanceUtils.mark(g.PerformanceMarkers.load),this.fire(new g.Event("load"))),this.style&&(this.style.hasTransitions()||u)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const p=this._sourcesDirty||this._styleDirty||this._placementDirty;return p||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new g.Event("idle")),!this._loaded||this._fullyLoaded||p||(this._fullyLoaded=!0,g.PerformanceUtils.mark(g.PerformanceMarkers.fullLoad)),this}redraw(){return this.style&&(this._frame&&(this._frame.cancel(),this._frame=null),this._render(0)),this}remove(){var _;this._hash&&this._hash.remove();for(const u of this._controls)u.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),Ur.removeThrottleControl(this._imageQueueHandle),null===(_=this._resizeObserver)||void 0===_||_.disconnect();const o=this.painter.context.gl.getExtension("WEBGL_lose_context");o&&o.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),be.remove(this._canvasContainer),be.remove(this._controlContainer),this._cooperativeGestures&&this._destroyCooperativeGestures(),this._container.classList.remove("maplibregl-map"),g.PerformanceUtils.clearMetrics(),this._removed=!0,this.fire(new g.Event("remove"))}triggerRepaint(){this.style&&!this._frame&&(this._frame=g.browser.frame(_=>{g.PerformanceUtils.frame(_),this._frame=null,this._render(_)}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(_){this._showTileBoundaries!==_&&(this._showTileBoundaries=_,this._update())}get showPadding(){return!!this._showPadding}set showPadding(_){this._showPadding!==_&&(this._showPadding=_,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(_){this._showCollisionBoxes!==_&&(this._showCollisionBoxes=_,_?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(_){this._showOverdrawInspector!==_&&(this._showOverdrawInspector=_,this._update())}get repaint(){return!!this._repaint}set repaint(_){this._repaint!==_&&(this._repaint=_,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(_){this._vertices=_,this._update()}get version(){return"3.3.1"}getCameraTargetElevation(){return this.transform.elevation}},rn.NavigationControl=class{constructor(_){this._updateZoomButtons=()=>{const o=this._map.getZoom(),u=o===this._map.getMaxZoom(),p=o===this._map.getMinZoom();this._zoomInButton.disabled=u,this._zoomOutButton.disabled=p,this._zoomInButton.setAttribute("aria-disabled",u.toString()),this._zoomOutButton.setAttribute("aria-disabled",p.toString())},this._rotateCompassArrow=()=>{const o=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=o},this._setButtonTitle=(o,u)=>{const p=this._map._getUIString(`NavigationControl.${u}`);o.title=p,o.setAttribute("aria-label",p)},this.options=g.extend({},Un,_),this._container=be.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",o=>o.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",o=>this._map.zoomIn({},{originalEvent:o})),be.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",o=>this._map.zoomOut({},{originalEvent:o})),be.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",o=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:o}):this._map.resetNorth({},{originalEvent:o})}),this._compassIcon=be.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(_){return this._map=_,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Ht(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){be.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(_,o){const u=be.create("button",_,this._container);return u.type="button",u.addEventListener("click",o),u}},rn.GeolocateControl=class extends g.Evented{constructor(_){super(),this._onSuccess=o=>{if(this._map){if(this._isOutOfMapMaxBounds(o))return this._setErrorState(),this.fire(new g.Event("outofmaxbounds",o)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=o,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(o),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(o),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new g.Event("geolocate",o)),this._finish()}},this._updateCamera=o=>{const u=new g.LngLat(o.coords.longitude,o.coords.latitude),p=o.coords.accuracy,m=this._map.getBearing(),b=g.extend({bearing:m},this.options.fitBoundsOptions),E=Yn.fromLngLat(u,p);this._map.fitBounds(E,b,{geolocateSource:!0})},this._updateMarker=o=>{if(o){const u=new g.LngLat(o.coords.longitude,o.coords.latitude);this._accuracyCircleMarker.setLngLat(u).addTo(this._map),this._userLocationDotMarker.setLngLat(u).addTo(this._map),this._accuracy=o.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=o=>{if(this._map){if(this.options.trackUserLocation)if(1===o.code){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const u=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=u,this._geolocateButton.setAttribute("aria-label",u),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===o.code&&ti)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new g.Event("error",o)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=o=>{if(this._map){if(this._container.addEventListener("contextmenu",u=>u.preventDefault()),this._geolocateButton=be.create("button","maplibregl-ctrl-geolocate",this._container),be.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",!1===o){g.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const u=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=u,this._geolocateButton.setAttribute("aria-label",u)}else{const u=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=u,this._geolocateButton.setAttribute("aria-label",u)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=be.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Go({element:this._dotElement}),this._circleElement=be.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Go({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",u=>{u.geolocateSource||"ACTIVE_LOCK"!==this._watchState||u.originalEvent&&"resize"===u.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new g.Event("trackuserlocationend")))})}},this.options=g.extend({},qs,_)}onAdd(_){return this._map=_,this._container=be.create("div","maplibregl-ctrl maplibregl-ctrl-group"),function(o,u=!1){void 0===Cs||u?void 0!==window.navigator.permissions?window.navigator.permissions.query({name:"geolocation"}).then(p=>{Cs="denied"!==p.state,o(Cs)}).catch(()=>{Cs=!!window.navigator.geolocation,o(Cs)}):(Cs=!!window.navigator.geolocation,o(Cs)):o(Cs)}(this._setupUI),this._container}onRemove(){void 0!==this._geolocationWatchID&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),be.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Zs=0,ti=!1}_isOutOfMapMaxBounds(_){const o=this._map.getMaxBounds(),u=_.coords;return o&&(u.longitude<o.getWest()||u.longitude>o.getEast()||u.latitude<o.getSouth()||u.latitude>o.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const _=this._map.getBounds(),o=_.getSouthEast(),u=_.getNorthEast(),p=o.distanceTo(u),m=Math.ceil(this._accuracy/(p/this._map._container.clientHeight)*2);this._circleElement.style.width=`${m}px`,this._circleElement.style.height=`${m}px`}trigger(){if(!this._setup)return g.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new g.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Zs--,ti=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new g.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new g.Event("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let _;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Zs++,Zs>1?(_={maximumAge:6e5,timeout:0},ti=!0):(_=this.options.positionOptions,ti=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,_)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},rn.AttributionControl=wt,rn.LogoControl=fo,rn.ScaleControl=class{constructor(_){this._onMove=()=>{tr(this._map,this._container,this.options)},this.setUnit=o=>{this.options.unit=o,tr(this._map,this._container,this.options)},this.options=g.extend({},qd,_)}getDefaultPosition(){return"bottom-left"}onAdd(_){return this._map=_,this._container=be.create("div","maplibregl-ctrl maplibregl-ctrl-scale",_.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){be.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},rn.FullscreenControl=class extends g.Evented{constructor(_={}){super(),this._onFullscreenChange=()=>{(window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement)===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,_&&_.container&&(_.container instanceof HTMLElement?this._container=_.container:g.warnOnce("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(_){return this._map=_,this._container||(this._container=this._map.getContainer()),this._controlContainer=be.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){be.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const _=this._fullscreenButton=be.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);be.create("span","maplibregl-ctrl-icon",_).setAttribute("aria-hidden","true"),_.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const _=this._getTitle();this._fullscreenButton.setAttribute("aria-label",_),this._fullscreenButton.title=_}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new g.Event("fullscreenstart")),this._map._cooperativeGestures&&(this._prevCooperativeGestures=this._map._cooperativeGestures,this._map.setCooperativeGestures())):(this.fire(new g.Event("fullscreenend")),this._prevCooperativeGestures&&(this._map.setCooperativeGestures(this._prevCooperativeGestures),delete this._prevCooperativeGestures))}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},rn.TerrainControl=class{constructor(_){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.disableTerrain")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.enableTerrain"))},this.options=_}onAdd(_){return this._map=_,this._container=be.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=be.create("button","maplibregl-ctrl-terrain",this._container),be.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){be.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},rn.Popup=class extends g.Evented{constructor(_){super(),this.remove=()=>(this._content&&be.remove(this._content),this._container&&(be.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new g.Event("close")),this),this._onMouseUp=o=>{this._update(o.point)},this._onMouseMove=o=>{this._update(o.point)},this._onDrag=o=>{this._update(o.point)},this._update=o=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=be.create("div","maplibregl-popup",this._map.getContainer()),this._tip=be.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const E of this.options.className.split(" "))this._container.classList.add(E);this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=ba(this._lngLat,this._pos,this._map.transform)),this._trackPointer&&!o)return;const u=this._pos=this._trackPointer&&o?o:this._map.project(this._lngLat);let p=this.options.anchor;const m=xa(this.options.offset);if(!p){const E=this._container.offsetWidth,D=this._container.offsetHeight;let M;M=u.y+m.bottom.y<D?["top"]:u.y>this._map.transform.height-D?["bottom"]:[],u.x<E/2?M.push("left"):u.x>this._map.transform.width-E/2&&M.push("right"),p=0===M.length?"bottom":M.join("-")}const b=u.add(m[p]).round();be.setTransform(this._container,`${gl[p]} translate(${b.x}px,${b.y}px)`),qr(this._container,p,"popup")},this._onClose=()=>{this.remove()},this.options=g.extend(Object.create(Wl),_)}addTo(_){return this._map&&this.remove(),this._map=_,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new g.Event("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(_){return this._lngLat=g.LngLat.convert(_),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(_){return this.setDOMContent(document.createTextNode(_))}setHTML(_){const o=document.createDocumentFragment(),u=document.createElement("body");let p;for(u.innerHTML=_;p=u.firstChild,p;)o.appendChild(p);return this.setDOMContent(o)}getMaxWidth(){var _;return null===(_=this._container)||void 0===_?void 0:_.style.maxWidth}setMaxWidth(_){return this.options.maxWidth=_,this._update(),this}setDOMContent(_){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=be.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(_),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(_){this._container&&this._container.classList.add(_)}removeClassName(_){this._container&&this._container.classList.remove(_)}setOffset(_){return this.options.offset=_,this._update(),this}toggleClassName(_){if(this._container)return this._container.classList.toggle(_)}_createCloseButton(){this.options.closeButton&&(this._closeButton=be.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const _=this._container.querySelector(mo);_&&_.focus()}},rn.Marker=Go,rn.Style=Yi,rn.LngLat=g.LngLat,rn.LngLatBounds=Yn,rn.Point=g.Point,rn.MercatorCoordinate=g.MercatorCoordinate,rn.Evented=g.Evented,rn.AJAXError=g.AJAXError,rn.config=g.config,rn.CanvasSource=we,rn.GeoJSONSource=_n,rn.ImageSource=Ft,rn.RasterDEMTileSource=Vn,rn.RasterTileSource=Oo,rn.VectorTileSource=Ka,rn.VideoSource=zs,rn.setRTLTextPlugin=g.setRTLTextPlugin,rn.getRTLTextPluginStatus=g.getRTLTextPluginStatus,rn.prewarm=function(){Fo().acquire(Be)},rn.clearPrewarmedResources=function(){const _=Bs;_&&(_.isPreloaded()&&1===_.numActive()?(_.release(Be),Bs=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},Or.extend(rn,{isSafari:g.isSafari,getPerformanceMetrics:g.PerformanceUtils.getPerformanceMetrics}),rn}),Jt}()}},xp=>{xp(xp.s=867)}]);